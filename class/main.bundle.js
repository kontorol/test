webpackJsonp([0],{

/***/ "../../../../../src async recursive":
/***/ (function(module, exports) {

function webpackEmptyContext(req) {
	throw new Error("Cannot find module '" + req + "'.");
}
webpackEmptyContext.keys = function() { return []; };
webpackEmptyContext.resolve = webpackEmptyContext;
module.exports = webpackEmptyContext;
webpackEmptyContext.id = "../../../../../src async recursive";

/***/ }),

/***/ "../../../../../src/assets/svg/176/rec-icon-disable.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "rec-icon-disable.51c93cb129e8f0de655e.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/176/rec-icon.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "rec-icon.e92c608f323390afeb6d.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/18/warn.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "warn.166d9e2617d8c06935d2.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/audio-mute.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "audio-mute.eed69d8f1656dc28baaf.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/audio.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "audio.b1f65c6993f6bed8141c.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/calendar.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "calendar.6a140b295f23c517c0b5.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/camera-disable.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "camera-disable.ebfa2f323a91478a532c.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/camera.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "camera.c12073ec9697de6ed8a6.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/combined-shape.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "combined-shape.4e3024580d0c8d017a15.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/edit.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "edit.bf87acf37887c011739e.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/exit.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "exit.7ea812edd9530afb2797.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/filter.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "filter.f2cdc1449a8e405a9324.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/full-screen.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "full-screen.657553331756a7df91ba.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/home-icon.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "home-icon.72c362974ba5789e6b4e.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/info.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "info.e224dd438702115e8fee.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/library.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "library.c12eed7d9ed73f1d2493.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/login.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "login.f81c135fe38dc3aa3cce.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/logout.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "logout.837b4ce88e4e9ff3b2c2.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/minimize.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "minimize.eab80b093a9f9036cfcf.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/plus-copy.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "plus-copy.b495b4dfe3739734f558.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/plus_large.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "plus_large.18346b776e8a0ce4d94c.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/recurrence.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "recurrence.4dbe4792ff35a52fb589.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/refresh.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "refresh.da5147c880e81522c855.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/resize-app.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "resize-app.3c90dbe5cd10ea0d1e93.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/screen.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "screen.d8d29ca9a3d79d3e7830.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/20/settings.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "settings.040cd0b11e6051863f34.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/32/cancel.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "cancel.c4f3a8089fe8a86d2f03.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/32/pause.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "pause.eb12e7d0c58f2cda62b1.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/32/stop.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "stop.f3224b5f5c847d5bde5e.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/40/camera.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "camera.c12073ec9697de6ed8a6.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/40/warn.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "warn.1d39e57c6e53c4e802d2.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/common/arrow-left.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "arrow-left.8e62716bb2587dea9249.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/common/arrow-right.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "arrow-right.51ceb22db53f60b67475.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/common/back-light.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "back-light.9ae8001e0de377b4f135.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/common/dot.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "dot.622f8924b09abef4067d.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/common/logo-pc-full.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "logo-pc-full.001ebd4b8a24e6853582.svg";

/***/ }),

/***/ "../../../../../src/assets/svg/common/logo.svg":
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__.p + "logo.3e17886a2eb623a835b7.svg";

/***/ }),

/***/ "../../../../../src/classroom/app-info/components/app-info.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"app-info-component\">\r\n\r\n  <div class=\"grid app-info-container\">\r\n\r\n    <div class=\"app-info-panel\">\r\n\r\n      <div class=\"col-12 app-info-header\">\r\n        <div class=\"grid\">\r\n          <div class=\"col-4 no-spaces\">\r\n            <div class=\"app-info-icon-container\">\r\n              <div class=\"app-info-icon info-icon\"></div>\r\n            </div>\r\n            <div class=\"app-info-text\">\r\n              Information\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n      <div class=\"col-12 app-info-body\">\r\n        <div class=\"info-row info-text-label\">Kaltura Classroom</div>\r\n        <div class=\"info-row\">\r\n          <span class=\"info-text-label\">Version:</span>{{_config ? _config.app_version: \"N/A\"}}</div>\r\n        <div class=\"info-row\">\r\n          <button class=\"app-link\" target=\"_blank\" (click)=\"openOpenSourceLicenses()\">Open-Source Libraries</button>\r\n        </div>\r\n        <div class=\"info-row info-text-label\">&copy; Copyright 2017 Kaltura</div>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/app-info/components/app-info.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".app-info-component {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.app-info-container {\n  height: 100%;\n  padding: 3.1% 2.5%;\n  margin: 0; }\n\n.app-info-panel {\n  width: 100%;\n  background-color: rgba(153, 153, 153, 0.1);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05); }\n\n.app-info-text {\n  line-height: 66px;\n  opacity: 0.5;\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 400;\n  font-style: normal;\n  font-stretch: normal;\n  color: #ffffff; }\n\n.app-info-icon-container {\n  position: relative;\n  height: 66px;\n  width: 66px;\n  background-color: #04af8e;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n  margin: 0 16px 0 0;\n  float: left; }\n\n.app-info-icon {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 10px);\n  display: inline-block;\n  height: 20px;\n  width: 20px; }\n\n.app-info-body {\n  line-height: 20px;\n  position: relative;\n  font-family: Lato;\n  font-size: 16px;\n  color: white;\n  padding: 11px 0px 0 85px;\n  margin-right: 26px; }\n\n.app-info-body * {\n  -webkit-user-select: text;\n     -moz-user-select: text;\n      -ms-user-select: text;\n          user-select: text; }\n\n.app-info-body-link {\n  cursor: pointer;\n  color: cornflowerblue;\n  text-decoration: underline; }\n\n.info-text-label {\n  font-weight: 400;\n  letter-spacing: 0.5px;\n  margin-right: 6px; }\n\n.info-row {\n  margin-top: 12px; }\n\n.info-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/info.svg")) + ") no-repeat top left; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/app-info/components/app-info.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppInfoComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let AppInfoComponent = class AppInfoComponent {
    constructor(appConfig) {
        this.appConfig = appConfig;
        this._config = this.appConfig.getConfigData("config.shared");
    }
    openOpenSourceLicenses() {
        __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC("open-external-link", "https://corp.kaltura.com/content/kaltura-lecture-capture-application-open-source-libraries");
    }
};
AppInfoComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-info',
        template: __webpack_require__("../../../../../src/classroom/app-info/components/app-info.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/app-info/components/app-info.component.scss")],
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _a || Object])
], AppInfoComponent);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-info.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/app-settings/components/app-settings/app-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"app-settings-component\">\r\n\r\n  <div class=\"grid app-settings-container\">\r\n\r\n    <div class=\"app-settings-panel\">\r\n\r\n      <div class=\"col-12 app-settings-header\">\r\n        <div class=\"grid\">\r\n          <div class=\"col-4 no-spaces\">\r\n\r\n            <div class=\"app-settings-icon-container\">\r\n              <div class=\"app-settings-icon settings-icon\"></div>\r\n            </div>\r\n            <div class=\"app-settings-text\">\r\n              {{'SETTINGS.panel_title' | translate}}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <div class=\"col-12 app-settings-body grid\">\r\n        <div class=\"settings-tab\" (click)=\"onTabClick('general-settings-tab')\"\r\n             [ngClass]=\"{'tab-selected': selectedTabName === 'general-settings-tab'}\">{{'SETTINGS.general_settings_tab' | translate}}</div>\r\n\r\n        <!--todo remove when network device will be available-->\r\n        <!--<div class=\"tab-separator\"></div>-->\r\n\r\n        <!--<div class=\"settings-tab\" (click)=\"onTabClick('network-device-settings-tab')\"-->\r\n             <!--[ngClass]=\"{'tab-selected': selectedTabName === 'network-device-settings-tab'}\">{{'SETTINGS.network_device_settings_tab' | translate}}</div>-->\r\n\r\n        <div class=\"app-length-sep-line\"></div>\r\n\r\n        <div class=\"settings-tab-content col-12 no-padding-left\">\r\n          <!-- routing here -->\r\n          <router-outlet></router-outlet>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <div class=\"buttons-control\">\r\n        <button class=\"app-settings-cancel-button app-link-button\" [disabled]=\"isCancelButtonDisabled()\" (click)=\"onCancelClicked()\">{{'COMMON.cancel' | translate}}</button>\r\n        <button class=\"app-settings-save-button app-oval-button\" [disabled]=\"isSaveButtonDisabled()\" (click)=\"onSaveClicked()\">{{'COMMON.save' | translate}}</button>\r\n      </div>\r\n\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/app-settings/components/app-settings/app-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".app-settings-component {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.app-settings-container {\n  height: 100%;\n  padding: 3.1% 2.5%;\n  margin: 0; }\n\n.app-settings-panel {\n  width: 100%;\n  position: relative;\n  background-color: rgba(153, 153, 153, 0.1);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05); }\n\n.settings-tab-content {\n  margin-top: 8.1%; }\n\n.app-settings-text {\n  line-height: 66px;\n  opacity: 0.5;\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 400;\n  font-style: normal;\n  font-stretch: normal;\n  color: #ffffff; }\n\n.app-settings-icon-container {\n  position: relative;\n  height: 66px;\n  width: 66px;\n  background-color: #04af8e;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n  margin: 0 16px 0 0;\n  float: left; }\n\n.app-settings-icon {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 10px);\n  display: inline-block;\n  height: 20px;\n  width: 20px; }\n\n.app-settings-body {\n  line-height: 1.5;\n  position: relative;\n  font-family: Lato;\n  font-size: 16px;\n  color: white;\n  padding: 26px 43px 0 85px;\n  margin-right: 26px; }\n\n.app-settings-body * {\n  -webkit-user-select: text;\n     -moz-user-select: text;\n      -ms-user-select: text;\n          user-select: text; }\n\n.settings-tab {\n  cursor: pointer;\n  box-sizing: border-box;\n  height: 29px;\n  font-family: Lato;\n  font-size: 16px;\n  font-weight: 700;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: 1.25;\n  letter-spacing: 0.5px;\n  color: white; }\n\n.tab-selected {\n  border-bottom: 2px solid white; }\n\n.tab-separator {\n  width: 32px; }\n\n.app-settings-confirm-buttons {\n  position: relative;\n  padding: 0; }\n\n.settings-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/settings.svg")) + ") no-repeat top left; }\n\n.buttons-control {\n  position: absolute;\n  top: 3px;\n  right: 0; }\n\n.app-settings-cancel-button, .app-settings-save-button {\n  margin-top: 14px;\n  margin-right: 14px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/app-settings/components/app-settings/app-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("../../../router/@angular/router.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_settings_service__ = __webpack_require__("../../../../../src/classroom/app-settings/services/settings.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppSettingsComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let AppSettingsComponent = class AppSettingsComponent {
    constructor(router, log, settingsService) {
        this.router = router;
        this.log = log;
        this.settingsService = settingsService;
        this.selectedTabName = 'general-settings-tab';
    }
    onTabClick(tabName) {
        this.selectedTabName = tabName;
        this.routeToSettings();
    }
    onCancelClicked() {
        this.settingsService.onCancel();
        this.router.navigate(['']);
    }
    onSaveClicked() {
        this.settingsService.onSave()
            .then(() => {
            this.router.navigate(['']);
        })
            .catch(err => {
            //stay in page...
        });
    }
    isCancelButtonDisabled() {
        return this.settingsService.isInProgress();
    }
    isSaveButtonDisabled() {
        return this.settingsService.isInProgress();
    }
    routeToSettings() {
        switch (this.selectedTabName) {
            case 'general-settings-tab':
                this.router.navigate(['/settings/general-settings']);
                break;
        }
    }
};
AppSettingsComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-settings',
        template: __webpack_require__("../../../../../src/classroom/app-settings/components/app-settings/app-settings.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/app-settings/components/app-settings/app-settings.component.scss")],
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__angular_router__["Router"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__angular_router__["Router"]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__services_settings_service__["a" /* SettingsService */]) === "function" && _c || Object])
], AppSettingsComponent);

var _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-settings.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/app-settings/components/general-settings/general-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"general-settings-component grid col-12 no-padding-left\">\r\n\r\n  <div class=\"general-settings-container col-12 no-padding-left\">\r\n\r\n    <div class=\"resource-name-column col-12 no-padding-left\">\r\n      <div class=\"detail-field-title no-padding-left\">{{'SETTINGS.ClientName' | translate}}</div>\r\n      <div class=\"details-input-field-wrapper no-padding-left\">\r\n        <input  type=\"text\" autofocus #firstInput\r\n                [attr.aria-label]=\"'SETTINGS.ClientName' | translate\"\r\n                [(ngModel)]=\"resourceName\"\r\n                (keyup)=\"onKey($event)\"\r\n                class=\"details-input-field no-padding-left\" >\r\n      </div>\r\n      <div class=\"non-valid-field no-padding-left\" [hidden]=\"!getLastResourceNameError()\">{{getLastResourceNameError() | translate}}</div>\r\n      <div class=\"details-input-field-underline no-padding col-12\"></div>\r\n    </div>\r\n\r\n    <div class=\"resource-id-column col-12 disabled no-padding-left\">\r\n      <div class=\"detail-field-title disabled no-padding-left\">{{'SETTINGS.ResourceID' | translate}}</div>\r\n      <div class=\"details-input-field-wrapper no-padding-left\">\r\n        <input  type=\"text\"\r\n                [attr.aria-label]=\"'SETTINGS.ResourceID' | translate\"\r\n                [ngModel]=\"resourceId\"\r\n                class=\"details-input-field no-padding-left\"\r\n                disabled>\r\n      </div>\r\n      <div class=\"details-input-field-underline no-padding col-12 disabled\"></div>\r\n    </div>\r\n\r\n    <div *ngIf=\"isAdmin\" class=\"col-12 app-settings-body grid no-padding-left general-settings-action\">\r\n      <div [attr.aria-label]=\"'SETTINGS.max_number_of_inputs' | translate\" class=\"detail-field-title general-settings-action-title-container no-padding-left\">\r\n        <div class=\"general-settings-action-title\">{{'SETTINGS.max_number_of_inputs' | translate}}</div>\r\n      </div>\r\n      <div class=\"general-settings-action-button-container\">\r\n        <p-dropdown inputId=\"maxNumberOfSessions_dp\" dropdown-addon autoWidth=\"false\" class=\"max-inputs-dropdown\"\r\n                    (onCustomChange)=\"onMaxInputsChange()\" [options]=\"numOfInputsChoices\" [(ngModel)]=\"maxNumOfSessions\"></p-dropdown>\r\n      </div>\r\n    </div>\r\n\r\n    <div *ngIf=\"isAdmin\" class=\"col-12 app-settings-body grid no-padding-left general-settings-action\">\r\n      <div [attr.aria-label]=\"'SETTINGS.save_admin_defaults' | translate\" class=\"general-settings-action-title-container detail-field-title no-padding-left\">\r\n        <div class=\"general-settings-action-title\">{{'SETTINGS.save_admin_defaults' | translate}}</div>\r\n      </div>\r\n      <div class=\"general-settings-action-button-container\">\r\n        <button [attr.aria-label]=\"'SETTINGS.save_admin_defaults' | translate\"\r\n                class=\"no-drag focus-once small-oval-button general-settings-oval-button\"\r\n                (click)=\"onSaveDefaults()\">\r\n          {{'SETTINGS.save_admin_defaults_button_label' | translate}}\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n  <!-- Log collector -->\r\n  <log-collector *ngIf=\"!userPrivacyEnabled\" [componentSize]=\"'small'\" class=\"grid col-12 general-settings-log-collector no-padding-left\"></log-collector>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/app-settings/components/general-settings/general-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".general-settings-component {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.details-input-field-wrapper {\n  display: -ms-flexbox;\n  display: flex; }\n\n.no-padding {\n  padding: 0; }\n\n.general-settings-oval-button {\n  width: 115px;\n  height: 24px;\n  border-radius: 100px;\n  border: solid 1px white;\n  background-color: rgba(255, 255, 255, 0);\n  font-family: Lato;\n  font-size: 12px;\n  font-weight: 700;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  text-align: center;\n  color: white; }\n\n.save-as-defaults {\n  padding-top: 25px; }\n\n:host /deep/ .max-inputs-dropdown .ui-dropdown {\n  width: 115px !important;\n  height: 34px !important; }\n\n:host /deep/ .max-inputs-dropdown .ui-dropdown-panel {\n  width: 115px !important;\n  min-height: 34px !important; }\n\n.general-settings-action {\n  padding-bottom: 50px; }\n\n.general-settings-action-title-container {\n  width: 210px; }\n\n.general-settings-action-title {\n  width: 190px; }\n\n.general-settings-action-button-container {\n  width: 115px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/app-settings/components/general-settings/general-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("../../../router/@angular/router.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_settings_service__ = __webpack_require__("../../../../../src/classroom/app-settings/services/settings.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return GeneralSettingsComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let GeneralSettingsComponent = class GeneralSettingsComponent {
    constructor(router, settingsService) {
        this.router = router;
        this.settingsService = settingsService;
        this.numOfInputsChoices = [];
        this.maxNumOfSessions = 2;
        this.isAdmin = false;
        this.userPrivacyEnabled = true;
        Promise.all([this.settingsService.hasAdminRights(), this.settingsService.getUserPrivacyStatus()])
            .then(([isAdmin, userPrivacyStatus]) => {
            this.isAdmin = isAdmin;
            this.userPrivacyEnabled = (userPrivacyStatus === 1);
        });
    }
    ngOnInit() {
        this.setMaxNumOfInputsData();
        this.setResourceDetails();
    }
    onSaveDefaults() {
        this.settingsService.saveCurrentSettingsAsDefault();
    }
    onOpenLogsDirClick() {
        this.settingsService.openLogsDir();
    }
    askBeforeLeave() {
        return this.settingsService.askBeforeLeave()
            .then((canLeave) => {
            this.setMaxNumOfInputsData(); //reset to default
            return Promise.resolve(canLeave);
        });
    }
    onKey() {
        this.settingsService.setLastResourceNameError("");
        this.settingsService.setResourceNameLocally(this.resourceName);
    }
    onMaxInputsChange() {
        this.settingsService.setMaxNumOfInputs(this.maxNumOfSessions);
    }
    getLastResourceNameError() {
        return this.settingsService.getLastResourceNameError();
    }
    setResourceDetails() {
        this.resourceName = this.settingsService.getResourceName();
        this.resourceId = this.settingsService.getResourceId();
        this.router.events.subscribe((event) => {
            // when entering the page
            if (event instanceof __WEBPACK_IMPORTED_MODULE_1__angular_router__["NavigationEnd"]) {
                if (this.router.url === '/settings/general-settings') {
                    //we do this twice since refreshResourceNameFromServer take times, and since most of the time the server side doesn't change it we rather display something fast
                    this.resourceName = this.settingsService.getResourceName();
                    this.resourceId = this.settingsService.getResourceId();
                    this.settingsService.setLastResourceNameError("");
                    this.setFocusOnFirstInput();
                    this.settingsService.refreshResourceName()
                        .then(() => {
                        //just to update  the resourceName
                        this.resourceName = this.settingsService.getResourceName();
                        this.resourceId = this.settingsService.getResourceId();
                    })
                        .catch(() => {
                        //not API response, we don't really care
                        return Promise.resolve(true);
                    });
                }
            }
        });
    }
    setFocusOnFirstInput() {
        this.firstInput.nativeElement.focus();
    }
    setMaxNumOfInputsData() {
        this.maxNumOfSessions = this.settingsService.getMaxNumOfInputs();
        this.numOfInputsChoices = [
            { label: "1", value: 1 }, { label: "2", value: 2 }, { label: "3", value: 3 }, { label: "4", value: 4 }
        ];
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('firstInput'),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _a || Object)
], GeneralSettingsComponent.prototype, "firstInput", void 0);
GeneralSettingsComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'general-settings',
        template: __webpack_require__("../../../../../src/classroom/app-settings/components/general-settings/general-settings.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/app-settings/components/general-settings/general-settings.component.scss")]
    }),
    __metadata("design:paramtypes", [typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__angular_router__["Router"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__angular_router__["Router"]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_2__services_settings_service__["a" /* SettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__services_settings_service__["a" /* SettingsService */]) === "function" && _c || Object])
], GeneralSettingsComponent);

var _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/general-settings.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/app-settings/guards/general-settings-component-guard.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return GeneralSettingsComponentGuard; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};

let GeneralSettingsComponentGuard = class GeneralSettingsComponentGuard {
    canDeactivate(generalSettingsComponent) {
        if (generalSettingsComponent) {
            return generalSettingsComponent.askBeforeLeave();
        }
        else {
            return Promise.resolve(true);
        }
    }
};
GeneralSettingsComponentGuard = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])()
], GeneralSettingsComponentGuard);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/general-settings-component-guard.js.map

/***/ }),

/***/ "../../../../../src/classroom/app-settings/services/settings.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_resource_id_resource_id_service__ = __webpack_require__("../../../../../src/shared/services/resource-id/resource-id.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_components_log_collector_log_collector_service__ = __webpack_require__("../../../../../src/shared/components/log-collector/log-collector.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SettingsService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










let SettingsService = class SettingsService {
    constructor(log, appState, appConfig, resourceIdService, logCollectorService, appPersistency) {
        this.log = log;
        this.appState = appState;
        this.appConfig = appConfig;
        this.resourceIdService = resourceIdService;
        this.logCollectorService = logCollectorService;
        this.appPersistency = appPersistency;
        this.lastResourceNameError = "";
    }
    onSave() {
        this.appConfig.setConfigData('config.captureApp.maxNumberOfInputs', this.maxNumOfInputs);
        return this.renameResourceName(this.resourceName)
            .then(() => {
            this.lastResourceNameError = "";
        })
            .catch(err => {
            this.lastResourceNameError = __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].getAPIErrorMessage(err);
        });
    }
    onCancel() {
        this.getMaxNumOfInputs(); //reset number of max inputs value
    }
    getMaxNumOfInputs() {
        this.maxNumOfInputs = this.appConfig.getConfigData('config.captureApp.maxNumberOfInputs');
        return this.maxNumOfInputs;
    }
    setMaxNumOfInputs(numOfInputs) {
        this.maxNumOfInputs = numOfInputs;
    }
    isInProgress() {
        return this.isUploadingLogs();
    }
    hasAdminRights() {
        return __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('hasAdminRights');
    }
    getUserPrivacyStatus() {
        return __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getPartnerUserPrivacyStatus');
    }
    getResourceName() {
        this.resourceName = this.resourceIdService.resourceName;
        return this.resourceName;
    }
    getResourceId() {
        return this.resourceIdService.resourceId;
    }
    refreshResourceName() {
        return this.resourceIdService.refreshResourceNameFromServer();
    }
    renameResourceName(resourceName) {
        return this.resourceIdService.renameResourceName(resourceName);
    }
    saveCurrentSettingsAsDefault() {
        return this.appPersistency.get('')
            .then(persistentData => {
            let defaultSettings = {};
            let sessionNames = __WEBPACK_IMPORTED_MODULE_3_lodash__["concat"](this.appState.getSessionsNames(true), this.appState.getSessionsNames(false));
            __WEBPACK_IMPORTED_MODULE_3_lodash__["forEach"](sessionNames, (sessionName) => {
                defaultSettings[sessionName] = persistentData[sessionName] ? persistentData[sessionName] : { preview: 'disabled' };
            });
            return this.appPersistency.set('defaultSettings', defaultSettings);
        })
            .catch((e) => {
            this.log.error('Failed to save default settings. ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(e));
        });
    }
    openLogsDir() {
        return __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('openDirectory', this.appConfig.getConfigData('config.shared.logsDir'))
            .then(success => {
            if (!success)
                this.log.error('Failed to open logs folder');
        });
    }
    askBeforeLeave() {
        return this.logCollectorService.askBeforeLeave();
    }
    isUploadingLogs() {
        return this.logCollectorService.isUploadingLogs();
    }
    setResourceNameLocally(resourceName) {
        this.resourceName = resourceName;
    }
    getLastResourceNameError() {
        return this.lastResourceNameError;
    }
    setLastResourceNameError(lastResourceNameError) {
        this.lastResourceNameError = lastResourceNameError;
    }
};
SettingsService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_resource_id_resource_id_service__["a" /* ResourceIdService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_resource_id_resource_id_service__["a" /* ResourceIdService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_8__shared_components_log_collector_log_collector_service__["a" /* LogCollectorService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_components_log_collector_log_collector_service__["a" /* LogCollectorService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _f || Object])
], SettingsService);

var _a, _b, _c, _d, _e, _f;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/settings.service.js.map

/***/ }),

/***/ "../../../../../src/classroom/app.component.html":
/***/ (function(module, exports) {

module.exports = "<app-container [containerProperties]=\"containerProperties\"></app-container>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/app.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_system_health_service__ = __webpack_require__("../../../../../src/shared/services/infra/system-health.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_monitoring_app_monitoring_agent_service__ = __webpack_require__("../../../../../src/shared/services/monitoring/app-monitoring-agent.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__classroom_capture_services_scheduling_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/scheduling.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_system_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/system-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_accessability_service__ = __webpack_require__("../../../../../src/shared/services/infra/accessability.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__app_service__ = __webpack_require__("../../../../../src/classroom/app.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









let AppComponent = class AppComponent {
    constructor(log, appService, appNotificationsService, schedulingService, systemData, sysNotificationService, appMonitoring, accessibilityService) {
        this.log = log;
        this.appService = appService;
        this.appNotificationsService = appNotificationsService;
        this.schedulingService = schedulingService;
        this.systemData = systemData;
        this.sysNotificationService = sysNotificationService;
        this.appMonitoring = appMonitoring;
        this.accessibilityService = accessibilityService;
        this.log.info("in AppComponent::constructor");
        this.appService.initLocale();
        this.sysNotificationService.start();
        this.appMonitoring.start();
        this.appService.registerForWindowNotifications();
        this.containerProperties = this.getContainerProperties();
        this.loadApplication();
    }
    loadApplication() {
        this.appService.initCaptureSessions()
            .then(() => {
            this.appService.loadApp(); //need to wait for window to be ready after splash screen
        })
            .then(() => {
            this.appService.handleDefaultSettingsInit();
        });
    }
    /**
     * The Main reason why doing it in a method way is to add outline focus square
     * on tab focus ONLY and not on click focus
     * @param KeyboardEvent
     */
    onKeyUp(event) {
        return this.accessibilityService.markNavigation(event);
    }
    onDocumentClick() {
        this.appService.onDocumentClickHandler();
    }
    getContainerProperties() {
        let properties = {
            header: {
                logoIcon: 'logo-icon',
                buttons: ['minimize_to_tray', 'maximize', 'minimize', 'debug']
            },
            navbar: {
                links: [{
                        linkClass: 'home-nav',
                        label: 'MENU.home',
                        routerLink: '/'
                    },
                    {
                        linkContainer: 'calendar-item',
                        linkClass: 'calendar-nav',
                        label: 'SCHEDULING.scheduling',
                        routerLink: '/scheduling',
                        shouldRender: () => { return this.schedulingService.isSchedulingEnabled; }
                    },
                    {
                        linkClass: 'info-nav',
                        label: 'APP_INFO.title',
                        routerLink: '/info',
                        shouldDisableWhenNotStable: true
                    },
                    {
                        linkContainer: '',
                        linkClass: 'settings-nav',
                        label: 'SETTINGS.panel_title',
                        routerLink: '/settings/general-settings',
                        shouldDisableWhenNotStable: true
                    }
                ]
            },
            showBackLight: true
        };
        return properties;
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('document:keyup', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], AppComponent.prototype, "onKeyUp", null);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('document:click', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", void 0)
], AppComponent.prototype, "onDocumentClick", null);
AppComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-root',
        template: __webpack_require__("../../../../../src/classroom/app.component.html"),
        providers: [__WEBPACK_IMPORTED_MODULE_8__app_service__["a" /* AppService */]]
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_8__app_service__["a" /* AppService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__app_service__["a" /* AppService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_5__classroom_capture_services_scheduling_service__["a" /* SchedulingService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__classroom_capture_services_scheduling_service__["a" /* SchedulingService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_system_data_service__["a" /* SystemDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_system_data_service__["a" /* SystemDataService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_system_health_service__["a" /* SystemHealthService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_system_health_service__["a" /* SystemHealthService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_monitoring_app_monitoring_agent_service__["a" /* AppMonitoringAgentService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_monitoring_app_monitoring_agent_service__["a" /* AppMonitoringAgentService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_accessability_service__["a" /* AccessibilityService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_accessability_service__["a" /* AccessibilityService */]) === "function" && _h || Object])
], AppComponent);

var _a, _b, _c, _d, _e, _f, _g, _h;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/app.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__ = __webpack_require__("../../../platform-browser/@angular/platform-browser.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_forms__ = __webpack_require__("../../../forms/@angular/forms.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_http__ = __webpack_require__("../../../http/@angular/http.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_pipes_shared_pipes_module__ = __webpack_require__("../../../../../src/shared/pipes/shared-pipes.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_directives_shared_directives_module__ = __webpack_require__("../../../../../src/shared/directives/shared-directives.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_infra_module__ = __webpack_require__("../../../../../src/shared/services/infra/infra.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_monitoring_monitoring_module__ = __webpack_require__("../../../../../src/shared/services/monitoring/monitoring.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_services_resource_id_resource_id_module__ = __webpack_require__("../../../../../src/shared/services/resource-id/resource-id.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shared_services_capture_device_capture_device_module__ = __webpack_require__("../../../../../src/shared/services/capture-device/capture-device.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__shared_services_recording_recording_module__ = __webpack_require__("../../../../../src/shared/services/recording/recording.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__shared_components_log_collector_log_collector_module__ = __webpack_require__("../../../../../src/shared/components/log-collector/log-collector.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shared_services_live_live_module__ = __webpack_require__("../../../../../src/shared/services/live/live.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__app_component__ = __webpack_require__("../../../../../src/classroom/app.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__app_info_components_app_info_component__ = __webpack_require__("../../../../../src/classroom/app-info/components/app-info.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__classroom_capture_components_default_app_view_cc_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/cc.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__scheduling_components_scheduling_component__ = __webpack_require__("../../../../../src/classroom/scheduling/components/scheduling.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__app_routing__ = __webpack_require__("../../../../../src/classroom/app.routing.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__classroom_capture_components_default_app_view_recording_details_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/recording-details.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__classroom_capture_components_default_app_view_recording_finalize_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/recording-finalize.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__app_settings_components_app_settings_app_settings_component__ = __webpack_require__("../../../../../src/classroom/app-settings/components/app-settings/app-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__classroom_capture_components_recording_notifications_recording_notifications_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/recording-notifications/recording-notifications.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__utils_minimize_service__ = __webpack_require__("../../../../../src/utils/minimize.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24__classroom_capture_services_recording_manager_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/recording-manager.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25__classroom_capture_services_scheduling_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/scheduling.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__app_settings_services_settings_service__ = __webpack_require__("../../../../../src/classroom/app-settings/services/settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27_primeng_primeng__ = __webpack_require__("../../../../primeng/primeng.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_27_primeng_primeng___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_27_primeng_primeng__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_28__angular_platform_browser_animations__ = __webpack_require__("../../../platform-browser/@angular/platform-browser/animations.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_29_primeng_components_tooltip_tooltip__ = __webpack_require__("../../../../primeng/components/tooltip/tooltip.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_29_primeng_components_tooltip_tooltip___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_29_primeng_components_tooltip_tooltip__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_30__shared_components_app_container_app_container_component__ = __webpack_require__("../../../../../src/shared/components/app-container/app-container.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_31__shared_components_user_login_user_login_component__ = __webpack_require__("../../../../../src/shared/components/user-login/user-login.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_32__app_settings_components_general_settings_general_settings_component__ = __webpack_require__("../../../../../src/classroom/app-settings/components/general-settings/general-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_33_primeng_components_progressbar_progressbar__ = __webpack_require__("../../../../primeng/components/progressbar/progressbar.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_33_primeng_components_progressbar_progressbar___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_33_primeng_components_progressbar_progressbar__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_34_primeng_components_common_confirmationservice__ = __webpack_require__("../../../../primeng/components/common/confirmationservice.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_34_primeng_components_common_confirmationservice___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_34_primeng_components_common_confirmationservice__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_35__app_settings_guards_general_settings_component_guard__ = __webpack_require__("../../../../../src/classroom/app-settings/guards/general-settings-component-guard.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_36__classroom_capture_components_inputs_management_inputs_management_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_37__classroom_capture_components_inputs_management_inputs_management_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_38__classroom_capture_components_inputs_management_add_visual_input_add_visual_input_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/add-visual-input/add-visual-input.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_39__classroom_capture_components_inputs_management_audio_input_audio_input_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input/audio-input.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_40__classroom_capture_components_inputs_management_visual_inputs_container_visual_inputs_container_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-inputs-container.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_41__classroom_capture_components_inputs_management_visual_inputs_container_visual_input_visual_input_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input/visual-input.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_42__classroom_capture_components_inputs_management_visual_inputs_container_visual_input_settings_visual_input_settings_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-settings/visual-input-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_43__classroom_capture_components_inputs_management_visual_inputs_container_visual_input_controllers_visual_input_controllers_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-controllers/visual-input-controllers.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_44__classroom_capture_components_inputs_management_audio_input_settings_audio_settings_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input-settings/audio-settings.component.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};





//shared modules









//main application components




//app routing

//components




//services




//UI components


















let AppModule = class AppModule {
};
AppModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [
            __WEBPACK_IMPORTED_MODULE_5__shared_pipes_shared_pipes_module__["a" /* SharedPipes */],
            __WEBPACK_IMPORTED_MODULE_6__shared_directives_shared_directives_module__["a" /* SharedDirectives */],
            __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_infra_module__["a" /* InfraModule */],
            __WEBPACK_IMPORTED_MODULE_9__shared_services_resource_id_resource_id_module__["a" /* ResourceIdModule */],
            __WEBPACK_IMPORTED_MODULE_8__shared_services_monitoring_monitoring_module__["a" /* MonitoringModule */],
            __WEBPACK_IMPORTED_MODULE_10__shared_services_capture_device_capture_device_module__["a" /* CaptureDeviceModule */],
            __WEBPACK_IMPORTED_MODULE_11__shared_services_recording_recording_module__["a" /* RecordingModule */],
            __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__["BrowserModule"],
            __WEBPACK_IMPORTED_MODULE_3__angular_http__["a" /* HttpModule */],
            __WEBPACK_IMPORTED_MODULE_4_ng2_translate__["a" /* TranslateModule */].forRoot(),
            __WEBPACK_IMPORTED_MODULE_18__app_routing__["a" /* routing */],
            __WEBPACK_IMPORTED_MODULE_2__angular_forms__["FormsModule"],
            __WEBPACK_IMPORTED_MODULE_27_primeng_primeng__["CheckboxModule"],
            __WEBPACK_IMPORTED_MODULE_27_primeng_primeng__["DropdownModule"],
            __WEBPACK_IMPORTED_MODULE_27_primeng_primeng__["DialogModule"],
            __WEBPACK_IMPORTED_MODULE_27_primeng_primeng__["ChipsModule"],
            __WEBPACK_IMPORTED_MODULE_27_primeng_primeng__["ConfirmDialogModule"],
            __WEBPACK_IMPORTED_MODULE_28__angular_platform_browser_animations__["a" /* BrowserAnimationsModule */],
            __WEBPACK_IMPORTED_MODULE_27_primeng_primeng__["AutoCompleteModule"],
            __WEBPACK_IMPORTED_MODULE_29_primeng_components_tooltip_tooltip__["TooltipModule"],
            __WEBPACK_IMPORTED_MODULE_27_primeng_primeng__["SpinnerModule"],
            __WEBPACK_IMPORTED_MODULE_33_primeng_components_progressbar_progressbar__["ProgressBarModule"],
            __WEBPACK_IMPORTED_MODULE_12__shared_components_log_collector_log_collector_module__["a" /* LogCollectorModule */],
            __WEBPACK_IMPORTED_MODULE_13__shared_services_live_live_module__["a" /* LiveModule */]
        ],
        declarations: [
            __WEBPACK_IMPORTED_MODULE_14__app_component__["a" /* AppComponent */],
            __WEBPACK_IMPORTED_MODULE_30__shared_components_app_container_app_container_component__["a" /* AppContainerComponent */],
            __WEBPACK_IMPORTED_MODULE_15__app_info_components_app_info_component__["a" /* AppInfoComponent */],
            __WEBPACK_IMPORTED_MODULE_21__app_settings_components_app_settings_app_settings_component__["a" /* AppSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_32__app_settings_components_general_settings_general_settings_component__["a" /* GeneralSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_17__scheduling_components_scheduling_component__["a" /* SchedulingComponent */],
            __WEBPACK_IMPORTED_MODULE_16__classroom_capture_components_default_app_view_cc_component__["a" /* ClassroomCaptureComponent */],
            __WEBPACK_IMPORTED_MODULE_19__classroom_capture_components_default_app_view_recording_details_component__["a" /* RecordingDetailsComponent */],
            __WEBPACK_IMPORTED_MODULE_20__classroom_capture_components_default_app_view_recording_finalize_component__["a" /* RecordingFinalizeComponent */],
            __WEBPACK_IMPORTED_MODULE_22__classroom_capture_components_recording_notifications_recording_notifications_component__["a" /* RecordingNotificationsComponent */],
            __WEBPACK_IMPORTED_MODULE_31__shared_components_user_login_user_login_component__["a" /* UserLoginComponent */],
            __WEBPACK_IMPORTED_MODULE_36__classroom_capture_components_inputs_management_inputs_management_component__["a" /* InputsManagementsComponent */],
            __WEBPACK_IMPORTED_MODULE_38__classroom_capture_components_inputs_management_add_visual_input_add_visual_input_component__["a" /* AddVisualInputComponent */],
            __WEBPACK_IMPORTED_MODULE_39__classroom_capture_components_inputs_management_audio_input_audio_input_component__["a" /* AudioInputComponent */],
            __WEBPACK_IMPORTED_MODULE_40__classroom_capture_components_inputs_management_visual_inputs_container_visual_inputs_container_component__["a" /* VisualInputsContainerComponent */],
            __WEBPACK_IMPORTED_MODULE_41__classroom_capture_components_inputs_management_visual_inputs_container_visual_input_visual_input_component__["a" /* VisualInputComponent */],
            __WEBPACK_IMPORTED_MODULE_43__classroom_capture_components_inputs_management_visual_inputs_container_visual_input_controllers_visual_input_controllers_component__["a" /* VisualInputControllersComponent */],
            __WEBPACK_IMPORTED_MODULE_42__classroom_capture_components_inputs_management_visual_inputs_container_visual_input_settings_visual_input_settings_component__["a" /* VisualInputSettingsComponent */],
            __WEBPACK_IMPORTED_MODULE_44__classroom_capture_components_inputs_management_audio_input_settings_audio_settings_component__["a" /* AudioSettingsComponent */]
        ],
        providers: [
            __WEBPACK_IMPORTED_MODULE_23__utils_minimize_service__["a" /* MinimizeService */],
            __WEBPACK_IMPORTED_MODULE_24__classroom_capture_services_recording_manager_service__["a" /* RecordingManagerService */],
            __WEBPACK_IMPORTED_MODULE_25__classroom_capture_services_scheduling_service__["a" /* SchedulingService */],
            __WEBPACK_IMPORTED_MODULE_26__app_settings_services_settings_service__["a" /* SettingsService */],
            __WEBPACK_IMPORTED_MODULE_34_primeng_components_common_confirmationservice__["ConfirmationService"],
            __WEBPACK_IMPORTED_MODULE_37__classroom_capture_components_inputs_management_inputs_management_service__["a" /* InputsManagementService */],
            __WEBPACK_IMPORTED_MODULE_35__app_settings_guards_general_settings_component_guard__["a" /* GeneralSettingsComponentGuard */]
        ],
        bootstrap: [__WEBPACK_IMPORTED_MODULE_14__app_component__["a" /* AppComponent */]]
    })
], AppModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app.module.js.map

/***/ }),

/***/ "../../../../../src/classroom/app.routing.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_router__ = __webpack_require__("../../../router/@angular/router.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classroom_capture_components_default_app_view_cc_component__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/cc.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__app_info_components_app_info_component__ = __webpack_require__("../../../../../src/classroom/app-info/components/app-info.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__app_settings_components_app_settings_app_settings_component__ = __webpack_require__("../../../../../src/classroom/app-settings/components/app-settings/app-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__scheduling_components_scheduling_component__ = __webpack_require__("../../../../../src/classroom/scheduling/components/scheduling.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__app_settings_components_general_settings_general_settings_component__ = __webpack_require__("../../../../../src/classroom/app-settings/components/general-settings/general-settings.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__app_settings_guards_general_settings_component_guard__ = __webpack_require__("../../../../../src/classroom/app-settings/guards/general-settings-component-guard.ts");







const appRoutes = [
    { path: 'info', component: __WEBPACK_IMPORTED_MODULE_2__app_info_components_app_info_component__["a" /* AppInfoComponent */] },
    { path: 'scheduling', component: __WEBPACK_IMPORTED_MODULE_4__scheduling_components_scheduling_component__["a" /* SchedulingComponent */] },
    { path: 'settings', component: __WEBPACK_IMPORTED_MODULE_3__app_settings_components_app_settings_app_settings_component__["a" /* AppSettingsComponent */], children: [
            { path: '', redirectTo: 'general-settings', pathMatch: 'full' },
            { path: 'general-settings', component: __WEBPACK_IMPORTED_MODULE_5__app_settings_components_general_settings_general_settings_component__["a" /* GeneralSettingsComponent */], canDeactivate: [__WEBPACK_IMPORTED_MODULE_6__app_settings_guards_general_settings_component_guard__["a" /* GeneralSettingsComponentGuard */]] }
        ] },
    { path: '', component: __WEBPACK_IMPORTED_MODULE_1__classroom_capture_components_default_app_view_cc_component__["a" /* ClassroomCaptureComponent */], pathMatch: 'full' } // redirect to home page on load
];
const routing = __WEBPACK_IMPORTED_MODULE_0__angular_router__["RouterModule"].forRoot(appRoutes);
/* harmony export (immutable) */ __webpack_exports__["a"] = routing;

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app.routing.js.map

/***/ }),

/***/ "../../../../../src/classroom/app.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_minimize_service__ = __webpack_require__("../../../../../src/utils/minimize.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_authentication_service__ = __webpack_require__("../../../../../src/shared/services/infra/authentication.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_services_capture_device_default_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/default-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__shared_services_capture_device_video_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__shared_services_capture_device_audio_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shared_services_infra_session_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/session-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__classroom_capture_components_inputs_management_inputs_management_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};















let AppService = class AppService {
    constructor(log, appState, appConfig, translate, minimizeService, videoService, audioService, authService, defaultSettings, sessionStateService, inputsManagementService) {
        this.log = log;
        this.appState = appState;
        this.appConfig = appConfig;
        this.translate = translate;
        this.minimizeService = minimizeService;
        this.videoService = videoService;
        this.audioService = audioService;
        this.authService = authService;
        this.defaultSettings = defaultSettings;
        this.sessionStateService = sessionStateService;
        this.inputsManagementService = inputsManagementService;
        this.isDefaultSettingsEnabled = false;
        this.registerToInitSessionsEvent();
    }
    initLocale() {
        // this language will be used as a fallback when a translation isn't found in the current language
        this.translate.setDefaultLang('en');
        //get os locale and load translation
        __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getOsLocale')
            .then((locale) => {
            this.translate.use(this.manipulateLocaleCode(locale));
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.translate.use('en');
        });
    }
    registerToInitSessionsEvent() {
        this.appState.notifyDeviceComponentInit$.subscribe(() => {
            this.log.info('Application sessions are being re-init after recording ended');
            this.initCaptureSessions()
                .catch((err) => {
                this.log.error('AppService: Failed to init capture sessions after' +
                    ' notifyDeviceComponentInit. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            });
        });
    }
    registerForWindowNotifications() {
        __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('on-window-maximize', () => {
            this.minimizeService.cancelTrayMinimizationSubscription();
        });
        __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('on-window-move', () => {
            this.minimizeService.cancelTrayMinimizationSubscription();
        });
    }
    onDocumentClickHandler() {
        this.minimizeService.cancelTrayMinimizationSubscription();
        this.authService.restartLoginIdleInterval();
        if (this.isDefaultSettingsEnabled)
            this.defaultSettings.restartInterval();
    }
    handleDefaultSettingsInit() {
        if (this.appConfig.getConfigData('config.captureApp.restoreDefaultSettings.enable')) {
            this.isDefaultSettingsEnabled = true;
            this.defaultSettings.start(() => {
                this.inputsManagementService.fireRefreshInputsEvent();
            });
        }
    }
    initCaptureSessions() {
        this.log.info('AppService: initCaptureSessions');
        let captureSessionsToInitPromises = [];
        return this.appState.getVisualSessionsNamesAndDefaultTypesForInit()
            .then(sessions => {
            __WEBPACK_IMPORTED_MODULE_5_lodash__["forEach"](sessions, (defaultType, sessionName) => {
                captureSessionsToInitPromises.push(this.initVideoCaptureDevice(sessionName, defaultType));
            });
            //adding audio session
            captureSessionsToInitPromises.push(this.initAudioCaptureDevice());
            //init all
            return __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].promiseAllSettled(captureSessionsToInitPromises);
        })
            .then((results) => {
            //no need to do anything, notifications for the user will be sent during device load
            //and app will handle device failures. Just logging errors...
            const failedPromises = results.filter(ps => ps.status !== 'fulfilled');
            const errMsgsReducer = (concatErrMsgs, failedPromise) => concatErrMsgs += (__WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(failedPromise.reason) + '\n');
            if (!__WEBPACK_IMPORTED_MODULE_5_lodash__["isEmpty"](failedPromises))
                this.log.error('AppService: Error while init capture sessions ' + failedPromises.reduce(errMsgsReducer, ''));
            this.log.info('appService sending sessionsInit event');
            this.sessionStateService.sessionsInit.next();
        });
    }
    loadApp() {
        this.log.info('Loading Kaltura Classroom app.');
        return this.appState.sessionsAreReadyPromise
            .then(() => {
            this.log.info('classroom-app-load done loading');
            return __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC("capture-app-load");
        });
    }
    initVideoCaptureDevice(sessionName, defaultCaptureType) {
        return this.videoService.initDevice(sessionName, defaultCaptureType)
            .then(() => {
            return this.videoService.startDevice(sessionName, { left: 0, top: 0, width: 0, height: 0 }); //we don't want to preview the video
        })
            .catch((err) => {
            this.log.error(sessionName + ' init Error ' + ' - ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.videoService.handleDeviceInitError(sessionName, err, { left: 0, top: 0, width: 0, height: 0 }); //we don't want to preview the video
        });
    }
    initAudioCaptureDevice() {
        return this.audioService.initAudioDevice();
    }
    /**
     * according to product - all en-XXXX should be mapped to en locale
     * @param locale
     * @returns {any}
     */
    manipulateLocaleCode(locale) {
        if (!locale) {
            return 'en';
        }
        return locale.substr(0, 2);
    }
};
AppService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_1_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_ng2_translate__["b" /* TranslateService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_6__utils_minimize_service__["a" /* MinimizeService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__utils_minimize_service__["a" /* MinimizeService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_11__shared_services_capture_device_video_device_service__["a" /* VideoDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__shared_services_capture_device_video_device_service__["a" /* VideoDeviceService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_12__shared_services_capture_device_audio_device_service__["a" /* AudioDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_12__shared_services_capture_device_audio_device_service__["a" /* AudioDeviceService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_authentication_service__["a" /* AuthenticationService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_authentication_service__["a" /* AuthenticationService */]) === "function" && _h || Object, typeof (_j = typeof __WEBPACK_IMPORTED_MODULE_9__shared_services_capture_device_default_settings_service__["a" /* DefaultSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__shared_services_capture_device_default_settings_service__["a" /* DefaultSettingsService */]) === "function" && _j || Object, typeof (_k = typeof __WEBPACK_IMPORTED_MODULE_13__shared_services_infra_session_state_service__["a" /* SessionStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_13__shared_services_infra_session_state_service__["a" /* SessionStateService */]) === "function" && _k || Object, typeof (_l = typeof __WEBPACK_IMPORTED_MODULE_14__classroom_capture_components_inputs_management_inputs_management_service__["a" /* InputsManagementService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_14__classroom_capture_components_inputs_management_inputs_management_service__["a" /* InputsManagementService */]) === "function" && _l || Object])
], AppService);

var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app.service.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/cc.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"classroom-capture\">\r\n\r\n  <p-confirmDialog class=\"cc-confirmation\" message=\"{{this.confirmationText | translate}}\" appendTo=\"body\" #rcd dialog-addon role=\"dialog\" aria-modal=\"true\">\r\n    <p-footer class=\"confirm-dialog-footer\">\r\n      <button class=\"app-oval-button\" pButton label=\"{{'COMMON.no' | translate}}\" (click)=\"rcd.reject()\"></button>\r\n      <button class=\"confirm-button app-link-button cc-button\" pButton label=\"{{'COMMON.yes' | translate}}\" (click)=\"rcd.accept()\"></button>\r\n    </p-footer>\r\n  </p-confirmDialog>\r\n\r\n  <div class=\"grid-noGutter no-spaces classroom-capture-grid\">\r\n\r\n    <div *ngIf=\"isAuthEnabled\" class=\"user-login-section\">\r\n      <button class=\"user-login-container\" (click)=\"onLoginClick()\" [disabled]=\"isUserLoginDisabled()\" [attr.aria-label]=\"getLogInActionText() | translate\" >\r\n        <div class=\"user-login-name\">{{getLoggedInUserName() | translate}}</div>\r\n        <div class=\"user-login-button-style\">\r\n          <div class=\"user-login-icon-style\" [ngClass]=\"{'user-login-button-icon' : !isUserLoggedIn(), 'user-logout-button-icon' : isUserLoggedIn()}\"></div>\r\n        </div>\r\n      </button>\r\n    </div>\r\n\r\n    <div class=\"recording-title\">{{getRecordingTitle() | translate | truncate : 20 }}\r\n      <button class=\"edit-recording-button cc-button focus-once\"\r\n              role=\"button\"\r\n              [attr.aria-label]=\"'RECORD_DETAILS.panel_title' | translate\"\r\n              (click)=\"onShowRecordingDetailsPanel('recording-details-edit')\"\r\n              [ngClass]=\"{'active-edit-recording-button' : isRecordingDetailsVisible()}\"\r\n              [disabled]=\"isRecordingDetailsDisabled()\">\r\n      </button>\r\n    </div>\r\n\r\n    <div class=\"cc-recording-notifications-container\" [hidden]=\"hasActivePanel()\">\r\n      <recording-notifications></recording-notifications>\r\n    </div>\r\n\r\n    <recording-finalize class=\"recording-finalize-container\" *ngIf=\"showRecordingFinalDetails\"></recording-finalize>\r\n\r\n    <div class=\"col-12 controls-panel\" [hidden]=\"showRecordingFinalDetails\">\r\n\r\n      <div class=\"recording-container\" [hidden]=\"hasActivePanel() || displayAuthentication\">\r\n\r\n        <div class=\"grid-center no-spaces\">\r\n          <div class=\"grid-column no-spaces recording-controllers\">\r\n            <div class=\"col-12 recording-button-col\">\r\n              <div class=\"grid-center no-margins\">\r\n                <!--Stop button-->\r\n                <div class=\"col-1 recording-button-col\">\r\n                  <div class=\"grid-middle recording-button-grid\">\r\n                    <div class=\"col-12 recording-button-col\">\r\n                      <button [attr.aria-label]=\"getRecordingText() | translate\"  class=\"recording-buttons recording-button-stop focus-once\" *ngIf=\"showRecordControllers()\"\r\n                           (click)=\"onRecordingActionClick('stop')\">\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <!--Start and Pause button-->\r\n                <div class=\"col-3 no-spaces\">\r\n                  <!--Start button-->\r\n                  <button [attr.aria-label]=\"getRecordingText() | translate\"  class=\"recording-button-start\"\r\n                          (click)=\"onRecordingActionClick('start')\" [disabled]=\"!isRecButtonsEnabled()\">\r\n                    <!--Pause button-->\r\n                    <span class=\"recording-buttons recording-button-pause\" *ngIf=\"showPauseButton()\"></span>\r\n                  </button>\r\n                </div>\r\n                <!--Cancel button-->\r\n                <div class=\"col-1 recording-button-col\">\r\n                  <div class=\"grid-middle recording-button-grid\">\r\n                    <div class=\"col-12 recording-button-col\">\r\n                      <button [attr.aria-label]=\"getRecordingText() | translate\"  class=\"recording-buttons recording-button-cancel focus-once\" *ngIf=\"showRecordControllers()\"\r\n                           (click)=\"onRecordingActionClick('cancel')\" #cancelButton>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"col-12\">\r\n              <div class=\"grid-center\">\r\n                <div class=\"recording-timer\" [ngClass]=\"{'recording-timer-disabled' : disableRecordingTime()}\" *ngIf=\"showRecordingTime()\">\r\n                  <div [hidden]=\"!isRecordingScheduledEvent()\" class=\"scheduling-icon\"></div>\r\n                  {{ getRecordingTime() | timer }}\r\n                  <button [hidden]=\"!shouldEnableEventExtension()\" onmouseup=\"this.blur()\" (click)=\"onExtendEventClick()\" class=\"extend-event-container\">\r\n                    <div class=\"extend-event-icon\"></div>\r\n                    <div class=\"extend-event-text\">{{extendEventText}}</div>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div class=\"grid-center\">\r\n                <div class=\"recording-text loading-inputs-text\" *ngIf=\"showLoadingInputsText()\">{{ 'RECORD.loading_inputs' | translate }}</div>\r\n                <div class=\"rec-loader\" *ngIf=\"showRecLoader()\"></div>\r\n                <div class=\"col-3 recording-text\" [ngClass]=\"{'recording-text-paused' : isRecPaused()}\" *ngIf=\"!showRecLoader()\">\r\n                  {{ getRecordingText() | translate }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"settings-container\" [hidden]=\"!hasActivePanel() && !displayAuthentication\">\r\n\r\n        <recording-details *ngIf=\"showRecordingDetails\"></recording-details>\r\n        <audio-settings [hidden]=\"!showAudioComponentSettings\"></audio-settings>\r\n        <user-login-dialog *ngIf=\"displayAuthentication\" (onSuccessfulSubmit)=\"onSuccessfulLogin()\"\r\n                           (onCancelClick)=\"onCancelLogin()\"></user-login-dialog>\r\n\r\n        <!--setting panels for all active visual inputs-->\r\n        <visual-input-settings *ngFor=\"let sessionName of getActiveVisualInputsSessions()\"\r\n                      id=\"sessionName\"\r\n                      [sessionName]=\"sessionName\"\r\n                      [deviceType]=\"activeVisualInputs[sessionName]\"\r\n                      [hidden]=\"!visualInputsPanelsDisplayState[sessionName]\">\r\n        </visual-input-settings>\r\n\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=\"col-12 devices-panel\" [hidden]=\"showRecordingFinalDetails\">\r\n\r\n      <inputs-management></inputs-management>\r\n\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/cc.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".classroom-capture {\n  position: relative;\n  height: 100%; }\n\n.recording-title {\n  position: absolute;\n  cursor: default;\n  top: -54px;\n  left: calc(50% - 80px);\n  width: 160px;\n  margin: auto;\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 600;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: 2.14;\n  text-align: center;\n  color: #ffffff; }\n\n.edit-recording-button {\n  -webkit-app-region: no-drag;\n  position: absolute;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  width: 20px;\n  margin-left: 9px;\n  opacity: 0.5;\n  margin-top: 2px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/edit.svg")) + ") no-repeat top left; }\n\n.edit-recording-button:hover {\n  opacity: 1; }\n\n.active-edit-recording-button {\n  opacity: 1; }\n\n.controls-panel {\n  position: relative;\n  margin: 0;\n  padding: 0;\n  height: 50%; }\n\n.settings-container {\n  height: 100%; }\n\n.devices-panel {\n  position: relative;\n  margin: 0;\n  padding: 0;\n  min-height: 40.55%;\n  height: 50%; }\n\n.recording-container {\n  position: relative;\n  top: 10%;\n  width: 100%; }\n\n.recording-container-grid {\n  padding-top: 12.4%; }\n\n.recording-controllers {\n  width: 100%; }\n\n.recording-buttons {\n  display: block;\n  text-decoration: none;\n  height: 32px;\n  width: 32px;\n  text-indent: -9999px;\n  background-size: 32px 32px;\n  margin: auto;\n  cursor: pointer;\n  border: none; }\n\n.recording-button-grid {\n  height: 100%; }\n\n.recording-button-col {\n  margin: 0;\n  padding: 0; }\n\n.recording-button-start {\n  position: relative;\n  display: block;\n  text-decoration: none;\n  height: 186px;\n  width: 186px;\n  text-indent: -9999px;\n  background-size: 186px 186px;\n  margin: auto;\n  cursor: pointer;\n  border: none;\n  transition: 0.5s;\n  transform: scale(1);\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/176/rec-icon.svg")) + ") no-repeat top left; }\n\n.recording-button-start:focus {\n  outline: none;\n  transform: scale(1.1); }\n\n.recording-button-start:hover {\n  outline: none;\n  transform: scale(1.1); }\n\n.recording-button-start:disabled {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/176/rec-icon-disable.svg")) + ") no-repeat top left; }\n\n.recording-button-stop {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/32/stop.svg")) + ") no-repeat top left;\n  opacity: 0.5; }\n\n.recording-button-stop:hover {\n  opacity: 1; }\n\n.recording-button-stop:focus {\n  opacity: 1;\n  outline: none; }\n\n.recording-button-cancel {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/32/cancel.svg")) + ") no-repeat top left;\n  opacity: 0.5; }\n\n.recording-button-cancel:hover {\n  opacity: 1; }\n\n.recording-button-cancel:focus {\n  opacity: 1;\n  outline: none; }\n\n.recording-button-pause {\n  position: absolute;\n  top: 50%;\n  margin-top: -16px;\n  left: 50%;\n  margin-left: -16px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/32/pause.svg")) + ") no-repeat top left; }\n\n.recording-text {\n  opacity: 0.8;\n  font-family: Lato;\n  font-size: 18px;\n  font-weight: 600;\n  font-style: normal;\n  font-stretch: normal;\n  color: #ffffff;\n  text-align: center; }\n\n.recording-text-paused {\n  width: 173px;\n  height: 27px;\n  font-family: Lato;\n  font-size: 22px;\n  font-weight: 300;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  text-align: center;\n  color: #ffffff; }\n\n.recording-timer {\n  position: relative;\n  width: 143px;\n  height: 44px;\n  font-family: Lato;\n  font-size: 36px;\n  font-weight: 300;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  color: #ffffff;\n  text-align: center; }\n\n.recording-timer-disabled {\n  opacity: 0.5; }\n\n.capture-devices-grid {\n  margin: 0;\n  padding: 0;\n  height: 100%; }\n\n.device-container-col {\n  margin: 0;\n  padding: 0;\n  height: 100%; }\n\n.audio-device-container-col {\n  padding-left: 1.1%;\n  padding-right: 1.1%; }\n\n.video-capture-device-container {\n  width: 44.68%; }\n\n.audio-capture-device-container {\n  width: 8.44%; }\n\n.cc-confirmation .ui-confirmdialog {\n  width: 545px;\n  height: 242px;\n  background-color: #333333;\n  box-shadow: 0 2px 15px 0 rgba(0, 0, 0, 0.25);\n  border: solid 2px #ffffff;\n  left: calc(50% - 242.5px) !important;\n  top: 19.2% !important; }\n\n.cc-confirmation .ui-dialog-content {\n  font-family: Lato;\n  font-size: 20px;\n  font-weight: normal;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  text-align: center;\n  color: #ffffff;\n  margin-top: 67px;\n  margin-bottom: 45px;\n  padding: 0 !important; }\n\n.cc-confirmation .ui-dialog-titlebar {\n  display: none; }\n\n.cc-confirmation .confirm-dialog-footer {\n  position: absolute;\n  width: 200px;\n  left: calc(50% - 100px);\n  bottom: 12px; }\n\n.cc-confirmation .confirm-button {\n  padding-top: 5px; }\n\n.cc-recording-notifications-container {\n  position: absolute;\n  pointer-events: none;\n  top: 89px;\n  left: -66px;\n  z-index: 1; }\n\n.recording-finalize-container {\n  width: 100%;\n  height: 100%; }\n\n.scheduling-icon {\n  position: absolute;\n  left: -31px;\n  top: 13px;\n  width: 20px;\n  height: 20px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/calendar.svg")) + ") no-repeat top left; }\n\n.extend-event-container {\n  position: absolute;\n  width: 115px;\n  height: 24px;\n  left: 156px;\n  top: 10.5px;\n  border-radius: 100px;\n  background-color: rgba(0, 0, 0, 0);\n  border: solid 1px transparent;\n  color: transparent;\n  opacity: 0.5;\n  outline: none; }\n\n.extend-event-container:hover, .extend-event-container:focus {\n  border: solid 1px #ffffff;\n  color: #ffffff;\n  opacity: 1;\n  cursor: pointer;\n  outline: none; }\n\n.extend-event-container:active {\n  box-shadow: inset 0 3px 3px 0 rgba(0, 0, 0, 0.5);\n  outline: none; }\n\n.extend-event-icon {\n  position: absolute;\n  top: 7.5px;\n  left: 9px;\n  width: 10px;\n  height: 10px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/plus-copy.svg")) + ") no-repeat top left; }\n\n.extend-event-text {\n  position: absolute;\n  top: 6px;\n  left: 20px;\n  width: 83px;\n  height: 15px;\n  font-family: Lato;\n  font-size: 12px;\n  font-weight: 600;\n  text-align: center; }\n\n.user-login-section {\n  text-align: right;\n  -webkit-app-region: no-drag;\n  position: absolute;\n  top: -45px;\n  right: 0px;\n  width: 160px;\n  height: 30px; }\n\n.user-login-container {\n  opacity: 0.7;\n  cursor: pointer;\n  position: relative;\n  height: 30px;\n  background: transparent;\n  border: none;\n  outline: none; }\n\n.user-login-container:hover {\n  opacity: 1; }\n\n.user-login-container:disabled,\n.user-login-container[disabled] {\n  cursor: default;\n  opacity: 0.7; }\n\n.user-login-name {\n  position: relative;\n  float: left;\n  right: 10px;\n  top: 9px;\n  min-width: 50px;\n  max-width: 115px;\n  height: 30px;\n  font-family: \"Lato\";\n  font-size: 12px;\n  font-weight: 600;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: 1;\n  letter-spacing: normal;\n  text-align: right;\n  color: #ffffff;\n  text-overflow: ellipsis;\n  overflow: hidden; }\n\n.user-login-button-style {\n  position: relative;\n  float: right;\n  display: inline-block;\n  border-radius: 50%;\n  width: 26px;\n  height: 26px;\n  border: solid 2px #06a885; }\n\n.user-login-icon-style {\n  position: absolute;\n  top: 3px;\n  right: 3px;\n  width: 20px;\n  height: 20px;\n  border: none; }\n\n.user-login-button-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/login.svg")) + ") no-repeat; }\n\n.user-logout-button-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/logout.svg")) + ") no-repeat; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/cc.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_primeng_primeng__ = __webpack_require__("../../../../primeng/primeng.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_primeng_primeng___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_primeng_primeng__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_recording_manager_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/recording-manager.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_capture_device_device_connection_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-connection.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_accessability_service__ = __webpack_require__("../../../../../src/shared/services/infra/accessability.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__shared_services_infra_authentication_service__ = __webpack_require__("../../../../../src/shared/services/infra/authentication.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__cc_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/cc.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__inputs_management_inputs_management_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__angular_router__ = __webpack_require__("../../../router/@angular/router.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ClassroomCaptureComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
















let ClassroomCaptureComponent = class ClassroomCaptureComponent {
    constructor(appState, ccService, zone, panelsService, confirmationService, recordingManagerService, log, deviceManagerService, translate, authService, inputsManagementService, accessibilityService, router) {
        this.appState = appState;
        this.ccService = ccService;
        this.zone = zone;
        this.panelsService = panelsService;
        this.confirmationService = confirmationService;
        this.recordingManagerService = recordingManagerService;
        this.log = log;
        this.deviceManagerService = deviceManagerService;
        this.translate = translate;
        this.authService = authService;
        this.inputsManagementService = inputsManagementService;
        this.accessibilityService = accessibilityService;
        this.router = router;
        this.isAuthEnabled = false;
        this.userAuthStateChangeSub = null;
        this.showRecordingDetails = false;
        this.showRecordingFinalDetails = false;
        this.displayAuthentication = false;
        //inputs settings panels display status
        this.showAudioComponentSettings = false;
        this.visualInputsPanelsDisplayState = [];
        this.confirmationText = '';
        this.extendEventText = '';
        this.pendingRecodingAction = null;
        this.activeVisualInputs = [];
        this.setInitialInputsPanelsAndTheirDisplayState();
        this.registerToVisualInputsRefresh();
        this.registerOnRouteEvents();
    }
    ngOnInit() {
        this.isAuthEnabled = __WEBPACK_IMPORTED_MODULE_12__shared_services_infra_authentication_service__["a" /* AuthenticationService */].isAuthenticationEnabled;
        this.panelsObservables();
        this.registerKeyboardShortcuts();
        this.setExtendEventText();
        this.onUserAuthStateChange();
    }
    ngOnDestroy() {
        if (this.userAuthStateChangeSub)
            this.userAuthStateChangeSub.unsubscribe();
    }
    //stop / start device preview when navigating out/in home page and remove all open dialogs
    registerOnRouteEvents() {
        this.router.events.subscribe((event) => {
            if (event instanceof __WEBPACK_IMPORTED_MODULE_15__angular_router__["NavigationStart"]) {
                //leaving the page
                if (this.router.url === '/' || this.router.url === '/home') {
                    this.ccService.handleRouteNavigationStart();
                    this.closeAllPanels();
                }
            }
            else if (event instanceof __WEBPACK_IMPORTED_MODULE_15__angular_router__["NavigationEnd"]) {
                if (this.router.url === '/' || this.router.url === '/home') {
                    this.ccService.handleRouteNavigationEnd();
                }
            }
        });
    }
    registerToVisualInputsRefresh() {
        this.inputsManagementService.refreshInputs$.subscribe(() => {
            this.log.info('ClassroomCaptureComponent: refresh inputs was fired');
            this.setInitialInputsPanelsAndTheirDisplayState();
        });
    }
    setInitialInputsPanelsAndTheirDisplayState() {
        //remove all current active visual inputs
        __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](this.activeVisualInputs), (key) => {
            delete this.activeVisualInputs[key];
        });
        this.activeVisualInputs = [];
        //remove all current display state
        __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](this.visualInputsPanelsDisplayState), (key) => {
            delete this.visualInputsPanelsDisplayState[key];
        });
        this.visualInputsPanelsDisplayState = [];
        //set all inputs display state to false (hidden)
        this.appState.getVisualSessionsNamesAndDefaultTypesForInit()
            .then((sessions) => {
            __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](sessions), (sessionName) => {
                this.activeVisualInputs[sessionName] = sessions[sessionName];
                this.visualInputsPanelsDisplayState[sessionName] = false;
            });
        });
    }
    getActiveVisualInputsSessions() {
        return __WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](this.activeVisualInputs);
    }
    onSuccessfulLogin() {
        this.closeLoginPanel();
    }
    onUserAuthStateChange() {
        this.userAuthStateChangeSub = this.authService.userAuthUpdate$
            .subscribe((authenticated) => {
            if (authenticated) {
                this.ccService.handleAuthenticatedUserChange()
                    .then((userChanged) => {
                    //if user wasn't changed - call requested action
                    if (!userChanged) {
                        this.onRecordingActionClick(this.pendingRecodingAction);
                    }
                });
            }
        });
    }
    onCancelLogin() {
        this.closeLoginPanel();
    }
    panelsObservables() {
        this.panelsService.currentPanel$.subscribe(panel => {
            switch (panel['type']) {
                case 'recording-details-edit':
                    this.showRecordingDetails = panel['active'];
                    break;
                case 'recording-details-finalize':
                    this.handleRecordingFinalizeChange(panel);
                    break;
                case 'audio-device-settings':
                    this.showAudioComponentSettings = panel['active'];
                    break;
            }
            __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](this.visualInputsPanelsDisplayState), sessionName => {
                if (panel['type'] === sessionName + '-device-settings') {
                    this.visualInputsPanelsDisplayState[sessionName] = panel['active'];
                }
            });
        });
        this.deviceManagerService.deviceConnectionState$.subscribe(event => {
            if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](event)) {
                this.closeAllSettingsPanels();
            }
        });
        //closes all panels on scheduled event start / terminate rec notifications
        this.recordingManagerService.focusOnRecording$.subscribe(data => {
            this.closeAllPanels();
        }, err => this.log.error('scheduling notifications panels removal error. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err)));
    }
    setExtendEventText() {
        this.ccService.getEventTimeInMinutes()
            .then((minutes) => {
            if (!minutes)
                this.extendEventText = '';
            else {
                this.translate.get('SCHEDULING.extend_event', { value: minutes }).subscribe((res) => {
                    this.extendEventText = res;
                });
            }
        });
    }
    closeAllPanels() {
        if (this.showRecordingDetails)
            this.panelsService.updateCurrentPanel({ type: 'recording-details-edit', active: false });
        if (this.showRecordingFinalDetails)
            this.panelsService.updateCurrentPanel({ type: 'recording-details-finalize', active: false, closeOnly: true });
        //close auth login panel if needed
        this.onCancelLogin();
        this.closeAllSettingsPanels();
    }
    closeAllSettingsPanels() {
        //go over all visual inputs settings panels
        __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](this.visualInputsPanelsDisplayState), sessionName => {
            if (this.visualInputsPanelsDisplayState[sessionName]) {
                this.panelsService.updateCurrentPanel({ type: sessionName + '-device-settings', active: false });
                this.visualInputsPanelsDisplayState[sessionName] = false;
            }
        });
        if (this.showAudioComponentSettings)
            this.panelsService.updateCurrentPanel({ type: 'audio-device-settings', active: false });
    }
    /**
     * panelType - 'recording-details-edit' / 'recording-details-finalize'
     */
    onShowRecordingDetailsPanel(panelType) {
        let active = !this.panelsService.isPanelActive('recording-details-edit');
        this.panelsService.updateCurrentPanel({ type: panelType, active: active });
    }
    showLoginPanel() {
        this.closeAllPanels();
        this.displayAuthentication = true;
        this.panelsService.updateCurrentPanel({ type: 'user-login-panel', active: true });
    }
    closeLoginPanel() {
        this.displayAuthentication = false;
        this.panelsService.updateCurrentPanel({ type: 'user-login-panel', active: this.displayAuthentication });
    }
    handleRecordingFinalizeChange(panel) {
        this.showRecordingFinalDetails = panel['active'];
        if (__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](panel['closeOnly'])) {
            //waiting for next ui cycle in order to get element position on page (engine is the one who paint the capture)
            setTimeout(() => {
                if (!this.showRecordingFinalDetails) {
                    this.ccService.startDevicesPreview();
                }
            }, 100);
        }
    }
    /**** UI manipulations ****/
    isRecordEnabled() {
        return this.ccService.isRecordEnabled();
    }
    isRecButtonsEnabled() {
        return this.isRecordEnabled() &&
            (this.appState.isAppStable() || this.appState.isAppRecording());
    }
    hasActivePanel() {
        return !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.panelsService.getCurrentPanel()) ? this.panelsService.getCurrentPanel()['active'] : false;
    }
    isRecordingDetailsVisible() {
        return this.panelsService.isPanelActive('recording-details-edit');
    }
    isRecordingDetailsDisabled() {
        return !this.isRecordingDetailsVisible() &&
            !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.panelsService.getCurrentPanel()) &&
            this.panelsService.getCurrentPanel()['active'];
    }
    isUserLoginDisabled() {
        return (this.authService.isUserLoggedIn() && this.appState.isAppRecording()) ||
            !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.panelsService.getCurrentPanel()) &&
                this.panelsService.getCurrentPanel()['active'];
    }
    showRecordControllers() {
        return this.ccService.showRecordControllers();
    }
    showPauseButton() {
        return this.ccService.showPauseButton();
    }
    showRecordingTime() {
        return this.ccService.showRecordingTime();
    }
    disableRecordingTime() {
        return this.isRecPaused();
    }
    isRecPaused() {
        return this.ccService.isRecPaused();
    }
    getRecordingTime() {
        //can't move it to service due to UI update issues
        this.zone.run(() => this.recordingManagerService.getRecordingTime());
        return this.recordingManagerService.getRecordingTime();
    }
    getRecordingTitle() {
        return this.ccService.getRecordingTitle();
    }
    isRecordingScheduledEvent() {
        return this.ccService.isRecordingScheduledEvent();
    }
    shouldEnableEventExtension() {
        return this.ccService.shouldEnableEventExtension();
    }
    getRecordingText() {
        return this.ccService.getRecordingText();
    }
    showRecLoader() {
        //can't move it to service due to UI update issues
        this.zone.run(() => this.recordingManagerService.recordingIsLoading);
        return this.recordingManagerService.recordingIsLoading ||
            (!this.appState.isAppStable() && !this.appState.isAppRecording());
    }
    showLoadingInputsText() {
        return !this.recordingManagerService.recordingIsLoading &&
            (!this.appState.isAppStable() && !this.appState.isAppRecording());
    }
    /**** Recording UI interactions ****/
    onRecordingActionClick(action) {
        //if need to log in - save user action and display login page
        if (__WEBPACK_IMPORTED_MODULE_12__shared_services_infra_authentication_service__["a" /* AuthenticationService */].isAuthenticationEnabled && !this.authService.isUserLoggedIn()) {
            this.pendingRecodingAction = action;
            this.showLoginPanel();
        }
        else {
            this.pendingRecodingAction = null;
            switch (action) {
                case 'start':
                    this.onRecordClick();
                    break;
                case 'stop':
                    this.onStopRecordClick();
                    break;
                case 'cancel':
                    this.onCancelRecordClick();
                    break;
                case 'none':
                    this.log.info('User logged in with no pending action');
                    break;
                default:
                    this.log.error('Invalid recording action: ' + action);
            }
        }
    }
    onRecordClick() {
        if (this.isRecordEnabled()) {
            if (this.ccService.shouldPauseRecording()) {
                this.ccService.pauseRecording();
            }
            else if (this.ccService.shouldResumeRecording()) {
                this.ccService.resumeRecording();
            }
            else {
                this.shouldStartRecording();
            }
        }
    }
    onStopRecordClick() {
        this.ccService.stopRecording()
            .then((succeeded) => {
            if (succeeded) {
                this.log.info('showing record final screen');
                this.onShowRecordingDetailsPanel('recording-details-finalize');
            }
        });
    }
    onCancelRecordClick() {
        let currentRecState = this.appState.recordingPhase;
        this.confirmationText = 'RECORD.cancel_confirm';
        if (!this.recordingManagerService.actionInProgress) {
            this.ccService.pauseRecording()
                .then(() => {
                this.confirmationService.confirm({
                    message: '',
                    accept: () => {
                        this.ccService.cancelRecording();
                    },
                    reject: () => {
                        if (this.appState.recordingPhase !== 'initial') {
                            if (currentRecState === 'recording') {
                                this.recordingManagerService.callRecordingNextAction('resume');
                            }
                            else {
                                this.recordingManagerService.callRecordingNextAction('pause');
                            }
                        }
                    }
                });
            });
        }
    }
    onExtendEventClick() {
        this.recordingManagerService.extendScheduledEvent();
    }
    isUserLoggedIn() {
        return this.authService.isUserLoggedIn();
    }
    getLoggedInUserName() {
        return this.isUserLoggedIn() ? this.authService.getLoggedInUserId() : 'COMMON.sign_in';
    }
    //user for accessibility
    getLogInActionText() {
        return this.isUserLoggedIn() ? 'COMMON.sign_out' : 'COMMON.sign_in';
    }
    onLoginClick() {
        if (this.isUserLoggedIn()) {
            this.authService.logOut();
        }
        else {
            this.pendingRecodingAction = 'none';
            this.showLoginPanel();
        }
    }
    shouldStartRecording() {
        //if audio is disabled / there are no audio devices - show confirmation to user
        if (__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.appState.getActiveAudioSession())) {
            this.confirmationText = 'RECORD.start_no_audio_confirm';
            this.confirmationService.confirm({
                message: '',
                accept: () => {
                    this.ccService.startRecording();
                }
            });
        }
        else {
            this.ccService.startRecording();
        }
    }
    registerKeyboardShortcuts() {
        __WEBPACK_IMPORTED_MODULE_9__utils_ipcWrapper__["a" /* ipcWrapper */].registerShortcut("CommandOrControl+Shift+R", () => {
            this.log.info('recording button shortcut...');
            this.onRecordingActionClick('start');
        });
        __WEBPACK_IMPORTED_MODULE_9__utils_ipcWrapper__["a" /* ipcWrapper */].registerShortcut("CommandOrControl+Shift+S", () => {
            this.log.info('stop recording button shortcut...');
            __WEBPACK_IMPORTED_MODULE_9__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('setFocusOnMainWindow').catch(() => { });
            if (this.appState.isAppRecording()) {
                this.onRecordingActionClick('stop');
            }
        });
        __WEBPACK_IMPORTED_MODULE_9__utils_ipcWrapper__["a" /* ipcWrapper */].registerShortcut("CommandOrControl+Shift+C", () => {
            this.log.info('cancel recording recording shortcut...');
            __WEBPACK_IMPORTED_MODULE_9__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('setFocusOnMainWindow').catch(() => { });
            if (this.appState.isAppRecording()) {
                this.onRecordingActionClick('cancel');
            }
        });
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('cancelButton'),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _a || Object)
], ClassroomCaptureComponent.prototype, "cancelButton", void 0);
ClassroomCaptureComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'classroom-capture',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/cc.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/cc.component.scss")],
        encapsulation: __WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewEncapsulation"].None,
        providers: [__WEBPACK_IMPORTED_MODULE_3_primeng_primeng__["ConfirmationService"], __WEBPACK_IMPORTED_MODULE_13__cc_service__["a" /* ClassroomCaptureService */]]
    }),
    __metadata("design:paramtypes", [typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_13__cc_service__["a" /* ClassroomCaptureService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_13__cc_service__["a" /* ClassroomCaptureService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["NgZone"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["NgZone"]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_3_primeng_primeng__["ConfirmationService"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3_primeng_primeng__["ConfirmationService"]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_6__services_recording_manager_service__["a" /* RecordingManagerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__services_recording_manager_service__["a" /* RecordingManagerService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _h || Object, typeof (_j = typeof __WEBPACK_IMPORTED_MODULE_8__shared_services_capture_device_device_connection_service__["a" /* DeviceConnectionService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_services_capture_device_device_connection_service__["a" /* DeviceConnectionService */]) === "function" && _j || Object, typeof (_k = typeof __WEBPACK_IMPORTED_MODULE_10_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10_ng2_translate__["b" /* TranslateService */]) === "function" && _k || Object, typeof (_l = typeof __WEBPACK_IMPORTED_MODULE_12__shared_services_infra_authentication_service__["a" /* AuthenticationService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_12__shared_services_infra_authentication_service__["a" /* AuthenticationService */]) === "function" && _l || Object, typeof (_m = typeof __WEBPACK_IMPORTED_MODULE_14__inputs_management_inputs_management_service__["a" /* InputsManagementService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_14__inputs_management_inputs_management_service__["a" /* InputsManagementService */]) === "function" && _m || Object, typeof (_o = typeof __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_accessability_service__["a" /* AccessibilityService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_accessability_service__["a" /* AccessibilityService */]) === "function" && _o || Object, typeof (_p = typeof __WEBPACK_IMPORTED_MODULE_15__angular_router__["Router"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_15__angular_router__["Router"]) === "function" && _p || Object])
], ClassroomCaptureComponent);

var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/cc.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/cc.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_recording_manager_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/recording-manager.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_services_recording_recording_details_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-details.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_authentication_service__ = __webpack_require__("../../../../../src/shared/services/infra/authentication.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ClassroomCaptureService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};











let ClassroomCaptureService = class ClassroomCaptureService {
    constructor(log, appState, appConfig, authService, devicePreviewService, notificationService, persistencyService, recordingManagerService, recordingDetailsService) {
        this.log = log;
        this.appState = appState;
        this.appConfig = appConfig;
        this.authService = authService;
        this.devicePreviewService = devicePreviewService;
        this.notificationService = notificationService;
        this.persistencyService = persistencyService;
        this.recordingManagerService = recordingManagerService;
        this.recordingDetailsService = recordingDetailsService;
    }
    isRecordEnabled() {
        return this.recordingManagerService.isRecordEnabled();
    }
    pauseRecording() {
        return this.recordingManagerService.callRecordingNextAction('pause')
            .catch((err) => {
            this.handleRecordingActionRejection(err, 'NOTIFICATIONS.error_pauseRecording', 'error');
        });
    }
    resumeRecording() {
        this.recordingManagerService.callRecordingNextAction('resume')
            .catch((err) => {
            this.handleRecordingActionRejection(err, 'NOTIFICATIONS.error_resumeRecording', 'error');
        });
    }
    cancelRecording() {
        this.recordingManagerService.callRecordingNextAction('cancel')
            .catch((err) => {
            this.handleRecordingActionRejection(err, 'NOTIFICATIONS.error_cancel', 'error');
        });
    }
    startRecording() {
        this.recordingManagerService.callRecordingNextAction('start')
            .catch((err) => {
            this.handleRecordingActionRejection(err, 'NOTIFICATIONS.error_startRecording', 'error');
        });
    }
    stopRecording() {
        return this.recordingManagerService.callRecordingNextAction('stop')
            .then(() => { return true; })
            .catch((err) => {
            this.handleRecordingActionRejection(err, 'NOTIFICATIONS.error_stopRecording', 'error');
            return false;
        });
    }
    shouldResumeRecording() {
        return this.recordingManagerService.getRecordingPhase() === 'paused';
    }
    shouldPauseRecording() {
        return this.recordingManagerService.getRecordingPhase() === 'recording';
    }
    startDevicesPreview() {
        return this.devicePreviewService.startPreviewSome(Object.keys(this.appState.getActiveVisualSessions()));
    }
    getEventTimeInMinutes() {
        return this.recordingManagerService.getExtendEventTimeInMinutes()
            .then((minutes) => {
            return minutes;
        })
            .catch((err) => {
            this.log.warn('Failed to load event extend time configuration');
            return '';
        });
    }
    showRecordControllers() {
        return this.recordingManagerService.getRecordingPhase() !== 'initial';
    }
    showPauseButton() {
        return this.recordingManagerService.getRecordingPhase() === 'recording';
    }
    showRecordingTime() {
        return this.recordingManagerService.getRecordingPhase() !== 'initial';
    }
    isRecPaused() {
        return this.recordingManagerService.getRecordingPhase() === 'paused';
    }
    getRecordingTitle() {
        let details = this.recordingDetailsService.getRecordingDetails();
        return details && details['title'] ? details['title'] : 'RECORD.new_title';
    }
    isRecordingScheduledEvent() {
        return this.recordingManagerService.isRecordingScheduledEvent();
    }
    shouldEnableEventExtension() {
        return this.recordingManagerService.shouldEnableEventExtension;
    }
    getRecordingText() {
        let recText = '';
        if (this.isRecordEnabled() || this.recordingManagerService.isRecordDisconnected()) {
            switch (this.recordingManagerService.getRecordingPhase()) {
                case 'initial':
                    recText = 'RECORD.start';
                    break;
                case 'paused':
                    recText = 'RECORD.paused';
                    break;
            }
        }
        else if (this.recordingManagerService.isRecIsLoading()) {
            recText = 'RECORD.loading_sources';
        }
        else {
            recText = 'RECORD.choose_source';
        }
        return recText;
    }
    /**
     * if app is in the middle of other user's recording. close it automatically
     * will return true is user was changed
     */
    handleAuthenticatedUserChange() {
        if (!__WEBPACK_IMPORTED_MODULE_8__shared_services_infra_authentication_service__["a" /* AuthenticationService */].isAuthenticationEnabled)
            return Promise.resolve(false);
        return this.persistencyService.get('recording.details')
            .then((recDetails) => {
            let configAppToken = this.appConfig.getConfigData('config.shared.externalSettings.appToken');
            let configUserId = this.appConfig.getConfigData('config.shared.externalSettings.userId');
            //if there is a mismatch between current logged in user and recording's owner (if exists)
            if (recDetails && recDetails['userName'] && recDetails['appToken'] && configAppToken && configUserId &&
                (recDetails['userName'] !== configUserId || recDetails['appToken'] !== configAppToken)) {
                return this.recordingManagerService.finalizeCurrentRecording(true)
                    .then(() => {
                    return true;
                });
            }
            else {
                return Promise.resolve(false);
            }
        });
    }
    handleRouteNavigationStart() {
        this.log.info('routing out - hiding all devices preview');
        this.devicePreviewService.hideAll()
            .then(() => {
            this.log.info('routing out - hiding all devices preview');
        });
    }
    handleRouteNavigationEnd() {
        if (this.isRecordEnabled()) {
            this.log.info('routing in - showing all devices preview');
            this.devicePreviewService.repositionActiveSessionsPreview();
        }
    }
    handleRecordingActionRejection(err, notification, severity) {
        if (__WEBPACK_IMPORTED_MODULE_1_lodash__["isObject"](err) && !__WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](err.code) &&
            (err.code === 'ACTION_IN_PROGRESS' || err.code === 'STATE_TRANSITION_INVALID')) {
            this.log.warn('Recording action is in progress or Requested transition is invalid: ' + err.msg);
        }
        else if (__WEBPACK_IMPORTED_MODULE_1_lodash__["isObject"](err) && !__WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](err[0]) && !__WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](err[0].code) && !this.inEngineErrorsBlackList(err[0].code)) {
            this.notificationService.sendNotification('NOTIFICATIONS.' + err[0].code, severity);
        }
        else {
            this.notificationService.sendNotification(notification, severity);
        }
    }
    inEngineErrorsBlackList(errCode) {
        if (errCode === 'EngineError_UnspecifiedError') {
            return true;
        }
        return false;
    }
};
ClassroomCaptureService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_authentication_service__["a" /* AuthenticationService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_authentication_service__["a" /* AuthenticationService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_4__services_recording_manager_service__["a" /* RecordingManagerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__services_recording_manager_service__["a" /* RecordingManagerService */]) === "function" && _h || Object, typeof (_j = typeof __WEBPACK_IMPORTED_MODULE_7__shared_services_recording_recording_details_service__["a" /* RecordingDetailsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__shared_services_recording_recording_details_service__["a" /* RecordingDetailsService */]) === "function" && _j || Object])
], ClassroomCaptureService);

var _a, _b, _c, _d, _e, _f, _g, _h, _j;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/cc.service.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/recording-details.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"recording-details-component\">\r\n\r\n  <div class=\"grid recording-details-container\">\r\n\r\n    <div class=\"recording-details-panel\">\r\n\r\n      <div class=\"col-12 recording-details-header\">\r\n        <div class=\"grid\">\r\n          <div class=\"col-4 no-spaces\">\r\n            <div class=\"recording-details-image\">\r\n              <div class=\"edit-details-icon\"></div>\r\n            </div>\r\n            <div class=\"edit-details-text\">\r\n              {{'RECORD_DETAILS.panel_title' | translate}}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n      <div class=\"col-12 recording-details-body\">\r\n        <div class=\"grid-2\">\r\n          <div class=\"col\">\r\n            <div class=\"detail-field-title\">{{'RECORD_DETAILS.title' | translate}}</div>\r\n            <input type=\"text\" autofocus #firstInput\r\n                   [attr.aria-label]=\"'RECORD_DETAILS.title' | translate\"\r\n                   [(ngModel)]=\"tempRecordingDetails.title\"\r\n                   class=\"details-input-field\"\r\n                   [disabled]=\"isReadOnly()\">\r\n            <div class=\"details-input-field-underline\"></div>\r\n          </div>\r\n          <div class=\"col\">\r\n            <div class=\"detail-field-title\">{{'RECORD_DETAILS.user_name' | translate}}</div>\r\n            <p-autoComplete inputStyleClass =\"details-input-field\" [(ngModel)]=\"selectedUser\" [suggestions]=\"getUserList()\"\r\n                            (completeMethod)=\"filterUserList($event)\" field=\"id\" [size]=\"40\" (ngModelChange)=\"onUserChange($event)\"\r\n                            [attr.aria-label]=\"'RECORD_DETAILS.user_name' | translate\"\r\n                            [minLength]=\"3\" [disabled]=\"isUserNameDisabled()\" (onFocus)=\"onUserNameFieldClick()\">\r\n              <template let-selectedUser pTemplate=\"item\">\r\n                {{selectedUser.fullName}} ({{selectedUser.id}})\r\n              </template>\r\n            </p-autoComplete>\r\n            <div class=\"non-valid-field\" [hidden]=\"isUserNameValid()\">{{'RECORD_DETAILS.invalid_user_name' | translate}}</div>\r\n            <div class=\"offline-field\" [hidden]=\"!isUserListOffline()\">{{'RECORD_DETAILS.offline_userList' | translate}}</div>\r\n            <div class=\"details-input-field-underline\">\r\n            </div>\r\n          </div>\r\n          <div class=\"col\">\r\n            <div class=\"detail-field-title\">{{'RECORD_DETAILS.description' | translate}}</div>\r\n            <textarea auto-resize [(ngModel)]=\"tempRecordingDetails.description\" [maxRows]=\"3\"\r\n                      [attr.aria-label]=\"'RECORD_DETAILS.description' | translate\"\r\n                      [rowHeight]=\"20\" rows=\"1\" type=\"text\" class=\"details-input-field\" [disabled]=\"isReadOnly()\"></textarea>\r\n            <div class=\"details-input-field-underline\"></div>\r\n          </div>\r\n          <div class=\"col\">\r\n            <div class=\"detail-field-title\">{{'RECORD_DETAILS.tags' | translate}}</div>\r\n            <div class=\"details-input-tags\">\r\n              <p-chips tags-chips\r\n                       [attr.aria-label]=\"'RECORD_DETAILS.tags' | translate\"\r\n                       [(ngModel)]=\"tempRecordingDetails.tags\"\r\n                       [disabled]=\"isReadOnly()\"></p-chips>\r\n            </div>\r\n            <div class=\"details-input-field-underline\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <span class=\"buttons-control\">\r\n          <button *ngIf=\"isReadOnly()\" class=\"recording-details-back app-oval-button\" (click)=\"onCancelDetailsClick()\">\r\n            {{'COMMON.back' | translate}}\r\n          </button>\r\n          <button *ngIf=\"!isReadOnly()\"\r\n                  class=\"recording-details-cancel app-link-button\" (click)=\"onCancelDetailsClick()\">\r\n            {{'COMMON.cancel' | translate}}\r\n          </button>\r\n          <button *ngIf=\"!isReadOnly()\" class=\"recording-details-save app-oval-button\" (click)=\"onSaveDetailsClick()\">\r\n            {{'COMMON.save' | translate}}\r\n          </button>\r\n      </span>\r\n\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/recording-details.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".recording-details-component {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.recording-details-container {\n  height: 100%;\n  padding: 3.1% 2.5%;\n  margin: 0; }\n\n.recording-details-panel {\n  width: 100%;\n  position: relative;\n  background-color: rgba(153, 153, 153, 0.1);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05); }\n\n.recording-details-header {\n  height: 66px; }\n\n.recording-details-image {\n  position: relative;\n  height: 66px;\n  width: 66px;\n  background-color: #04af8e;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n  margin: 0 16px 0 0;\n  float: left; }\n\n.edit-details-icon {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 10px);\n  display: inline-block;\n  height: 20px;\n  width: 20px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/edit.svg")) + ") no-repeat top left; }\n\n.buttons-control {\n  position: absolute;\n  top: 14px;\n  right: 13px; }\n\n.recording-details-back, .recording-details-cancel {\n  margin-right: 14px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/recording-details.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_recording_recording_details_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-details.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordingDetailsComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





let RecordingDetailsComponent = class RecordingDetailsComponent {
    constructor(recordingDetailsService, panelsService, log) {
        this.recordingDetailsService = recordingDetailsService;
        this.panelsService = panelsService;
        this.log = log;
        this.mySubscription = null;
        this.validSave = true;
        this.tempRecordingDetails = {};
        this.selectedUser = null;
        this.mySubscription = this.panelsService.currentPanel$
            .subscribe(panel => { this.onPanelUpdate(panel); });
    }
    ngOnInit() {
        this.validSave = true;
        let panelObj = this.panelsService.getCurrentPanel();
        if (panelObj['type'] === 'recording-details-edit' && panelObj['active'] === true) {
            this.tempRecordingDetails = __WEBPACK_IMPORTED_MODULE_2_lodash__["cloneDeep"](this.recordingDetailsService.getRecordingDetails());
        }
        this.setFocusOnFirstInput();
    }
    filterUserList(event) {
        this.recordingDetailsService.filterUserList(event.query);
    }
    getUserList() {
        return this.recordingDetailsService.userList;
    }
    onSaveDetailsClick() {
        if (this.recordingDetailsService.isUserNameValidForSave(this.selectedUser)) {
            this.tempRecordingDetails['userName'] = __WEBPACK_IMPORTED_MODULE_2_lodash__["isObject"](this.selectedUser) ? this.selectedUser['id'] : this.selectedUser;
            this.recordingDetailsService.setRecordingDetails(this.tempRecordingDetails);
            this.onCancelDetailsClick();
        }
        else {
            this.validSave = false;
        }
    }
    onCancelDetailsClick() {
        this.panelsService.updateCurrentPanel({ type: 'recording-details-edit', active: false });
    }
    ngOnDestroy() {
        this.mySubscription.unsubscribe();
    }
    isReadOnly() {
        return this.recordingDetailsService.isReadOnly();
    }
    isUserNameDisabled() {
        return this.recordingDetailsService.isUserNameDisabled();
    }
    onUserChange(text) {
        this.recordingDetailsService.onAutoCompleteUserChange(text);
    }
    isUserNameValid() {
        return this.recordingDetailsService.isUserNameValid(this.selectedUser) && this.validSave;
    }
    isUserListOffline() {
        return this.recordingDetailsService.isUserListOffline();
    }
    onUserNameFieldClick() {
        this.validSave = true;
    }
    /* Accessibility */
    setFocusOnFirstInput() {
        setTimeout(() => {
            this.firstInput.nativeElement.focus();
        });
    }
    onPanelUpdate(panel) {
        if (panel['type'] === 'recording-details-edit' && panel['active'] === true) {
            this.tempRecordingDetails = __WEBPACK_IMPORTED_MODULE_2_lodash__["cloneDeep"](this.recordingDetailsService.getRecordingDetails());
            if (!__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.recordingDetailsService.getAuthenticatedUserName()))
                this.tempRecordingDetails['userName'] = this.recordingDetailsService.getAuthenticatedUserName();
            this.selectedUser = { id: this.tempRecordingDetails['userName'] };
        }
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('firstInput'),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _a || Object)
], RecordingDetailsComponent.prototype, "firstInput", void 0);
RecordingDetailsComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'recording-details',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/recording-details.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/recording-details.component.scss"), __webpack_require__("../../../../../src/classroom/classroom-capture/styles/recording-details.scss")],
    }),
    __metadata("design:paramtypes", [typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_recording_recording_details_service__["a" /* RecordingDetailsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_recording_recording_details_service__["a" /* RecordingDetailsService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _d || Object])
], RecordingDetailsComponent);

var _a, _b, _c, _d;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/recording-details.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/recording-finalize.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"recording-final-details-component\">\r\n\r\n  <div class=\"grid recording-final-details-container\">\r\n\r\n    <div class=\"recording-final-details-panel\">\r\n\r\n      <div class=\"col-12 recording-final-details-header\">\r\n        <div class=\"grid\">\r\n          <div class=\"col-4 no-spaces\">\r\n            <div class=\"recording-final-details-image\">\r\n              <div class=\"final-details-icon\"></div>\r\n            </div>\r\n            <div class=\"edit-details-text\">\r\n              {{'RECORD_DETAILS.panel_title_complete' | translate}}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"col-12 recording-details-body\">\r\n        <div class=\"grid\">\r\n          <div class=\"col-12\">\r\n            <div class=\"recording-details-alert-container\" *ngIf=\"shouldDisplayAnAlert()\">\r\n              <div class=\"recording-details-alert-icon\"></div>\r\n              <div class=\"recording-details-alert-text\">\r\n                {{alertMsg}}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12\">\r\n            <div class=\"detail-field-title\">{{'RECORD_DETAILS.title' | translate}}</div>\r\n            <input type=\"text\" autofocus #firstInput\r\n                   [(ngModel)]=\"tempRecordingDetails.title\"\r\n                   [attr.aria-label]=\"'RECORD_DETAILS.title' | translate\"\r\n                   class=\"details-input-field\" [disabled]=\"isReadOnly()\">\r\n            <div class=\"details-input-field-underline\"></div>\r\n          </div>\r\n          <div class=\"col-12\">\r\n            <div class=\"detail-field-title\">{{'RECORD_DETAILS.user_name' | translate}}</div>\r\n            <p-autoComplete inputStyleClass =\"details-input-field\" [(ngModel)]=\"selectedUser\" [suggestions]=\"getUserList()\"\r\n                            (completeMethod)=\"filterUserList($event)\" field=\"id\" [size]=\"40\" (ngModelChange)=\"onUserChange($event)\"\r\n                            [attr.aria-label]=\"'RECORD_DETAILS.user_name' | translate\"\r\n                            [minLength]=\"3\" [disabled]=\"isUserNameDisabled()\" (onFocus)=\"onUserNameFieldClick()\">\r\n              <template let-selectedUser pTemplate=\"item\">\r\n                {{selectedUser.fullName}} ({{selectedUser.id}})\r\n              </template>\r\n            </p-autoComplete>\r\n            <div class=\"non-valid-field\" [hidden]=\"isUserNameValid()\">{{'RECORD_DETAILS.invalid_user_name' | translate}}</div>\r\n            <div class=\"offline-field\" [hidden]=\"!isUserListOffline()\">{{'RECORD_DETAILS.offline_userList' | translate}}</div>\r\n            <div class=\"details-input-field-underline\">\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12\">\r\n            <div class=\"detail-field-title\">{{'RECORD_DETAILS.description' | translate}}</div>\r\n            <textarea auto-resize [(ngModel)]=\"tempRecordingDetails.description\" [maxRows]=\"3\"\r\n                      [attr.aria-label]=\"'RECORD_DETAILS.description' | translate\"\r\n                      [rowHeight]=\"20\" rows=\"1\" type=\"text\" class=\"details-input-field\" [disabled]=\"isReadOnly()\"></textarea>\r\n            <div class=\"details-input-field-underline\"></div>\r\n          </div>\r\n          <div class=\"col-12\">\r\n            <div class=\"detail-field-title\">{{'RECORD_DETAILS.tags' | translate}}</div>\r\n            <div class=\"details-input-tags\">\r\n              <p-chips\r\n                 tags-chips [(ngModel)]=\"tempRecordingDetails.tags\" [disabled]=\"isReadOnly()\"></p-chips>\r\n            </div>\r\n            <div class=\"details-input-field-underline\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"buttons-control\">\r\n        <button class=\"finalize-cancel-button app-link-button\" (click)=\"onCancelDetailsClick()\">{{'COMMON.cancel' | translate}}</button>\r\n        <button class=\"finalize-save-button app-oval-button\" (click)=\"onSaveDetailsClick()\">{{'COMMON.save' | translate}}</button>\r\n      </div>\r\n\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/recording-finalize.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".recording-final-details-component {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.recording-final-details-container {\n  height: 100%;\n  padding: 3.1% 2.5%;\n  margin: 0; }\n\n.recording-final-details-panel {\n  width: 100%;\n  position: relative;\n  background-color: rgba(153, 153, 153, 0.1);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05); }\n\n.recording-final-details-header {\n  height: 66px; }\n\n.recording-final-details-image {\n  position: relative;\n  height: 66px;\n  width: 66px;\n  background-color: #04af8e;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n  margin: 0 16px 0 0;\n  float: left; }\n\n.final-details-icon {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 10px);\n  display: inline-block;\n  height: 20px;\n  width: 20px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/combined-shape.svg")) + ") no-repeat top left; }\n\n.recording-details-alert-container {\n  position: relative;\n  width: 622px;\n  height: 60px;\n  background-color: rgba(255, 255, 255, 0.05);\n  border: solid 1px rgba(255, 255, 255, 0.5); }\n\n.recording-details-alert-icon {\n  position: absolute;\n  top: 14px;\n  left: 14px;\n  height: 20px;\n  width: 20px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/18/warn.svg")) + ") no-repeat top left; }\n\n.recording-details-alert-text {\n  width: 564px;\n  height: 52px;\n  position: absolute;\n  font-family: Lato;\n  font-weight: 400;\n  font-size: 16px;\n  line-height: 1.55;\n  color: #ffffff;\n  top: 50%;\n  left: calc(50% + 18px);\n  transform: translate(-50%, -50%) !important; }\n\n.finalize-save-button, .finalize-cancel-button {\n  margin-top: 14px;\n  margin-right: 14px; }\n\n.buttons-control {\n  position: absolute;\n  top: 0;\n  right: 0; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/default-app-view/recording-finalize.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_recording_recording_details_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-details.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_recording_manager_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/recording-manager.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__services_scheduling_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/scheduling.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordingFinalizeComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









let RecordingFinalizeComponent = class RecordingFinalizeComponent {
    constructor(recordingDetailsService, recordingManagerService, panelsService, log, notificationService, schedulingService, translate) {
        this.recordingDetailsService = recordingDetailsService;
        this.recordingManagerService = recordingManagerService;
        this.panelsService = panelsService;
        this.log = log;
        this.notificationService = notificationService;
        this.schedulingService = schedulingService;
        this.translate = translate;
        this.mySubscription = null;
        this.tempRecordingDetails = {};
        this.validSave = true;
        this.isSaveClicked = false;
        this.selectedUser = null;
        this.alertMsg = '';
        this.mySubscription = this.panelsService.currentPanel$.subscribe(panel => {
            if (panel['type'] === 'recording-details-finalize' && panel['active'] === true) {
                this.tempRecordingDetails = __WEBPACK_IMPORTED_MODULE_2_lodash__["cloneDeep"](this.recordingDetailsService.getRecordingDetails());
                this.selectedUser = { id: this.tempRecordingDetails['userName'] };
            }
        });
    }
    ngOnInit() {
        this.validSave = true;
        if (this.shouldDisplayAnAlert()) {
            this.setRelevantAlert();
        }
        this.setFocusOnFirstInput();
    }
    /* Accessibility */
    setFocusOnFirstInput() {
        this.firstInput.nativeElement.focus();
    }
    filterUserList(event) {
        this.recordingDetailsService.filterUserList(event.query);
    }
    getUserList() {
        return this.recordingDetailsService.userList;
    }
    onSaveDetailsClick() {
        this.isSaveClicked = true;
        if (this.recordingDetailsService.isUserNameValidForSave(this.selectedUser)) {
            this.log.info('Save current recording was clicked by the user.');
            this.tempRecordingDetails['userName'] = __WEBPACK_IMPORTED_MODULE_2_lodash__["isObject"](this.selectedUser) ? this.selectedUser['id'] : this.selectedUser;
            this.recordingDetailsService.setRecordingDetails(this.tempRecordingDetails);
            return this.recordingManagerService.finalizeCurrentRecording(true)
                .catch(() => { }) //there is nothing to do here, all is being taken case of in recording manager
                .then(() => {
                this.panelsService.updateCurrentPanel({ type: 'recording-details-finalize', active: false });
            });
        }
        else {
            this.validSave = false;
        }
    }
    onCancelDetailsClick() {
        this.panelsService.updateCurrentPanel({ type: 'recording-details-finalize', active: false });
    }
    isUserNameValid() {
        return this.recordingDetailsService.isUserNameValid(this.selectedUser) && this.validSave;
    }
    isUserListOffline() {
        return this.recordingDetailsService.isUserListOffline();
    }
    setRelevantAlert() {
        let alertMsg = '';
        let params = {};
        //if it is a scheduled event alert
        if (!__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.schedulingService.getCurrentEvent())) {
            let remainingTime = this.schedulingService.getCurrentEventRemainingInMin();
            if (remainingTime)
                alertMsg = remainingTime === 1 ?
                    'SCHEDULING.save_before_end_notification_minute' : 'SCHEDULING.save_before_end_notification_minutes';
            params['value'] = remainingTime;
        }
        this.translate.get(alertMsg, params).subscribe((res) => {
            this.alertMsg = res;
        });
    }
    onUserNameFieldClick() {
        this.validSave = true;
    }
    isReadOnly() {
        return this.recordingDetailsService.isReadOnly();
    }
    isUserNameDisabled() {
        return this.recordingDetailsService.isUserNameDisabled();
    }
    ngOnDestroy() {
        this.mySubscription.unsubscribe();
    }
    shouldDisplayAnAlert() {
        return !__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.schedulingService.getCurrentEvent());
    }
    onUserChange(text) {
        this.recordingDetailsService.onAutoCompleteUserChange(text);
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('firstInput'),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _a || Object)
], RecordingFinalizeComponent.prototype, "firstInput", void 0);
RecordingFinalizeComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'recording-finalize',
        encapsulation: __WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewEncapsulation"].None,
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/recording-finalize.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/default-app-view/recording-finalize.component.scss"), __webpack_require__("../../../../../src/classroom/classroom-capture/styles/recording-details.scss")],
    }),
    __metadata("design:paramtypes", [typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_recording_recording_details_service__["a" /* RecordingDetailsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_recording_recording_details_service__["a" /* RecordingDetailsService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_6__services_recording_manager_service__["a" /* RecordingManagerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__services_recording_manager_service__["a" /* RecordingManagerService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_7__services_scheduling_service__["a" /* SchedulingService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__services_scheduling_service__["a" /* SchedulingService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_8_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8_ng2_translate__["b" /* TranslateService */]) === "function" && _h || Object])
], RecordingFinalizeComponent);

var _a, _b, _c, _d, _e, _f, _g, _h;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/recording-finalize.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/add-visual-input/add-visual-input.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"add-visual-input\">\r\n  <button class=\"add-visual-input-button\" (click)=\"onAddInputClick()\" [disabled]=\"isAddButtonDisable()\"\r\n          [pTooltip]=\" 'CAPTURE_DEVICE.add_input' | translate \" tooltipPosition=\"bottom\" tooltip-addon>\r\n    <button class=\"add-visual-input-icon\" [disabled]=\"isAddButtonDisable()\"></button>\r\n  </button>\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/add-visual-input/add-visual-input.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".add-visual-input {\n  height: 100%;\n  width: 100%;\n  background-color: rgba(153, 153, 153, 0.1);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05); }\n\n.add-visual-input-button {\n  cursor: pointer;\n  opacity: 0.8;\n  height: 38px;\n  width: 38px;\n  position: absolute;\n  top: calc(50% - 19px);\n  left: calc(50% - 19px);\n  border: none;\n  border-radius: 50%;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n  background-color: rgba(153, 153, 153, 0.6); }\n\n.add-visual-input-button:disabled {\n  opacity: 0.5;\n  cursor: default;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n  background-color: rgba(153, 153, 153, 0.3); }\n\n.add-visual-input-button:hover:enabled,\n.add-visual-input-button:active:enabled,\n.add-visual-input-button:focus:enabled {\n  opacity: 1;\n  background-color: rgba(153, 153, 153, 0.8); }\n\n.add-visual-input-icon {\n  cursor: pointer;\n  outline: none;\n  border: none;\n  position: absolute;\n  opacity: 1;\n  top: calc(50% - 10px);\n  left: calc(50% - 10px);\n  width: 20px;\n  height: 20px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/plus_large.svg")) + ") no-repeat center; }\n\n.add-visual-input-icon:disabled {\n  cursor: default;\n  opacity: 0.5; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/add-visual-input/add-visual-input.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AddVisualInputComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let AddVisualInputComponent = class AddVisualInputComponent {
    constructor() {
        this.shouldDisable = true;
        this.inputAdded = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        this.disableButton = false;
    }
    onAddInputClick() {
        if (!this.disableButton) {
            this.disableButton = true;
            this.inputAdded.emit();
            setTimeout(() => {
                this.disableButton = false;
            }, 300);
        }
    }
    isAddButtonDisable() {
        return this.shouldDisable || this.disableButton;
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Boolean)
], AddVisualInputComponent.prototype, "shouldDisable", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]) === "function" && _a || Object)
], AddVisualInputComponent.prototype, "inputAdded", void 0);
AddVisualInputComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'add-visual-input',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/add-visual-input/add-visual-input.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/add-visual-input/add-visual-input.component.scss")],
        providers: []
    })
], AddVisualInputComponent);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/add-visual-input.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input-settings/audio-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"device-settings-component\">\r\n\r\n  <div class=\"grid device-settings-container\">\r\n\r\n    <div class=\"device-settings-panel\">\r\n\r\n      <div class=\"col-12 device-settings-header\">\r\n        <div class=\"grid\">\r\n          <div class=\"col-4 no-spaces\">\r\n            <div class=\"device-settings-icon-container\">\r\n              <div class=\"device-settings-icon video-settings-icon\"></div>\r\n            </div>\r\n            <div class=\"device-settings-text\">\r\n              {{'CAPTURE_DEVICE.audio_panel_title' | translate}}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n      <div class=\"col-12 device-settings-body\">\r\n\r\n        <div class=\"grid\">\r\n\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\">\r\n              <label  for=\"audioDevicesDropDown\">{{'CAPTURE_DEVICE.input_source' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"audioDevicesDropDown\" dropdown-addon [styleClass]=\"settings-field-dropdown\" [options]=\"audioDevices\" [(ngModel)]=\"selectedAudioDevice\"\r\n                        (onCustomChange)=\"onAudioDeviceChange()\" [disabled]=\"isProcessing()\" #firstInput></p-dropdown>\r\n          </div>\r\n\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\">\r\n              <label for=\"audioInputDropDown\">{{'CAPTURE_DEVICE.input_type' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"audioInputDropDown\" dropdown-addon [styleClass]=\"settings-field-dropdown\" [options]=\"audioInputTypes\" [(ngModel)]=\"selectedAudioInputType\"\r\n                        (onCustomChange)=\"onAudioInputTypeChange()\" [disabled]=\"isProcessing()\"></p-dropdown>\r\n          </div>\r\n\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\">\r\n              <label for=\"captureSystemAudio\">{{'CAPTURE_DEVICE.capture_system_audio' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"captureSystemAudio\" dropdown-addon [styleClass]=\"settings-field-dropdown\" [options]=\"captureSystemAudioStates\" [(ngModel)]=\"isCaptureSystemAudioOn\"\r\n                        (onCustomChange)=\"onCaptureSystemAudioChange()\" [disabled]=\"isProcessing()\"></p-dropdown>\r\n          </div>\r\n\r\n            <div class=\"col device-settings-col\" style=\"display: none\">\r\n                <div class=\"settings-field-title\">\r\n                    <label for=\"selectedAudioDeviceDelay\">{{'CAPTURE_DEVICE.capture_audio_delay' | translate}}</label>\r\n                </div>\r\n              <p-spinner spinner-number inputId=\"selectedAudioDeviceDelay\"\r\n                           [(ngModel)]=\"selectedAudioDeviceDelay\"\r\n                           max=\"{{audioDeviceDelayMaxValue}}\"\r\n                           min=\"{{audioDeviceDelayMinValue}}\"\r\n                          class=\"settings-field-dropdown\"\r\n                         [disabled]=\"isProcessing()\"></p-spinner>\r\n            </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"buttons-control\">\r\n        <button class=\"device-settings-back-button app-oval-button\" (click)=\"onBackClick()\">{{'COMMON.back' | translate}}</button>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input-settings/audio-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".video-settings-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/audio.svg")) + ") no-repeat top left; }\n\n.buttons-control {\n  position: absolute;\n  top: 0;\n  right: 0; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input-settings/audio-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_capture_device_audio_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_audio_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_primeng_components_dropdown_dropdown__ = __webpack_require__("../../../../primeng/components/dropdown/dropdown.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_primeng_components_dropdown_dropdown___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_primeng_components_dropdown_dropdown__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_accessability_service__ = __webpack_require__("../../../../../src/shared/services/infra/accessability.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AudioSettingsComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};











let AudioSettingsComponent = class AudioSettingsComponent {
    constructor(audioDeviceService, audioDeviceSettingsService, panelsService, log, translate, myElement, accessibilityService, appState) {
        this.audioDeviceService = audioDeviceService;
        this.audioDeviceSettingsService = audioDeviceSettingsService;
        this.panelsService = panelsService;
        this.log = log;
        this.translate = translate;
        this.myElement = myElement;
        this.accessibilityService = accessibilityService;
        this.appState = appState;
        this.configurationLoading = false;
        this.audioDevices = [];
        this.audioInputTypes = [];
        this.captureSystemAudioStates = [];
        this.panelsService.currentPanel$.subscribe(panel => {
            if (panel['type'] === 'audio-device-settings' && panel['active'] === true) {
                this.loadAudioSettings()
                    .then(() => {
                    this.setFocusOnFirstInput();
                });
            }
            else if (panel['type'] === 'audio-device-settings') {
                this.accessibilityService.clearFocusAndScrollUp(this.myElement, '.device-settings-body');
            }
        });
    }
    loadAudioSettings() {
        return this.audioDeviceSettingsService.loadAudioDeviceList()
            .then((devices) => {
            this.log.info('loading audio device list');
            let selectedAudio = this.audioDeviceSettingsService.selectedAudioDevice;
            this.setAudioDeviceList(devices, selectedAudio);
            this.setAudioInputTypeList();
            this.setCaptureSystemAudioOptions();
            this.loadAudioDelay();
        })
            .catch((err) => {
            this.log.error('ERROR loading audio settings ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /* Accessibility */
    setFocusOnFirstInput() {
        this.firstInput.applyFocus();
    }
    setAudioDeviceList(devices, selectedAudioDevice) {
        this.audioDevices.length = 0;
        for (let i in devices) {
            this.audioDevices.push({ label: devices[i].friendly_name, value: devices[i].device_id });
        }
        this.selectedAudioDevice = selectedAudioDevice;
    }
    setAudioInputTypeList() {
        this.audioInputTypes.length = 0;
        __WEBPACK_IMPORTED_MODULE_3_lodash__["forEach"](this.getInputTypes(), (inputType) => {
            this.audioInputTypes.push({ label: this.getAudioInputTypeLabel(inputType), value: inputType['description'] });
        });
        this.selectedAudioInputType = this.audioDeviceSettingsService.selectedInputType;
    }
    setCaptureSystemAudioOptions() {
        this.translate.get(['COMMON.On', 'COMMON.Off'])
            .subscribe((res) => {
            this.captureSystemAudioStates = [{ label: res['COMMON.On'], value: true }, { label: res['COMMON.Off'], value: false }];
        });
        this.isCaptureSystemAudioOn = this.audioDeviceSettingsService.isCaptureSystemAudioOn;
    }
    loadAudioDelay() {
        this.selectedAudioDeviceDelay = this.audioDeviceSettingsService.selectedAudioDeviceDelay;
        this.audioDeviceDelayMaxValue = this.audioDeviceSettingsService.sinkStartTimeout;
        this.audioDeviceDelayMinValue = -this.audioDeviceDelayMaxValue;
        this.log.info("loadAudioDelay " + this.selectedAudioDeviceDelay
            + "(" + this.audioDeviceDelayMinValue + " " + this.audioDeviceDelayMaxValue + ")");
    }
    onAudioDeviceChange() {
        let device = __WEBPACK_IMPORTED_MODULE_3_lodash__["find"](this.audioDevices, (d) => d.value === this.selectedAudioDevice);
        this.audioDeviceSettingsService.onAudioDeviceChange(device)
            .then(() => {
            this.loadAudioDelay();
            this.setAudioInputTypeList();
        })
            .catch((err) => { }); //do nothing
    }
    onBackClick() {
        this.onAudioDeviceDelayChange();
        this.panelsService.updateCurrentPanel({ type: 'audio-device-settings', active: false });
    }
    isProcessing() {
        return this.audioDeviceService.isProcessing() || this.configurationLoading;
    }
    getAudioInputTypeLabel(inputType) {
        return inputType['samplesPerSec'] + ' Hz ' + ', ' + inputType['bitsPerSample'] + ' bit, ' + inputType['channels'];
    }
    onAudioInputTypeChange() {
        return this.audioDeviceSettingsService.onAudioInputTypeChange(this.selectedAudioInputType)
            .catch((err) => { }); //do nothing
    }
    onCaptureSystemAudioChange() {
        this.configurationLoading = true;
        this.audioDeviceSettingsService.setCaptureSystemAudioState(this.isCaptureSystemAudioOn)
            .catch((err) => { }) //do nothing
            .then(() => {
            return this.appState.areSessionsReadyForRecording('audio-settings');
        })
            .then(() => {
            this.configurationLoading = false;
        });
    }
    onAudioDeviceDelayChange() {
        this.audioDeviceSettingsService.setSelectedAudioDeviceDelay(this.selectedAudioDeviceDelay)
            .catch((err) => { }); //do nothing
    }
    getInputTypes() {
        return this.audioDeviceSettingsService.audioInputTypes;
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('firstInput'),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_8_primeng_components_dropdown_dropdown__["Dropdown"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8_primeng_components_dropdown_dropdown__["Dropdown"]) === "function" && _a || Object)
], AudioSettingsComponent.prototype, "firstInput", void 0);
AudioSettingsComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'audio-settings',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input-settings/audio-settings.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input-settings/audio-settings.component.scss"), __webpack_require__("../../../../../src/classroom/classroom-capture/styles/device-settings.scss")],
    }),
    __metadata("design:paramtypes", [typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_capture_device_audio_device_service__["a" /* AudioDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_capture_device_audio_device_service__["a" /* AudioDeviceService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_audio_device_settings_service__["a" /* AudioDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_audio_device_settings_service__["a" /* AudioDeviceSettingsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_7_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7_ng2_translate__["b" /* TranslateService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_accessability_service__["a" /* AccessibilityService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__shared_services_infra_accessability_service__["a" /* AccessibilityService */]) === "function" && _h || Object, typeof (_j = typeof __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _j || Object])
], AudioSettingsComponent);

var _a, _b, _c, _d, _e, _f, _g, _h, _j;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/audio-settings.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input/audio-input.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"audio-input\">\r\n\r\n  <div class=\"device-container\">\r\n    <div class=\"audio-settings-bar\">\r\n      <div class=\"grid no-spaces\">\r\n        <button class=\"device-preview-button cc-button audio-preview-button\"\r\n                [attr.aria-label]=\"devicePreviewAriaText() | translate\"\r\n                [ngClass]=\"devicePreviewStyleClass()\"\r\n                (click)=\"onAudioPreviewClick()\"\r\n                [disabled]=\"disableAudioPreviewButton()\">\r\n        </button>\r\n\r\n        <button class=\" device-settings-button cc-button audio-settings-button focus-once\"\r\n                [attr.aria-label]=\"'CAPTURE_DEVICE.audio_panel_title' | translate\"\r\n                [ngClass]=\"{'device-icon-button-active' : isAudioSettingsPanelActive()}\"\r\n                (click)=\"onAudioSettingsClick()\"\r\n                [hidden]=\"isAppRecording()\"\r\n                [disabled]=\"disabledAudioSettingsButton()\">\r\n        </button>\r\n      </div>\r\n    </div>\r\n    <div class=\"audio-device\">\r\n      <div class=\"audio-device-volume-bar volume-bar-left\">\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 93.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 88 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 82.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 77 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 71.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 66 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 60.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 55 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 49.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 44 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 38.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 33 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 27.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 22 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 16.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 11 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 5.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel0 > 0 }\"></div>\r\n      </div>\r\n      <div class=\"audio-device-volume-bar volume-bar-right\">\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 93.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 88 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 82.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 77 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 71.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 66 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 60.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 55 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 49.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 44 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 38.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 33 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 27.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 22 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 16.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 11 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 5.5 }\"></div>\r\n        <div class=\"audio-bar-level\" [ngClass]=\"{'audio-bar-level-colored' : audioLevel1 > 0 }\"></div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input/audio-input.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".audio-input {\n  height: 100%;\n  width: 100%;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n  background-color: rgba(153, 153, 153, 0.1); }\n\n.audio-container {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.audio-settings-bar {\n  position: relative;\n  height: 13.6%;\n  width: 100%; }\n\n.audio-device {\n  position: relative;\n  box-sizing: border-box;\n  height: 86.4%;\n  max-width: 78px;\n  margin: auto; }\n\n.audio-device-volume-bar {\n  position: absolute;\n  bottom: 12.1%;\n  height: 75%;\n  width: 16px; }\n\n.volume-bar-left {\n  left: 20.5%; }\n\n.volume-bar-right {\n  right: 20.5%; }\n\n.audio-bar-level {\n  width: 16px;\n  height: 4px;\n  border-radius: 100px;\n  background-color: #cccccc;\n  margin-bottom: 0.85vh; }\n\n.audio-bar-level-colored {\n  background-color: #04af8e; }\n\n.audio-preview-button {\n  margin-left: 7.5px; }\n\n.audio-settings-button {\n  position: absolute !important;\n  right: 8px !important;\n  margin: 0 !important;\n  padding: 0 !important;\n  top: calc(50% - 10px) !important; }\n\n.audio-disabled-button {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/audio-mute.svg")) + ") no-repeat top left; }\n\n.audio-enabled-button {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/audio.svg")) + ") no-repeat top left; }\n\n.audio-device-preview {\n  position: relative;\n  box-sizing: border-box;\n  opacity: 0.98;\n  height: 86.4%;\n  width: 100%; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input/audio-input.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_audio_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AudioInputComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








let AudioInputComponent = class AudioInputComponent {
    constructor(zone, log, appState, appConfig, panelsService, audioDeviceService, devicePreviewService) {
        this.zone = zone;
        this.log = log;
        this.appState = appState;
        this.appConfig = appConfig;
        this.panelsService = panelsService;
        this.audioDeviceService = audioDeviceService;
        this.devicePreviewService = devicePreviewService;
        this.SETTINGS_PANEL = 'audio-device-settings';
        this.deviceNotificationSub = null;
        this.audioLevelSub = null;
        this.audioLevel0 = 0;
        this.audioLevel1 = 0;
    }
    ngOnInit() {
        this.addListeners();
    }
    ngOnDestroy() {
        this.removeListeners();
    }
    isAppRecording() {
        return this.audioDeviceService.isAppRecording();
    }
    onAudioPreviewClick() {
        this.getAudioPreviewAction(!this.isAudioEnabled())
            .catch((err) => {
            this.log.error('Audio-Input: failed to change audio device preview state to ' +
                !this.isAudioEnabled() + ' :' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    onAudioSettingsClick() {
        this.panelsService.updateCurrentPanel({
            type: this.SETTINGS_PANEL,
            active: !this.panelsService.isPanelActive(this.SETTINGS_PANEL)
        });
    }
    isAudioSettingsPanelActive() {
        return this.panelsService.isPanelActive(this.SETTINGS_PANEL);
    }
    disabledAudioSettingsButton() {
        return this.audioDeviceService.isAudioSettingsDisabled() ||
            (this.panelsService.isCurrentPanelActive() &&
                !this.panelsService.isPanelActive(this.SETTINGS_PANEL)); //the active panel is not audio settings
    }
    disableAudioPreviewButton() {
        return this.audioDeviceService.shouldDisableAudioButton() || this.panelsService.isCurrentPanelActive();
    }
    isAudioEnabled() {
        return this.audioDeviceService.isAudioEnabled(this.appConfig.getConfigData('config.captureApp.audioOnlyRecording'));
    }
    devicePreviewStyleClass() {
        return this.isAudioEnabled() ?
            'audio-enabled-button device-preview-in-progress' :
            'audio-disabled-button device-preview-stopped';
    }
    devicePreviewAriaText() {
        return this.isAudioEnabled ?
            'CAPTURE_DEVICE.disableAudio' :
            'CAPTURE_DEVICE.enableAudio';
    }
    getAudioPreviewAction(enable) {
        return enable ?
            this.audioDeviceService.enableAudioDevice() :
            this.audioDeviceService.disableAudioDevice();
    }
    addListeners() {
        this.audioLevelSub =
            this.devicePreviewService.audioLeverSubject$.subscribe(audioLevel => {
                this.zone.run(() => this.audioLevel0 = audioLevel['Channel0']);
                this.zone.run(() => this.audioLevel1 = audioLevel['Channel1']);
            });
    }
    removeListeners() {
        if (this.deviceNotificationSub)
            this.deviceNotificationSub.unsubscribe();
        if (this.audioLevelSub)
            this.audioLevelSub.unsubscribe();
    }
};
AudioInputComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'audio-input',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input/audio-input.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/audio-input/audio-input.component.scss"), __webpack_require__("../../../../../src/classroom/classroom-capture/styles/device-container.scss")],
        providers: []
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["NgZone"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["NgZone"]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_audio_device_service__["a" /* AudioDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_audio_device_service__["a" /* AudioDeviceService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */]) === "function" && _g || Object])
], AudioInputComponent);

var _a, _b, _c, _d, _e, _f, _g;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/audio-input.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"inputs-management\">\r\n\r\n  <div class=\"add-visual-input-wrapper\">\r\n    <add-visual-input (inputAdded)=\"onInputAddedEvent()\" [shouldDisable]=\"!allowAddInput()\"></add-visual-input>\r\n  </div>\r\n\r\n  <div class=\"grid co-12 inputs-grid\">\r\n    <div class=\"visual-inputs-container-wrapper inputs-grid\">\r\n      <visual-inputs-container class=\"grid col-12 inputs-grid\" [activeInputs]=\"getActiveInputs()\"></visual-inputs-container>\r\n    </div>\r\n    <div class=\"inputs-divider\"></div>\r\n    <div class=\"audio-input-wrapper inputs-grid\">\r\n      <audio-input></audio-input>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".inputs-management {\n  height: 100%;\n  width: 100%; }\n\n.add-visual-input-wrapper {\n  position: absolute;\n  left: -64px;\n  bottom: 0;\n  width: 64px;\n  height: 100%; }\n\n.inputs-grid {\n  height: 100%;\n  width: 100%;\n  padding: 0;\n  margin: 0; }\n\n.inputs-divider {\n  height: 100%;\n  width: 1px;\n  box-shadow: 2px 0 0 0 rgba(255, 255, 255, 0.06); }\n\n.visual-inputs-container-wrapper {\n  width: calc(100% - 84px);\n  height: 100%; }\n\n.audio-input-wrapper {\n  position: absolute;\n  width: 78px;\n  height: 100%;\n  padding: 0;\n  margin: 0;\n  right: 0; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__inputs_management_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return InputsManagementsComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let InputsManagementsComponent = class InputsManagementsComponent {
    constructor(log, appConfig, panelsService, inputsManagementService) {
        this.log = log;
        this.appConfig = appConfig;
        this.panelsService = panelsService;
        this.inputsManagementService = inputsManagementService;
    }
    ngOnInit() {
        //for first component load to avoid racing
        this.inputsManagementService.setActiveInputs();
        this.inputsManagementService.subscribeToSessionsInitEvent();
    }
    ngOnDestroy() {
        this.inputsManagementService.unSubscribeFromSessionsInitEvent();
    }
    onInputAddedEvent() {
        this.inputsManagementService.addNewSession()
            .catch((err) => {
            this.log.error('InputsManagementsComponent Failed to add new session: ' + __WEBPACK_IMPORTED_MODULE_3__utils_utils__["a" /* utils */].stringifyMsg(err));
            //todo [SA] show the user notification
        });
    }
    allowAddInput() {
        let maxNumOfInputs = this.appConfig.getConfigData('config.captureApp.maxNumberOfInputs');
        return this.inputsManagementService.isAppStable() &&
            this.inputsManagementService.getActiveVisualInputsCount() < maxNumOfInputs &&
            !this.panelsService.isCurrentPanelActive();
    }
    getActiveInputs() {
        return this.inputsManagementService.activeVisualInputs;
    }
};
InputsManagementsComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'inputs-management',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.component.scss")],
        providers: []
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_2__inputs_management_service__["a" /* InputsManagementService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__inputs_management_service__["a" /* InputsManagementService */]) === "function" && _d || Object])
], InputsManagementsComponent);

var _a, _b, _c, _d;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/inputs-management.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_services_capture_device_device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_services_capture_device_video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_capture_device_device_recovery_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-recovery.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_session_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/session-state.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return InputsManagementService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};












let InputsManagementService = class InputsManagementService {
    constructor(log, appState, recoveryService, sessionStateService, appPersistency, devicePreviewService, videoDeviceSettingsService, notificationService) {
        this.log = log;
        this.appState = appState;
        this.recoveryService = recoveryService;
        this.sessionStateService = sessionStateService;
        this.appPersistency = appPersistency;
        this.devicePreviewService = devicePreviewService;
        this.videoDeviceSettingsService = videoDeviceSettingsService;
        this.notificationService = notificationService;
        this.PRIMARY_SESSION_NAME = 'session0';
        this.sessionsInitSub = null;
        this.activeVisualInputs = [];
        this.refreshInputs = new __WEBPACK_IMPORTED_MODULE_10_rxjs__["Subject"]();
        this.refreshInputs$ = this.refreshInputs.asObservable();
    }
    fireRefreshInputsEvent() {
        this.appState.areSessionsReadyForRecording('fireRefreshInputsEvent')
            .then(() => {
            this.refreshInputs.next();
        });
    }
    subscribeToSessionsInitEvent() {
        this.sessionsInitSub =
            this.sessionStateService.sessionsInit$.subscribe(() => {
                this.log.info('InputsManagementService: re-setting active inputs after sessions init.');
                this.setActiveInputs();
            });
    }
    unSubscribeFromSessionsInitEvent() {
        if (this.sessionsInitSub)
            this.sessionsInitSub.unsubscribe();
    }
    setActiveInputs() {
        this.getActiveVisualSessions()
            .then((sessions) => {
            this.activeVisualInputs = sessions;
        });
    }
    getActiveVisualSessions() {
        this.log.info('InputsManagementService getActiveVisualSessions');
        return this.appState.getVisualSessionsNamesAndDefaultTypesForInit();
    }
    isAppStable() {
        return this.appState.isAppStable();
    }
    addNewSession() {
        let newSessionName = '';
        //add session with default type to persistent data
        return this.appState.getVisualSessionsFromPersistentData()
            .then((sessions) => {
            let lastSessionNumber = parseInt(__WEBPACK_IMPORTED_MODULE_1_lodash__["keys"](sessions).sort().pop().split('session')[1]);
            newSessionName = 'session' + (++lastSessionNumber);
            return this.appPersistency.set(newSessionName, { 'preview': 'enabled' });
        })
            .then(() => {
            this.activeVisualInputs[newSessionName] = this.appState.DEFAULT_CAPTURE_TYPE; //for fast visual update
            return this.shutDownAndReInitSessions();
        });
    }
    removeSession(sessionName) {
        if (this.appState.isAppRecording()) {
            return this.notificationService.sendNotification("NOTIFICATIONS.error_removeInputDuringRecording", "error");
        }
        return this.appPersistency.get('')
            .then((persistentData) => {
            delete persistentData[sessionName];
            persistentData = this.rearrangeSessions(parseInt(sessionName.split('session')[1]), //get removed session index
            persistentData); //persistent data without removed session
            return this.appPersistency.set('all', persistentData);
        })
            .then(() => {
            delete this.activeVisualInputs[sessionName]; //for fast visual update
            return this.shutDownAndReInitSessions();
        })
            .then(() => {
            this.fireRefreshInputsEvent();
        });
    }
    switchToPrimarySession(sessionName) {
        return this.appPersistency.get('')
            .then((persistentData) => {
            //save current primary obj.
            let currentPrimarySession = persistentData[this.PRIMARY_SESSION_NAME];
            //move provided session to be the new primary session
            persistentData[this.PRIMARY_SESSION_NAME] = persistentData[sessionName];
            //move prev primary session to privided session old location
            persistentData[sessionName] = currentPrimarySession;
            return this.appPersistency.set('all', persistentData);
        })
            .then(() => {
            return this.shutDownAndReInitSessions();
        })
            .then(() => {
            this.fireRefreshInputsEvent();
        });
    }
    getActiveVisualInputsCount() {
        return __WEBPACK_IMPORTED_MODULE_1_lodash__["keys"](this.activeVisualInputs).length;
    }
    getActiveSessionDisplayName(sessionName) {
        if (sessionName === this.PRIMARY_SESSION_NAME) {
            return 'Primary Input';
        }
        else {
            let sessionIndex = parseInt(sessionName.split('session')[1]);
            return 'Input ' + ++sessionIndex;
        }
    }
    hideAllActiveSessionsPreview() {
        return this.devicePreviewService.hideAll();
    }
    shutDownAndReInitSessions() {
        return this.appState.areSessionsReadyForRecording('InputsManagementService')
            .catch(() => { }) //shut down sessions any way...
            .then(() => {
            return this.devicePreviewService.unregisterFromAudioNotification();
        })
            .then(() => {
            this.recoveryService.resetRecoverySessions();
            return this.appState.shutDownSessions()
                .then(() => {
                return this.videoDeviceSettingsService.clearSessions();
            })
                .then(() => {
                this.appState.sendInitNotification();
            })
                .catch((err) => {
                this.log.error('InputsManagementService: failed to shutdown active sessions. ' + __WEBPACK_IMPORTED_MODULE_9__utils_utils__["a" /* utils */].stringifyMsg(err));
                return Promise.reject(err);
            });
        });
    }
    /**
     * rearranges all sessions indexes in app persistent data object after removal of a session
     * @param removedSessionIndex
     * @param persistentDataObject
     * @returns {any}
     */
    rearrangeSessions(removedSessionIndex, persistentDataObject) {
        //next session object in persistent data (if exists)
        let currentSessionKey = 'session' + removedSessionIndex;
        let nextSessionKey = 'session' + ++removedSessionIndex;
        while (!__WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](persistentDataObject[nextSessionKey])) {
            let migratedObj = persistentDataObject[nextSessionKey];
            persistentDataObject[currentSessionKey] = migratedObj;
            delete persistentDataObject[nextSessionKey];
            currentSessionKey = nextSessionKey;
            nextSessionKey = 'session' + ++removedSessionIndex;
        }
        return persistentDataObject;
    }
};
InputsManagementService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_8__shared_services_capture_device_device_recovery_service__["a" /* DeviceRecoveryService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_services_capture_device_device_recovery_service__["a" /* DeviceRecoveryService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_session_state_service__["a" /* SessionStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_session_state_service__["a" /* SessionStateService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_6__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_7__shared_services_capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__shared_services_capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _h || Object])
], InputsManagementService);

var _a, _b, _c, _d, _e, _f, _g, _h;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/inputs-management.service.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-controllers/visual-input-controllers.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"visual-input-controllers\">\r\n\r\n  <div class=\"grid-spaceBetween device-settings-bar\">\r\n\r\n    <div class=\"grid col-8 no-spaces device-preview-section\">\r\n      <div class=\"device-preview-text\">\r\n        {{ this.getInputName() | translate }}\r\n      </div>\r\n      <button class=\"device-preview-button cc-button\"\r\n              [attr.aria-label]=\"getInputAriaLabel() | translate\"\r\n              [ngClass]=\"getPreviewButtonClass()\"\r\n              (click)=\"onPreviewStateChange()\"\r\n              [disabled]=\"disablePreviewButton()\">\r\n\r\n      </button>\r\n    </div>\r\n\r\n    <div *ngIf=\"isLiveConfigured()\" class=\"On-Air\" [ngClass]=\"{live: isLive()}\">ON AIR</div>\r\n\r\n    <div *ngIf=\"!isAppRecording()\" class=\"grid-noGutter no-spaces device-settings-section\">\r\n      <button class=\"device-settings-button cc-button focus-once\"\r\n              (click)=\"onSettingsButtonClick()\"\r\n              [attr.aria-label]=\"getDevicePanelTitleText() | translate\"\r\n              [ngClass]=\"{'device-icon-button-active' : isSettingsPanelVisible()}\"\r\n              [disabled]=\"disableSettingsButton()\">\r\n      </button>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-controllers/visual-input-controllers.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".video-preview-stopped {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/camera-disable.svg")) + ") no-repeat top left; }\n\n.video-preview-in-progress {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/camera.svg")) + ") no-repeat top left; }\n\n.visual-input-controllers {\n  height: 100%; }\n\n.On-Air {\n  height: 14px;\n  width: 52px;\n  padding: 3px 4px 3px 4px;\n  margin-top: auto;\n  margin-bottom: auto;\n  border-radius: 4px;\n  background-color: #808080;\n  color: #222222;\n  opacity: 0.9;\n  font-family: Lato;\n  font-size: 13px;\n  font-weight: 600;\n  text-align: center;\n  letter-spacing: 0; }\n\n.live {\n  background-color: #db1f26; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-controllers/visual-input-controllers.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_capture_device_video_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_live_live_manager_service__ = __webpack_require__("../../../../../src/shared/services/live/live-manager.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return VisualInputControllersComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let VisualInputControllersComponent = class VisualInputControllersComponent {
    constructor(appState, appConfig, panelsService, videoService, liveManagerService) {
        this.appState = appState;
        this.appConfig = appConfig;
        this.panelsService = panelsService;
        this.videoService = videoService;
        this.liveManagerService = liveManagerService;
        /**
         * inputSession
         * @type {{name: sessionName, type: sessionType}}
         */
        this.inputSession = { sessionName: '', type: '', displayName: '' };
        /**
         * emit event when input's preview button is clicked
         * @type {EventEmitter<void>}
         */
        this.previewStateChange = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        this.inputSettingsClick = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
    }
    getInputName() {
        return this.inputSession.displayName;
    }
    getInputAriaLabel() {
        return this.isInputPreviewing() ?
            'CAPTURE_DEVICE.disableCamera' :
            'CAPTURE_DEVICE.enableCamera';
    }
    getPreviewButtonClass() {
        return this.isInputPreviewing() ?
            'video-preview-in-progress device-preview-in-progress' :
            'video-preview-stopped device-preview-stopped';
    }
    onPreviewStateChange() {
        this.previewStateChange.emit();
    }
    disablePreviewButton() {
        return this.videoService.shouldDisableDeviceConfiguration(this.inputSession.sessionName) ||
            this.panelsService.isCurrentPanelActive();
    }
    //if in process or if other panel is opened
    disableSettingsButton() {
        return !this.videoService.isDeviceStable(this.inputSession.sessionName) ||
            !this.appState.isAppStable() ||
            (this.panelsService.isCurrentPanelActive() &&
                !this.panelsService.isPanelActive(this.inputSession.sessionName + '-device-settings'));
    }
    isSettingsPanelVisible() {
        return this.panelsService.isPanelActive(this.inputSession.sessionName + '-device-settings');
    }
    getDevicePanelTitleText() {
        return this.inputSession.type === 'video' ?
            'CAPTURE_DEVICE.camera_panel_title' :
            'CAPTURE_DEVICE.screen_panel_title';
    }
    onSettingsButtonClick() {
        this.inputSettingsClick.emit(this.inputSession.sessionName);
    }
    isAppRecording() {
        return this.appState.isAppRecording();
    }
    isInputPreviewing() {
        return this.videoService.isDevicePreviewing(this.inputSession.sessionName);
    }
    isLive() {
        return this.appState.isAppStreaming();
    }
    isLiveConfigured() {
        return this.liveManagerService.isInputLiveConfigured(this.inputSession.sessionName);
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object)
], VisualInputControllersComponent.prototype, "inputSession", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]) === "function" && _a || Object)
], VisualInputControllersComponent.prototype, "previewStateChange", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
    __metadata("design:type", typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]) === "function" && _b || Object)
], VisualInputControllersComponent.prototype, "inputSettingsClick", void 0);
VisualInputControllersComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'visual-input-controllers',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-controllers/visual-input-controllers.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-controllers/visual-input-controllers.component.scss"), __webpack_require__("../../../../../src/classroom/classroom-capture/styles/device-container.scss")],
        providers: []
    }),
    __metadata("design:paramtypes", [typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_capture_device_video_device_service__["a" /* VideoDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_capture_device_video_device_service__["a" /* VideoDeviceService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_live_live_manager_service__["a" /* LiveManagerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_live_live_manager_service__["a" /* LiveManagerService */]) === "function" && _g || Object])
], VisualInputControllersComponent);

var _a, _b, _c, _d, _e, _f, _g;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/visual-input-controllers.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-settings/visual-input-settings.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"device-settings-component\">\r\n\r\n  <div class=\"grid device-settings-container\">\r\n\r\n    <p-confirmDialog class=\"cc-confirmation\"\r\n                     message=\"{{'CONFIRMATIONS.remove_input' | translate:{ input_name: getInputDisplayName() } }}\"\r\n                     appendTo=\"body\" #cri [key]=\"getInputDisplayName()\" dialog-addon role=\"dialog\" aria-modal=\"true\">\r\n      <p-footer class=\"confirm-dialog-footer\">\r\n        <button class=\"app-oval-button\" pButton label=\"{{'COMMON.no' | translate}}\" (click)=\"cri.reject()\"></button>\r\n        <button class=\"confirm-button app-link-button cc-button\" pButton label=\"{{'COMMON.yes' | translate}}\" (click)=\"cri.accept()\"></button>\r\n      </p-footer>\r\n    </p-confirmDialog>\r\n\r\n    <div class=\"device-settings-panel\">\r\n\r\n      <div class=\"col-12 device-settings-header\">\r\n        <div class=\"grid\">\r\n          <div class=\"col-4 no-spaces\">\r\n            <div class=\"device-settings-icon-container\">\r\n              <div class=\"device-settings-icon video-settings-icon\"></div>\r\n            </div>\r\n            <div class=\"device-settings-text\">\r\n              {{ 'CAPTURE_DEVICE.input_settings_title' | translate: {input_name: getInputDisplayName()} }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n      <div class=\"col-12 device-settings-body\">\r\n        <!-- Capture Device -->\r\n        <div class=\"grid-3\">\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\" [ngClass]=\"{'settings-field-title-disabled': disableSettingsDropDown(devices)}\">\r\n              <label for=\"captureDevicesDropDown\">{{ this.getDeviceInputText() | translate }}</label>\r\n              <a *ngIf=\"showDeviceIndication()\" class=\"app-link device-indication-link\" target=\"_blank\" (click)=\"identifyDevice()\">({{'CAPTURE_DEVICE.screen_indication' | translate}})</a>\r\n            </div>\r\n            <p-dropdown inputId=\"captureDevicesDropDown\" dropdown-addon [styleClass]=\"settings-field-dropdown\" [options]=\"devices\" [(ngModel)]=\"selectedDevice\"\r\n                        (onCustomChange)=\"onDeviceChange(true)\" [disabled]=\"disableSettingsDropDown(devices)\"\r\n                        [placeholder]=\"getEmptyDataText() | translate\" #firstInput></p-dropdown>\r\n          </div>\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\" [ngClass]=\"{'settings-field-title-disabled': disableSettingsDropDown(devices)}\">\r\n              <label for=\"captureResolutionsDropDown\">{{'CAPTURE_DEVICE.resolution' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"captureResolutionsDropDown\" dropdown-addon [styleClass]=\"settings-field-dropdown\" [options]=\"resolutions\" [(ngModel)]=\"selectedResolution\"\r\n                        (onCustomChange)=\"onResolutionChange(true)\" [disabled]=\"disableSettingsDropDown(devices)\" [placeholder]=\"getEmptyDataText() | translate\" ></p-dropdown>\r\n          </div>\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\" [ngClass]=\"{'settings-field-title-disabled': disableSettingsDropDown(devices)}\">\r\n              <label for=\"captureFpsDropDown\">{{'CAPTURE_DEVICE.fps' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"captureFpsDropDown\" dropdown-addon [styleClass]=\"settings-field-dropdown\" [options]=\"fps\" [(ngModel)]=\"selectedFps\"\r\n                        (onCustomChange)=\"onFpsChange(true)\" [disabled]=\"disableSettingsDropDown(devices)\" [placeholder]=\"getEmptyDataText() | translate\" ></p-dropdown>\r\n          </div>\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\" [ngClass]=\"{'settings-field-title-disabled': disableSettingsDropDown(devices)}\">\r\n              <label for=\"captureCSDropDown\">{{'CAPTURE_DEVICE.colorspace' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"captureCSDropDown\" dropdown-addon [styleClass]=\"settings-field-dropdown\" [options]=\"CS\" [(ngModel)]=\"selectedCS\"\r\n                        (onCustomChange)=\"onCsChange(true)\" [disabled]=\"disableSettingsDropDown(devices)\" [placeholder]=\"getEmptyDataText() | translate\"\r\n                        (onFocus)=\"autoScrollDown()\"></p-dropdown>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"sep-line\"></div>\r\n        <!-- Encoder -->\r\n        <div class=\"grid-3\">\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\" [ngClass]=\"{'settings-field-title-disabled': disableSettingsDropDown(devices)}\">\r\n              <label for=\"captureEncoderDropDown\">{{'CAPTURE_DEVICE.encoder' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"captureEncoderDropDown\" dropdown-addon [dropdown-addon-autoscroll]=\"true\" [styleClass]=\"settings-field-dropdown\"\r\n                        [options]=\"encoder\" [(ngModel)]=\"selectedEncoder\" (onCustomChange)=\"onEncoderChange(true)\"\r\n                        [disabled]=\"disableSettingsDropDown(devices)\" [placeholder]=\"getEmptyDataText() | translate\" ></p-dropdown>\r\n          </div>\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\" [ngClass]=\"{'settings-field-title-disabled': disableSettingsDropDown(devices)}\">\r\n              <label for=\"captureBitratesDropDown\">{{'CAPTURE_DEVICE.bit_rate' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"captureBitratesDropDown\" dropdown-addon [dropdown-addon-autoscroll]=\"true\" [styleClass]=\"settings-field-dropdown\"\r\n                        [options]=\"bitrates\" [(ngModel)]=\"selectedBitrate\" (onCustomChange)=\"onBitrateChange()\" [disabled]=\"disableSettingsDropDown(devices)\"\r\n                        [placeholder]=\"getEmptyDataText() | translate\" ></p-dropdown>\r\n          </div>\r\n          <div class=\"col device-settings-col\">\r\n            <div class=\"settings-field-title\" [ngClass]=\"{'settings-field-title-disabled': disableSettingsDropDown(devices)}\">\r\n              <label for=\"encoderProfilesDropDown\">{{'CAPTURE_DEVICE.encoder_profile' | translate}}</label>\r\n            </div>\r\n            <p-dropdown inputId=\"encoderProfilesDropDown\" dropdown-addon [dropdown-addon-autoscroll]=\"true\" [styleClass]=\"settings-field-dropdown\"\r\n                        [options]=\"encoderProfiles\" [(ngModel)]=\"selectedEncoderProfile\" (onCustomChange)=\"onEncoderProfileChange()\"\r\n                        [disabled]=\"disableSettingsDropDown(devices)\" [placeholder]=\"getEmptyDataText() | translate\" ></p-dropdown>\r\n          </div>\r\n\r\n        </div>\r\n\r\n        <!-- switch to primary input -->\r\n        <div *ngIf=\"!isPrimaryInput()\" class=\"sep-line\"></div>\r\n        <div class=\"set-as-primary-container\">\r\n          <button *ngIf=\"!isPrimaryInput()\" class=\"app-oval-button input-switch-to-primary-button focus-once\" [disabled]=\"disableSettingsDropDown(devices)\"\r\n                  (click)=\"onSwitchToPrimaryClick()\" [attr.aria-label]=\"'CAPTURE_DEVICE.set_as_primary' | translate\">\r\n            {{ 'CAPTURE_DEVICE.set_as_primary' | translate }}\r\n          </button>\r\n        </div>\r\n\r\n      </div>\r\n\r\n      <div class=\"buttons-control\">\r\n        <button *ngIf=\"enableRemoveInput()\" class=\"large-non-oval-button focus-once remove-input-button\" (click)=\"onRemoveInputClick()\"\r\n                [attr.aria-label]=\"'CAPTURE_DEVICE.remove_input' | translate\">{{'CAPTURE_DEVICE.remove_input' | translate}}</button>\r\n        <button class=\"capture-settings-back-button app-oval-button\" (click)=\"onBackClick()\">{{'COMMON.back' | translate}}</button>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-settings/visual-input-settings.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".video-settings-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/camera.svg")) + ") no-repeat top left; }\n\n.screen-settings-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/screen.svg")) + ") no-repeat top left; }\n\n.device-indication-link {\n  padding-left: 5px;\n  font-size: 12px;\n  font-family: 'Lato'; }\n\n.capture-settings-back-button {\n  margin-top: 14px;\n  margin-right: 14px; }\n\n.buttons-control {\n  position: absolute;\n  top: 0;\n  right: 0; }\n\n.remove-input-button {\n  margin-right: 20px; }\n\n.set-as-primary-container {\n  height: 30px; }\n\n.settings-field-title-disabled {\n  color: #999999 !important; }\n\n.input-switch-to-primary-button {\n  width: 115px;\n  height: 24px;\n  font-size: 12px;\n  line-height: normal; }\n\n.input-switch-to-primary-button:disabled {\n  cursor: default;\n  opacity: 0.3; }\n\n:host /deep/ .ui-state-disabled {\n  color: #666666;\n  opacity: 0.7; }\n\n:host /deep/ .ui-state-disabled .ui-dropdown-trigger {\n  color: #666666;\n  opacity: 0.3; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-settings/visual-input-settings.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_primeng_components_dropdown_dropdown__ = __webpack_require__("../../../../primeng/components/dropdown/dropdown.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_primeng_components_dropdown_dropdown___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_primeng_components_dropdown_dropdown__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_accessability_service__ = __webpack_require__("../../../../../src/shared/services/infra/accessability.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__inputs_management_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_primeng_primeng__ = __webpack_require__("../../../../primeng/primeng.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_primeng_primeng___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_primeng_primeng__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return VisualInputSettingsComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};











let VisualInputSettingsComponent = class VisualInputSettingsComponent {
    constructor(appState, panelsService, log, myElement, deviceSettingsService, accessibilityService, inputsManagementService, confirmationService) {
        this.appState = appState;
        this.panelsService = panelsService;
        this.log = log;
        this.myElement = myElement;
        this.deviceSettingsService = deviceSettingsService;
        this.accessibilityService = accessibilityService;
        this.inputsManagementService = inputsManagementService;
        this.confirmationService = confirmationService;
        this.devices = [];
        this.resolutions = [];
        this.fps = [];
        this.CS = [];
        this.encoder = [];
        this.bitrates = [];
        this.encoderProfiles = [];
        this.panelsSub = null;
        this.loading = true;
    }
    ngOnInit() {
        this.panelsSub =
            this.panelsService.currentPanel$.subscribe(panel => {
                if (panel['type'] === this.sessionName + '-device-settings' && panel['active'] === true) {
                    this.log.info('Opening ' + this.sessionName + ' settings panel');
                    this.loadSettings()
                        .then(() => {
                        return this.setFocusOnFirstInput();
                    });
                }
                else if (panel['type'] === this.sessionName + '-device-settings') {
                    this.accessibilityService.clearFocusAndScrollUp(this.myElement, '.device-settings-body');
                    this.resetSettingsData();
                }
            });
    }
    ngOnDestroy() {
        if (this.panelsSub)
            this.panelsSub.unsubscribe();
    }
    autoScrollDown() {
        setTimeout(() => {
            let element = this.myElement.nativeElement.querySelector('.device-settings-body');
            if (element) {
                element.scrollTop = element.scrollHeight;
            }
        });
    }
    loadSettings() {
        this.loading = true;
        this.sessionId = this.deviceSettingsService.getSessionId(this.sessionName);
        return this.deviceSettingsService.getVideoDeviceSettings(this.sessionName, this.deviceType)
            .then(([captureDevices, videoEncoders, bitrates, profiles]) => {
            this.setDeviceList(captureDevices, this.deviceSettingsService.getSessionData(this.sessionName).selectedDevice);
            this.setEncoderList(videoEncoders, this.deviceSettingsService.getSessionData(this.sessionName).selectedEncoder);
            this.setBitrateList(bitrates, this.deviceSettingsService.getSessionData(this.sessionName).selectedBitrate);
            this.setProfileList(profiles, this.deviceSettingsService.getSessionData(this.sessionName).selectedEncoderProfile);
            this.loading = false;
            return this.setResolutionList(false);
        })
            .catch((err) => {
            this.loading = false;
            this.log.error('ERROR - loading ' + this.sessionName + ' settings. ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    /* Accessibility */
    setFocusOnFirstInput() {
        return this.accessibilityService.setFocusOnMainWindow()
            .then(() => {
            this.firstInput.applyFocus();
        });
    }
    setDeviceList(devices, selectedDevice) {
        for (let i in devices) {
            let deviceBounds = devices[i].bounds ? devices[i].bounds : { "height": 0, "width": 0, "x": 0, "y": 0 };
            this.devices.push({ label: devices[i].friendly_name, value: devices[i].device_id });
        }
        this.selectedDevice = selectedDevice;
    }
    setResolutionList(triggeredFromUI) {
        this.resolutions.length = 0;
        __WEBPACK_IMPORTED_MODULE_5_lodash__["forEach"](this.getInputTypes(), (inputType) => {
            this.pushResolutionToList(inputType);
        });
        this.resolutions = __WEBPACK_IMPORTED_MODULE_5_lodash__["uniqBy"](this.resolutions, 'label');
        __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].sortResolutionArray(this.resolutions);
        this.setSelectedResolutionForDevice();
        return this.onResolutionChange(triggeredFromUI);
    }
    pushResolutionToList(inputType) {
        this.resolutions.push({
            label: inputType.width + ' x ' + inputType.height + (inputType.interlaceMode === 'progressive' ? 'p' : 'i'),
            value: [inputType.width, inputType.height, inputType.interlaceMode]
        });
    }
    setSelectedResolutionForDevice() {
        this.selectedResolution = [
            this.deviceSettingsService.getSessionData(this.sessionName).selectedInputType.width,
            this.deviceSettingsService.getSessionData(this.sessionName).selectedInputType.height,
            this.deviceSettingsService.getSessionData(this.sessionName).selectedInputType.interlaceMode
        ];
    }
    filterInputsTypes(filteFps = false, filterCS = false) {
        return __WEBPACK_IMPORTED_MODULE_5_lodash__["filter"](this.getInputTypes(), (inputType) => {
            return inputType.width === this.selectedResolution[0] &&
                inputType.height === this.selectedResolution[1] &&
                inputType.interlaceMode === this.selectedResolution[2] &&
                (!filteFps || inputType.fps === this.selectedFps) &&
                (!filterCS || inputType.colorspace === this.selectedCS);
        });
    }
    setFpsList(triggeredFromUI) {
        let fpsRelatedInputTypes = this.filterInputsTypes();
        __WEBPACK_IMPORTED_MODULE_5_lodash__["forEach"](fpsRelatedInputTypes, (inputType) => {
            this.fps.push({ label: inputType.fps.toFixed(2), value: inputType.fps });
        });
        this.fps = __WEBPACK_IMPORTED_MODULE_5_lodash__["orderBy"](__WEBPACK_IMPORTED_MODULE_5_lodash__["uniqBy"](this.fps, 'label'), 'value', ['desc']);
        this.selectedFps = this.deviceSettingsService.getDefaultSelection(this.sessionName, fpsRelatedInputTypes, 'fps', triggeredFromUI);
        return this.onFpsChange(triggeredFromUI);
    }
    setColorSpaceList(triggeredFromUI) {
        let csRelatedInputTypes = this.filterInputsTypes(true);
        __WEBPACK_IMPORTED_MODULE_5_lodash__["forEach"](csRelatedInputTypes, (inputType) => {
            this.CS.push({ label: inputType.colorspace, value: inputType.colorspace });
        });
        this.CS = __WEBPACK_IMPORTED_MODULE_5_lodash__["uniqBy"](this.CS, 'label');
        this.selectedCS = this.deviceSettingsService.getDefaultSelection(this.sessionName, csRelatedInputTypes, 'colorspace', triggeredFromUI);
        return this.onCsChange(triggeredFromUI);
    }
    setEncoderList(encoders, selectedEncoder) {
        __WEBPACK_IMPORTED_MODULE_5_lodash__["forEach"](encoders, (encoder) => {
            this.encoder.push({ label: encoder.friendly_name, value: encoder.encoder_id });
        });
        this.encoder = __WEBPACK_IMPORTED_MODULE_5_lodash__["uniqBy"](this.encoder, 'label');
        this.selectedEncoder = selectedEncoder;
    }
    setBitrateList(bitrates, selectedBitrate) {
        this.bitrates = bitrates;
        this.selectedBitrate = selectedBitrate;
    }
    setProfileList(profiles, selectedProfile) {
        this.encoderProfiles = profiles;
        this.selectedEncoderProfile = selectedProfile;
    }
    resetSettingsData() {
        this.devices.length = 0;
        this.resolutions.length = 0;
        this.fps.length = 0;
        this.CS.length = 0;
        this.encoder.length = 0;
        this.bitrates.length = 0;
        this.encoderProfiles.length = 0;
        this.selectedDevice = null;
        this.selectedResolution = null;
        this.selectedFps = null;
        this.selectedCS = null;
        this.selectedEncoder = null;
        this.selectedBitrate = null;
        this.selectedEncoderProfile = null;
    }
    /**
     * on UI changes
     */
    onDeviceChange(triggeredFromUI) {
        this.deviceSettingsService.onDeviceChange(this.sessionName, this.sessionId, this.selectedDevice, this.selectedEncoder, this.selectedBitrate, this.selectedEncoderProfile)
            .then(() => {
            return this.setResolutionList(triggeredFromUI);
        })
            .catch((err) => {
            this.log.error('ERROR changing ' + this.sessionName + ' device selection ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    onResolutionChange(triggeredFromUI) {
        this.fps.length = 0;
        return this.setFpsList(triggeredFromUI);
    }
    onFpsChange(triggeredFromUI) {
        this.CS.length = 0;
        return this.setColorSpaceList(triggeredFromUI);
    }
    //set selected input type according to all input selected parameters
    onCsChange(riggeredFromUI) {
        let selectedInputType = this.filterInputsTypes(true, true);
        return this.deviceSettingsService.onCsChange(this.sessionName, this.sessionId, selectedInputType[0])
            .catch((err) => { }); //do nothing
    }
    onEncoderChange(triggeredFromUI) {
        return this.deviceSettingsService.setSelectedEncoder(this.sessionName, this.sessionId, this.selectedEncoder)
            .then(() => {
            this.resolutions.length = 0;
            return this.setResolutionList(triggeredFromUI);
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    onBitrateChange() {
        return this.deviceSettingsService.onBitrateChange(this.sessionName, this.sessionId, this.selectedBitrate)
            .catch((err) => { }); //do nothing
    }
    onEncoderProfileChange() {
        return this.deviceSettingsService.onEncoderProfileChange(this.sessionName, this.sessionId, this.selectedEncoderProfile)
            .catch((err) => { }); //do nothing
    }
    getInputTypes() {
        return this.deviceSettingsService.getSessionData(this.sessionName).InputTypes;
    }
    getEncoders() {
        return this.deviceSettingsService.getSessionData(this.sessionName).Encoders;
    }
    onBackClick() {
        this.panelsService.updateCurrentPanel({ type: this.sessionName + '-device-settings', active: false });
    }
    disableSettingsDropDown(devices) {
        return this.isProcessing() || __WEBPACK_IMPORTED_MODULE_5_lodash__["isEmpty"](devices);
    }
    isProcessing() {
        return !this.appState.isSourceStable(this.sessionId);
    }
    getEmptyDataText() {
        return this.loading ? 'SETTINGS.loading' : 'SETTINGS.not_available';
    }
    getInputDisplayName() {
        return this.inputsManagementService.getActiveSessionDisplayName(this.sessionName);
    }
    getDeviceInputText() {
        return 'CAPTURE_DEVICE.input_source';
    }
    identifyDevice() {
        return this.deviceSettingsService.identifyDevice(this.selectedDevice, this.sessionName);
    }
    showDeviceIndication() {
        return this.deviceSettingsService.shouldShowDeviceIndication(this.sessionName);
    }
    enableRemoveInput() {
        return this.inputsManagementService.getActiveVisualInputsCount() > 1;
    }
    isPrimaryInput() {
        return this.sessionName === this.inputsManagementService.PRIMARY_SESSION_NAME;
    }
    onRemoveInputClick() {
        this.confirmationService.confirm({
            message: '',
            key: this.getInputDisplayName(),
            accept: () => {
                this.onBackClick();
                this.inputsManagementService.removeSession(this.sessionName);
            },
            reject: () => { } //will return to settings panel
        });
    }
    onSwitchToPrimaryClick() {
        this.onBackClick();
        this.inputsManagementService.switchToPrimarySession(this.sessionName);
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", String)
], VisualInputSettingsComponent.prototype, "sessionName", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", String)
], VisualInputSettingsComponent.prototype, "deviceType", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('firstInput'),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_7_primeng_components_dropdown_dropdown__["Dropdown"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7_primeng_components_dropdown_dropdown__["Dropdown"]) === "function" && _a || Object)
], VisualInputSettingsComponent.prototype, "firstInput", void 0);
VisualInputSettingsComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'visual-input-settings',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-settings/visual-input-settings.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input-settings/visual-input-settings.component.scss"), __webpack_require__("../../../../../src/classroom/classroom-capture/styles/device-settings.scss")]
    }),
    __metadata("design:paramtypes", [typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_accessability_service__["a" /* AccessibilityService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_accessability_service__["a" /* AccessibilityService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_9__inputs_management_service__["a" /* InputsManagementService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__inputs_management_service__["a" /* InputsManagementService */]) === "function" && _h || Object, typeof (_j = typeof __WEBPACK_IMPORTED_MODULE_10_primeng_primeng__["ConfirmationService"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10_primeng_primeng__["ConfirmationService"]) === "function" && _j || Object])
], VisualInputSettingsComponent);

var _a, _b, _c, _d, _e, _f, _g, _h, _j;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/visual-input-settings.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input/visual-input.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"visual-input capture-device\">\r\n\r\n  <p-confirmDialog class=\"cc-confirmation\" message= \"{{ 'CONFIRMATIONS.stop_live_streaming_Message' | translate }}\"\r\n                   key=\"{{ 'stop-broadcast-key-' + this.inputSession.sessionName}}\" appendTo=\"body\" #cb dialog-addon role=\"dialog\" aria-modal=\"true\">\r\n    <p-footer class=\"confirm-dialog-footer\">\r\n      <button class=\"app-link-button\" pButton label=\"{{'COMMON.cancel' | translate}}\" (click)=\"cb.reject()\"></button>\r\n      <button class=\"confirm-button app-oval-button cc-button\" pButton label=\"{{'CONFIRMATIONS.stop_live_streaming_confirm' | translate}}\" (click)=\"cb.accept()\"></button>\r\n    </p-footer>\r\n  </p-confirmDialog>\r\n\r\n  <visual-input-controllers class=\"visual-input-controller-container\" [inputSession]=\"inputSession\"\r\n                     (previewStateChange)=\"onPreviewStateChangeEvent()\"\r\n                     (inputSettingsClick)=\"onInputSettingsClickEvent()\">\r\n  </visual-input-controllers>\r\n\r\n  <div class=\"input-preview device-preview\" [ngClass]=\"{'single-device-preview': isSingleInput()}\">\r\n    <div class=\"device-temp-preview video-temp-preview\"></div>\r\n  </div>\r\n\r\n  <div class=\"visual-input-footer\">\r\n    <button class=\"stop-streaming-button\"\r\n          (click)=\"onStopStreamingButtonClick()\"\r\n          [hidden]=\"!isLiveStreamingInput()\">Stop Broadcasting</button>\r\n  </div>\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input/visual-input.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".video-temp-preview {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/40/camera.svg")) + ") no-repeat top left; }\n\n.capture-device {\n  box-sizing: border-box;\n  background-color: #24212A; }\n\n.visual-input-controller-container {\n  height: 10%;\n  display: block;\n  background-color: rgba(153, 153, 153, 0.1); }\n\n.visual-input-footer {\n  height: 13.8%; }\n\n.stop-streaming-button {\n  position: absolute;\n  bottom: 3.2%;\n  margin-top: auto;\n  margin-bottom: auto;\n  left: calc(50% - 70px);\n  width: 140px;\n  height: 24px;\n  opacity: 0.7;\n  border-radius: 100px;\n  background-color: rgba(255, 255, 255, 0);\n  border: solid 1px #ffffff;\n  color: #ffffff;\n  font-family: Lato;\n  text-align: center; }\n  .stop-streaming-button:hover {\n    opacity: 1; }\n\n.confirm-dialog-footer {\n  width: 242px;\n  left: calc(50% - 121px); }\n\n.confirm-button {\n  width: 130px;\n  padding-top: 0px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input/visual-input.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__shared_services_capture_device_video_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__inputs_management_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_live_live_manager_service__ = __webpack_require__("../../../../../src/shared/services/live/live-manager.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_primeng_primeng__ = __webpack_require__("../../../../primeng/primeng.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_primeng_primeng___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_primeng_primeng__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return VisualInputComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










let VisualInputComponent = class VisualInputComponent {
    constructor(log, elementRef, appState, panelsService, videoService, inputsManagementService, devicePreviewService, liveManagerService, confirmationService) {
        this.log = log;
        this.elementRef = elementRef;
        this.appState = appState;
        this.panelsService = panelsService;
        this.videoService = videoService;
        this.inputsManagementService = inputsManagementService;
        this.devicePreviewService = devicePreviewService;
        this.liveManagerService = liveManagerService;
        this.confirmationService = confirmationService;
        this.inputSession = {};
        this.visualInputsRefreshSub = null;
        this.startInputsPreviewSubscription = null;
    }
    onResize(event) {
        this.videoService.repositionsDevicePreview(this.inputSession.sessionName, this.getPreviewElementPosition());
    }
    ngAfterViewInit() {
        this.log.info('VisualInputComponent ngAfterViewInit for ' + this.inputSession.sessionName);
        this.visualInputsRefreshSub =
            this.inputsManagementService.refreshInputs$.subscribe(() => {
                this.log.info('VisualInputComponent: refresh inputs was fired for ' + this.inputSession.sessionName);
                this.setInitPreviewDisplay();
            });
        this.registerToPreviewReposition();
        this.registerStartInputsPreviewEvent();
        this.setInitPreviewDisplay();
    }
    ngOnDestroy() {
        if (this.visualInputsRefreshSub)
            this.visualInputsRefreshSub.unsubscribe();
        if (this.startInputsPreviewSubscription)
            this.startInputsPreviewSubscription.unsubscribe();
    }
    onPreviewStateChangeEvent() {
        if (!this.isPreviewing()) {
            this.startPreview();
        }
        else {
            this.stopPreview();
        }
    }
    onInputSettingsClickEvent() {
        let active = !this.panelsService.isPanelActive(this.inputSession.sessionName + '-device-settings');
        this.panelsService.updateCurrentPanel({ type: this.inputSession.sessionName + '-device-settings', active: active });
    }
    isSingleInput() {
        return this.inputsManagementService.getActiveVisualInputsCount() === 1;
    }
    /**
     * check if input's preview should be visible at component load
     */
    setInitPreviewDisplay() {
        if (this.isPreviewing()) {
            this.log.info('VisualInputComponent: setInitPreviewDisplay: display preview for ' + this.inputSession.sessionName);
            this.toggleDevicePreview(true);
        }
    }
    startPreview() {
        let pos = this.getPreviewElementPosition();
        if (pos) {
            return this.videoService.startDevicePreviewAndActivateSession(this.inputSession.sessionName, pos)
                .catch((err) => {
            }); //do nothing
        }
        else {
            return Promise.resolve();
        }
    }
    stopPreview() {
        this.videoService.stopDevicePreviewAndDeactivateSession(this.inputSession.sessionName)
            .catch((err) => { }); //do nothing
    }
    getPreviewElementPosition() {
        let previewElement = this.elementRef.nativeElement.querySelector('.device-preview');
        let rect = previewElement ? previewElement.getBoundingClientRect() : null;
        return rect ? {
            left: rect.left * window.devicePixelRatio,
            top: rect.top * window.devicePixelRatio,
            width: previewElement.offsetWidth * window.devicePixelRatio,
            height: previewElement.offsetHeight * window.devicePixelRatio
        } : null;
    }
    registerToPreviewReposition() {
        this.devicePreviewService.repositionPreview$.subscribe(() => {
            this.videoService.repositionsDevicePreview(this.inputSession.sessionName, this.getPreviewElementPosition());
        });
    }
    registerStartInputsPreviewEvent() {
        this.startInputsPreviewSubscription = this.startInputsPreviewEvent.subscribe(() => {
            this.log.info('VisualInputComponent: received startInputsPreviewEvent');
            this.videoService.updateDevicePreviewLocation(this.inputSession.sessionName, this.getPreviewElementPosition());
        });
    }
    /**
     * only hides device preview
     * @param showPreview
     */
    toggleDevicePreview(showPreview) {
        if (showPreview) {
            //wait for next ui cycle
            setTimeout(() => {
                this.videoService.updateDevicePreviewLocation(this.inputSession.sessionName, this.getPreviewElementPosition());
            });
        }
        else {
            this.videoService.hideDevicePreview(this.inputSession.sessionName);
        }
    }
    isPreviewing() {
        return this.videoService.isDevicePreviewing(this.inputSession.sessionName);
    }
    isLiveStreamingInput() {
        return this.liveManagerService.isInputLiveConfigured(this.inputSession.sessionName);
    }
    onStopStreamingButtonClick() {
        this.confirmationService.confirm({
            message: '',
            key: "stop-broadcast-key-" + this.inputSession.sessionName,
            accept: () => {
                this.videoService.stopLiveStreaming(this.inputSession.sessionName);
                this.liveManagerService.stopLiveStreaming();
            },
            reject: () => { }
        });
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object)
], VisualInputComponent.prototype, "inputSession", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]) === "function" && _a || Object)
], VisualInputComponent.prototype, "startInputsPreviewEvent", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('window:resize', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], VisualInputComponent.prototype, "onResize", null);
VisualInputComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'visual-input',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input/visual-input.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-input/visual-input.component.scss"), __webpack_require__("../../../../../src/classroom/classroom-capture/styles/device-container.scss")],
        providers: []
    }),
    __metadata("design:paramtypes", [typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_panels_service__["a" /* PanelsService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_2__shared_services_capture_device_video_device_service__["a" /* VideoDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__shared_services_capture_device_video_device_service__["a" /* VideoDeviceService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_6__inputs_management_service__["a" /* InputsManagementService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__inputs_management_service__["a" /* InputsManagementService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */]) === "function" && _h || Object, typeof (_j = typeof __WEBPACK_IMPORTED_MODULE_8__shared_services_live_live_manager_service__["a" /* LiveManagerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_services_live_live_manager_service__["a" /* LiveManagerService */]) === "function" && _j || Object, typeof (_k = typeof __WEBPACK_IMPORTED_MODULE_9_primeng_primeng__["ConfirmationService"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9_primeng_primeng__["ConfirmationService"]) === "function" && _k || Object])
], VisualInputComponent);

var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/visual-input.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-inputs-container.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"grid col-12 visual-inputs-container\">\r\n\r\n  <visual-input *ngFor=\"let inputName of getActiveSessionsNames()\"\r\n                aria-hidden id=\"inputName\"\r\n                class=\"visual-input-item\"\r\n                [ngClass]=\"getColumnClass()\"\r\n                [startInputsPreviewEvent]=\"startInputsPreviewEvent\"\r\n                [inputSession]=\r\n                  \"{sessionName: inputName,\r\n                    type: _activeInputs[inputName],\r\n                    displayName: getActiveSessionDisplayName(inputName)}\">\r\n  </visual-input>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-inputs-container.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".visual-inputs-container {\n  width: 100%;\n  height: 100%; }\n\n.visual-input-item {\n  -ms-flex-item-align: stretch;\n      -ms-grid-row-align: stretch;\n      align-self: stretch;\n  padding: 0 1px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-inputs-container.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__inputs_management_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/inputs-management.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return VisualInputsContainerComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








let VisualInputsContainerComponent = class VisualInputsContainerComponent {
    constructor(log, appState, inputsManagementService) {
        this.log = log;
        this.appState = appState;
        this.inputsManagementService = inputsManagementService;
        this.THROTTLING_THRESHOLD = 200;
        /**
         * will fire an event when all inputs should start their preview after window movement and visibility state change
         */
        this.startInputsPreviewEvent = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this._activeInputs = [];
        this.onWinMoveSubscription = null;
        this.activeWindowTransition = false;
        this.windowTransitionTimer = null;
        this.windowMoveThrottlingTimestamp = null;
        this.hideWindowPromise = Promise.resolve();
    }
    set activeInputs(inputs) {
        this.log.info('VisualInputsContainerComponent: active inputs update');
        this._activeInputs = inputs;
        this.inputsManagementService.fireRefreshInputsEvent();
    }
    ngOnInit() {
        this.registerToWindowMove();
        this.registerWindowVisibilityChanges();
    }
    ngOnDestroy() {
        this.unRegisterFromWindowMove();
    }
    getColumnClass() {
        let inputsLength = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this._activeInputs).length;
        return inputsLength > 0 ? 'col-' + Math.floor(12 / inputsLength) : '';
    }
    /**
     * output order - primary session (always session0), and than all others
     * @returns {string[]}
     */
    getActiveSessionsNames() {
        return __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this._activeInputs).sort((a, b) => {
            //alphabetical order
            return a < b ? -1 : 1;
        });
    }
    getActiveSessionDisplayName(sessionName) {
        return this.inputsManagementService.getActiveSessionDisplayName(sessionName);
    }
    registerToWindowMove() {
        if (!this.onWinMoveSubscription) {
            this.onWinMoveSubscription =
                __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('on-window-move', () => {
                    if (!this.windowMoveThrottlingTimestamp || (Date.now() - this.windowMoveThrottlingTimestamp > this.THROTTLING_THRESHOLD)) {
                        this.windowMoveThrottlingTimestamp = Date.now();
                        this.handleWindowMove();
                    }
                });
        }
    }
    registerWindowVisibilityChanges() {
        this.appState.applicationWindowState$.subscribe((state) => {
            if (state === this.appState.WINDOW_STATE.HIDDEN) {
                clearTimeout(this.windowTransitionTimer);
                this.unRegisterFromWindowMove();
                this.inputsPreviewHide()
                    .catch((err) => {
                    this.log.info('VisualInputsContainer: Failed to hide previews after window visibility change');
                });
            }
            else if (state === this.appState.WINDOW_STATE.VISIBLE) {
                this.registerToWindowMove();
                this.startInputsPreviewEvent.next();
            }
        });
    }
    unRegisterFromWindowMove() {
        if (this.onWinMoveSubscription) {
            __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].unregisterForNotification('on-window-move', this.onWinMoveSubscription);
            this.onWinMoveSubscription = null;
        }
    }
    handleWindowMove() {
        if (!this.activeWindowTransition) {
            this.activeWindowTransition = true;
            this.updatePreviewPosition();
        }
        else {
            this.log.debug('VisualInputsContainerComponent: window transition is in progress - ignoring win move event.');
            this.initWindowTransitionTimer();
        }
    }
    updatePreviewPosition() {
        //only if we are not during window transition
        this.log.debug('VisualInputsContainerComponent: not in window transition, hiding inputs preview');
        this.inputsPreviewHide()
            .then(() => {
            this.initWindowTransitionTimer();
        });
    }
    inputsPreviewHide() {
        this.log.info('VisualInputsContainerComponent: not in window transition, hiding inputs preview');
        this.hideWindowPromise =
            this.hideWindowPromise
                .then(() => {
                this.log.info('VisualInputsContainerComponent: previous hide window promise ended, hiding inputs preview');
                this.activeWindowTransition = true;
                return this.inputsManagementService.hideAllActiveSessionsPreview();
            })
                .catch((err) => {
                this.log.info('VisualInputsContainerComponent: Failed to hide all active inputs preview. ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
            });
        return this.hideWindowPromise;
    }
    initWindowTransitionTimer() {
        clearTimeout(this.windowTransitionTimer);
        //wait for movement to stop
        this.windowTransitionTimer = setTimeout(() => {
            //fire a show preview event after stop promise resolved
            this.log.info('VisualInputsContainerComponent: preparing to fire start inputs preview event');
            this.hideWindowPromise
                .then(() => {
                //start inputs preview only if app is visible
                if (this.appState.getApplicationWindowState() === this.appState.WINDOW_STATE.VISIBLE) {
                    this.startInputsPreviewEvent.next();
                    this.log.info('VisualInputsContainerComponent: fired start inputs preview event');
                }
                this.activeWindowTransition = false;
                this.windowMoveThrottlingTimestamp = null;
                this.windowTransitionTimer = null;
            });
        }, 750);
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], VisualInputsContainerComponent.prototype, "activeInputs", null);
VisualInputsContainerComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'visual-inputs-container',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-inputs-container.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/inputs-management/visual-inputs-container/visual-inputs-container.component.scss")],
        providers: []
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_4__inputs_management_service__["a" /* InputsManagementService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__inputs_management_service__["a" /* InputsManagementService */]) === "function" && _c || Object])
], VisualInputsContainerComponent);

var _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/visual-inputs-container.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/recording-notifications/recording-notifications.component.html":
/***/ (function(module, exports) {

module.exports = "<div *ngIf=\"isNextEventCountdownVisible\" class=\"countdown-notification\" [ngClass]=\"{liveNotification: isNextEventLive()}\">\r\n  <div *ngIf=\"isNextEventLive()\" class=\"live-box\"><div class=\"live-text\">LIVE</div></div>\r\n  <span class=\"countdown-text\">{{ countdownTimeDuration | duration }}</span>\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/recording-notifications/recording-notifications.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".countdown-notification {\n  width: 196px;\n  height: 48px;\n  line-height: 48px;\n  background-color: rgba(153, 153, 153, 0.2);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 600;\n  color: #cccccc;\n  text-align: right; }\n  .countdown-notification .countdown-text {\n    margin-right: 15px; }\n\n.liveNotification {\n  width: 220px; }\n\n.live-box {\n  width: 40px;\n  height: 20px;\n  margin-top: 13px;\n  margin-left: 92px;\n  padding-right: 2px;\n  float: left;\n  border-radius: 4px;\n  background-color: #ffffff;\n  opacity: 0.5; }\n\n.live-text {\n  font-family: Lato;\n  font-size: 13px;\n  font-weight: bold;\n  color: #000000;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n      align-items: center;\n  height: 100%;\n  margin-left: 7px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/components/recording-notifications/recording-notifications.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_scheduling_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/scheduling.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_moment__ = __webpack_require__("../../../../moment/moment.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_moment___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_moment__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordingNotificationsComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let RecordingNotificationsComponent = RecordingNotificationsComponent_1 = class RecordingNotificationsComponent {
    constructor(schedulingService, appState, translate) {
        this.schedulingService = schedulingService;
        this.appState = appState;
        this.translate = translate;
        this.isNextEventCountdownVisible = false;
        this._currentIcon = null;
        this.ICON_NAMES = {
            RECORDING: 'recording',
            SCHEDULED_EVENT: 'scheduled-event',
            DEFAULT: 'default'
        };
    }
    ngOnInit() {
        this.countdownSubscription$ = __WEBPACK_IMPORTED_MODULE_3_rxjs__["Observable"].timer(0, 1000)
            .subscribe(() => {
            this.isNextEventCountdownVisible = this.schedulingService.shouldDisplayNextEventNotifications(RecordingNotificationsComponent_1.COUNT_DOWN_DISAPPEAR_BEFORE_EVENT_START_SEC);
            this.showCountDownAndNotification();
            this.changeCurrentIcon();
        });
    }
    get nextEvent() {
        return this.schedulingService.getNextEvent();
    }
    showCountDownAndNotification() {
        if (this.isNextEventCountdownVisible) {
            let now = __WEBPACK_IMPORTED_MODULE_2_moment__().valueOf();
            this.countdownTimeDuration = this.schedulingService.getNextEventRealStartTime() * 1000 - now;
        }
        else {
            this.countdownTimeDuration = null;
        }
    }
    changeCurrentIcon() {
        if (this.appState.isAppRecording() && this.appState.recordingPhase === 'recording') {
            this.currentIcon = this.ICON_NAMES.RECORDING;
        }
        else if (this.isNextEventCountdownVisible) {
            this.currentIcon = this.ICON_NAMES.SCHEDULED_EVENT;
        }
        else {
            this.currentIcon = this.ICON_NAMES.DEFAULT;
        }
    }
    get currentIcon() {
        return this._currentIcon;
    }
    set currentIcon(newCurrentIconValue) {
        if (this._currentIcon !== newCurrentIconValue) {
            this._currentIcon = newCurrentIconValue;
            this.translate.get("NOTIFICATIONS." + this._currentIcon).subscribe((localeText) => {
                __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__["a" /* ipcWrapper */].sendSystemCommand('changeTaskBarIcon', this._currentIcon, localeText);
            });
        }
    }
    isNextEventLive() {
        let event = this.schedulingService.getNextEvent();
        return event && event.primaryRtmp;
    }
};
// const
RecordingNotificationsComponent.COUNT_DOWN_DISAPPEAR_BEFORE_EVENT_START_SEC = 5;
RecordingNotificationsComponent = RecordingNotificationsComponent_1 = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'recording-notifications',
        template: __webpack_require__("../../../../../src/classroom/classroom-capture/components/recording-notifications/recording-notifications.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/classroom-capture/components/recording-notifications/recording-notifications.component.scss")]
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__services_scheduling_service__["a" /* SchedulingService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__services_scheduling_service__["a" /* SchedulingService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_6_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6_ng2_translate__["b" /* TranslateService */]) === "function" && _c || Object])
], RecordingNotificationsComponent);

var RecordingNotificationsComponent_1, _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/recording-notifications.component.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/services/recording-manager.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_router__ = __webpack_require__("../../../router/@angular/router.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_services_recording_recording_details_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-details.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_services_capture_device_device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__scheduling_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/scheduling.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shared_services_capture_device_device_connection_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-connection.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__shared_services_infra_system_health_service__ = __webpack_require__("../../../../../src/shared/services/infra/system-health.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__shared_services_capture_device_device_resources_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-resources.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__utils_minimize_service__ = __webpack_require__("../../../../../src/utils/minimize.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__shared_services_recording_slides_service__ = __webpack_require__("../../../../../src/shared/services/recording/slides.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__ = __webpack_require__("../../../../../src/shared/services/monitoring/app-monitoring-agent-error-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__shared_services_capture_device_video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__shared_services_recording_recording_recovery_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-recovery.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__shared_services_capture_device_audio_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__shared_services_capture_device_video_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_24__shared_services_recording_mouse_click_indication_service__ = __webpack_require__("../../../../../src/shared/services/recording/mouse-click-indication.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_25__shared_services_recording_recording_utils_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-utils.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_26__shared_services_live_live_manager_service__ = __webpack_require__("../../../../../src/shared/services/live/live-manager.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordingManagerService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



























let RecordingManagerService = class RecordingManagerService {
    /**
     * init recording timer
     */
    constructor(appState, persistencyService, log, recordingDetailsService, devicePreviewService, recoveryService, notificationService, schedulingService, deviceManagerService, router, appConfig, systemHealthService, captureResourcesService, minimizeService, slidesService, appMonitoringAgentData, videoDeviceService, videoDeviceSettingsService, audioSettingsService, mouseClickIndicationService, recordingUtilsService, liveManagerService) {
        this.appState = appState;
        this.persistencyService = persistencyService;
        this.log = log;
        this.recordingDetailsService = recordingDetailsService;
        this.devicePreviewService = devicePreviewService;
        this.recoveryService = recoveryService;
        this.notificationService = notificationService;
        this.schedulingService = schedulingService;
        this.deviceManagerService = deviceManagerService;
        this.router = router;
        this.appConfig = appConfig;
        this.systemHealthService = systemHealthService;
        this.captureResourcesService = captureResourcesService;
        this.minimizeService = minimizeService;
        this.slidesService = slidesService;
        this.appMonitoringAgentData = appMonitoringAgentData;
        this.videoDeviceService = videoDeviceService;
        this.videoDeviceSettingsService = videoDeviceSettingsService;
        this.audioSettingsService = audioSettingsService;
        this.mouseClickIndicationService = mouseClickIndicationService;
        this.recordingUtilsService = recordingUtilsService;
        this.liveManagerService = liveManagerService;
        /**
         * recording timer properties
         */
        this.recordingTimerSub = null;
        this.recordingTimer = null;
        this.recordingTotalDuration = 0;
        this.recordingCurrentSessionDuration = 0;
        /**
         * triggered when need to focus on application's recording main page (used as indication for closing panels etc...)
         */
        this.focusOnRecording = new __WEBPACK_IMPORTED_MODULE_7_rxjs__["BehaviorSubject"]('');
        this.focusOnRecording$ = this.focusOnRecording.asObservable();
        /**
         * scheduled event notifications subscriptions
         */
        this.scheduledEventUpdateNotification = null;
        /**
         * indicates if should enable current scheduled event extension
         */
        this.shouldEnableEventExtension = false;
        /**
         * device connection state notification subscription
         */
        this.deviceConnectionStateNotification = null;
        /**
         * indicates if an action is still in progress
         * @type {boolean}
         */
        this.actionInProgress = false;
        /**
         * indicates if recording request is loading (engine can delay response util video samples starts arriving)
         * @type {boolean}
         */
        this.recordingIsLoading = false;
        // config obj
        this.recordingConfigObj = {};
        //skip scheduled event no resources log - make sure to log only once each event if needed
        this.skipScheduledEventStartLog = false;
        this.recordingTimer = __WEBPACK_IMPORTED_MODULE_7_rxjs__["Observable"].timer(100, 1000);
        this.getRecordingConfigSetting();
        this.registerSystemHealthNotification();
        // init the rest
        this.initialClassroomCaptureLoading();
    }
    getRecordingConfigSetting() {
        // init default values
        this.recordingConfigObj['minimizeWhenRecordingStarts'] = false;
        this.recordingConfigObj['adHockCountdownBeforeStart'] = true;
        this.recordingConfigObj['scheduledCountdownBeforeStart'] = true;
        this.recordingConfigObj['minimizeRecordingDelaySec'] = 10;
        let recordingConfigObj = this.appConfig.getConfigData('config.captureApp.recording');
        // minimizeWhenRecordingStarts
        if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isBoolean"](recordingConfigObj['minimizeWhenRecordingStarts'])) {
            recordingConfigObj['minimizeWhenRecordingStarts'] = false;
            this.log.info('RecordingManagerService: Validate Config settings - minimizeWhenRecordingStarts should be a true/false (default: false)');
        }
        // minimizeRecordingDelaySec
        if (recordingConfigObj['minimizeWhenRecordingStarts']) {
            if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isNumber"](recordingConfigObj['minimizeRecordingDelaySec'])) {
                recordingConfigObj['minimizeRecordingDelaySec'] = 10;
                this.log.info('RecordingManagerService: Validate Config settings - minimizeRecordingDelaySec must be a number between 1 - 60 (default: 10 seconds).');
            }
            else if (recordingConfigObj['minimizeRecordingDelaySec'] < 1) {
                recordingConfigObj['minimizeRecordingDelaySec'] = 1;
                this.log.info('RecordingManagerService: Validate Config settings - minimizeRecordingDelaySec is not a valid value - must be more than 1 sec (value set to: 1 seconds).');
            }
            else if (recordingConfigObj['minimizeRecordingDelaySec'] > 60) {
                recordingConfigObj['minimizeRecordingDelaySec'] = 60;
                this.log.info('RecordingManagerService: Validate Config settings - minimizeRecordingDelaySec is not a valid value - must be less than 60 sec (value set to: 60 seconds).');
            }
        }
        // adHockCountdownBeforeStart
        if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isBoolean"](recordingConfigObj['adHockCountdownBeforeStart'])) {
            recordingConfigObj['adHockCountdownBeforeStart'] = true;
            this.log.info('RecordingManagerService: Validate Config settings - adHockCountdownBeforeStart should be a true/false (default: true)');
        }
        // scheduledCountdownBeforeStart
        if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isBoolean"](recordingConfigObj['scheduledCountdownBeforeStart'])) {
            recordingConfigObj['scheduledCountdownBeforeStart'] = true;
            this.log.info('RecordingManagerService: Validate Config settings - scheduledCountdownBeforeStart should be a true/false (default: true)');
        }
        this.recordingConfigObj = recordingConfigObj;
    }
    registerSystemHealthNotification() {
        this.systemHealthService.systemNotHealthy$.subscribe(isSysNotHealthy => {
            if (isSysNotHealthy) {
                this.log.info('Recording Manager: Not enough diskspace was detected during recording, pausing recording.');
                this.callRecordingNextAction('pause')
                    .catch(() => {
                    this.log.error('systemNotHealthy subscription: Failed to pause ');
                });
            }
        });
    }
    /**
     * loads initial classroom capture state and configuration
     * checks if app should be loaded in recovery mode (exited in the middle of a recording session)
     */
    initialClassroomCaptureLoading(reload = false) {
        this.log.info('initialClassroomCaptureLoading(' + reload + ')');
        //settings initial state to - loading (if app is not in recovery mode the state will be changed to - stable, else - will change to in_process)
        this.updateRecState(this.appState.REC_STATE.LOADING);
        return this.appState.areSessionsReadyForRecording('initRecordingService')
            .then(() => {
            return this.recordingDetailsService.isReady;
        })
            .then(() => {
            return this.initRecordingSession();
        })
            .catch((err) => {
            this.log.error('Failed to load previous recording details. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.notificationService.sendNotification('NOTIFICATIONS.error_loadPrevRecDetails', 'warn');
            this.actionInProgress = false;
            this.updateRecState(this.appState.REC_STATE.STABLE);
        })
            .then(() => {
            if (!reload) {
                this.setMainProcessListeners();
                this.addDeviceConnectionStateListeners();
            }
            let schedulingConfig = this.appConfig.getConfigData('config.captureApp.scheduling');
            if (schedulingConfig && schedulingConfig['enabled']) {
                this.startSchedulingManagement();
            }
        });
    }
    /**
     * listens for start/pause/resume/cancel events from thumbnail view in main process
     */
    setMainProcessListeners() {
        //listening to main process actions (thumbnail view in system tray)
        electron.ipcRenderer.on('startRecording', (event, data) => {
            this.log.info('starting recording...');
            this.callRecordingNextAction('start');
        });
        electron.ipcRenderer.on('stopRecording', (event, data) => {
            this.log.info('stopping recording...');
            this.callRecordingNextAction('stop');
        });
    }
    initRecordingSession() {
        return this.recoveryService.shouldRecoverRecordingSession()
            .then((recData) => {
            if (__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](recData)) {
                //app is not in recovery mode - start normally
                this.updateRecState(this.appState.REC_STATE.STABLE);
                this.log.info('Starting Classroom Capture in regular mode');
            }
            else {
                //setting recording state to 'in_process' and starting app in recovery mode
                this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
                return this.tryToRecoverRecordingSession(recData);
            }
        })
            .catch((err) => {
            return this.failedRecoveryFlow(err);
        });
    }
    tryToRecoverRecordingSession(recData) {
        this.log.debug('tryToRecoverRecordingSession');
        this.actionInProgress = true;
        //todo add timeout and start app....
        //wait for relevant sessions to be ready
        return this.recoveryService.getRecoverySessionsReadyPromise()
            .then((ready) => {
            if (ready) {
                this.log.debug('recovery sessions are ready for recover recording.');
                return this.recoveryService.canRecoverRecordingSession()
                    .then((canRecover) => {
                    if (canRecover) {
                        this.log.debug('application can start in recovery mode.');
                        return this.startInRecoveryMode(recData);
                    }
                    else {
                        this.log.debug('handling failed recovery flow.');
                        return this.handleRecoveryFlowErrorFlow(recData);
                    }
                })
                    .catch((err) => {
                    this.log.error('Failed to recover recording: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                    return this.failedRecoveryFlow(err);
                });
            }
            else {
                this.log.debug('application recovery mode return with a non-ready state, closing current recording.');
                this.schedulingService.resetCurrentEvent();
                return this.closeFailedRecoveredSession();
            }
        });
    }
    /**
     * handling error in devices recovery flow, different outcome for disconnected device or a failed initiation
     */
    handleRecoveryFlowErrorFlow(recData) {
        this.log.debug('handleRecoveryFlowErrorFlow');
        if (this.isRecordDisconnected()) {
            this.log.debug('recovery flow failed due to a disconnected device.');
            this.notificationService.sendNotification("NOTIFICATIONS.warn_appLoadedAfterDisconnection", 'warn');
            return this.startInRecoveryMode(recData);
        }
        else {
            this.log.debug('recovery flow failed due to a recovery failure.');
            this.schedulingService.resetCurrentEvent();
            return this.closeFailedRecoveredSession();
        }
    }
    startInRecoveryMode(recData) {
        this.actionInProgress = false;
        this.callRecordingNextAction('pause', true);
        this.setPrevRecordingTime(recData['recordingTime']);
        return Promise.resolve(true);
    }
    closeFailedRecoveredSession() {
        this.log.info('closeFailedRecoveredSession');
        return this.tryToRecoverAndCloseRecording()
            .then(() => {
            this.notificationService.sendNotification("NOTIFICATIONS.error_restore", 'warn');
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].RECOVER_RECORDING, 'NOTIFICATIONS.error_restore');
            return Promise.resolve(false);
        })
            .catch((err) => {
            this.log.error('Failed to close previous recording session. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    failedRecoveryFlow(err) {
        this.log.error('Failed to load in recovery mode. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
        this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].RECOVER_RECORDING, 'NOTIFICATIONS.error_loadPrevRec');
        this.notificationService.sendNotification('NOTIFICATIONS.error_loadPrevRec', 'error');
        this.schedulingService.resetCurrentEvent();
        return this.resetRecording();
    }
    finalizeRecordingFileOffCycle(files) {
        return this.recordingUtilsService.finalizeRecordingFileOffCycle(files);
    }
    navigateToRecordingPage() {
        return new Promise((resolve, reject) => {
            if (this.router.url !== '/' && this.router.url !== '/home') {
                this.log.info('Navigating back to recording page before starting scheduled recording');
                this.router.navigate(['']);
                let routeSub = this.router.events.subscribe((event) => {
                    if (event instanceof __WEBPACK_IMPORTED_MODULE_1__angular_router__["NavigationEnd"]) {
                        routeSub.unsubscribe();
                        resolve(true);
                    }
                });
            }
            else {
                resolve(true);
            }
        });
    }
    setScheduledEventRecordingDetails(metadata) {
        if (__WEBPACK_IMPORTED_MODULE_10_lodash__["isObject"](metadata)) {
            this.log.debug('Updating recording details for current scheduled event. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(metadata));
            this.recordingDetailsService.setRecordingDetails({
                'title': metadata['summary'],
                'description': metadata['description'],
                'userName': metadata['organizer'],
                'tags': metadata['tags'] ? metadata['tags'].split(',') : [],
                'templateEntryId': metadata['templateEntryId'],
                'eventId': metadata['id'],
                'liveStreamed': !!metadata["primaryRtmp"]
            });
            this.recordingDetailsService.setReadOnly(true);
        }
    }
    /**
     * Finalizing current recording.
     * pausing record id needed, closing files (using recoveryMP4 if needed), saving recording details to json
     * and notifying the user.
     * In case of a scheduled event that was manually stopped, making sure to notify scheduling service to handle
     * end of scheduled event ahead of time
     */
    finalizeCurrentRecording(manuallyTriggered) {
        this.log.info('RecordingManagerService: finalizeCurrentRecording(' + manuallyTriggered + ')');
        if (this.appState.recordingPhase !== 'initial') {
            this.log.info('Finalizing current recording.');
            return this.callRecordingNextAction('pause') //will return a resolved promise if rec already paused
                .then(() => {
                this.liveManagerService.removeLiveConfig(); // will check if exist else will ignore
                return this.closeFinishedRecording(manuallyTriggered);
            })
                .then(() => {
                return this.recordingDetailsService.saveRecordingDetailsJson();
            })
                .then(([res, recJson]) => {
                this.log.info('RecordingManagerService: Json file for current capture recording was saved in: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(res));
                this.notificationService.sendNotification('NOTIFICATIONS.info_successfulRecording', 'info');
                this.appMonitoringAgentData.clearError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].ALL);
                return this.resetRecording();
            })
                .catch((err) => {
                return this.tryToRecoverAndCloseRecording()
                    .then(() => {
                    this.notificationService.sendNotification('NOTIFICATIONS.info_successfulRecording', 'info');
                })
                    .catch(() => {
                    this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].STOP_RECORDING, 'NOTIFICATIONS.error_saveRecording');
                    this.log.error('RecordingManagerService: Failed to finalize current recording: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                });
            });
        }
        else {
            this.log.warn('RecordingManagerService: A request for closing a recording was ignored since application is not recording.');
            return Promise.resolve('INITIAL_STATE');
        }
    }
    /**
     * try to close recording using recover mp4 process,
     * being used if a regular recording finalization process failed of if app recovery process failed.
     */
    tryToRecoverAndCloseRecording() {
        this.log.info('RecordingManagerService: tryToRecoverAndCloseRecording()');
        //close recording using off cycle api call
        return this.appState.areSessionsReadyForRecording('tryToRecoverAndCloseRecording()')
            .catch(() => {
            //we want to close failed recovery event if not all sessions were created successully
        })
            .then(() => {
            return this.appState.shutDownSessions(this.appState.SESSION_LOAD_WAIT_STATE.NEXT_TIME); //need to remove handles from recorded files in order to close them
        })
            .then(() => {
            return this.persistencyService.get('recording');
        })
            .then((recData) => {
            if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](recData) && !__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](recData['details']) && !__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](recData['details']['files'])) {
                return this.finalizeRecordingFileOffCycle(recData['details']['files']);
            }
            else {
                return Promise.reject('Failed to finalize recording using recoverMP4 since there are no files in recording details');
            }
        })
            .then(() => {
            return this.recordingDetailsService.saveRecordingDetailsJson();
        })
            .then(() => {
            this.log.info('Recording Json file for previous recording was saved.');
            return this.resetRecording();
        })
            .catch((err) => {
            this.log.error('Failed to recover and close recording session. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.notificationService.sendNotification('NOTIFICATIONS.error_saveRecording', 'error');
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].RECOVER_RECORDING, 'NOTIFICATIONS.error_saveRecording');
            return this.resetRecording();
        });
    }
    /**
     * recording session actions
     */
    startRecording() {
        this.log.info('startRecording()');
        this.recordingIsLoading = true;
        return this.appState.areSessionsReadyForRecording('startRecording()')
            .then(() => {
            return this.canStartOrResumeRecording();
        })
            .then(() => {
            return this.captureResourcesService.getCaptureResources();
        })
            .then(() => {
            // for testing only!!
            let primaryRtmp = this.appConfig.getConfigData('config.captureApp.primaryRtmp');
            let flavorArray = this.appConfig.getConfigData('config.captureApp.flavorArray') || [];
            if (primaryRtmp)
                return this.addLiveConfig({ primaryRtmp: primaryRtmp, flavorArray: flavorArray, id: "DW-hack-asdf" });
            else
                return Promise.resolve();
        })
            .then(() => {
            return this.doRecordingAction('buildRecord');
        })
            .then(() => {
            this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
            if (this.recordingConfigObj['minimizeWhenRecordingStarts'] === true) {
                this.minimizeService.minimizeToTray(this.recordingConfigObj['minimizeRecordingDelaySec']);
            }
            return this.showCountdownBeforeStart();
        }).then(() => {
            return this.doRecordingAction('startRecord');
        })
            .then((files) => {
            this.recordingIsLoading = false;
            this.appState.recordingPhase = 'recording';
            this.log.info('recording media files created: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(files));
            this.recordingUtilsService.updateRecordingFiles(files);
            this.recordingDetailsService.setDefaultRecDetails();
            this.startRecordingTimer();
            this.actionInProgress = false;
            //clear start record error if exists
            this.appMonitoringAgentData.clearError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].ALL);
            return files;
        })
            .catch((err) => {
            this.minimizeService.cancelTrayMinimizationSubscription();
            return this.handleStartRecordingFailure(err);
        });
    }
    showCountdownBeforeStart() {
        let returnPromise;
        if (this.isRecordingScheduledEvent() && this.recordingConfigObj['scheduledCountdownBeforeStart']) {
            returnPromise = this.openCountdown();
        }
        else if (!this.isRecordingScheduledEvent() && this.recordingConfigObj['adHockCountdownBeforeStart']) {
            returnPromise = this.openCountdown();
        }
        else {
            returnPromise = Promise.resolve();
        }
        // swallow error as we don't want to fail the recording when animation fails.
        return returnPromise.catch((e) => {
            this.log.error('RecordingManagerService: Error while showing countdown animation: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(e));
        });
    }
    openCountdown() {
        return __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('start-countdown', { time: this.appConfig.getConfigData('config.captureApp.recording.countdownTime'),
            bounds: { x: window.screenX, y: window.screenY, width: window.screen.width, height: window.screen.height }
        });
    }
    handleStartRecordingFailure(err) {
        if (__WEBPACK_IMPORTED_MODULE_10_lodash__["isObject"](err) && !__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](err) && err['type'] === this.systemHealthService.SYS_HEALTH_ERROR && !__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](err['message'])) {
            this.log.error('RecordingManagerService: Failed to start recording due to system health. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.updateRecState(this.appState.REC_STATE.STABLE);
            return this.handleSysHealthRecordingFailure(err);
        }
        else {
            this.log.error('RecordingManagerService: Error while starting new recording.' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].START_RECORDING, 'NOTIFICATIONS.error_startRecording');
            return this.resetRecording()
                .catch(() => { })
                .then(() => {
                return Promise.reject(err);
            });
        }
    }
    stopRecording() {
        return this.callRecordingNextAction('pause')
            .then((res) => {
            return this.devicePreviewService.stopPreviewAll();
        })
            .catch((err) => {
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].STOP_RECORDING, 'NOTIFICATIONS.error_stopRecording');
            //no need to reload sessions and recording state in case of failure since it is being handled by the pause actions
            this.log.error(__WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    pauseRecording() {
        return this.doRecordingAction('pauseRecord')
            .then((res) => {
            this.appState.recordingPhase = 'paused';
            this.pauseRecordingTimer();
            this.log.info('Paused recording. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(res));
            this.actionInProgress = false;
            this.appMonitoringAgentData.clearError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].ALL);
            return res;
        })
            .catch((err) => {
            this.log.error('Failed to pause recording. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].PAUSE_RECORDING, 'NOTIFICATIONS.error_pauseRecording');
            this.actionInProgress = false;
            //reloading sessions and recording state
            return this.shutDownAndReInitSessions()
                .catch(() => { })
                .then(() => {
                return Promise.reject(err);
            });
        });
    }
    resumeRecording() {
        this.log.info('resumeRecording()');
        this.recordingIsLoading = true;
        return this.appState.areSessionsReadyForRecording('resumeRecording()')
            .then(() => {
            return this.canStartOrResumeRecording();
        })
            .then(() => {
            this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
            return this.doRecordingAction('startRecord');
        })
            .then((res) => {
            this.recordingIsLoading = false;
            this.appState.recordingPhase = 'recording';
            this.startRecordingTimer();
            this.log.info('Resume recording. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(res));
            this.actionInProgress = false;
            if (this.recordingConfigObj['minimizeWhenRecordingStarts'] === true) {
                this.minimizeService.minimizeToTray(this.recordingConfigObj['minimizeRecordingDelaySec']);
            }
            this.appMonitoringAgentData.clearError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].ALL);
            return res;
        })
            .catch((err) => {
            return this.handleResumeRecordingFailure(err);
        });
    }
    handleResumeRecordingFailure(err) {
        if (__WEBPACK_IMPORTED_MODULE_10_lodash__["isObject"](err) && !__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](err) && err['type'] === this.systemHealthService.SYS_HEALTH_ERROR && !__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](err['message'])) {
            this.log.error('RecordingManagerService: Failed to resume recording due to system health. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            return this.handleSysHealthRecordingFailure(err);
        }
        else {
            this.log.error('RecordingManagerService: Error while resuming recording. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].RESUME_RECORDING, 'NOTIFICATIONS.error_resumeRecording');
            //reloading sessions and recording state
            this.recordingIsLoading = false;
            return this.shutDownAndReInitSessions()
                .catch(() => { })
                .then(() => {
                return Promise.reject(err);
            });
        }
    }
    cancelRecording() {
        return this.appState.areSessionsReadyForRecording('cancelRecording()')
            .then(() => {
            this.liveManagerService.removeLiveConfig(); // will check if exist else will ignore
            return this.closeCanceledRecording();
        })
            .then(([filesToDelete]) => {
            this.recordingUtilsService.removeRecordedFiles(filesToDelete); //the outcome is written to log in case of failure
            this.appMonitoringAgentData.clearError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].ALL);
            return Promise.resolve();
        })
            .catch((err) => {
            this.log.error('Failed to cancel recording. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].RECORDING_ERROR, __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].CANCEL_RECORDING, 'NOTIFICATIONS.error_cancel');
            return this.resetRecording()
                .catch(() => { })
                .then(() => {
                return Promise.reject(err);
            });
        });
    }
    /**
     * on successful execution will return a list of files for deletion in the first index of the returned array
     * (the second index will returned empty)
     */
    closeCanceledRecording() {
        this.log.info('closeCanceledRecording');
        let filesToDelete = null;
        return this.doRecordingAction('cancelRecord')
            .then((filesObj) => {
            //if current event exists, cancel of a scheduled event was triggered by the user (need to handle it)
            if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](this.schedulingService.getCurrentEvent())) {
                this.schedulingService.closeEventBeforeEndTime();
            }
            return this.recordingUtilsService.getRecordingFilesForDeletion(filesObj);
        })
            .then((filesForDeletion) => {
            return Promise.all([Promise.resolve(filesForDeletion), this.resetRecording()]);
        })
            .catch((err) => {
            this.log.error('Failed to close recording. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    closeFinishedRecording(closeEvent) {
        this.log.info('closeFinishedRecording(' + closeEvent + ')');
        return this.getFinishedRecordingClosePromise()
            .then(() => {
            //if current event exists, stop of a scheduled event was triggered by the user (need to handle it)
            if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](this.schedulingService.getCurrentEvent()) && closeEvent) {
                this.schedulingService.closeEventBeforeEndTime();
            }
            this.updateRecState(this.appState.REC_STATE.STABLE);
            return Promise.resolve();
        })
            .catch((err) => {
            this.log.error('Failed to stop recording. checking if need to close current scheduled event (' + closeEvent + ')');
            if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](this.schedulingService.getCurrentEvent()) && closeEvent) {
                this.schedulingService.closeEventBeforeEndTime();
            }
            return this.shutDownAndReInitSessions()
                .catch(() => { })
                .then(() => {
                return Promise.reject(err);
            });
        });
    }
    //returns the relevant close record promise - 'stopRecord' or 'recoverMp4' when disconnected
    getFinishedRecordingClosePromise() {
        if (!this.isRecordDisconnected()) {
            this.log.info('stopping finished recording - stopRecord');
            return this.doRecordingAction('stopRecord');
        }
        else {
            if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](this.recordingDetailsService.getRecordingDetails()['files'])) {
                this.log.info('stopping finished recording - finalizeRecordingFileOffCycle');
                return this.appState.shutDownSessions(this.appState.SESSION_LOAD_WAIT_STATE.NEXT_TIME)
                    .then(() => {
                    this.mouseClickIndicationService.stopMouseClickIndication();
                    return this.finalizeRecordingFileOffCycle(this.recordingDetailsService.getRecordingDetails()['files']);
                });
            }
            else {
                this.log.error('Filed to stop finished recording in disconnection state. recording details files property is empty');
                return Promise.reject('Filed to stop finished recording in disconnection state.');
            }
        }
    }
    /**
     * check if it is possible to start or resume recording
     * promise will be rejected if sys health failed and recording can't start / resume
     */
    canStartOrResumeRecording() {
        return this.systemHealthService.checkSystemHealth(false) //promise will never be rejected
            .then((sysHealth) => {
            if (__WEBPACK_IMPORTED_MODULE_10_lodash__["isObject"](sysHealth) && !__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](sysHealth) &&
                sysHealth['status'] === this.systemHealthService.HEALTH_STATUS.ERROR) {
                return Promise.reject(sysHealth);
            }
            else {
                return Promise.resolve(true);
            }
        });
    }
    handleSysHealthRecordingFailure(err) {
        this.notificationService.sendNotification(err.message, 'error');
        this.recordingIsLoading = false;
        this.actionInProgress = false;
        return false; //not rejecting the call to avoid misleading error messages
    }
    /**
     * Executes recording actions
     * @param action
     * @return {Promise<TResult>}
     */
    doRecordingAction(action) {
        let relatedSessions;
        return this.appState.areSessionsReadyForRecording(action)
            .then(() => {
            relatedSessions = this.appState.getActiveRecordableSessionsIds();
            let argsPromisesArr = [];
            __WEBPACK_IMPORTED_MODULE_10_lodash__["each"](relatedSessions, (sessionId) => {
                argsPromisesArr.push(this.getSessionActionArgs(action, sessionId));
            });
            return Promise.all(argsPromisesArr);
        })
            .then((recordingActionArgs) => {
            let preparationPromise = Promise.resolve([]);
            switch (action) {
                case 'startRecord':
                    preparationPromise = Promise.all([
                        this.slidesService.shouldCaptureSlides(),
                        this.mouseClickIndicationService.startMouseClickIndication()
                    ]);
                    break;
                case 'cancelRecord':
                    //when canceling recording, make sure to send inactive sessions as well
                    relatedSessions = relatedSessions.concat(this.appState.getInActiveRecordableSessionsIds());
                case 'stopRecord':
                    this.stopRecordingTimer();
                    preparationPromise = this.mouseClickIndicationService.stopMouseClickIndication();
                    break;
                case 'pauseRecord':
                    this.pauseRecordingTimer();
                    preparationPromise = this.mouseClickIndicationService.stopMouseClickIndication();
                    break;
            }
            return preparationPromise.then(() => {
                return recordingActionArgs;
            });
        })
            .then(recordingActionArgs => {
            this.appState.onCallStarted(action, JSON.stringify(relatedSessions));
            return __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(action + 'Some', relatedSessions, ...recordingActionArgs);
        })
            .then((res) => {
            this.appState.onCallEnded(action + ' - SUCCESS', JSON.stringify(relatedSessions));
            return res;
        })
            .catch((err) => {
            this.appState.onCallEnded(action + ' - FAILURE', JSON.stringify(relatedSessions));
            return Promise.reject(err);
        });
    }
    resetRecording() {
        this.log.info('resetRecording()');
        this.recordingIsLoading = false;
        this.appState.recordingPhase = 'initial';
        this.updateRecState(this.appState.REC_STATE.STABLE);
        return this.recordingDetailsService.resetRecordingDetails()
            .catch((err) => {
            this.log.error('Failed to reset recording details.' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
        })
            .then(() => {
            this.stopRecordingTimer();
            return this.shutDownAndReInitSessions();
        });
    }
    shutDownSessions() {
        this.log.info('shutDownSessions()');
        return this.appState.areSessionsReadyForRecording('shutDownAndReInitSessions()')
            .catch(() => {
            //shut down sessions any way...
        })
            .then(() => {
            //check if need to free app resources after recording is done
            //(there is another check in device preview service in order to know if to start device preview)
            return this.captureResourcesService.freeCaptureResources();
        })
            .then(() => {
            return this.devicePreviewService.unregisterFromAudioNotification();
        })
            .then(() => {
            this.recoveryService.resetRecoverySessions();
            return this.appState.shutDownSessions(this.appState.SESSION_LOAD_WAIT_STATE.NEXT_TIME);
        });
    }
    shutDownAndReInitSessions() {
        this.log.info('shutDownAndReInitSessions()');
        return this.shutDownSessions()
            .then(() => {
            return this.videoDeviceSettingsService.clearSessions();
        })
            .then(() => {
            this.actionInProgress = false;
            this.appState.sendInitNotification();
        })
            .catch((err) => {
            this.log.error('failed to shut down active sessions. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.actionInProgress = false;
            return Promise.reject(err);
        });
    }
    updateRecState(state) {
        return this.recordingUtilsService.updateRecState(state);
    }
    addDeviceConnectionStateListeners() {
        this.deviceConnectionStateNotification =
            this.deviceManagerService.deviceConnectionState$.subscribe(event => {
                this.log.info('RecordingManagerService: on device connection state change: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(event));
                if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](event) && event['inUse']) {
                    this.log.info('RecordingManagerService: handling inUse device connection state change');
                    this.appState.areSessionsReadyForRecording('on-device-status-change')
                        .catch(() => {
                        //we want to listen to on-device-status-change notification all the time
                    })
                        .then(() => {
                        this.log.info('RecordingManagerService: handling on-device-status-change notification for in-use device. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(event));
                        //display power change
                        if ((event['state'] !== 'disconnected' && event['state'] !== 'connected') && (event['deviceId'].toLowerCase().includes('display') || event['deviceId'].toLowerCase().includes('screen'))) {
                            this.handleDisplayPowerChange(event);
                        }
                        else {
                            this.handleDeviceConnectionStateChange(event);
                        }
                    });
                }
                else if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](event) && !event['inUse']) {
                    this.log.info('RecordingManagerService: handling not inUse device connection state change');
                    this.handleNotUsedDeviceConnectionChange(event);
                }
            });
    }
    handleDisplayPowerChange(event) {
        this.log.info('display power change event.' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(event));
        //sleep mode / alt+ctl+del
        let mustRelaunch = this.recordingConfigObj['requiresRestartAfterSleep'] && event['event'] === 'sleep';
        if (event['state'] === 'true') {
            return Promise.resolve()
                .then(() => {
                if (this.appState.isAppRecording() && this.appState.recordingPhase !== 'paused') {
                    return this.callRecordingNextAction('pause');
                }
            })
                .catch((err) => {
                this.log.error('Failed to pause recording before entering to sleep mode / log out screen');
            })
                .then(() => {
                //no more handling related to disconnected device
                this.appState.setConnectionStateChangeLock('recordingService: handleDisplayPowerChange', false);
                if (mustRelaunch) {
                    this.log.info('handleDisplayPowerChange stop all engine activity on entering sleep');
                    return this.shutDownSessions();
                }
            });
        }
        else {
            if (mustRelaunch) {
                this.log.info('handleDisplayPowerChange send relunch request due to wake from sleep');
                return __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('relaunch');
            }
            else {
                return this.callRecordingNextAction('pause')
                    .catch((err) => {
                    this.log.warn('Failed to pause recovered recording after display power change. re-init app.' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                })
                    .then(() => {
                    this.reInitAfterConnectionChange();
                });
            }
        }
    }
    handleDeviceConnectionStateChange(event) {
        this.log.debug('deviceConnectionState - change: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(event));
        //if app is not in recording state
        if (!this.appState.isAppRecording()) {
            this.log.debug('deviceConnectionState - app is not recording at the moment, shutting down and re-init sessions');
            this.shutDownAndReInitSessions();
        }
        else {
            this.log.debug('deviceConnectionState - app is in recording at the moment, pause, shut down and re-init sessions');
            this.deviceConnectionChangeDuringRecording();
        }
    }
    deviceConnectionChangeDuringRecording() {
        this.callRecordingNextAction('pause')
            .catch((err) => {
            this.log.error('Failed to pause recording after device disconnection: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
        })
            .then(() => {
            return this.reInitAfterConnectionChange();
        });
    }
    handleNotUsedDeviceConnectionChange(event) {
        //if we are not recording and a not in use device was reconnected refresh app to load the new device
        if (!this.appState.isAppRecording() && event['state'] === 'connected') {
            this.shutDownAndReInitSessions();
        }
        else {
            //no more handling related to disconnected device
            this.appState.setConnectionStateChangeLock('recordingService: handleNotUsedDeviceConnectionChange', false);
        }
    }
    reInitAfterConnectionChange() {
        this.log.info('reInitAfterConnectionChange');
        this.resetNotificationSubscriptions();
        return this.shutDownAndReInitSessions()
            .then(() => {
            this.log.info('successfuly sent sessions re-init');
            this.resetRecordingTimers();
            this.initialClassroomCaptureLoading(true);
            this.schedulingService.restartSchedulingService();
        });
    }
    /**
     * recording session state machine
     */
    callRecordingNextAction(nextAction, recover = false) {
        this.log.info('callRecordingNextAction: ' + nextAction);
        if (!this.recordingUtilsService.isProcessing() && !this.actionInProgress) {
            this.actionInProgress = true;
            switch (this.appState.recordingPhase) {
                case 'initial':
                    if (nextAction === 'pause') {
                        //application started in recovery mode
                        if (recover) {
                            this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
                            this.appState.recordingPhase = 'paused';
                        }
                        this.actionInProgress = false;
                        return Promise.resolve();
                    }
                    else {
                        //in regular flow the only action from 'initial' state is - start
                        this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
                        return this.startRecording();
                    }
                case 'recording':
                    if (nextAction === 'pause') {
                        this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
                        return this.pauseRecording();
                    }
                    else if (nextAction === 'stop') {
                        this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
                        this.actionInProgress = false; //immediately calls pause action that will set actionInProgress to true
                        return this.stopRecording();
                    }
                    break;
                case 'paused':
                    if (nextAction === 'resume') {
                        this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
                        return this.resumeRecording();
                    }
                    else if (nextAction === 'stop') {
                        this.updateRecState(this.appState.REC_STATE.IN_PROCESS);
                        this.actionInProgress = false; //immediately calls pause action that will set actionInProgress to true
                        return this.stopRecording();
                    }
                    else if (nextAction === 'cancel') {
                        return this.cancelRecording();
                    }
                    else if (nextAction === 'pause') {
                        this.actionInProgress = false;
                        return Promise.resolve();
                    }
                    break;
            }
            this.actionInProgress = false;
            return Promise.reject({ code: 'STATE_TRANSITION_INVALID',
                msg: 'Transition from: ' + this.appState.recordingPhase + ' to: ' + nextAction });
        }
        else {
            return Promise.reject({ code: 'ACTION_IN_PROGRESS', msg: 'Action still in progress: ' + this.appState.recordingPhase });
        }
    }
    resetNotificationSubscriptions() {
        this.log.info('resetNotificationSubscriptions()');
        if (this.scheduledEventUpdateNotification) {
            this.scheduledEventUpdateNotification.unsubscribe();
            this.scheduledEventUpdateNotification = null;
        }
    }
    /**
     * recording timer
     */
    resetRecordingTimers() {
        this.recordingTotalDuration = 0;
        this.recordingCurrentSessionDuration = 0;
    }
    startRecordingTimer() {
        let isScheduledEvent = this.isRecordingScheduledEvent();
        let start = new Date().getTime();
        this.recordingTimerSub = this.recordingTimer.subscribe(t => {
            let now = new Date().getTime();
            if (isScheduledEvent) {
                let endTime = this.schedulingService.getCurrentEvent()['endDate'];
                let remainingTime = endTime - (now / 1000);
                this.recordingCurrentSessionDuration = remainingTime < 0 ? 0 : remainingTime;
            }
            else {
                this.recordingCurrentSessionDuration = (now - start) / 1000;
            }
            this.updateRecordingTimePersistentData();
        });
    }
    pauseRecordingTimer() {
        if (this.recordingTimerSub) {
            this.recordingTimerSub.unsubscribe();
            this.recordingTimerSub = null;
        }
        if (!this.isRecordingScheduledEvent()) {
            this.recordingTotalDuration += this.recordingCurrentSessionDuration;
            this.recordingCurrentSessionDuration = 0;
        }
    }
    stopRecordingTimer() {
        if (this.recordingTimerSub) {
            this.recordingTimerSub.unsubscribe();
            this.recordingTimerSub = null;
        }
        this.recordingCurrentSessionDuration = 0;
        this.recordingTotalDuration = 0;
        this.persistencyService.set('recording.recordingTime', 0);
    }
    getRecordingTime() {
        let recTime = this.recordingTotalDuration + this.recordingCurrentSessionDuration;
        return recTime;
    }
    //in case the app is being loaded in recovery mode (after crash in the middle of a recording session)
    setPrevRecordingTime(time) {
        //set total time only for ad-hoc recordings
        if (!this.isRecordingScheduledEvent()) {
            this.recordingTotalDuration += time;
        }
    }
    updateRecordingTimePersistentData() {
        this.persistencyService.set('recording.recordingTime', this.recordingTotalDuration + this.recordingCurrentSessionDuration);
    }
    /**
     * helper functions
     */
    getRecordingPhase() {
        return this.appState.recordingPhase;
    }
    isRecordEnabled() {
        return this.appState.getActiveRecordableSessionsIds().length > 0 && !this.isRecordDisconnected();
    }
    isRecordDisconnected() {
        return this.recoveryService.getRecoveryFailureReason() === this.recoveryService.getRecoveryDisconnectionState();
    }
    isRecIsLoading() {
        return this.appState.getLoadingSessionsCount() > 0;
    }
    isRecordingScheduledEvent() {
        return this.recordingDetailsService.getRecordingDetails()['eventId'];
    }
    /**
     * Scheduled events management
     */
    extendScheduledEvent() {
        this.schedulingService.extendCurrentEvent();
    }
    startSchedulingManagement() {
        this.schedulingService.onReady
            .then(() => {
            return this.handleInitialSchedulingState();
        })
            .then(() => {
            //subscribing for scheduled event metadata updates
            this.subscribeToScheduledEventMetadataUpdates();
            //waiting for scheduling initialization phase will be over
            this.manageScheduledEventsRecording();
        })
            .catch((err) => {
            this.log.error('RecordingManagerService: Failed to start scheduling management. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    /**
     * check initial scheduling state,
     * handle in progress event loaded from persistent data -> check if need to auto resume it
     * if need to end loaded event - the regular pulling flow will handle it
     */
    handleInitialSchedulingState() {
        this.log.info('RecordingManagerService: handleInitialSchedulingState()');
        //check if should start in progress event
        let autoResume = this.schedulingService.queryForScheduledEventAction(this.schedulingService.ACTION_QUERY.SHOULD_RESUME_INPROGRESS);
        if (this.isScheduledEventQueryResponseValid(autoResume)) {
            this.log.info('RecordingManagerService: Scheduled event need to be recovered: ' + autoResume['eventId']);
            //handle auto resume of scheduled event
            return this.recoveryService.canRecoverRecordingSession()
                .then((canRecover) => {
                if (canRecover) {
                    this.log.info('RecordingManagerService: Scheduled event can be recovered. Resuming event: ' + autoResume['eventId']);
                    return this.callRecordingNextAction('resume');
                }
                else {
                    this.log.error('RecordingManagerService: Scheduled event can\'t be recovered. closing event: ' + autoResume['eventId']);
                    return Promise.reject('scheduled event could not be resumed due to failed recovery process');
                }
            })
                .then(() => {
                this.log.info('RecordingManagerService: Scheduled event was recovered and resumed successfully: ' + autoResume['eventId']);
                autoResume['cb'](this.schedulingService.ACTION_STATUS.SUCCESS);
            })
                .catch((err) => {
                this.log.error('RecordingManagerService: Failed to resume scheduling event after resuming application. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                autoResume['cb'](this.schedulingService.ACTION_STATUS.FAILURE); //not closing scheduled event, we probably in disconnection mode
            });
        }
        else {
            return Promise.resolve(true);
        }
    }
    subscribeToScheduledEventMetadataUpdates() {
        this.log.info('RecordingManagerService: subscribeToScheduledEventMetadataUpdates()');
        this.scheduledEventUpdateNotification = this.schedulingService.eventUpdated$.subscribe(currentEvent => {
            let recordingDetails = this.recordingDetailsService.getRecordingDetails();
            if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](recordingDetails) && currentEvent['id'] && recordingDetails['eventId'] === currentEvent['id']) {
                this.log.info('Scheduled event metadata was changed, updating recording details for event: ' + currentEvent['id']);
                this.setScheduledEventRecordingDetails(currentEvent);
            }
        });
    }
    /**
     * check for scheduled event actions that need to be executed
     * End current scheduled event
     * Terminate current ad-hoc recording
     * Start next scheduled event
     * --- the order of there checks is crucial ---
     */
    manageScheduledEventsRecording() {
        this.log.info('RecordingManagerService: manageScheduledEventsRecording()');
        __WEBPACK_IMPORTED_MODULE_7_rxjs__["Observable"].timer(0, 1000)
            .subscribe(() => {
            this.shouldEnableEventExtension = this.schedulingService.shouldEnableEventExtension();
            if (this.schedulingService.canStartNewScheduledEventQueryProcess()) {
                this.executeNextSchedulingServiceQuery();
            }
            else {
                this.log.debug('RecordingManagerService: current scheduled event query is in progress, not querying for next task');
            }
        });
    }
    /**
     * check if should end current scheduled event
     * check if should terminate current ad-hoc recording
     * check if should start next scheduled event
     */
    executeNextSchedulingServiceQuery() {
        //first check for end scheduled event
        let endQueryRes = this.queryForEndScheduledEvent();
        if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](endQueryRes)) {
            this.executeScheduledEventEndQuery(endQueryRes);
        }
        else {
            //if there is no end event task check for ad-hoc termination
            let terminateQueryRes = this.queryForTerminateAdHocRecording();
            if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](terminateQueryRes)) {
                this.executeAdHocRecordingTerminateQuery(terminateQueryRes);
            }
            else {
                //if there is no need for end event or ad-hoc recording termination check for event start
                //check only if there are active recordable sessions
                if (this.appState.getActiveRecordableSessionsIds().length > 0) {
                    let startQueryRes = this.queryForStartScheduledEvent();
                    if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](startQueryRes)) {
                        this.executeScheduledEventStartQuery(startQueryRes);
                    }
                }
                else {
                    if (!this.skipScheduledEventStartLog) {
                        this.skipScheduledEventStartLog = true;
                        this.log.info('Skipped Scheduled event start query since there are no active recordable sessions');
                    }
                }
            }
        }
    }
    queryForEndScheduledEvent() {
        return this.schedulingService.queryForScheduledEventAction(this.schedulingService.ACTION_QUERY.SHOULD_END);
    }
    /**
     * ending recording for a scheduled event
     * if regular closing of an event will fail, trying to close recording using recoverMp4 flow.
     * since this is a scheduled event and there is no user interaction involved, we need to make sure the recording
     * will be closed no matter what. The process will fail only if both attempts will fail.
     */
    executeScheduledEventEndQuery(queryRes) {
        this.log.info('RecordingManagerService: executeScheduledEventEndQuery()');
        this.skipScheduledEventStartLog = false;
        if (this.isScheduledEventQueryResponseValid(queryRes)) {
            //making sure the the event we will end is the current recorded scheduled event
            if (this.recordingDetailsService.getRecordingDetails()['eventId'] &&
                queryRes['eventId'] === this.recordingDetailsService.getRecordingDetails()['eventId']) {
                this.log.info('RecordingManagerService: Executing scheduled event end query for event: ' + queryRes['eventId']);
                this.finalizeCurrentRecording(false)
                    .then(() => {
                    this.log.info('RecordingManagerService: successfully ended scheduled event: ' + queryRes['eventId']);
                    queryRes['cb'](this.schedulingService.ACTION_STATUS.SUCCESS);
                })
                    .catch((err) => {
                    this.log.error('RecordingManagerService: Failed to end scheduled event: ' +
                        queryRes['eventId'] + '. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                    queryRes['cb'](this.schedulingService.ACTION_STATUS.FAILURE);
                });
            }
            else {
                queryRes['cb'](this.schedulingService.ACTION_STATUS.NOT_NEEDED);
            }
        }
    }
    queryForTerminateAdHocRecording() {
        return this.schedulingService.queryForScheduledEventAction(this.schedulingService.ACTION_QUERY.SHOULD_TERMINATE);
    }
    executeAdHocRecordingTerminateQuery(queryRes) {
        this.log.info('RecordingManagerService: executeAdHocRecordingTerminateQuery()');
        this.skipScheduledEventStartLog = false;
        if (this.isScheduledEventQueryResponseValid(queryRes)) {
            if (!this.isRecordingScheduledEvent()) {
                this.log.info('RecordingManagerService: Executing ad hoc recording termination query before event: ' + queryRes['eventId']);
                //making sure current recording is not a scheduled recording (if there is no eventId in recording details object)
                this.finalizeCurrentRecording(false)
                    .then((res) => {
                    if (!res || res !== 'INITIAL_STATE') {
                        this.log.info('RecordingManagerService: Successfully terminated ad hoc recording before event: ' + queryRes['eventId']);
                        this.focusOnRecording.next(queryRes['eventId']);
                        this.notificationService.sendNotification("NOTIFICATIONS.rec_terminated", 'success');
                        queryRes['cb'](this.schedulingService.ACTION_STATUS.SUCCESS);
                    }
                    else {
                        this.log.info('RecordingManagerService: There is no need for a ad hoc recording termination before event: ' + queryRes['eventId']);
                        queryRes['cb'](this.schedulingService.ACTION_STATUS.NOT_NEEDED);
                    }
                })
                    .catch((err) => {
                    this.log.error('RecordingManagerService: Failed to terminated ad hoc recording before event: ' +
                        queryRes['eventId'] + '. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                    queryRes['cb'](this.schedulingService.ACTION_STATUS.FAILURE);
                });
            }
            else {
                queryRes['cb'](this.schedulingService.ACTION_STATUS.NOT_NEEDED);
            }
        }
    }
    queryForStartScheduledEvent() {
        return this.schedulingService.queryForScheduledEventAction(this.schedulingService.ACTION_QUERY.SHOULD_START);
    }
    executeScheduledEventStartQuery(queryRes) {
        this.log.info('RecordingManagerService: executeScheduledEventStartQuery()');
        this.skipScheduledEventStartLog = false;
        if (this.isScheduledEventQueryResponseValid(queryRes)) {
            this.prepareForScheduledEventStart(queryRes['eventId'])
                .then((res) => {
                this.focusOnRecording.next(queryRes['eventId']);
                //start event
                return this.startScheduledEvent(queryRes['eventId']);
            })
                .then(() => {
                queryRes['cb'](this.schedulingService.ACTION_STATUS.SUCCESS);
            })
                .catch((err) => {
                this.log.error('Failed to prepare and start scheduled event: ' + queryRes['eventId'] + '. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                queryRes['cb'](this.schedulingService.ACTION_STATUS.FAILURE);
                this.notificationService.sendNotification('NOTIFICATIONS.error_startRecording', 'error'); //todo think of a better notification since we will attempt to start this recording again in next tick
            });
        }
    }
    prepareForScheduledEventStart(eventId) {
        this.log.info('RecordingManagerService: prepareForScheduledEventStart()');
        this.log.info('RecordingManagerService: Checking if need to finalize recording before next scheduled event will start: ' + eventId);
        //waiting for all relevant sessions to be ready
        return this.appState.areSessionsReadyForRecording('executeScheduledEventStartQuery()')
            .catch(() => {
            //we would like to begin scheduled event start process regardless of the sessions state
            this.log.warn('RecordingManagerService: PrepareForScheduledEventStart - not all sessions are in a ready state, continue scheduling start process');
        })
            .then(() => {
            //navigate to recording page if user are currently in a different page (f.e. scheduling tab)
            //finalizing current recording again to support a case where the user starts a new recording right before the sched. event
            return Promise.all([this.finalizeCurrentRecording(false), this.navigateToRecordingPage()]);
        })
            .catch(() => {
            //ignoring promise rejection since even in failed finalization, the recording is being reset
            this.log.warn('RecordingManagerService: prepareForScheduledEventStart - ignoring failed recording closing process.');
        });
    }
    startScheduledEvent(eventId) {
        this.log.info('RecordingManagerService: startScheduledEvent()');
        return this.appState.areSessionsReadyForRecording('executeScheduledEventStartQuery()')
            .then(() => {
            this.log.info('Fetching current scheduled event metadata. ' + eventId);
            let eventMetaData = this.schedulingService.getScheduledEventObject(eventId);
            //set recording details and flag it as ready only
            this.setScheduledEventRecordingDetails(eventMetaData);
            return this.addLiveConfig(eventMetaData);
        })
            .then(() => {
            //staring new event recording
            this.log.info('calling record start for current scheduled event: ' + eventId);
            return this.callRecordingNextAction('start');
        });
    }
    isScheduledEventQueryResponseValid(queryRes) {
        if (!__WEBPACK_IMPORTED_MODULE_10_lodash__["isEmpty"](queryRes) && queryRes.hasOwnProperty('cb') && queryRes.hasOwnProperty('eventId')) {
            return true;
        }
        else {
            this.log.error('RecordingManagerService: Can\'t execute scheduled event end query due to corrupted query response. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(queryRes));
        }
    }
    getExtendEventTimeInMinutes() {
        return this.schedulingService.onReady
            .then(() => {
            return this.schedulingService.getEventExtendTime() / 60;
        });
    }
    getSessionActionArgs(action, sessionId) {
        return this.recordingUtilsService.getSessionActionArgs(action, sessionId);
    }
    addLiveConfig(liveData) {
        return this.liveManagerService.addLiveConfig(liveData).then(() => {
            let name = this.liveManagerService.getStreamingSessionName();
            this.recordingDetailsService.setRecordingLiveData(name, __WEBPACK_IMPORTED_MODULE_10_lodash__["pick"](liveData, ['primaryRtmp', 'flavorArray', "id"]));
        });
    }
};
RecordingManagerService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_6__shared_services_recording_recording_details_service__["a" /* RecordingDetailsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__shared_services_recording_recording_details_service__["a" /* RecordingDetailsService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_9__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__shared_services_capture_device_device_preview_service__["a" /* DevicePreviewService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_21__shared_services_recording_recording_recovery_service__["a" /* RecordingRecoveryService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_21__shared_services_recording_recording_recovery_service__["a" /* RecordingRecoveryService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_12__scheduling_service__["a" /* SchedulingService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_12__scheduling_service__["a" /* SchedulingService */]) === "function" && _h || Object, typeof (_j = typeof __WEBPACK_IMPORTED_MODULE_13__shared_services_capture_device_device_connection_service__["a" /* DeviceConnectionService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_13__shared_services_capture_device_device_connection_service__["a" /* DeviceConnectionService */]) === "function" && _j || Object, typeof (_k = typeof __WEBPACK_IMPORTED_MODULE_1__angular_router__["Router"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__angular_router__["Router"]) === "function" && _k || Object, typeof (_l = typeof __WEBPACK_IMPORTED_MODULE_15__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_15__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _l || Object, typeof (_m = typeof __WEBPACK_IMPORTED_MODULE_14__shared_services_infra_system_health_service__["a" /* SystemHealthService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_14__shared_services_infra_system_health_service__["a" /* SystemHealthService */]) === "function" && _m || Object, typeof (_o = typeof __WEBPACK_IMPORTED_MODULE_16__shared_services_capture_device_device_resources_service__["a" /* DeviceResourcesService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_16__shared_services_capture_device_device_resources_service__["a" /* DeviceResourcesService */]) === "function" && _o || Object, typeof (_p = typeof __WEBPACK_IMPORTED_MODULE_17__utils_minimize_service__["a" /* MinimizeService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_17__utils_minimize_service__["a" /* MinimizeService */]) === "function" && _p || Object, typeof (_q = typeof __WEBPACK_IMPORTED_MODULE_18__shared_services_recording_slides_service__["a" /* SlideService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_18__shared_services_recording_slides_service__["a" /* SlideService */]) === "function" && _q || Object, typeof (_r = typeof __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["a" /* AppMonitoringAgentErrorDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_19__shared_services_monitoring_app_monitoring_agent_error_data_service__["a" /* AppMonitoringAgentErrorDataService */]) === "function" && _r || Object, typeof (_s = typeof __WEBPACK_IMPORTED_MODULE_23__shared_services_capture_device_video_device_service__["a" /* VideoDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_23__shared_services_capture_device_video_device_service__["a" /* VideoDeviceService */]) === "function" && _s || Object, typeof (_t = typeof __WEBPACK_IMPORTED_MODULE_20__shared_services_capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_20__shared_services_capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */]) === "function" && _t || Object, typeof (_u = typeof __WEBPACK_IMPORTED_MODULE_22__shared_services_capture_device_audio_device_settings_service__["a" /* AudioDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_22__shared_services_capture_device_audio_device_settings_service__["a" /* AudioDeviceSettingsService */]) === "function" && _u || Object, typeof (_v = typeof __WEBPACK_IMPORTED_MODULE_24__shared_services_recording_mouse_click_indication_service__["a" /* MouseClickIndicationService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_24__shared_services_recording_mouse_click_indication_service__["a" /* MouseClickIndicationService */]) === "function" && _v || Object, typeof (_w = typeof __WEBPACK_IMPORTED_MODULE_25__shared_services_recording_recording_utils_service__["a" /* RecordingUtilsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_25__shared_services_recording_recording_utils_service__["a" /* RecordingUtilsService */]) === "function" && _w || Object, typeof (_x = typeof __WEBPACK_IMPORTED_MODULE_26__shared_services_live_live_manager_service__["a" /* LiveManagerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_26__shared_services_live_live_manager_service__["a" /* LiveManagerService */]) === "function" && _x || Object])
], RecordingManagerService);

var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/recording-manager.service.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/services/scheduling.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_kaltura_api_service__ = __webpack_require__("../../../../../src/shared/services/infra/kaltura-api.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_moment__ = __webpack_require__("../../../../moment/moment.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_moment___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_moment__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__shared_services_resource_id_resource_id_service__ = __webpack_require__("../../../../../src/shared/services/resource-id/resource-id.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__shared_services_monitoring_app_monitoring_agent_service__ = __webpack_require__("../../../../../src/shared/services/monitoring/app-monitoring-agent.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__shared_services_live_live_manager_service__ = __webpack_require__("../../../../../src/shared/services/live/live-manager.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SchedulingService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};














let SchedulingService = SchedulingService_1 = class SchedulingService {
    constructor(log, apiService, appConfig, resourceIdService, appNotificationService, persistentData, appMonitoringAgent, liveManagerService) {
        this.log = log;
        this.apiService = apiService;
        this.appConfig = appConfig;
        this.resourceIdService = resourceIdService;
        this.appNotificationService = appNotificationService;
        this.persistentData = persistentData;
        this.appMonitoringAgent = appMonitoringAgent;
        this.liveManagerService = liveManagerService;
        this.ACTION_QUERY = {
            SHOULD_START: 'start',
            SHOULD_END: 'end',
            SHOULD_TERMINATE: 'terminate',
            SHOULD_RESUME_INPROGRESS: 'resume_inprogress',
            NONE: 'none'
        };
        this.ACTION_STATUS = {
            SUCCESS: 'success',
            FAILURE: 'failure',
            NOT_NEEDED: 'not-needed',
            UNKNOWN: 'unknown'
        };
        /**
         * indicates if Scheduling service is ready to use
         * @type {any}
         */
        this.onReady = null;
        /**
         * indicates if scheduled event call is currently in progress.
         * callback for certain event was yet to return and handle
         * @type {boolean}
         */
        this.schedulingEventInProgressCall = this.ACTION_QUERY.NONE;
        /**
         * event id for last terminated ad-hoc recording process
         * need to save this id so we won't handle ad-hoc recordig in each query interval
         * @type {string}
         */
        this.lastHandledEventIdForTermination = '';
        //is module enabled
        this.isSchedulingEnabled = false;
        //current custom scheduled event. will hold the actual start and end time (saved in app persistent data) and metadata
        this.currentEvent = {};
        // scheduled event param object (as in api response)
        this.nextEvent = {};
        //scheduled events Mapped by day and sorted by start time and creation time
        this.schedulingEventsMap = {};
        //scheduling event fetch interval observable
        this.schedulingInterval$ = null;
        /**
         * triggered when need to terminate current recording
         */
        this.eventUpdated = new __WEBPACK_IMPORTED_MODULE_2_rxjs__["BehaviorSubject"]('');
        this.eventUpdated$ = this.eventUpdated.asObservable();
        /**
         * Id's of event on which we had notifications for.
         */
        this.nextEventNotificationEventId = null;
        this.eventEndNotificationEventId = null;
        this.eventStatusMap = {};
        this.onReady = this.start();
    }
    /**
     * Start sampling the server for scheduled events
     */
    start() {
        return Promise.all([
            this.persistentData.get("recording.scheduling"),
            this.resourceIdService.ready()
        ])
            .then(([recordingData, resourceIdServiceReady]) => {
            if (resourceIdServiceReady === true) {
                let schedulingConfig = this.appConfig.getConfigData('config.captureApp.scheduling');
                if (schedulingConfig && schedulingConfig['enabled']) {
                    this.initSchedulingService(recordingData);
                    this.startFetchInterval();
                }
            }
            else {
                //todo
                this.appNotificationService.sendNotification('SCHEDULING.forced_disabled', 'error');
            }
        })
            .catch((err) => {
            // TODO: send notification in case of reject - will happen when config file does not exist
            return Promise.reject(err);
        });
    }
    initSchedulingService(schedulingData) {
        this.log.info('SchedulingService: init scheduling service');
        this.isSchedulingEnabled = true;
        let intervalSec = this.appConfig.getConfigData('config.captureApp.scheduling.intervalSec');
        if (schedulingData) {
            this.excludedEventsIdSet = __WEBPACK_IMPORTED_MODULE_6_lodash__["isArray"](schedulingData.excludedEventsIdSet) ? new Set(schedulingData.excludedEventsIdSet) : new Set();
            if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](schedulingData.scheduledEvent)) {
                this.setCurrentEvent(schedulingData.scheduledEvent);
            }
        }
        else {
            this.excludedEventsIdSet = new Set();
        }
        //set scheduling interval
        this.schedulingInterval$ = __WEBPACK_IMPORTED_MODULE_2_rxjs__["Observable"].timer(0, intervalSec * 1000);
        // checking status every 1 sec for showing notifications when needed
        __WEBPACK_IMPORTED_MODULE_2_rxjs__["Observable"].timer(0, 1000)
            .subscribe(() => {
            this.showCurrentEventEndNotification();
            this.prepareNextEvent();
        });
    }
    prepareNextEvent() {
        if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.nextEvent)) {
            let countdownInSec = this.appConfig.getConfigData('config.captureApp.scheduling.countdownInSec');
            let timeToShowNextEventNotification = (this.getNextEventRealStartTime() - countdownInSec) * 1000;
            let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf();
            if (this.nextEventNotificationEventId !== this.nextEvent.id && timeToShowNextEventNotification <= now && now <= this.getNextEventRealStartTime() * 1000) {
                let isLiveEvent = this.isLiveScheduledEvent(this.nextEvent);
                this.showNextEventNotification(isLiveEvent);
                if (isLiveEvent) {
                    this.setRedirectAsNull(this.nextEvent.templateEntryId);
                }
                // show it only once
                this.nextEventNotificationEventId = this.nextEvent.id;
            }
        }
    }
    showNextEventNotification(isLive) {
        let msg = isLive ? 'SCHEDULING.next_live_event_notification' : 'SCHEDULING.next_event_notification';
        this.appNotificationService.sendNotificationWithParams(msg, { event_name: this.nextEvent.summary, time_in_minutes: this.getTimeToNextEventInMinutes() }, 'success');
    }
    setRedirectAsNull(liveEntryId) {
        // when live stream is about to start we want to set the RedirectEntryId of the live entry as null
        // so new viewer won't redirect to the last record couple of minutes before the live starts
        return this.apiService.updateRedirectEntryId(liveEntryId, '').toPromise().then((res) => {
            this.log.info("Updated redirect entry id to null");
            return res;
        }).catch((err) => {
            this.log.warn("Failed to update redirect entry id as null: " + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    /**
     * since user can extend current event end time,
     * next event start time can be the later between next.startDate or current.endDate
     */
    getNextEventRealStartTime() {
        return this.currentEvent && this.currentEvent.endDate > this.nextEvent.startDate ?
            this.currentEvent.endDate : this.nextEvent.startDate;
    }
    showCurrentEventEndNotification() {
        if (this.eventEndNotificationEventId !== this.currentEvent.id && this.isTimeForEndEventNotifications()) {
            this.appNotificationService.sendNotificationWithParams('SCHEDULING.end_event_notification', { event_name: this.currentEvent['summary'], time_in_minutes: this.getTimeToEventEndInMinutes() }, 'success');
            // show it only once
            this.eventEndNotificationEventId = this.currentEvent.id;
        }
    }
    isTimeForEndEventNotifications() {
        if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent)) {
            let eventEndNotificationInSec = this.appConfig.getConfigData('config.captureApp.scheduling.eventEndNotificationInSec');
            let timeBeforeEventEndNotificationInMs = (this.currentEvent.endDate - eventEndNotificationInSec) * 1000;
            if (timeBeforeEventEndNotificationInMs <= __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf()) {
                return true;
            }
        }
        return false;
    }
    shouldEnableEventExtension() {
        if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent)) {
            let displayExtendEventInSec = this.appConfig.getConfigData('config.captureApp.scheduling.displayExtendEventInSec');
            let timeToEnableEventExtension = (this.currentEvent.endDate - displayExtendEventInSec) * 1000;
            if (timeToEnableEventExtension <= __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf()) {
                return true;
            }
        }
        return false;
    }
    getEventExtendTime() {
        return this.appConfig.getConfigData('config.captureApp.scheduling.extendEventInSec');
    }
    /**
     * starts scheduled events fetching process in a fix interval
     */
    startFetchInterval() {
        this.schedulingIntervalSubscription = this.schedulingInterval$.subscribe(() => {
            this.fetchScheduledEvents().then((data) => {
                this.log.info('SchedulingService: get scheduling events from server (at interval time)');
                this.handledFetchedScheduledEvents(data);
                if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent)) {
                    this.updateCurrentEventAttributes(this.getCurrentEventObject());
                }
            }, (err) => {
                this.log.warn('SchedulingService: Failed to load scheduling events from server, using offline scheduling data. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
                this.getScheduledEventsOffline()
                    .then((data) => {
                    this.handledFetchedScheduledEvents(data);
                })
                    .catch((err) => {
                    this.log.error('SchedulingService: Failed to get offline scheduled event data. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
                });
            });
        });
    }
    handledFetchedScheduledEvents(data) {
        this.setScheduledEventForOfflineUsage(data);
        this.mapScheduleEventsByStartDateAndEndDate(data);
        this.setNextScheduledEvent();
        this.mapEventStatuses(data);
    }
    /**
     * Map the event by day and handle 2-days event
     * @param ScheduleEvents
     */
    mapScheduleEventsByStartDateAndEndDate(data) {
        this.schedulingEventsMap = {};
        __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](data, event => {
            let start = __WEBPACK_IMPORTED_MODULE_4_moment__(event['startDate'] * 1000).startOf('day');
            let startDateStr = start.format();
            let end = __WEBPACK_IMPORTED_MODULE_4_moment__(event['endDate'] * 1000).startOf('day');
            let endDateStr = end.format();
            if (!this.schedulingEventsMap[startDateStr]) {
                this.schedulingEventsMap[startDateStr] = [];
            }
            this.schedulingEventsMap[startDateStr].push(event);
            // if there is more than 1 day diff between start to end then add this event also
            // to the day it ends (2-days event).
            if (end.diff(start, 'days', true) > 0) {
                if (!this.schedulingEventsMap[endDateStr]) {
                    this.schedulingEventsMap[endDateStr] = [];
                }
                this.schedulingEventsMap[endDateStr].push(event);
            }
        });
    }
    /**
     * Map event-id with it's status: COMPLETED, RECORDING, FUTURE_EVENT
     * Scheduling list will now get the event status in O(1)
     * @param data
     */
    mapEventStatuses(data) {
        this.eventStatusMap = {};
        let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf();
        __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](data, event => {
            // is event at recording now
            if (this.currentEvent ? (this.currentEvent['id'] === event['id']) : false) {
                this.eventStatusMap[event['id']] = SchedulingService_1.EVENT_STATUS.RECORDING;
            }
            else if (this.isExcludedEvent(event['id'])) {
                this.eventStatusMap[event['id']] = SchedulingService_1.EVENT_STATUS.COMPLETED;
            }
            else {
                let isTimePassed = (event.startDate * 1000) < now;
                let isBeforeTheNextEvent = this.nextEvent ? (event.startDate < this.nextEvent.startDate) : true; // important when manually starting next event with Start-Now button;
                let isItNextEvent = this.nextEvent && this.nextEvent.id === event['id'];
                let hasEnded = (isTimePassed || isBeforeTheNextEvent) && !isItNextEvent;
                if (hasEnded) {
                    this.eventStatusMap[event['id']] = SchedulingService_1.EVENT_STATUS.COMPLETED;
                }
                else {
                    this.eventStatusMap[event['id']] = SchedulingService_1.EVENT_STATUS.FUTURE_EVENT;
                }
            }
        });
    }
    /**
     * Fetches scheduled events Ordered by startDate and creation date
     * @returns {Observable<R>}
     */
    fetchScheduledEvents() {
        let start = __WEBPACK_IMPORTED_MODULE_4_moment__().set({ hour: 0, minute: 0, second: 0, millisecond: 0 });
        let viewEventsAheadDay = this.appConfig.getConfigData('config.captureApp.scheduling.viewEventsAheadDay');
        let end = start.clone().add(viewEventsAheadDay, 'days'); // ms to sec (server units)
        return this.apiService.getScheduledEvents(start.valueOf(), end.valueOf(), this.resourceIdService.resourceId)
            .toPromise().then((data) => {
            return this.enrichEventsData(data);
        });
    }
    // set all metadata
    setCurrentEvent(event) {
        if (event) {
            this.currentEvent = __WEBPACK_IMPORTED_MODULE_6_lodash__["cloneDeep"](event);
            this.currentEvent.manuallyUpdated = event.manuallyUpdated ? event.manuallyUpdated : false;
            // map the current event state at eventStatusMap
            this.eventStatusMap[this.currentEvent.id] = SchedulingService_1.EVENT_STATUS.RECORDING;
            // minimize persisted array
            this.minimizeExcludedEventsIdSet();
            // persist it
            this.persistentData.set("recording.scheduling", { scheduledEvent: this.currentEvent, excludedEventsIdSet: Array.from(this.excludedEventsIdSet) });
            this.log.info('SchedulingService: Current scheduled event: ' + this.currentEvent.id);
            this.appMonitoringAgent.setSchedulingDataCurrentEvent(this.currentEvent);
        }
    }
    /**
     * remove from persisted excludedEventsIdSet set, all excluded events that are older than the max time-window which the user could
     * start-in-advance (start-now) the events.
     */
    minimizeExcludedEventsIdSet() {
        let countdownThresholdTime = __WEBPACK_IMPORTED_MODULE_4_moment__().subtract(SchedulingService_1.MAX_COUNTDOWN_IN_SEC, 'seconds').valueOf();
        let eventsArray = this.getFlattenedScheduledEvents();
        this.excludedEventsIdSet.forEach(excludedId => {
            let ExcludedEventObj = __WEBPACK_IMPORTED_MODULE_6_lodash__["find"](eventsArray, e => e['id'] === excludedId);
            if (ExcludedEventObj && ExcludedEventObj['endDate'] * 1000 < countdownThresholdTime) {
                this.excludedEventsIdSet.delete(excludedId);
                this.eventStatusMap[excludedId] = SchedulingService_1.EVENT_STATUS.COMPLETED;
            }
            else if (!ExcludedEventObj) {
                this.excludedEventsIdSet.delete(excludedId); // delete deleted scheduled events
            }
        });
    }
    /**
     * reloading scheduling service, in case an event need to be resumed while device was disconnected
     * when the device will reconnect and all application will reload - the notifications will send a resume event
     */
    restartSchedulingService() {
        this.log.info('restartSchedulingService()');
        if (this.schedulingIntervalSubscription) {
            this.schedulingIntervalSubscription.unsubscribe();
            this.schedulingIntervalSubscription = null;
        }
        this.nextEvent = {};
        this.start();
    }
    getCurrentEventObject() {
        let id = this.currentEvent.id;
        return this.getScheduledEventObject(id);
    }
    getScheduledEventObject(id) {
        return __WEBPACK_IMPORTED_MODULE_6_lodash__["find"](this.getFlattenedScheduledEvents(), function (e) {
            return e['id'] === id;
        });
    }
    updateCurrentEventAttributes(event) {
        if (event) {
            this.log.info('SchedulingService: update current scheduled event attributes ' + this.currentEvent.id);
            let lastCurrentEvent = __WEBPACK_IMPORTED_MODULE_6_lodash__["clone"](this.currentEvent);
            this.currentEvent.summary = event.summary;
            this.currentEvent.description = event.description;
            this.currentEvent.organizer = event.organizer;
            this.currentEvent.tags = event.tags;
            if (!this.currentEvent.manuallyUpdated) {
                this.currentEvent.endDate = event.endDate;
            }
            // Save and Fire change-event if there was a change
            if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEqual"](this.currentEvent, lastCurrentEvent)) {
                this.saveCurrentEvent();
                this.eventUpdated.next(this.currentEvent);
            }
        }
    }
    /**
     * Next event is an in progress event that wasn't started or
     * the first event in scheduled events array that its' start time greater than now / last recorded event.
     */
    setNextScheduledEvent() {
        this.log.info('SchedulingService: Setting next scheduled event');
        // adding one second to avoid duplicate event registration
        // since start time is in seconds, multiple events can be set in the same period of time (date is in milliseconds)
        let now = Math.floor(new Date().getTime() / 1000) + 1;
        //check if there is an in progress event that it is not the current event and it is not excluded
        let nextInLine = __WEBPACK_IMPORTED_MODULE_6_lodash__["find"](this.getFlattenedScheduledEvents(), e => {
            return (now > e['startDate'] && now < e['endDate']) &&
                (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent) ? e['id'] !== this.currentEvent['id'] : true) &&
                !this.isExcludedEvent(e['id']);
        });
        //if there is no in progress event that was unhandled
        if (__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](nextInLine)) {
            //checking for the first event that its' start time is greater than now,
            //its' start time is only after the current event start time (in case of manually scheduled event start),
            //and it is not the current event (in case an event starts and only then the user changes its' start time),
            //and it is not in the exclude list
            nextInLine = __WEBPACK_IMPORTED_MODULE_6_lodash__["find"](this.getFlattenedScheduledEvents(), e => {
                return now < e['startDate'] &&
                    (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent) ?
                        (this.currentEvent['startDate'] < e['startDate'] && this.currentEvent['id'] !== e['id']) : true) &&
                    !this.isExcludedEvent(e['id']);
            });
        }
        //update next scheduled event
        if (!__WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].areEventsEqual(nextInLine, this.nextEvent)) {
            if (__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](nextInLine)) {
                this.log.info('SchedulingService: next scheduled event was deleted, removing it.');
                this.nextEvent = {};
            }
            else {
                this.log.info('SchedulingService: update Next scheduled event id: ' + nextInLine['id']);
                this.nextEvent = __WEBPACK_IMPORTED_MODULE_6_lodash__["clone"](nextInLine);
                this.avoidEndStartCollisions();
            }
        }
        this.appMonitoringAgent.setSchedulingDataNextEvent(this.nextEvent);
    }
    saveCurrentEvent() {
        this.persistentData.set('recording.scheduling.scheduledEvent', this.currentEvent)
            .catch((err) => {
            this.log.error('SchedulingService: Failed to save current scheduled event to persistent data. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    /**
     * In case the start date of the next event equals to current event end time - push start event date by 1 second
     */
    avoidEndStartCollisions() {
        if (this.currentEvent && this.nextEvent) {
            if (this.currentEvent.endDate === this.nextEvent.startDate) {
                this.nextEvent.startDate += 1; //adding one second to next event
            }
        }
    }
    getScheduledEventsOffline() {
        return __WEBPACK_IMPORTED_MODULE_11__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getScheduledEvents');
    }
    setScheduledEventForOfflineUsage(events) {
        return __WEBPACK_IMPORTED_MODULE_11__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('setScheduledEvents', events);
    }
    getFlattenedScheduledEvents() {
        return __WEBPACK_IMPORTED_MODULE_6_lodash__["flatten"](__WEBPACK_IMPORTED_MODULE_6_lodash__["values"](this.schedulingEventsMap));
    }
    getScheduledEventsByDay(date) {
        let startTimeOfTheXPage = date.startOf('day').format();
        return this.schedulingEventsMap[startTimeOfTheXPage];
    }
    getCurrentEvent() {
        return this.currentEvent;
    }
    resetCurrentEvent() {
        this.log.info( true ? this.currentEvent.id : ' unknown');
        this.eventStatusMap[this.currentEvent.id] = SchedulingService_1.EVENT_STATUS.COMPLETED;
        this.currentEvent = {};
        this.appMonitoringAgent.setSchedulingDataCurrentEvent({});
        return this.persistentData.set("recording.scheduling.scheduledEvent", {});
    }
    getNextEvent() {
        return this.nextEvent;
    }
    /**
     * extending current scheduled event end time
     * @return {boolean}
     */
    extendCurrentEvent() {
        if (this.currentEvent) {
            let schedulingConfigObj = this.appConfig.getConfigData('config.captureApp.scheduling');
            this.log.info('SchedulingService: Extending current scheduled event in ' + schedulingConfigObj.extendEventInSec + ' seconds');
            this.currentEvent.endDate += schedulingConfigObj.extendEventInSec;
            this.currentEvent.manuallyUpdated = true;
            this.saveCurrentEvent();
            //so the user will get notification again when needed (only if the new end time is greater the notification time)
            //f.e: extended from 8 min to 13 min when configured notification time is 10 min)
            let timeBeforeEndNotification = (this.currentEvent.endDate - schedulingConfigObj.eventEndNotificationInSec) * 1000;
            if (timeBeforeEndNotification >= __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf()) {
                this.eventEndNotificationEventId = null;
            }
            //so the user will get updated notification about next event start time
            this.nextEventNotificationEventId = null;
        }
        else {
            this.log.warn('SchedulingService: There is no current event to extend');
        }
    }
    restartSchedulingEventInterval() {
        if (this.schedulingIntervalSubscription) {
            this.schedulingIntervalSubscription.unsubscribe();
            this.schedulingIntervalSubscription = null;
            this.startFetchInterval();
        }
    }
    closeEventBeforeEndTime() {
        this.log.info('SchedulingService: handling external scheduled event stop.');
        this.eventStatusMap[this.currentEvent.id] = SchedulingService_1.EVENT_STATUS.COMPLETED;
        this.excludedEventsIdSet.add(this.currentEvent.id);
        this.persistentData.set("recording.scheduling.excludedEventsIdSet", Array.from(this.excludedEventsIdSet));
        this.resetCurrentEvent();
    }
    startRecordingNextEvent() {
        // check that there is no current event recording and next-event exists
        if (__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent) && this.nextEvent) {
            this.log.info('SchedulingService: Starting next event: ' + this.nextEvent['id'] + ' now due to user decision.');
            //add a flag to next event that will indicate that it should start now and no in its' original time
            this.nextEvent['startNow'] = true;
        }
        else {
            this.log.error('SchedulingService: Fail to start next event because current event is still recording');
        }
    }
    getTimeToNextEventInMinutes() {
        if (!this.nextEvent) {
            return '';
        }
        let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf();
        let duration = __WEBPACK_IMPORTED_MODULE_4_moment__["duration"](this.getNextEventRealStartTime() * 1000 - now);
        return Math.floor(duration.asMinutes()) + 1 + '';
    }
    getTimeToEventEndInMinutes() {
        let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf();
        let duration = __WEBPACK_IMPORTED_MODULE_4_moment__["duration"](this.currentEvent.endDate * 1000 - now);
        return Math.floor(duration.asMinutes()) + 1 + '';
    }
    getCurrentEventRemainingInMin() {
        if (this.currentEvent) {
            let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf();
            let duration = __WEBPACK_IMPORTED_MODULE_4_moment__["duration"](this.currentEvent.endDate * 1000 - now);
            return Math.floor(duration.asMinutes()) + 1;
        }
        return null;
    }
    shouldDisplayNextEventNotifications(subtractSecondsBeforeEvent = 0) {
        let schedulingConfigObj = this.appConfig.getConfigData('config.captureApp.scheduling');
        if (!this.nextEvent || !schedulingConfigObj) {
            return false;
        }
        let now = __WEBPACK_IMPORTED_MODULE_4_moment__();
        let from = __WEBPACK_IMPORTED_MODULE_4_moment__(this.getNextEventRealStartTime() * 1000).subtract(schedulingConfigObj.countdownInSec, 'seconds');
        let end = __WEBPACK_IMPORTED_MODULE_4_moment__(this.getNextEventRealStartTime() * 1000).subtract(subtractSecondsBeforeEvent, 'seconds');
        return now.isBetween(from, end);
    }
    isExcludedEvent(eventId) {
        return this.excludedEventsIdSet.has(eventId);
    }
    getEventStatus(eventId) {
        return this.eventStatusMap[eventId];
    }
    /**
     * Scheduling service management functions
     */
    queryForScheduledEventAction(query) {
        if (this.canStartNewScheduledEventQueryProcess()) {
            this.startScheduledEventQueryProcess(query);
            switch (query) {
                case this.ACTION_QUERY.SHOULD_START:
                    return this.shouldStartNextScheduledEvent();
                case this.ACTION_QUERY.SHOULD_END:
                    return this.shouldEndCurrentScheduledEvent();
                case this.ACTION_QUERY.SHOULD_TERMINATE:
                    return this.shouldTerminateAdHocRecording();
                case this.ACTION_QUERY.SHOULD_RESUME_INPROGRESS:
                    return this.shouldResumeLoadedEvent();
                default:
                    this.endScheduledEventQueryProcess(query, this.ACTION_STATUS.UNKNOWN);
                    return {};
            }
        }
        else {
            this.log.info('SchedulingService: Can\'t process requested scheduled event query: ' +
                query + '. Since current query is still in progress: ' + this.schedulingEventInProgressCall);
            return {};
        }
    }
    /**
     * During application life time (not initial load)
     * check if need to start next scheduled event
     */
    shouldStartNextScheduledEvent() {
        this.log.debug('SchedulingService: shouldStartNextScheduledEvent()');
        let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf() / 1000; //adjust time to Kaltura BE time
        //if there is no current event and there is a next event which its' startDate elapsed or has the startNow flag
        if (__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent) && !__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.nextEvent) &&
            (this.nextEvent['startNow'] || (this.nextEvent['startDate'] && this.nextEvent['startDate'] < now))) {
            return { eventId: this.nextEvent['id'], cb: this.startNextEventCallbackHandler.bind(this) };
        }
        else {
            return this.handleUnNeededQuery(this.ACTION_QUERY.SHOULD_START);
        }
    }
    startNextEventCallbackHandler(status) {
        this.log.info('SchedulingService: startNextEventCallbackHandler(' + status + ')');
        if (status === this.ACTION_STATUS.SUCCESS) {
            this.log.info('SchedulingService: successfully started next scheduled event: ' + this.nextEvent['id']);
            this.setCurrentEvent(this.nextEvent);
            this.nextEvent = null;
            this.setNextScheduledEvent();
        }
        this.endScheduledEventQueryProcess(this.ACTION_QUERY.SHOULD_START, status);
    }
    /**
     * During application life time (not initial load)
     * check if need to end current scheduled event
     */
    shouldEndCurrentScheduledEvent() {
        this.log.debug('SchedulingService: shouldEndCurrentScheduledEvent()');
        let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf() / 1000; //adjust time to Kaltura BE time
        //if there is current event and its' end time elapsed
        if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent) && this.currentEvent['endDate'] && this.currentEvent['endDate'] < now) {
            this.log.info('SchedulingService: should end current event: ' + this.currentEvent['id']);
            return { eventId: this.currentEvent['id'], cb: this.endCurrentEventCallbackHandler.bind(this) };
        }
        else {
            return this.handleUnNeededQuery(this.ACTION_QUERY.SHOULD_END);
        }
    }
    /**
     * handle current event end callBack,
     * @param status
     */
    endCurrentEventCallbackHandler(status) {
        this.log.info('SchedulingService: endCurrentEventCallbackHandler(' + status + ')');
        this.resetCurrentEvent();
        this.endScheduledEventQueryProcess(this.ACTION_QUERY.SHOULD_END, status);
    }
    /**
     * check if need to terminate running ad hoc recording before scheduled event starts
     */
    shouldTerminateAdHocRecording() {
        this.log.debug('SchedulingService: shouldTerminateAdHocRecording()');
        //if next event start time is less then termination time, and current terminated event id is not euqal to nextEvent.id
        if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.nextEvent) && this.nextEvent['id'] !== this.lastHandledEventIdForTermination) {
            let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf() / 1000; //adjust time to Kaltura BE time
            let recTerminationInSec = this.appConfig.getConfigData('config.captureApp.scheduling.recTerminationInSec');
            let terminationTime = this.nextEvent.startDate - recTerminationInSec;
            if (terminationTime < now) {
                return { eventId: this.nextEvent['id'], cb: this.terminateAdHocRecordingCallbackHandler.bind(this) };
            }
        }
        return this.handleUnNeededQuery(this.ACTION_QUERY.SHOULD_END);
    }
    terminateAdHocRecordingCallbackHandler(status) {
        this.log.info('SchedulingService: terminateAdHocRecordingCallbackHandler(' + status + ')');
        if (status === this.ACTION_STATUS.SUCCESS || status === this.ACTION_STATUS.NOT_NEEDED) {
            this.log.info('successfully handled recording termination before event: ' + this.nextEvent['id'] + '. call response was: ' + status);
            this.lastHandledEventIdForTermination = this.nextEvent['id'];
        }
        this.endScheduledEventQueryProcess(this.ACTION_QUERY.SHOULD_TERMINATE, status);
    }
    /**
     * check if need to resume loaded scheduled event from persistent data
     * this function should be called on app loading/reloading only
     */
    shouldResumeLoadedEvent() {
        this.log.debug('SchedulingService: shouldResumeLoadedEvent()');
        let now = __WEBPACK_IMPORTED_MODULE_4_moment__().valueOf() / 1000; //adjust time to Kaltura BE time
        //if scheduled event was saved in persistent data and it wasn't ended, it should be in progress
        //need to resume recording automatically
        if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.currentEvent) && this.currentEvent['startDate'] < now && now < this.currentEvent['endDate']) {
            this.log.info('SchedulingService: Initial loading - Resume recording for event: ' + this.currentEvent['id']);
            return { eventId: this.currentEvent['id'], cb: this.resumeLoadedEventCallbackHandler.bind(this) };
        }
        else {
            return this.handleUnNeededQuery(this.ACTION_QUERY.SHOULD_RESUME_INPROGRESS);
        }
    }
    resumeLoadedEventCallbackHandler(status) {
        this.log.info('SchedulingService: resumeLoadedEventCallbackHandler(' + status + ')');
        if (status === this.ACTION_STATUS.SUCCESS) {
            this.log.info('SchedulingService: scheduled event was auto resumed by application: ' + this.currentEvent['id']);
        }
        else if (status === this.ACTION_STATUS.FAILURE) {
            this.log.info('SchedulingService: scheduled event failed to auto resume by application');
        }
        this.endScheduledEventQueryProcess(this.ACTION_QUERY.SHOULD_RESUME_INPROGRESS, status);
    }
    canStartNewScheduledEventQueryProcess() {
        return this.schedulingEventInProgressCall === this.ACTION_QUERY.NONE;
    }
    handleUnNeededQuery(query) {
        this.log.debug('SchedulingService: there is no need for scheduled event query: ' + query);
        this.endScheduledEventQueryProcess(query, this.ACTION_STATUS.NOT_NEEDED);
        return {};
    }
    startScheduledEventQueryProcess(query) {
        this.log.debug('SchedulingService: startScheduledEventQueryProcess - ' + query);
        this.schedulingEventInProgressCall = query;
    }
    endScheduledEventQueryProcess(query, status) {
        this.log.debug('SchedulingService: endScheduledEventQueryProcess - ' + query + ' with state: ' + status);
        this.schedulingEventInProgressCall = this.ACTION_QUERY.NONE;
    }
    enrichEventsData(data) {
        let promises = [];
        data.forEach(event => { promises.push(this.enrichEvent(event)); });
        return Promise.all(promises);
    }
    enrichEvent(event) {
        if (!this.isLiveEventEnabled()) {
            this.log.info("Live event is not enabled - skip enrich process");
            return Promise.resolve(event); // currently only enrich is live data
        }
        return this.apiService.getEntry(event['templateEntryId']).toPromise()
            .then((entry) => {
            if (entry["type"] != 7) {
                return event;
            }
            else {
                let flavorsIds = entry["flavorParamsIds"];
                let baseUrl = entry["primaryBroadcastingUrl"] + "/" + entry['streamName'];
                this.addAdminTags(entry);
                this.log.info("Live entry in template having baseUrl: [" + baseUrl + "] and flavors: " + flavorsIds);
                return this.apiService.getFlavors(flavorsIds).toPromise().then((flavors) => {
                    return __WEBPACK_IMPORTED_MODULE_6_lodash__["merge"](event, this.liveManagerService.getLiveData(baseUrl, flavors));
                });
            }
        }).catch((err) => {
            this.log.warn('Failed to enrich event data to ' + event.id + " with error: " + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
            return event; //  fallback to regular event without the live data
        });
    }
    isLiveEventEnabled() {
        return this.appConfig.getConfigData('config.captureApp.scheduling.liveEventsEnable');
    }
    addAdminTags(entry) {
        if (entry.hasOwnProperty('adminTags') && entry['adminTags'].includes(SchedulingService_1.KALTURA_CLASSROOM_ADMIN_TAG)) {
            return;
        }
        let newAdminTags = SchedulingService_1.KALTURA_CLASSROOM_ADMIN_TAG;
        if (entry['adminTags']) {
            newAdminTags += "," + entry['adminTags'];
        }
        return this.apiService.updateAdminTags(entry['id'], newAdminTags).toPromise().then((res) => {
            this.log.info("Updated admin tag to " + res['adminTags']);
            return res;
        }).catch((err) => {
            this.log.warn("Failed to update admin tags: " + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    isLiveScheduledEvent(event) {
        return !!event.primaryRtmp;
    }
};
// consts
SchedulingService.EVENT_STATUS = {
    COMPLETED: 'COMPLETED',
    RECORDING: 'RECORDING',
    FUTURE_EVENT: 'FUTURE_EVENT'
};
SchedulingService.MAX_COUNTDOWN_IN_SEC = 10800;
SchedulingService.KALTURA_CLASSROOM_ADMIN_TAG = "kalturaclassroom";
SchedulingService = SchedulingService_1 = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_kaltura_api_service__["a" /* KalturaApiService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__shared_services_infra_kaltura_api_service__["a" /* KalturaApiService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_9__shared_services_resource_id_resource_id_service__["a" /* ResourceIdService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__shared_services_resource_id_resource_id_service__["a" /* ResourceIdService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__shared_services_infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_12__shared_services_monitoring_app_monitoring_agent_service__["a" /* AppMonitoringAgentService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_12__shared_services_monitoring_app_monitoring_agent_service__["a" /* AppMonitoringAgentService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_13__shared_services_live_live_manager_service__["a" /* LiveManagerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_13__shared_services_live_live_manager_service__["a" /* LiveManagerService */]) === "function" && _h || Object])
], SchedulingService);

var SchedulingService_1, _a, _b, _c, _d, _e, _f, _g, _h;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/scheduling.service.js.map

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/styles/device-container.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".capture-device {\n  position: relative;\n  height: 100%;\n  width: 100%;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05); }\n\n.device-container {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.device-settings-bar {\n  height: 100%;\n  width: 100%;\n  margin: 0 !important;\n  padding: 6px; }\n\n.device-icon-button-active {\n  opacity: 1 !important; }\n\n.device-preview-button {\n  display: block;\n  text-decoration: none;\n  height: 20px;\n  width: 20px;\n  text-indent: -9999px;\n  background-size: 20px 20px;\n  margin-left: 14px;\n  margin-top: auto;\n  margin-bottom: auto; }\n\n.device-preview-button:focus {\n  opacity: 1; }\n\n.device-preview-text {\n  font-family: Lato;\n  font-size: 12px;\n  font-weight: normal;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: 1;\n  color: #ffffff;\n  margin-left: 13px;\n  margin-top: auto;\n  margin-bottom: auto; }\n\n.device-settings-button {\n  display: block;\n  text-decoration: none;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/filter.svg")) + ") no-repeat top left;\n  height: 20px;\n  width: 20px;\n  text-indent: -9999px;\n  background-size: 20px 20px;\n  opacity: 0.5;\n  margin-right: 14px;\n  margin-top: auto;\n  margin-bottom: auto; }\n\n.device-settings-button:hover {\n  opacity: 1; }\n\n.device-settings-button[disabled] {\n  opacity: 0.3; }\n\n.device-size-change-button {\n  display: block;\n  text-decoration: none;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/full-screen.svg")) + ") no-repeat top left;\n  height: 20px;\n  width: 20px;\n  text-indent: -9999px;\n  background-size: 20px 20px;\n  opacity: 0.5;\n  margin-right: 14px;\n  margin-top: auto;\n  margin-bottom: auto; }\n\n.device-size-change-button:hover {\n  opacity: 1; }\n\n.device-preview {\n  position: relative;\n  box-sizing: border-box;\n  opacity: 0.98;\n  height: 76.4%;\n  width: 100%;\n  background-color: #24212A;\n  margin-left: auto;\n  margin-right: auto; }\n\n.single-device-preview {\n  max-width: 54%; }\n\n.device-temp-preview {\n  position: absolute;\n  display: block;\n  text-decoration: none;\n  height: 40px;\n  width: 40px;\n  top: 50%;\n  margin-top: -20px;\n  left: 50%;\n  margin-left: -20px;\n  text-indent: -9999px;\n  background-size: 40px 40px !important;\n  opacity: 0.3; }\n\n.device-preview-stopped {\n  opacity: 0.7; }\n\n.device-preview-stopped:hover {\n  opacity: 1; }\n\n.device-preview-stopped[disabled] {\n  opacity: 0.5; }\n\n.device-preview-stopped:hover[disabled] {\n  opacity: 0.5; }\n\n.device-preview-in-progress {\n  opacity: 0.7; }\n\n.device-preview-in-progress:hover {\n  opacity: 1; }\n\n.device-preview-in-progress[disabled] {\n  opacity: 0.5; }\n\n.device-preview-in-progress:hover[disabled] {\n  opacity: 0.5; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/styles/device-settings.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".device-settings-component {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.device-settings-container {\n  height: 100%;\n  padding: 3.1% 2.5%;\n  margin: 0; }\n\n.device-settings-panel {\n  position: relative;\n  width: 100%;\n  background-color: rgba(153, 153, 153, 0.1);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05); }\n\n.device-settings-header {\n  height: 66px; }\n\n.device-settings-icon-container {\n  position: relative;\n  height: 66px;\n  width: 66px;\n  background-color: #04af8e;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n  margin: 0 16px 0 0;\n  float: left; }\n\n.device-settings-icon {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 10px);\n  display: inline-block;\n  height: 20px;\n  width: 20px; }\n\n.device-settings-text {\n  line-height: 66px;\n  opacity: 0.5;\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 600;\n  font-style: normal;\n  font-stretch: normal;\n  color: #ffffff; }\n\n.device-settings-confirm-buttons {\n  padding: 0; }\n\n.device-settings-back-button {\n  float: right;\n  margin-top: 14px;\n  margin-right: 14px; }\n\n.device-settings-body {\n  overflow: auto;\n  position: relative;\n  height: calc(100% - 96px);\n  margin: 0;\n  margin-right: 26px;\n  padding: 26px 43px 0 85px; }\n\n.device-settings-col {\n  padding-bottom: 35px; }\n\n.settings-field-title {\n  width: 221px;\n  height: 15px;\n  font-family: Lato;\n  font-size: 12px;\n  font-weight: normal;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  color: #f1f1f1;\n  padding-bottom: 13px; }\n\n.settings-note {\n  margin-top: 10px;\n  width: 154px;\n  height: 15px;\n  font-family: Lato;\n  font-size: 12px;\n  font-weight: normal;\n  font-style: italic;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  color: #999999; }\n\n.sep-line {\n  width: 100%;\n  height: 1px;\n  border-radius: 1px;\n  background-color: rgba(255, 255, 255, 0.2);\n  margin-bottom: 35px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/classroom-capture/styles/recording-details.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".details-confirm-buttons {\n  position: relative;\n  padding: 0; }\n\n.edit-details-text {\n  line-height: 66px;\n  opacity: 0.5;\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 600;\n  font-style: normal;\n  font-stretch: normal;\n  color: #ffffff; }\n\n.recording-details-body {\n  position: relative;\n  height: calc(100% - 66px);\n  margin: 0;\n  padding: 26px 0 0 85px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/main.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__polyfills_ts__ = __webpack_require__("../../../../../src/polyfills.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser_dynamic__ = __webpack_require__("../../../platform-browser-dynamic/@angular/platform-browser-dynamic.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__environments_environment__ = __webpack_require__("../../../../../src/environments/environment.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__app_module__ = __webpack_require__("../../../../../src/classroom/app.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_authentication_service__ = __webpack_require__("../../../../../src/shared/services/infra/authentication.service.ts");







if (__WEBPACK_IMPORTED_MODULE_3__environments_environment__["a" /* environment */].production) {
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2__angular_core__["enableProdMode"])();
}
Promise.all([__WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__["a" /* AppConfigService */].loadConfigData(), __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_authentication_service__["a" /* AuthenticationService */].getAuthenticationMode()])
    .then(() => {
    return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__angular_platform_browser_dynamic__["a" /* platformBrowserDynamic */])().bootstrapModule(__WEBPACK_IMPORTED_MODULE_5__app_module__["a" /* AppModule */]);
})
    .catch((err) => {
    console.log('bootstrapModule error', err);
});
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/main.js.map

/***/ }),

/***/ "../../../../../src/classroom/scheduling/components/scheduling.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"app-scheduling-component\">\r\n\r\n  <div class=\"grid app-scheduling-container\">\r\n\r\n    <div class=\"app-scheduling-panel col-12 no-margins\">\r\n\r\n      <!-- Header + Icon -->\r\n      <div class=\"header col-12 \">\r\n        <div class=\"grid-spaceBetween\">\r\n          <div class=\"col-4 no-margins\">\r\n            <div class=\"app-scheduling-icon-container\">\r\n              <div class=\"app-scheduling-icon calendar-icon\"></div>\r\n            </div>\r\n            <div class=\"app-scheduling-text\">\r\n              {{ 'SCHEDULING.scheduling' | translate }}\r\n            </div>\r\n          </div>\r\n          <div class=\"scheduling-actions\">\r\n            <button class=\"refresh actions-button cc-button\"\r\n                    [attr.aria-label]=\"'SCHEDULING.manual_refresh_button_label' | translate\"\r\n                    (click)=\"updateEventsManually()\"></button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- List scheduling Body -->\r\n      <div class=\"app-scheduling-body grid col-12 \">\r\n\r\n        <div class=\"date-header col-12\">\r\n          <div class=\"date-header-inner grid-spaceBetween no-margins\">\r\n            <div class=\"current-date\">{{date.format('MMMM D, YYYY - dddd')}}</div>\r\n            <div class=\"grid calendar-nav-buttons\">\r\n              <button class=\"arrow-left actions-button cc-button\"\r\n                      [attr.aria-label]=\"'SCHEDULING.previous_day_button_label' | translate\"\r\n                      (click)=\"goOneDayBack()\"></button>\r\n              <button class=\"dot actions-button cc-button\"\r\n                      [attr.aria-label]=\"'SCHEDULING.today_button_label' | translate\"\r\n                      (click)=\"goToToday()\"></button>\r\n              <button class=\"arrow-right actions-button cc-button\"\r\n                      [attr.aria-label]=\"'SCHEDULING.next_day_button_label' | translate\"\r\n                      (click)=\"goOneDayForward()\"></button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"scheduling-list col-12 grid\">\r\n          <div class=\"col-12 scheduling-list-inner\">\r\n            <div *ngFor=\"let event of scheduledEvents; trackBy: trackEventBy; let isFirstItem = first\"\r\n                 [id]=\"'_' + event.id\"\r\n                 class=\"schedule-item col-12 grid\"\r\n                 [ngClass]=\"{'event-end': hasEventCompleted(event), 'first-item': isFirstItem}\">\r\n\r\n              <div class=\"event-date col-3 no-margins\">{{ event.startDate*1000 | time:'LT':'REMOVE_AM_PM_SUFFIX'  }}-{{ event.endDate*1000 | time:'LT':'REMOVE_SPACES' }}</div>\r\n\r\n              <div class=\"col-6 no-margins\">\r\n                <div class=\"truncate2Lines\">\r\n                  <div *ngIf=\"isRecurrenceEvent(event.recurrenceType)\"\r\n                       class=\"recurrence-event recurrence-icon\"\r\n                       [ngClass]=\"{'recurrence-event-complete': hasEventCompleted(event)}\">\r\n                  </div>\r\n                  <span class=\"col no-margins\" pTooltip=\"{{event.summary}}\" tooltipPosition=\"top\" showDelay=\"500\">{{ event.summary}}</span>\r\n                </div>\r\n              </div>\r\n\r\n              <div class=\"schedule-status col-3\">\r\n                <div *ngIf=\"hasEventCompleted(event)\" class=\"status-recording\">\r\n                  <span class=\"dot-icon\" [ngClass]=\"{'complete': true}\"></span>\r\n                  <span class=\"status-text\">{{ 'SCHEDULING.completed' | translate }}</span>\r\n                </div>\r\n                <div *ngIf=\"isEventAtRecording(event.id)\" class=\"status-recording\">\r\n                  <span class=\"dot-icon\" [ngClass]=\"{'recording': true}\"></span>\r\n                  <span *ngIf=\"!isLiveEvent(event)\" class=\"status-text\" [ngClass]=\"{'recording': true}\">{{ 'SCHEDULING.recording' | translate}}</span>\r\n                  <span *ngIf=\"isLiveEvent(event)\" class=\"status-text\" [ngClass]=\"{'recording': true}\">{{ 'SCHEDULING.recording_live' | translate}}</span>\r\n                </div>\r\n                <div *ngIf=\"isItTheNextEvent(event.id) && shouldDisplayNextEventButton\" class=\"event-status\">\r\n                  <button [disabled]=\"isStartNextEventButtonDisabled()\" class=\"cc-button status-notifier\" [ngClass]=\"isStartNextEventButtonDisabled() ? 'start-at' : 'start-at-flopping'\">\r\n                    {{ 'SCHEDULING.startingInXMin' | translate: {'value': countdownTime} }}\r\n                  </button>\r\n                  <button *ngIf=\"!isStartNextEventButtonDisabled()\" class=\"cc-button status-notifier start-now-flopping\" (click)=\"startRecordingNextEventNow()\">\r\n                    {{ 'SCHEDULING.start_now' | translate}}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/classroom/scheduling/components/scheduling.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".app-scheduling-component {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.app-scheduling-container {\n  height: 100%;\n  padding: 3.1% 2.5%;\n  margin: 0; }\n\n.app-scheduling-panel {\n  width: 100%;\n  background-color: rgba(153, 153, 153, 0.1);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n  overflow-y: hidden;\n  padding-left: 0; }\n\n.app-scheduling-text {\n  line-height: 66px;\n  opacity: 0.5;\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 600;\n  font-style: normal;\n  font-stretch: normal;\n  color: #ffffff; }\n\n.app-scheduling-icon-container {\n  position: relative;\n  height: 66px;\n  width: 66px;\n  background-color: #04af8e;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n  margin: 0 16px 0 0;\n  float: left; }\n\n.app-scheduling-icon {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 10px);\n  display: inline-block;\n  height: 20px;\n  width: 20px; }\n\n.app-scheduling-body {\n  line-height: 1.5;\n  position: relative;\n  font-family: Lato;\n  font-size: 16px;\n  color: white;\n  padding: 11px 0 0 85px;\n  margin-right: 26px;\n  height: calc(100% - 82px); }\n\n.calendar-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/calendar.svg")) + ") no-repeat top left; }\n\n.recurrence-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/recurrence.svg")) + ") no-repeat top left; }\n\n.date-header {\n  padding: 0 46px 0 0; }\n\n.date-header-inner, .schedule-item, .current-date {\n  border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n\n.schedule-item {\n  padding: 29px 0;\n  cursor: default; }\n\n.current-date {\n  border-width: 4px;\n  padding: 0 8px 0 1px;\n  font-weight: 600; }\n\n.schedule-status {\n  text-align: left;\n  position: relative;\n  font-size: 14px;\n  font-weight: 600;\n  font-family: 'Lato';\n  padding-left: 25px; }\n\n.status-text {\n  padding: 0 10px 0 0;\n  font-weight: 600; }\n  .status-text.recording {\n    color: #db1f26; }\n\n.scheduling-list {\n  overflow-y: auto;\n  height: calc(100% - 29px); }\n\n.scheduling-list-inner {\n  padding: 0 45px 0 0; }\n\n.actions-button {\n  display: block;\n  text-decoration: none;\n  height: 20px;\n  width: 20px;\n  text-indent: -9999px;\n  background-size: 20px 20px;\n  opacity: 0.7;\n  margin-left: 9px; }\n\n.actions-button:hover {\n  opacity: 1; }\n\n.arrow-right {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/common/arrow-right.svg")) + ") no-repeat top left; }\n\n.dot {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/common/dot.svg")) + ") no-repeat top left;\n  opacity: 1; }\n\n.arrow-left {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/common/arrow-left.svg")) + ") no-repeat top left; }\n\n.calendar-nav-buttons {\n  padding-right: 3px; }\n\n.scheduling-actions {\n  margin-top: 24px;\n  margin-right: 34px; }\n\n.refresh {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/refresh.svg")) + ") no-repeat top left; }\n\n.event-date {\n  padding-left: 1px !important; }\n\n.status-recording {\n  padding-top: 3px; }\n\n.dot-icon {\n  height: 6px;\n  width: 6px;\n  display: inline-block;\n  border-radius: 50%;\n  margin: 0 2px 1px 0; }\n  .dot-icon.recording {\n    background-color: #e03640; }\n  .dot-icon.complete {\n    background-color: rgba(255, 255, 255, 0.5); }\n\n.event-end {\n  color: #999999; }\n\n.event-status .start-at {\n  background-color: rgba(0, 0, 0, 0);\n  display: block; }\n\n.event-status .start-at-flopping {\n  background-color: rgba(0, 0, 0, 0);\n  display: block; }\n\n.event-status .start-now-flopping {\n  display: none; }\n\n.event-status:hover .start-at-flopping {\n  display: none; }\n\n.event-status:hover .start-now-flopping {\n  background-color: rgba(255, 255, 255, 0.2);\n  display: block; }\n\n.status-notifier {\n  border: 1px solid #FFFFFF;\n  border-radius: 100px;\n  text-align: center;\n  width: 176px;\n  padding: 7px 0;\n  top: -4px;\n  right: 8px;\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 600;\n  color: #ffffff; }\n\n.recurrence-event {\n  width: 20px;\n  height: 20px;\n  margin-right: 12px;\n  margin-top: 4px; }\n  .recurrence-event.recurrence-event-complete {\n    opacity: 0.5; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/classroom/scheduling/components/scheduling.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__classroom_capture_services_scheduling_service__ = __webpack_require__("../../../../../src/classroom/classroom-capture/services/scheduling.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_moment__ = __webpack_require__("../../../../moment/moment.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_moment___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_moment__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__angular_router__ = __webpack_require__("../../../router/@angular/router.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SchedulingComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









let SchedulingComponent = class SchedulingComponent {
    constructor(schedulingService, elementRef, appConfig, router, logger, appStateService) {
        this.schedulingService = schedulingService;
        this.elementRef = elementRef;
        this.appConfig = appConfig;
        this.router = router;
        this.logger = logger;
        this.appStateService = appStateService;
        this.date = __WEBPACK_IMPORTED_MODULE_2_moment__();
    }
    ngOnInit() {
        // Todo: Create or modify the config service to load on bootstrap with all config data (json).
        let schedulingInfo = this.appConfig.getConfigData('config.captureApp.scheduling');
        if (!Number.isInteger(schedulingInfo.viewEventsAheadDay) || schedulingInfo.viewEventsAheadDay > 30) {
            this.viewEventsAheadDay = 14;
            this.logger.info('viewEventsAheadDay maximum number is 30');
        }
        else {
            this.viewEventsAheadDay = schedulingInfo.viewEventsAheadDay;
        }
        this.setOnRouteActions();
        __WEBPACK_IMPORTED_MODULE_7_rxjs__["Observable"].timer(0, 1000)
            .subscribe(() => {
            this.shouldDisplayNextEventButton = this.schedulingService.shouldDisplayNextEventNotifications();
            this.countdownTime = this.shouldDisplayNextEventButton ? this.schedulingService.getTimeToNextEventInMinutes() : '';
        });
    }
    setOnRouteActions() {
        let that = this;
        //stop / start device preview when navigating in scheduling page
        that.router.events.subscribe((event) => {
            // when entering the page
            if (event instanceof __WEBPACK_IMPORTED_MODULE_5__angular_router__["NavigationEnd"]) {
                if (this.router.url === '/scheduling') {
                    this.goToToday();
                }
            }
        });
    }
    /**
     * getter for binding the event-list from the schedulingService
     * @returns event[]
     */
    get scheduledEvents() {
        return this.schedulingService.getScheduledEventsByDay(this.date);
    }
    /**
     * getter for binding the current-event from the schedulingService
     * @returns event
     */
    get currentEvent() {
        return this.schedulingService.getCurrentEvent();
    }
    /**
     * getter for binding the next-event from the schedulingService
     * @returns event
     */
    get nextEvent() {
        return this.schedulingService.getNextEvent();
    }
    /**
     * The function is used for *ngFor loop for tracking new changes
     */
    trackEventBy(index, scheduledEvent) {
        return scheduledEvent ? scheduledEvent.id : undefined;
    }
    /**
     * Manually refresh the current event list
     */
    updateEventsManually() {
        this.schedulingService.restartSchedulingEventInterval();
    }
    hasEventCompleted(event) {
        return this.schedulingService.getEventStatus(event.id) === __WEBPACK_IMPORTED_MODULE_1__classroom_capture_services_scheduling_service__["a" /* SchedulingService */].EVENT_STATUS.COMPLETED;
    }
    isEventAtRecording(eventId) {
        return this.currentEvent && this.currentEvent.id === eventId && this.appStateService.isAppRecording();
    }
    isItTheNextEvent(eventId) {
        return this.nextEvent && this.nextEvent.id === eventId;
    }
    scrollToCurrentTime() {
        let now = __WEBPACK_IMPORTED_MODULE_2_moment__().valueOf();
        let fetchedCurrentViewEvent = __WEBPACK_IMPORTED_MODULE_3_lodash__["find"](this.scheduledEvents, event => {
            return now < (event['endDate'] * 1000);
        });
        if (fetchedCurrentViewEvent != undefined) {
            this.scrollToSomeEvent('#_' + fetchedCurrentViewEvent['id']);
        }
    }
    scrollToFirstEvent() {
        this.scrollToSomeEvent('.first-item');
    }
    scrollToSomeEvent(selector) {
        let elem = this.elementRef.nativeElement.querySelector(selector);
        if (elem)
            elem.scrollIntoView(true);
    }
    goOneDayForward() {
        let endOfCalendar = __WEBPACK_IMPORTED_MODULE_2_moment__().add(this.viewEventsAheadDay, 'day');
        if (this.date.isBefore(endOfCalendar, 'day')) {
            this.date.add(1, 'day');
            this.scrollToFirstEvent();
        }
    }
    goToToday() {
        this.date = __WEBPACK_IMPORTED_MODULE_2_moment__();
        this.scrollToCurrentTime();
    }
    goOneDayBack() {
        if (this.date.isAfter(__WEBPACK_IMPORTED_MODULE_2_moment__(), 'day')) {
            this.date.subtract(1, 'days');
            this.scrollToFirstEvent();
        }
    }
    isRecurrenceEvent(recurrenceType) {
        return recurrenceType === 2;
    }
    startRecordingNextEventNow() {
        this.schedulingService.startRecordingNextEvent();
    }
    isStartNextEventButtonDisabled() {
        // blocking when another scheduled event is recording
        return !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.currentEvent) && this.appStateService.isAppRecording();
    }
    isLiveEvent(event) {
        return this.schedulingService.isLiveScheduledEvent(event);
    }
};
SchedulingComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'scheduling',
        template: __webpack_require__("../../../../../src/classroom/scheduling/components/scheduling.component.html"),
        styles: [__webpack_require__("../../../../../src/classroom/scheduling/components/scheduling.component.scss")],
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__classroom_capture_services_scheduling_service__["a" /* SchedulingService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__classroom_capture_services_scheduling_service__["a" /* SchedulingService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__shared_services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_5__angular_router__["Router"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__angular_router__["Router"]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__shared_services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__shared_services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _f || Object])
], SchedulingComponent);

var _a, _b, _c, _d, _e, _f;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/scheduling.component.js.map

/***/ }),

/***/ "../../../../../src/environments/environment.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
// The file contents for the current environment will overwrite these during build.
// The build system defaults to the dev environment which uses `environment.ts`, but if you do
// `ng build --env=prod` then `environment.prod.ts` will be used instead.
// The list of which env maps to which file can be found in `angular-cli.json`.
// The file contents for the current environment will overwrite these during build.
const environment = {
    production: false
};
/* harmony export (immutable) */ __webpack_exports__["a"] = environment;

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/environment.js.map

/***/ }),

/***/ "../../../../../src/personal/app.consts.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
class AppConsts {
}
/* harmony export (immutable) */ __webpack_exports__["a"] = AppConsts;

AppConsts.MINIMUM_APP_HEIGHT = 220;
AppConsts.MINIMUM_APP_WIDTH = 440;
AppConsts.DEFAULT_WIN_HEIGHT = 150;
AppConsts.VIDEO_PREVIEW_HEIGHT = 400;
AppConsts.AUDIO_PREVIEW_HEIGHT = 400;
AppConsts.ACTIVE_RECORDING_HEIGHT = AppConsts.MINIMUM_APP_HEIGHT;
AppConsts.ACTIVE_RECORDING_PREVIEW_HEIGHT = 450;
AppConsts.ACTIVE_RECORDING_WIDTH = AppConsts.MINIMUM_APP_WIDTH;
AppConsts.MANAGEMENT_WIN_WIDTH = 1024;
AppConsts.MANAGEMENT_WIN_HEIGHT = 768;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app.consts.js.map

/***/ }),

/***/ "../../../../../src/polyfills.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_core_js_es6_symbol__ = __webpack_require__("../../../../core-js/es6/symbol.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_core_js_es6_symbol___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_core_js_es6_symbol__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_core_js_es6_object__ = __webpack_require__("../../../../core-js/es6/object.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_core_js_es6_object___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_core_js_es6_object__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_core_js_es6_function__ = __webpack_require__("../../../../core-js/es6/function.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_core_js_es6_function___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_core_js_es6_function__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_core_js_es6_parse_int__ = __webpack_require__("../../../../core-js/es6/parse-int.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_core_js_es6_parse_int___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_core_js_es6_parse_int__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_core_js_es6_parse_float__ = __webpack_require__("../../../../core-js/es6/parse-float.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_core_js_es6_parse_float___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_core_js_es6_parse_float__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_core_js_es6_number__ = __webpack_require__("../../../../core-js/es6/number.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_core_js_es6_number___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_core_js_es6_number__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_core_js_es6_math__ = __webpack_require__("../../../../core-js/es6/math.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_core_js_es6_math___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_core_js_es6_math__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_core_js_es6_string__ = __webpack_require__("../../../../core-js/es6/string.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_core_js_es6_string___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_core_js_es6_string__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_core_js_es6_date__ = __webpack_require__("../../../../core-js/es6/date.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_core_js_es6_date___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8_core_js_es6_date__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_core_js_es6_array__ = __webpack_require__("../../../../core-js/es6/array.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_core_js_es6_array___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_core_js_es6_array__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_core_js_es6_regexp__ = __webpack_require__("../../../../core-js/es6/regexp.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10_core_js_es6_regexp___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10_core_js_es6_regexp__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_core_js_es6_map__ = __webpack_require__("../../../../core-js/es6/map.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11_core_js_es6_map___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_11_core_js_es6_map__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_core_js_es6_set__ = __webpack_require__("../../../../core-js/es6/set.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_core_js_es6_set___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_12_core_js_es6_set__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_core_js_es6_reflect__ = __webpack_require__("../../../../core-js/es6/reflect.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13_core_js_es6_reflect___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_13_core_js_es6_reflect__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_core_js_es7_reflect__ = __webpack_require__("../../../../core-js/es7/reflect.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14_core_js_es7_reflect___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_14_core_js_es7_reflect__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_zone_js_dist_zone__ = __webpack_require__("../../../../zone.js/dist/zone.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15_zone_js_dist_zone___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_15_zone_js_dist_zone__);
// This file includes polyfills needed by Angular 2 and is loaded before
// the app. You can add your own extra polyfills to this file.
















//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/polyfills.js.map

/***/ }),

/***/ "../../../../../src/shared/components/app-container/app-container.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"main-container\">\r\n\r\n  <div class=\"app-main-grid\">\r\n\r\n    <div class=\"col-12 header-col\">\r\n\r\n      <div class=\"app-header\">\r\n\r\n        <div class=\"kaltura-logo\">\r\n          <div [ngClass]=\"containerProperties.header.logoIcon\"></div>\r\n        </div>\r\n\r\n        <!-- extendedButtons -->\r\n        <button *ngFor=\"let button of containerProperties.header.extendedButtons\"\r\n          (click)=\"button.onClick()\" [ngClass]=\"[button.class]\"\r\n                [attr.aria-label]=\"getExtendedButtonsAriaLabel(button) | translate\">{{ button.title | translate }}</button>\r\n\r\n        <!-- app-sizing-buttons -->\r\n        <div class=\"app-sizing-buttons\">\r\n          <button\r\n            *ngIf=\"containerProperties.header.buttons.includes('minimize_to_tray')\"\r\n            [attr.aria-label]=\"'MENU.minimize_to_tray_button' | translate\"\r\n            class=\"taskbar-button minimize-to-tray-button\"\r\n            (click)=\"onMinimizeToTrayClick()\"></button>\r\n\r\n          <button\r\n            *ngIf=\"containerProperties.header.buttons.includes('maximize')\"\r\n            [attr.aria-label]=\"'MENU.maximize_button' | translate\"\r\n            class=\"taskbar-button maximize-restore-button\"\r\n            (click)=\"onMaximizeRestore()\"></button>\r\n\r\n          <button\r\n            *ngIf=\"containerProperties.header.buttons.includes('minimize')\"\r\n            [attr.aria-label]=\"'MENU.minimize_button' | translate\"\r\n            class=\"taskbar-button minimize-button\"\r\n            (click)=\"onMinimizeClick()\"></button>\r\n\r\n          <button\r\n            *ngIf=\"containerProperties.header.buttons.includes('debug')\"\r\n            [attr.aria-label]=\"'MENU.debug_button' | translate\"\r\n            class=\"taskbar-button\"\r\n            aria-hidden=\"true\"\r\n            [hidden]=\"!debugState\">D</button>\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=\"nav-bar-col\">\r\n\r\n      <div class=\"app-nav-bar\">\r\n        <ul class=\"app-menu\">\r\n\r\n          <li *ngFor=\"let link of containerProperties.navbar.links\" [ngClass]=\"link.linkContainer\"\r\n              [hidden]=\"!shouldRender(link.shouldRender)\">\r\n            <div class=\"nav-container-position\">\r\n              <a [ngClass]=\"['nav-tab-item', link.linkClass]\"\r\n                 role=\"button\"\r\n                 tabindex=\"0\"\r\n                 [attr.aria-label]=\"getLinksAriaLabel(link) | translate\"\r\n                 (click)=\"navigateToLink(link.routerLink, link.shouldDisableWhenNotStable)\"\r\n                 routerLinkActive=\"active\"\r\n                 oncontextmenu=\"return false;\"\r\n                 [class.disabled]=\"(link.shouldDisableWhenNotStable === true && isMenuDisabled()) ? true : null\"></a>\r\n              <span class=\"location-dot\" *ngIf=\"router.url === link.routerLink\"></span>\r\n            </div>\r\n          </li>\r\n\r\n        </ul>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <div class=\"app-inner-container-col\">\r\n      <div class=\"app-inner-container\">\r\n        <div [ngClass]=\"{ 'back-light': containerProperties.showBackLight }\"></div>\r\n        <!-- routing here -->\r\n        <router-outlet></router-outlet>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n</div>\r\n"

/***/ }),

/***/ "../../../../../src/shared/components/app-container/app-container.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".main-container {\n  position: relative;\n  height: 100vh;\n  background-color: #24212a;\n  opacity: 0.98; }\n\n.app-main-grid {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-flow: row wrap;\n      flex-flow: row wrap;\n  box-sizing: border-box;\n  height: 100%;\n  -webkit-app-region: no-drag;\n  padding: 1px; }\n\n.header-col {\n  padding: 0; }\n\n.app-header {\n  -webkit-app-region: drag;\n  background-color: rgba(153, 153, 153, 0.03);\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.05);\n  height: 80px; }\n\n.kaltura-logo {\n  padding-left: 2.1%;\n  padding-top: 24px; }\n\n.logo-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/common/logo.svg")) + ") no-repeat top left;\n  width: 188px;\n  height: 28px;\n  object-fit: contain; }\n\n.logo-pc-full {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/common/logo-pc-full.svg")) + ") no-repeat top left;\n  width: 188px;\n  height: 28px;\n  object-fit: contain; }\n\n.app-sizing-buttons {\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: 9999999999; }\n\n.taskbar-button {\n  -webkit-app-region: no-drag;\n  display: block;\n  border: none;\n  height: 20px;\n  width: 20px;\n  background-size: 20px 20px;\n  opacity: 0.5;\n  margin-right: 8px;\n  margin-top: 8px;\n  float: right; }\n\n.taskbar-button:hover, .taskbar-button:active {\n  outline: none;\n  opacity: 1; }\n\n.taskbar-button:focus {\n  outline: none;\n  opacity: 1; }\n\n.minimize-button {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/minimize.svg")) + ") no-repeat top left; }\n\n.maximize-restore-button {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/resize-app.svg")) + ") no-repeat top left; }\n\n.minimize-to-tray-button {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/exit.svg")) + ") no-repeat top left; }\n\n/* --- Nav Bar ---*/\n.app-nav-bar {\n  width: 64px;\n  position: absolute;\n  height: calc(100% - 82px); }\n\n.nav-bar-col {\n  width: 64px;\n  min-width: 64px;\n  max-width: 64px !important;\n  height: calc(100% - 80px);\n  margin: 0;\n  padding: 0;\n  box-shadow: 1px 2px 0 0 rgba(255, 255, 255, 0.06); }\n\n.home-nav {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/home-icon.svg")) + ") no-repeat top left; }\n\n.library {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/library.svg")) + ") no-repeat top left; }\n\n.info-nav {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/info.svg")) + ") no-repeat top left; }\n\n.calendar-nav {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/calendar.svg")) + ") no-repeat top left; }\n\n.settings-nav {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/settings.svg")) + ") no-repeat top left; }\n\n.nav-tab-item {\n  display: block;\n  text-decoration: none;\n  height: 20px;\n  width: 20px;\n  text-indent: -9999px;\n  background-size: 20px 20px;\n  opacity: 0.7;\n  margin: auto;\n  cursor: pointer; }\n\n.nav-tab-item:hover {\n  opacity: 1; }\n\n.nav-tab-item.disabled {\n  pointer-events: none;\n  cursor: default; }\n\n.nav-tab-item:focus {\n  opacity: 1;\n  outline: none; }\n\n.location-dot {\n  height: 4px;\n  width: 4px;\n  display: block;\n  color: white;\n  border-radius: 50%;\n  background-color: white;\n  opacity: 0.5;\n  margin: 4px auto 0 auto; }\n\n/*--- Inner Conatiner - for App Route ---*/\n.app-inner-container-col {\n  width: calc(100% - 66px);\n  height: calc(100% - 80px);\n  padding: 0 0 0 1px; }\n\n.app-menu {\n  padding: 46px 0 0;\n  margin-top: 0; }\n\n.app-menu > li {\n  list-style: none;\n  height: 56px; }\n  .app-menu > li.nav-tab-item-bottom {\n    position: absolute;\n    bottom: 6px;\n    height: 40px;\n    width: 64px; }\n\n.back-light {\n  width: calc(100% - 100px);\n  height: calc(138%);\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/common/back-light.svg")) + ") no-repeat top left;\n  z-index: -5000;\n  margin: 0;\n  position: absolute;\n  top: 30%;\n  left: 50%;\n  transform: translate(-50%, -50%); }\n\n.app-inner-container {\n  height: 100%;\n  position: relative;\n  background-color: #24212a;\n  opacity: 0.98; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/shared/components/app-container/app-container.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__angular_router__ = __webpack_require__("../../../router/@angular/router.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__services_infra_panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppContainerComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








let AppContainerComponent = class AppContainerComponent {
    constructor(translate, log, appState, panelsService, router) {
        this.log = log;
        this.appState = appState;
        this.panelsService = panelsService;
        this.router = router;
        this.debugState = false;
        this.debug_mode_UUID = '';
    }
    ngOnInit() {
        this.debug_mode_UUID = __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('debug_mode', (data) => {
            this.debugState = data;
        });
    }
    ngOnDestroy() {
        __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].unregisterForNotification('debug_mode', this.debug_mode_UUID);
    }
    onMinimizeToTrayClick() {
        return __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendSystemCommand('closeApp'); // go to tray
    }
    onMinimizeClick() {
        __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendSystemCommand('minimize');
    }
    onMaximizeRestore() {
        __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendSystemCommand('maximize-restore');
    }
    isMenuDisabled() {
        return !this.appState.isAppStable();
    }
    shouldRender(value = true) {
        return (typeof value === 'boolean') ? value : value();
    }
    getLinksAriaLabel(link) {
        return link.ariaLabel ? link.ariaLabel : link.label;
    }
    getExtendedButtonsAriaLabel(button) {
        return button.ariaLabel ? button.ariaLabel : button.title;
    }
    navigateToLink(link, disableIfUnstable) {
        if (disableIfUnstable && this.isMenuDisabled()) {
            return;
        }
        this.router.navigateByUrl(link)
            .catch((err) => {
            this.log.error('Failed to navigate to: ' + link + '. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object)
], AppContainerComponent.prototype, "containerProperties", void 0);
AppContainerComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'app-container',
        template: __webpack_require__("../../../../../src/shared/components/app-container/app-container.component.html"),
        styles: [__webpack_require__("../../../../../src/shared/components/app-container/app-container.component.scss")]
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_ng2_translate__["b" /* TranslateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_4__services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__services_infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__services_infra_app_state_service__["a" /* AppStateService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_6__services_infra_panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__services_infra_panels_service__["a" /* PanelsService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_3__angular_router__["Router"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__angular_router__["Router"]) === "function" && _e || Object])
], AppContainerComponent);

var _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-container.component.js.map

/***/ }),

/***/ "../../../../../src/shared/components/log-collector/log-collector.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"log-collector-container\">\r\n  <div class=\"grid col-12\">\r\n    <div [attr.aria-label]=\"'SETTINGS.logs_upload_desc' | translate\" class=\"no-margins\"\r\n         [ngClass]=\"{'detail-field-title upload-logs-desc': componentSize && componentSize === 'small',\r\n                  'settings-desc col-4': !componentSize || componentSize === 'large'}\">\r\n      {{'SETTINGS.logs_upload_desc' | translate}}\r\n    </div>\r\n    <div class=\"col-8 no-margins settings-values\">\r\n      <div class=\"grid col-8\">\r\n        <button fit-text [attr.aria-label]=\"'SETTINGS.upload_logs' | translate\"\r\n                class=\"settings-logs-upload-button no-drag small-oval-button focus-once no-margins upload-logs-button\"\r\n                (click)=\"onLogClick()\" [disabled]=\"readOnly || isUploadingLogs()\">\r\n          {{'SETTINGS.upload_logs' | translate}}\r\n        </button>\r\n        <div class=\"col-4 no-margins\" *ngIf=\"isUploadingLogs()\">\r\n          <p-progressBar class=\"progressbar-component logs-progressbar\" [value]=\"getUploadProgress()\"></p-progressBar>\r\n        </div>\r\n        <button *ngIf=\"false\" [attr.aria-label]=\"'SETTINGS.open_logs_dir' | translate\"\r\n                class=\"settings-open-logs-dir no-drag small-oval-button focus-once col-3 no-margins\"\r\n                (click)=\"onOpenLogsDirClick()\">\r\n          {{'SETTINGS.open_logs_dir' | translate}}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <management-confirm-dialog confirm_dialog_key=\"uploaded-logs-token-msg\"\r\n                             accept_button_text=\"{{'COMMON.OK' | translate}}\"\r\n                             personalize_class=\"uploaded-logs-token-dialog\">\r\n  </management-confirm-dialog>\r\n\r\n  <management-confirm-dialog class=\"leave-page-confirm-dialog\"\r\n                             confirm_dialog_key=\"leave-while-uploading-logs\"\r\n                             reject_button_text=\"{{'COMMON.no' | translate}}\"\r\n                             accept_button_text=\"{{'MANAGEMENT.Confirm_Leave' | translate}}\">\r\n  </management-confirm-dialog>\r\n</div>\r\n\r\n\r\n"

/***/ }),

/***/ "../../../../../src/shared/components/log-collector/log-collector.component.scss":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, ".log-collector-container {\n  width: 100%;\n  height: 100%; }\n\n.settings-desc {\n  opacity: 0.7;\n  font-family: lato;\n  font-size: 16px;\n  font-weight: 300;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: 1.25;\n  letter-spacing: normal;\n  text-align: left;\n  color: #ffffff; }\n\n.logs-progressbar {\n  margin-top: 9px; }\n\n.settings-open-logs-dir {\n  margin-left: 7px !important; }\n\n.upload-logs-button {\n  width: 115px; }\n\n.upload-logs-desc {\n  width: 210px; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/shared/components/log-collector/log-collector.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__log_collector_service__ = __webpack_require__("../../../../../src/shared/components/log-collector/log-collector.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LogCollectorComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let LogCollectorComponent = class LogCollectorComponent {
    constructor(logger, translate, logCollectorService) {
        this.logger = logger;
        this.translate = translate;
        this.logCollectorService = logCollectorService;
    }
    onLogClick() {
        this.logCollectorService.resetFakeLogUploadProgress();
        this.logCollectorService.onLogClick();
    }
    getUploadProgress() {
        return this.logCollectorService.getFakeLogUploadProgress();
    }
    isUploadingLogs() {
        return this.logCollectorService.isUploadingLogs();
    }
    onOpenLogsDirClick() {
        this.logCollectorService.openLogsDir();
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", String)
], LogCollectorComponent.prototype, "componentSize", void 0);
LogCollectorComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'log-collector',
        template: __webpack_require__("../../../../../src/shared/components/log-collector/log-collector.component.html"),
        styles: [__webpack_require__("../../../../../src/shared/components/log-collector/log-collector.component.scss")]
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_3__services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_ng2_translate__["b" /* TranslateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_2__log_collector_service__["a" /* LogCollectorService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__log_collector_service__["a" /* LogCollectorService */]) === "function" && _c || Object])
], LogCollectorComponent);

var _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/log-collector.component.js.map

/***/ }),

/***/ "../../../../../src/shared/components/log-collector/log-collector.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__ = __webpack_require__("../../../platform-browser/@angular/platform-browser.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__log_collector_service__ = __webpack_require__("../../../../../src/shared/components/log-collector/log-collector.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_infra_infra_module__ = __webpack_require__("../../../../../src/shared/services/infra/infra.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__log_collector_component__ = __webpack_require__("../../../../../src/shared/components/log-collector/log-collector.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_primeng_components_progressbar_progressbar__ = __webpack_require__("../../../../primeng/components/progressbar/progressbar.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_primeng_components_progressbar_progressbar___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_primeng_components_progressbar_progressbar__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_primeng_components_confirmdialog_confirmdialog__ = __webpack_require__("../../../../primeng/components/confirmdialog/confirmdialog.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_primeng_components_confirmdialog_confirmdialog___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_primeng_components_confirmdialog_confirmdialog__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__managment_confirm_dialog_menagement_confirm_dialog_module__ = __webpack_require__("../../../../../src/shared/components/managment-confirm-dialog/menagement-confirm-dialog.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__directives_shared_directives_module__ = __webpack_require__("../../../../../src/shared/directives/shared-directives.module.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LogCollectorModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};










let LogCollectorModule = class LogCollectorModule {
};
LogCollectorModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [
            __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__["BrowserModule"],
            __WEBPACK_IMPORTED_MODULE_3__services_infra_infra_module__["a" /* InfraModule */],
            __WEBPACK_IMPORTED_MODULE_5_ng2_translate__["a" /* TranslateModule */].forRoot(),
            __WEBPACK_IMPORTED_MODULE_6_primeng_components_progressbar_progressbar__["ProgressBarModule"],
            __WEBPACK_IMPORTED_MODULE_7_primeng_components_confirmdialog_confirmdialog__["ConfirmDialogModule"],
            __WEBPACK_IMPORTED_MODULE_8__managment_confirm_dialog_menagement_confirm_dialog_module__["a" /* ManagementConfirmDialogModule */],
            __WEBPACK_IMPORTED_MODULE_9__directives_shared_directives_module__["a" /* SharedDirectives */]
        ],
        declarations: [
            __WEBPACK_IMPORTED_MODULE_4__log_collector_component__["a" /* LogCollectorComponent */]
        ],
        providers: [
            __WEBPACK_IMPORTED_MODULE_2__log_collector_service__["a" /* LogCollectorService */]
        ],
        exports: [
            __WEBPACK_IMPORTED_MODULE_4__log_collector_component__["a" /* LogCollectorComponent */]
        ]
    })
], LogCollectorModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/log-collector.module.js.map

/***/ }),

/***/ "../../../../../src/shared/components/log-collector/log-collector.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_angular2_uuid__ = __webpack_require__("../../../../angular2-uuid/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_angular2_uuid___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_angular2_uuid__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__services_infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_primeng_components_common_confirmationservice__ = __webpack_require__("../../../../primeng/components/common/confirmationservice.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_primeng_components_common_confirmationservice___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_primeng_components_common_confirmationservice__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__services_infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LogCollectorService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








let LogCollectorService = class LogCollectorService {
    constructor(log, appConfig, translate, confirmationService, appNotifications) {
        this.log = log;
        this.appConfig = appConfig;
        this.translate = translate;
        this.confirmationService = confirmationService;
        this.appNotifications = appNotifications;
        this.COLLECTOR_STATUS = {
            IN_PROGRESS: 'IN_PROGRESS',
            SUCCEEDED: 'SUCCEEDED',
            FAILED: 'FAILED'
        };
        this.logUploadProgress = 0;
        this.fakeProgressInterval = null;
        this.currentLogCollectorId = null;
        this.logCollectorStatusCheckInterval = null;
        this.uploadingLogs = false;
    }
    getFakeLogUploadProgress() {
        return this.logUploadProgress;
    }
    resetFakeLogUploadProgress() {
        this.logUploadProgress = 0;
    }
    onLogClick() {
        this.uploadingLogs = true;
        this.currentLogCollectorId = __WEBPACK_IMPORTED_MODULE_1_angular2_uuid__["UUID"].UUID();
        this.startFakeLogsUploadProgress();
        __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('collect-logs-and-data', this.currentLogCollectorId);
        this.startCollectorStatusCheckInterval();
    }
    isUploadingLogs() {
        return this.uploadingLogs;
    }
    openLogsDir() {
        __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('openDirectory', this.appConfig.getConfigData('config.shared.logsDir'))
            .then(success => {
            if (!success)
                this.log.error('Failed to open logs folder');
        });
    }
    clearCollectorStatusCheckInterval() {
        this.uploadingLogs = false;
        clearInterval(this.logCollectorStatusCheckInterval);
    }
    askBeforeLeave() {
        return new Promise((resolve, reject) => {
            if (this.isUploadingLogs()) {
                this.translate.get('SETTINGS.uploading_logs_leave_while_uploading')
                    .subscribe((leaveWithoutChangesText) => {
                    this.confirmationService.confirm({
                        message: leaveWithoutChangesText,
                        key: "leave-while-uploading-logs",
                        accept: () => {
                            this.clearCollectorStatusCheckInterval();
                            //since the next call will be to route to different page, there is an issue with primeng confirm dialog UI. we need to wait for it to close...
                            setTimeout(() => {
                                resolve(true);
                            }, 1000);
                        },
                        reject: () => {
                            resolve(false);
                        }
                    });
                });
            }
            else {
                resolve(true);
            }
        });
    }
    openUploadedLogsTokenPopup(tokenId) {
        this.translate.get('SETTINGS.uploaded_logs_token_message')
            .subscribe((text) => {
            this.confirmationService.confirm({
                message: text + "<br><br><span class='log-token'>" + tokenId + "</span>",
                key: "uploaded-logs-token-msg"
            });
        });
    }
    startFakeLogsUploadProgress() {
        this.logUploadProgress = 4;
        this.fakeProgressInterval = setInterval(() => {
            let operand = this.logUploadProgress > 70 ? 1 : 7;
            this.logUploadProgress += operand;
            if (this.logUploadProgress > 96)
                this.clearFakeLogsUploadInterval();
        }, 4000);
    }
    startCollectorStatusCheckInterval() {
        this.logCollectorStatusCheckInterval = setInterval(() => {
            __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('get-log-collector-status', this.currentLogCollectorId)
                .then((collector) => {
                if (collector && collector['status'] !== this.COLLECTOR_STATUS.IN_PROGRESS) {
                    this.clearFakeLogsUploadInterval();
                    if (collector['status'] === this.COLLECTOR_STATUS.SUCCEEDED) {
                        this.logUploadProgress = 100;
                        setTimeout(() => {
                            this.openUploadedLogsTokenPopup(collector['collectionUrl']);
                            this.clearCollectorStatusCheckInterval();
                        }, 1000); //so the user will see the progress bar at 100%
                    }
                    else {
                        this.resetFakeLogUploadProgress();
                        this.clearCollectorStatusCheckInterval();
                        this.appNotifications.sendNotification('SETTINGS.upload_logs_failure', 'warn');
                    }
                }
            });
        }, 5000);
    }
    clearFakeLogsUploadInterval() {
        clearInterval(this.fakeProgressInterval);
    }
};
LogCollectorService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_4__services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_5__services_infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__services_infra_app_config_service__["a" /* AppConfigService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_2_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2_ng2_translate__["b" /* TranslateService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_6_primeng_components_common_confirmationservice__["ConfirmationService"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6_primeng_components_common_confirmationservice__["ConfirmationService"]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_7__services_infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__services_infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _e || Object])
], LogCollectorService);

var _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/log-collector.service.js.map

/***/ }),

/***/ "../../../../../src/shared/components/managment-confirm-dialog/management-confirm-dialog.component.html":
/***/ (function(module, exports) {

module.exports = "<p-confirmDialog class=\"management-dialog\" [ngClass]=\"personalize_class\" closable=\"false\" #cd [key]=\"confirm_dialog_key\" [appendTo]=\"'body'\" tabindex=\"-1\" dialog-addon role=\"dialog\" aria-modal=\"true\">\r\n  <p-footer>\r\n    <div class=\"warning-icon\"></div>\r\n    <button *ngIf=\"reject_button_text\" class=\"no-drag small-oval-button reject\" type=\"button\" pButton icon=\"\" label={{reject_button_text}}\r\n            (click)=\"cd.reject()\" [attr.aria-label]=\"reject_button_text\"></button>\r\n    <button class=\"no-drag\" [attr.aria-label]=\"accept_button_text\"\r\n            [ngClass]=\"{'small-oval-button' : !accept_button_size || accept_button_size === BUTTON_SIZE.small,\r\n                        'large-oval-button' : accept_button_size === BUTTON_SIZE.large}\"\r\n            type=\"button\" pButton icon=\"\" label={{accept_button_text}} (click)=\"cd.accept()\"></button>\r\n  </p-footer>\r\n</p-confirmDialog>\r\n"

/***/ }),

/***/ "../../../../../src/shared/components/managment-confirm-dialog/management-confirm-dialog.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "p-confirmDialog.management-dialog .ui-confirmdialog {\n  width: 364px;\n  border-radius: 4px;\n  background-color: #24212a;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.25);\n  border: solid 1px #ffffff; }\n\np-confirmDialog.management-dialog .ui-dialog-titlebar,\np-confirmDialog.management-dialog .ui-dialog-titlebar-close {\n  display: none; }\n\np-confirmDialog.management-dialog .ui-confirmdialog.ui-dialog .ui-dialog-content {\n  padding: 24px; }\n\np-confirmDialog.management-dialog .ui-confirmdialog-message {\n  font-family: Lato;\n  font-size: 16px;\n  font-weight: 400;\n  line-height: 1.25;\n  letter-spacing: 0.5px;\n  text-align: left;\n  color: #ffffff; }\n\np-confirmDialog.management-dialog .ui-dialog-footer.ui-widget-content {\n  padding: 0 24px 24px 24px; }\n\np-confirmDialog.management-dialog .reject {\n  margin-right: 8px; }\n\np-confirmDialog.management-dialog .warning-icon {\n  position: absolute;\n  bottom: 15px;\n  left: 25px;\n  height: 40px;\n  width: 40px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/40/warn.svg")) + ") no-repeat top left; }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/shared/components/managment-confirm-dialog/management-confirm-dialog.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ManagementConfirmDialogComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let ManagementConfirmDialogComponent = class ManagementConfirmDialogComponent {
    constructor() {
        this.BUTTON_SIZE = {
            small: 'small',
            large: 'large'
        };
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", String)
], ManagementConfirmDialogComponent.prototype, "confirm_dialog_key", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", String)
], ManagementConfirmDialogComponent.prototype, "reject_button_text", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", String)
], ManagementConfirmDialogComponent.prototype, "accept_button_text", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", String)
], ManagementConfirmDialogComponent.prototype, "accept_button_size", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", String)
], ManagementConfirmDialogComponent.prototype, "personalize_class", void 0);
ManagementConfirmDialogComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'management-confirm-dialog',
        encapsulation: __WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewEncapsulation"].None,
        template: __webpack_require__("../../../../../src/shared/components/managment-confirm-dialog/management-confirm-dialog.component.html"),
        styles: [__webpack_require__("../../../../../src/shared/components/managment-confirm-dialog/management-confirm-dialog.component.scss")]
    })
], ManagementConfirmDialogComponent);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/management-confirm-dialog.component.js.map

/***/ }),

/***/ "../../../../../src/shared/components/managment-confirm-dialog/menagement-confirm-dialog.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__ = __webpack_require__("../../../platform-browser/@angular/platform-browser.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_infra_infra_module__ = __webpack_require__("../../../../../src/shared/services/infra/infra.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__managment_confirm_dialog_management_confirm_dialog_component__ = __webpack_require__("../../../../../src/shared/components/managment-confirm-dialog/management-confirm-dialog.component.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_primeng_components_confirmdialog_confirmdialog__ = __webpack_require__("../../../../primeng/components/confirmdialog/confirmdialog.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_primeng_components_confirmdialog_confirmdialog___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_primeng_components_confirmdialog_confirmdialog__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__directives_shared_directives_module__ = __webpack_require__("../../../../../src/shared/directives/shared-directives.module.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ManagementConfirmDialogModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};







let ManagementConfirmDialogModule = class ManagementConfirmDialogModule {
};
ManagementConfirmDialogModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [
            __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__["BrowserModule"],
            __WEBPACK_IMPORTED_MODULE_2__services_infra_infra_module__["a" /* InfraModule */],
            __WEBPACK_IMPORTED_MODULE_3_ng2_translate__["a" /* TranslateModule */].forRoot(),
            __WEBPACK_IMPORTED_MODULE_5_primeng_components_confirmdialog_confirmdialog__["ConfirmDialogModule"],
            __WEBPACK_IMPORTED_MODULE_6__directives_shared_directives_module__["a" /* SharedDirectives */]
        ],
        declarations: [
            __WEBPACK_IMPORTED_MODULE_4__managment_confirm_dialog_management_confirm_dialog_component__["a" /* ManagementConfirmDialogComponent */]
        ],
        exports: [
            __WEBPACK_IMPORTED_MODULE_4__managment_confirm_dialog_management_confirm_dialog_component__["a" /* ManagementConfirmDialogComponent */]
        ]
    })
], ManagementConfirmDialogModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/menagement-confirm-dialog.module.js.map

/***/ }),

/***/ "../../../../../src/shared/components/user-login/user-login.component.html":
/***/ (function(module, exports) {

module.exports = "<div class=\"user-login-component\">\r\n\r\n    <div class=\"user-login-panel\">\r\n\r\n        <iframe *ngIf=\"loginUrl && !displayErrorMessage\" width=\"100%\" height=\"100%\" #iframe [src]=\"loginUrl\" (load)=\"onLoad()\"></iframe>\r\n\r\n        <button *ngIf=\"displayCancelButton\" (click)=\"cancelLogin()\" [ngClass]=\"cancelLoginButtonStyle\"\r\n                class=\"user-login-cancel-button user-login-cancel-icon\"></button>\r\n\r\n        <div *ngIf=\"displayErrorMessage\" class=\"login-error-container\">\r\n          <div class=\"non-valid-inner-container\" [attr.aria-label]=\"errorMessageString | translate\">\r\n            <div class=\"non-valid-url-alert\"></div>\r\n            <div class=\"non-valid-url-text\">\r\n              {{ errorMessageString | translate}}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      <div *ngIf=\"displayLoader\" class=\"loader\"></div>\r\n    </div>\r\n\r\n</div>\r\n\r\n"

/***/ }),

/***/ "../../../../../src/shared/components/user-login/user-login.component.scss":
/***/ (function(module, exports, __webpack_require__) {

var escape = __webpack_require__("../../../../css-loader/lib/url/escape.js");
exports = module.exports = __webpack_require__("../../../../css-loader/lib/css-base.js")(false);
// imports


// module
exports.push([module.i, "iframe {\n  background-color: #333333;\n  border: none; }\n\n.user-login-component {\n  position: relative;\n  height: 100%;\n  width: 100%; }\n\n.user-login-panel {\n  position: relative;\n  height: 306px;\n  width: 545px;\n  margin: 3.1% auto;\n  box-shadow: 0 2px 15px 0 rgba(0, 0, 0, 0.25);\n  border: solid 2px #ffffff;\n  background-color: #333333; }\n\n.device-settings-header {\n  height: 66px; }\n\n.device-settings-icon-container {\n  position: relative;\n  height: 66px;\n  width: 66px;\n  background-color: #04af8e;\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n  margin: 0 16px 0 0;\n  float: left; }\n\n.device-settings-icon {\n  position: absolute;\n  top: calc(50% - 10px);\n  left: calc(50% - 10px);\n  display: inline-block;\n  height: 20px;\n  width: 20px; }\n\n.device-settings-text {\n  line-height: 66px;\n  opacity: 0.5;\n  font-family: Lato;\n  font-size: 14px;\n  font-weight: 600;\n  font-style: normal;\n  font-stretch: normal;\n  color: #ffffff; }\n\n.device-settings-confirm-buttons {\n  padding: 0; }\n\n.device-settings-back-button {\n  float: right;\n  margin-top: 14px;\n  margin-right: 14px; }\n\n.device-settings-body {\n  position: relative;\n  height: calc(100% - 96px);\n  margin: 0;\n  margin-right: 26px;\n  padding: 26px 43px 0 85px; }\n\n.device-settings-col {\n  padding-bottom: 35px; }\n\n.settings-field-title {\n  width: 221px;\n  height: 15px;\n  font-family: Lato;\n  font-size: 12px;\n  font-weight: normal;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  color: #f1f1f1;\n  padding-bottom: 13px; }\n\n.settings-note {\n  margin-top: 10px;\n  width: 154px;\n  height: 15px;\n  font-family: Lato;\n  font-size: 12px;\n  font-weight: normal;\n  font-style: italic;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  color: #999999; }\n\n.sep-line {\n  width: 100%;\n  height: 1px;\n  border-radius: 1px;\n  background-color: rgba(255, 255, 255, 0.2);\n  margin-bottom: 35px; }\n\n.auth-loading {\n  width: 100%;\n  height: 100%;\n  background-color: grey; }\n\n.user-login-cancel-icon {\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/20/exit.svg")) + ") no-repeat top left; }\n\n.user-login-cancel-button {\n  -webkit-app-region: no-drag;\n  display: block;\n  border: none;\n  height: 20px;\n  width: 20px;\n  background-size: 20px 20px;\n  opacity: 0.5;\n  position: absolute;\n  top: 8px;\n  right: 8px; }\n\n.cancelLoginScrollLocation {\n  right: 30px; }\n\n.user-login-cancel-button:hover, .user-login-cancel-button:active {\n  outline: none;\n  cursor: pointer;\n  opacity: 1; }\n\n.user-login-cancel-button:focus {\n  outline: none;\n  opacity: 1; }\n\n.login-error-container {\n  width: 545px;\n  height: 306px; }\n\n.non-valid-inner-container {\n  position: absolute;\n  height: 100px;\n  top: calc(50% - 50px);\n  padding: 20px; }\n\n.non-valid-url-text {\n  font-family: 'Lato';\n  font-size: 20px;\n  font-weight: 400;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  text-align: center;\n  color: #ffffff; }\n\n.non-valid-url-alert {\n  margin-right: 5px;\n  float: left;\n  height: 40px;\n  width: 40px;\n  background: url(" + escape(__webpack_require__("../../../../../src/assets/svg/40/warn.svg")) + ") no-repeat top left; }\n\n.loader {\n  bottom: calc(50% - 3px);\n  left: calc(50% - 131px);\n  height: 6px;\n  width: 50%;\n  position: absolute;\n  overflow: hidden;\n  background-color: #333333; }\n\n.loader:before {\n  display: block;\n  position: absolute;\n  content: \"\";\n  left: -600px;\n  width: 400px;\n  height: 6px;\n  background-color: #04af8e;\n  background: -webkit-linear-gradient(left, rgba(4, 176, 142, 0) 0%, #04b08e 20%, #04b08e 80%, rgba(4, 176, 142, 0) 100%);\n  animation: loading 2s linear infinite; }\n\n@keyframes loading {\n  from {\n    left: -500px; }\n  to {\n    left: +600px; } }\n", ""]);

// exports


/*** EXPORTS FROM exports-loader ***/
module.exports = module.exports.toString();

/***/ }),

/***/ "../../../../../src/shared/components/user-login/user-login.component.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_platform_browser__ = __webpack_require__("../../../platform-browser/@angular/platform-browser.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_infra_authentication_service__ = __webpack_require__("../../../../../src/shared/services/infra/authentication.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return UserLoginComponent; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let UserLoginComponent = class UserLoginComponent {
    constructor(log, sanitizer, authService) {
        this.log = log;
        this.sanitizer = sanitizer;
        this.authService = authService;
        this.onSuccessfulSubmit = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        this.onCancelClick = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        this.loginUrl = '';
        this.displayErrorMessage = false;
        this.errorMessageString = '';
        this.displayLoader = true;
        this.displayCancelButton = false; //since we are patching a cancel button on top of login iframe, we want to do it in time...
        this.cancelLoginButtonStyle = '';
    }
    ngOnInit() {
        this.setLoginUrl();
    }
    setLoginUrl() {
        this.authService.getAuthLoginUrl()
            .then((url) => {
            this.loginUrl = this.sanitizer.bypassSecurityTrustResourceUrl(url);
        })
            .catch(() => {
            this.displayLoader = false;
            this.setErrorMessage("NOTIFICATIONS.auth_url_invalid");
            this.displayCancelButton = true;
        });
    }
    onLoad() {
        this.log.info('user login external site was loaded');
        if (!this.iframe)
            return;
        this.displayLoader = true;
        let iDoc = this.iframe.nativeElement.contentDocument;
        this.updateCancelLoginButtonStyle(iDoc.body);
        try {
            let userData = JSON.parse(iDoc.body.innerText.trim());
            if (userData.errorCode) {
                this.handleLoginErrors();
            }
            else if (userData.userId) {
                this.authService.logIn(userData);
                this.log.info('User was logged in');
                this.onSuccessfulSubmit.emit(true);
            }
        }
        catch (e) {
            this.log.info('User was not authenticated. ' + e);
            this.displayLoader = false;
        }
        setTimeout(() => {
            this.displayCancelButton = true;
        }, 1000);
    }
    cancelLogin() {
        this.displayLoader = true;
        this.authService.logOut()
            .then(() => {
            this.onCancelClick.emit(true);
        });
    }
    updateCancelLoginButtonStyle(iframeBody) {
        this.cancelLoginButtonStyle = (iframeBody.scrollHeight === this.iframe.nativeElement.clientHeight) ? '' : 'cancelLoginScrollLocation';
    }
    setErrorMessage(errMsg) {
        this.displayErrorMessage = true;
        this.errorMessageString = errMsg;
    }
    /**
     * todo - for more advanced error handling we can use error codes and display relevant error messages
     */
    handleLoginErrors() {
        this.displayLoader = false;
        this.setErrorMessage('NOTIFICATIONS.auth_no_permissions');
        setTimeout(() => {
            this.cancelLogin();
        }, 5000);
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["ViewChild"])('iframe'),
    __metadata("design:type", typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _a || Object)
], UserLoginComponent.prototype, "iframe", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
    __metadata("design:type", Object)
], UserLoginComponent.prototype, "onSuccessfulSubmit", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
    __metadata("design:type", Object)
], UserLoginComponent.prototype, "onCancelClick", void 0);
UserLoginComponent = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Component"])({
        selector: 'user-login-dialog',
        template: __webpack_require__("../../../../../src/shared/components/user-login/user-login.component.html"),
        styles: [__webpack_require__("../../../../../src/shared/components/user-login/user-login.component.scss")]
    }),
    __metadata("design:paramtypes", [typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_2__angular_platform_browser__["DomSanitizer"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__angular_platform_browser__["DomSanitizer"]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_3__services_infra_authentication_service__["a" /* AuthenticationService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__services_infra_authentication_service__["a" /* AuthenticationService */]) === "function" && _d || Object])
], UserLoginComponent);

var _a, _b, _c, _d;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/user-login.component.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/auto-resize-textarea.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AutoResizeTextarea; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

let AutoResizeTextarea = class AutoResizeTextarea {
    constructor(element) {
        this.element = element;
        this.element.nativeElement.style.resize = 'none';
        this.element.nativeElement.style['line-height'] = '1';
        this.element.nativeElement.style['padding-bottom'] = '2px';
        this.element.nativeElement.style['margin-bottom'] = '0';
        this.element.nativeElement.style.height = this.getRowMultiplier();
        this.element.nativeElement.style.overflow = 'auto';
    }
    onInput(event) {
        let that = this;
        setTimeout(function () {
            that.adjust();
        });
    }
    ngAfterViewInit() {
        let that = this;
        setTimeout(function () {
            that.adjust();
        });
    }
    adjust() {
        this.element.nativeElement.style.height = 'auto';
        this.element.nativeElement.style.height = this.getRowMultiplier();
    }
    getRowMultiplier() {
        let rowsCount = Math.round(this.element.nativeElement.scrollHeight / this.rowHeight);
        return rowsCount > this.maxRows ?
            (this.maxRows * this.rowHeight + 'px') : (rowsCount * this.rowHeight + 'px');
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object)
], AutoResizeTextarea.prototype, "maxRows", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object)
], AutoResizeTextarea.prototype, "rowHeight", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('document:keydown', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], AutoResizeTextarea.prototype, "onInput", null);
AutoResizeTextarea = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: 'textarea[auto-resize]'
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _a || Object])
], AutoResizeTextarea);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/auto-resize-textarea.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/dialog-addon.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_confirmdialog_confirmdialog__ = __webpack_require__("../../../../primeng/components/confirmdialog/confirmdialog.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_confirmdialog_confirmdialog___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_primeng_components_confirmdialog_confirmdialog__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_primeng_components_common_confirmationservice__ = __webpack_require__("../../../../primeng/components/common/confirmationservice.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_primeng_components_common_confirmationservice___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_primeng_components_common_confirmationservice__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__services_infra_accessability_service__ = __webpack_require__("../../../../../src/shared/services/infra/accessability.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DialogAddon; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};




/*
* The purpose of this directive is to set and remove tabindex because the dialog msg box is always visible.
* and if we will put it permanently the tab will hit an empty box, and if we put tabindex on the not-visible part
* the order of the navigation will be wrong.
* */
let DialogAddon = class DialogAddon {
    constructor(component, confirmationService, elementRef, accessibilityService) {
        this.confirmationService = confirmationService;
        this.elementRef = elementRef;
        this.accessibilityService = accessibilityService;
        this.dialog = component;
        this.confirmSubscription = confirmationService.requireConfirmation$
            .delay(200)
            .subscribe((confirmation) => {
            if (confirmation.key === this.dialog.key) {
                this.elementRef.nativeElement.setAttribute("aria-label", this.dialog.message);
                // set focus on the first button of the dialog.
                let lastKeyCode = this.accessibilityService.getLastCode();
                if (lastKeyCode === 'Enter' || lastKeyCode === "Space" || lastKeyCode === "NumpadEnter") {
                    this.accessibilityService.setLastCode(null);
                    setTimeout(() => {
                        let button = this.elementRef.nativeElement.querySelector('button');
                        if (button) {
                            button.classList.add('keyboard-focus');
                            button.focus();
                        }
                    });
                }
                else {
                    this.removeKeyboardFocus();
                }
            }
        });
    }
    /*
    * remove the tabindex. - otherwise we will hit at tab navigation
    * */
    ngAfterViewInit() {
        let footer = this.elementRef.nativeElement.querySelector('p-footer');
        if (footer)
            footer.classList.add('dialog-footer');
        let that = this; //do not remove
        // Save original function
        let onHideOriginalFunc = this.dialog.hide;
        //override original keyDown function
        this.dialog.hide = function () {
            // the dialog is a general component, and we want to keep the message updated
            that.elementRef.nativeElement.removeAttribute("tabindex");
            that.elementRef.nativeElement.removeAttribute("aria-label");
            //call original onKeyDown function
            onHideOriginalFunc.call(that.dialog);
        };
        Object.defineProperty(this.dialog, '_visible', {
            get: function () {
                return this.__visible;
            },
            set: function (isDialogVisible) {
                //return if visibility didn't change
                if (this.__visible === isDialogVisible)
                    return;
                //set new panel state
                this.__visible = isDialogVisible;
                that.accessibilityService.toggleNavLimitationOnDialog(this.__visible, that.elementRef.nativeElement);
                // remove focus on the first button of the dialog.
                if (!this.__visible && that.elementRef) {
                    that.removeKeyboardFocus();
                }
            },
            enumerable: true,
            configurable: true
        });
    }
    removeKeyboardFocus() {
        setTimeout(() => {
            let button = this.elementRef.nativeElement.querySelector('button');
            if (button) {
                button.classList.remove('keyboard-focus');
            }
        });
    }
    ngOnDestroy() {
        this.confirmSubscription.unsubscribe();
    }
};
DialogAddon = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[dialog-addon]',
    }),
    __param(0, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Self"])()),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_primeng_components_confirmdialog_confirmdialog__["ConfirmDialog"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_primeng_components_confirmdialog_confirmdialog__["ConfirmDialog"]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_2_primeng_components_common_confirmationservice__["ConfirmationService"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2_primeng_components_common_confirmationservice__["ConfirmationService"]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_3__services_infra_accessability_service__["a" /* AccessibilityService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__services_infra_accessability_service__["a" /* AccessibilityService */]) === "function" && _d || Object])
], DialogAddon);

var _a, _b, _c, _d;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/dialog-addon.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/dropdown-addon.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_dropdown_dropdown__ = __webpack_require__("../../../../primeng/components/dropdown/dropdown.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_dropdown_dropdown___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_primeng_components_dropdown_dropdown__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DropdownAddon; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};



/**
 * Enhancement features for ngPrime dropdown:
 * 1. Dropdown behaviour changes - Arrows (Up/Down) will not select item only after Enter/Space
 *
 * 2. Accessibility:
 *    * Tab, Enter and Arrows (Up/Down) navigation are achieved
 *    * Screen reader support due to adding WAI-ARIA attributes
 *
 * 3. Scroll to Element option when needed - in case at the bottom of a scroll div (Css limitation issue)
 */
let DropdownAddon = class DropdownAddon {
    constructor(component, elementRef) {
        this.elementRef = elementRef;
        this.onCustomChange = new __WEBPACK_IMPORTED_MODULE_0__angular_core__["EventEmitter"]();
        this.dropdown = component;
        this.isFirstArrow = true;
        this.listenToPanelVisibilityAndEmitChange();
    }
    ngAfterViewInit() {
        let that = this; //do not remove
        // Save original keyDown function
        let onKeydownOriginalFunc = this.dropdown.onKeydown;
        //override original keyDown function
        this.dropdown.onKeydown = function (event) {
            if (event.altKey || event.metaKey)
                return;
            //saving last key event for the setter handling
            that.lastKeydownEvent = event;
            // if dropdown is closed - on arrow down: open the dropdown
            if (!this.panelVisible && (event.code === 'ArrowDown' || event.code === 'ArrowUp' || event.code === 'Enter')) {
                that.initialSelection = this.selectedOption;
                that.isFirstArrow = false;
                this.show(this.panel, this.container);
                if (event.code === 'Enter') {
                    return;
                }
            }
            else if (event.code === 'Enter' || event.code === 'Escape') {
                // On Enter or on Escape reset isFirstArrow (to be first arrow in the new arrow key-down)
                that.isFirstArrow = true;
            }
            //call original onKeyDown function
            onKeydownOriginalFunc.call(that.dropdown, event);
        };
        // At last, add accessibility for the dropdown
        this.addDropdownAccessibility();
    }
    listenToPanelVisibilityAndEmitChange() {
        let that = this; //do not remove
        this.dropdown._panelVisible = false; // init it to close
        Object.defineProperty(this.dropdown, 'panelVisible', {
            get: function () {
                return this._panelVisible;
            },
            set: function (isPanelVisible) {
                that.addListItemAccessibilityOnRuntime(isPanelVisible);
                //return if panel visibility didn't change
                if (this._panelVisible === isPanelVisible)
                    return;
                //set new panel state
                this._panelVisible = isPanelVisible;
                // on escape: return and set initial selection
                if (that.lastKeydownEvent && that.lastKeydownEvent.code === 'Escape') {
                    this.selectedOption = that.initialSelection;
                    this.value = that.initialSelection.value;
                    that.lastKeydownEvent = null;
                    return;
                }
                //on first opening of the panel - save initial selection
                if (isPanelVisible) {
                    that.initialSelection = this.selectedOption;
                }
                else if (this.selectedOption) {
                    //panel was closed and we want to trigger change event if needed
                    let isValueChanged = that.initialSelection ? (that.initialSelection.value !== this.selectedOption.value) : true;
                    if (isValueChanged) {
                        that.initialSelection = this.selectedOption;
                        that.lastKeydownEvent = null;
                        // choose the new selection
                        // ngPrime: dropdown.ts: onKeydown(event) like down case + impl as selectItem(event, option)
                        this.selectedOptionUpdated = true;
                        this.value = this.selectedOption.value;
                        this.onModelChange(this.value);
                        that.onCustomChange.emit();
                    }
                }
                that.autoScrollToElement(isPanelVisible);
            },
            enumerable: true,
            configurable: true
        });
    }
    autoScrollToElement(isPanelVisible) {
        if (this.isAutoScrollToElement === true && isPanelVisible) {
            setTimeout(() => {
                let elem = this.elementRef.nativeElement.querySelector('.ui-dropdown-items-wrapper');
                if (elem)
                    elem.scrollIntoView({ block: "start", behavior: "smooth" });
            });
        }
    }
    addListItemAccessibilityOnRuntime(isPanelVisible) {
        if (isPanelVisible) {
            setTimeout(() => {
                let uiDropdownList = this.elementRef.nativeElement.querySelector('.ui-dropdown-list');
                if (uiDropdownList) {
                    uiDropdownList.setAttribute("role", "menu");
                }
                let uiDropdownItems = this.elementRef.nativeElement.querySelectorAll('.ui-dropdown-item');
                if (uiDropdownItems) {
                    __WEBPACK_IMPORTED_MODULE_2_lodash__["each"](uiDropdownItems, (dropdownItem) => {
                        dropdownItem.setAttribute("role", "menuitem");
                    });
                }
            });
        }
    }
    addDropdownAccessibility() {
        let uiDropdownPanel = this.elementRef.nativeElement.querySelector('.ui-dropdown-panel');
        if (uiDropdownPanel)
            uiDropdownPanel.setAttribute("role", "none");
        let uiDropdownItemsWrapper = this.elementRef.nativeElement.querySelector('.ui-dropdown-items-wrapper');
        if (uiDropdownItemsWrapper)
            uiDropdownItemsWrapper.setAttribute("role", "none");
        let uiHelperHiddenAccessible = this.elementRef.nativeElement.querySelectorAll('.ui-helper-hidden-accessible');
        if (uiHelperHiddenAccessible && uiHelperHiddenAccessible[1])
            uiHelperHiddenAccessible[1].setAttribute("role", "none");
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Output"])(),
    __metadata("design:type", Object)
], DropdownAddon.prototype, "onCustomChange", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])('dropdown-addon-autoscroll'),
    __metadata("design:type", Boolean)
], DropdownAddon.prototype, "isAutoScrollToElement", void 0);
DropdownAddon = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[dropdown-addon]',
    }),
    __param(0, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Self"])()),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_primeng_components_dropdown_dropdown__["Dropdown"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_primeng_components_dropdown_dropdown__["Dropdown"]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _b || Object])
], DropdownAddon);

var _a, _b;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/dropdown-addon.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/fit-text.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return FitText; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};

/**
 * auto fix text into an element height
 * //todo handle width as well
 */
let FitText = class FitText {
    constructor(el) {
        this.minFontSize = 10;
        this.defaultFontSize = 10;
        this.element = el.nativeElement;
    }
    ngAfterViewInit() {
        if (!this.element)
            return;
        while (this.element.clientHeight < this.element.scrollHeight) {
            this.decreaseFontSize();
        }
    }
    decreaseFontSize() {
        let size = this.getCurrentFontSize();
        this.element.style.fontSize = --size + 'px';
    }
    getCurrentFontSize() {
        let fontSize = window.getComputedStyle(this.element, null).getPropertyValue('font-size');
        return fontSize ? parseInt(fontSize) : this.defaultFontSize;
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object)
], FitText.prototype, "minFontSize", void 0);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object)
], FitText.prototype, "defaultFontSize", void 0);
FitText = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[fit-text]',
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _a || Object])
], FitText);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/fit-text.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/shared-directives.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__auto_resize_textarea__ = __webpack_require__("../../../../../src/shared/directives/auto-resize-textarea.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__dropdown_addon__ = __webpack_require__("../../../../../src/shared/directives/dropdown-addon.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__spinner_number__ = __webpack_require__("../../../../../src/shared/directives/spinner-number.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__tags_chips__ = __webpack_require__("../../../../../src/shared/directives/tags-chips.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__tooltip_addon__ = __webpack_require__("../../../../../src/shared/directives/tooltip-addon.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__dialog_addon__ = __webpack_require__("../../../../../src/shared/directives/dialog-addon.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__tags_autocomplete__ = __webpack_require__("../../../../../src/shared/directives/tags-autocomplete.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__fit_text__ = __webpack_require__("../../../../../src/shared/directives/fit-text.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__toggled_click_through_addon__ = __webpack_require__("../../../../../src/shared/directives/toggled-click-through-addon.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SharedDirectives; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};










let SharedDirectives = class SharedDirectives {
};
SharedDirectives = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        declarations: [
            __WEBPACK_IMPORTED_MODULE_1__auto_resize_textarea__["a" /* AutoResizeTextarea */],
            __WEBPACK_IMPORTED_MODULE_2__dropdown_addon__["a" /* DropdownAddon */],
            __WEBPACK_IMPORTED_MODULE_3__spinner_number__["a" /* SpinnerNumber */],
            __WEBPACK_IMPORTED_MODULE_4__tags_chips__["a" /* TagsChips */],
            __WEBPACK_IMPORTED_MODULE_5__tooltip_addon__["a" /* TooltipAddon */],
            __WEBPACK_IMPORTED_MODULE_6__dialog_addon__["a" /* DialogAddon */],
            __WEBPACK_IMPORTED_MODULE_7__tags_autocomplete__["a" /* TagsAutocomplete */],
            __WEBPACK_IMPORTED_MODULE_8__fit_text__["a" /* FitText */],
            __WEBPACK_IMPORTED_MODULE_9__toggled_click_through_addon__["a" /* ToggledClickThroughAddon */]
        ],
        exports: [
            __WEBPACK_IMPORTED_MODULE_1__auto_resize_textarea__["a" /* AutoResizeTextarea */],
            __WEBPACK_IMPORTED_MODULE_2__dropdown_addon__["a" /* DropdownAddon */],
            __WEBPACK_IMPORTED_MODULE_3__spinner_number__["a" /* SpinnerNumber */],
            __WEBPACK_IMPORTED_MODULE_4__tags_chips__["a" /* TagsChips */],
            __WEBPACK_IMPORTED_MODULE_5__tooltip_addon__["a" /* TooltipAddon */],
            __WEBPACK_IMPORTED_MODULE_6__dialog_addon__["a" /* DialogAddon */],
            __WEBPACK_IMPORTED_MODULE_7__tags_autocomplete__["a" /* TagsAutocomplete */],
            __WEBPACK_IMPORTED_MODULE_8__fit_text__["a" /* FitText */],
            __WEBPACK_IMPORTED_MODULE_9__toggled_click_through_addon__["a" /* ToggledClickThroughAddon */]
        ]
    })
], SharedDirectives);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/shared-directives.module.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/spinner-number.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_spinner_spinner__ = __webpack_require__("../../../../primeng/components/spinner/spinner.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_spinner_spinner___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_primeng_components_spinner_spinner__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SpinnerNumber; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
/**
 * Created by igor.shevach on 7/20/2017.
 */



let SpinnerNumber = class SpinnerNumber {
    constructor(component, logger) {
        this.logger = logger;
        this.spinner = component;
    }
    // hook min/max properties to calculate maxlength value
    set min(value) {
        value = Number(value);
        if (this.spinner.min !== value) {
            this.logger.info("SpinnerNumber.setMin " + this.spinner.min + " value " + value);
            this.spinner.min = value;
            this.updateInputLength();
        }
    }
    set max(value) {
        value = Number(value);
        if (this.spinner.max !== value) {
            this.logger.info("SpinnerNumber.setMax " + this.spinner.max + " value " + value);
            this.spinner.max = value;
            this.updateInputLength();
        }
    }
    ngAfterViewInit() {
        this.logger.debug("SpinnerNumber.ngAfterViewInit");
        //remember input element which is 1-st child of span which 1-st child of p-spinner element
        this.inputEl = this.spinner.el.nativeElement.querySelector("input");
        /*
          spinner has nasty behaviour:
          when completely deleting contents of an input it decides to display spinner.min
        */
        let parseValue = this.spinner.parseValue.bind(this.spinner);
        this.spinner.parseValue = (val) => {
            if (val.trim() === '') {
                this.logger.debug("empty value! -> " + this.spinner.value);
                return this.spinner.value;
            }
            else {
                return parseValue(val);
            }
        };
        /*
          make sure to sync this.spinner.valueAsString with contents of an input at all times:
          when underlying logic decides not to update valueAsString/value of a spinner
          then input looks completely out of sync
        */
        let formatValue = this.spinner.formatValue.bind(this.spinner);
        this.spinner.formatValue = () => {
            formatValue();
            this.inputEl.value = this.spinner.valueAsString;
        };
    } //end of ngAfterViewInit
    // calculate string length for particular value val
    getValLength(val) {
        this.spinner.value = val;
        this.spinner.formatValue();
        this.logger.info("value " + val + " -> " + this.spinner.valueAsString + " = " + this.spinner.valueAsString.length);
        return this.spinner.valueAsString.length;
    }
    ;
    // calculate maxlength property for specific min-max range
    updateInputLength() {
        let value = this.spinner.value;
        let maxlength = Math.max(this.getValLength(this.spinner.min), this.getValLength(this.spinner.max));
        this.spinner.value = value;
        this.spinner.formatValue();
        this.logger.info("SpinnerNumber.updateInputLength range: " + this.spinner.min + " " + this.spinner.max + " maxlength: " + maxlength);
        this.spinner.maxlength = maxlength;
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], SpinnerNumber.prototype, "min", null);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Input"])(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], SpinnerNumber.prototype, "max", null);
SpinnerNumber = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[spinner-number]',
    }),
    __param(0, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Self"])()),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_primeng_components_spinner_spinner__["Spinner"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_primeng_components_spinner_spinner__["Spinner"]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_2__services_infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__services_infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object])
], SpinnerNumber);

var _a, _b;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/spinner-number.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/tags-autocomplete.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_autocomplete_autocomplete__ = __webpack_require__("../../../../primeng/components/autocomplete/autocomplete.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_autocomplete_autocomplete___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_primeng_components_autocomplete_autocomplete__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TagsAutocomplete; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};


let TagsAutocomplete = class TagsAutocomplete {
    constructor(component, elementRef) {
        this.elementRef = elementRef;
        this.enterEvent = {
            which: 13,
            preventDefault: function () {
                return;
            }
        };
        this.escaped = false;
        this.autocomplete = component;
    }
    ngAfterViewInit() {
        this.changeIsSelected();
        this.modifyChipsOriginalFunctions();
        this.registerUIEvents();
    }
    registerUIEvents() {
        let element = this.elementRef.nativeElement.querySelectorAll('.ui-autocomplete-input-token>input')[0];
        element.onblur = () => {
            if (this.escaped) {
                element.value = "";
                this.autocomplete.highlightOption = '';
                this.autocomplete.hide();
                this.escaped = false;
            }
            else if (!this.autocomplete.panelVisible) {
                this.autocomplete.onKeydown(this.enterEvent, this.elementRef.nativeElement.querySelectorAll('.ui-autocomplete-input-token>input')[0]);
            }
        };
    }
    changeIsSelected() {
        this.autocomplete.isSelected = (val) => {
            return false;
        };
    }
    modifyChipsOriginalFunctions() {
        let that = this;
        this.escaped = false;
        let originalKeydown = this.autocomplete.onKeydown;
        this.autocomplete.onKeydown = (event, inputEL) => {
            switch (event.which) {
                case 27:
                    this.escaped = true;
                    break;
                case 13:
                case 186:
                case 188:
                    this.autocomplete.highlightOption =
                        this.autocomplete.highlightOption ?
                            this.autocomplete.highlightOption :
                            this.elementRef.nativeElement.querySelectorAll('.ui-autocomplete-input-token>input')[0].value;
                    if (this.autocomplete.highlightOption.trim()) {
                        this.autocomplete.highlightOption = this.autocomplete.highlightOption.substring(0, 255); //tags limitation in kaltura server
                        this.autocomplete.selectItem(this.autocomplete.highlightOption);
                        this.autocomplete.highlightOption = '';
                        this.autocomplete.hide();
                    }
                    event.preventDefault();
                    break;
                default:
                    originalKeydown.call(that.autocomplete, event, inputEL);
                    break;
            }
        };
        let origSelectItem = this.autocomplete.selectItem;
        this.autocomplete.selectItem = (option) => {
            //first call original func.
            origSelectItem.call(that.autocomplete, option);
            //clearing values to avoid duplication by OnBlur event (due do mouse click)
            this.autocomplete.highlightOption = '';
            this.autocomplete.hide();
        };
    }
};
TagsAutocomplete = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[tags-autocomplete]',
    }),
    __param(0, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Self"])()),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_primeng_components_autocomplete_autocomplete__["AutoComplete"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_primeng_components_autocomplete_autocomplete__["AutoComplete"]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _b || Object])
], TagsAutocomplete);

var _a, _b;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/tags-autocomplete.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/tags-chips.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_chips_chips__ = __webpack_require__("../../../../primeng/components/chips/chips.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_chips_chips___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_primeng_components_chips_chips__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TagsChips; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};


let TagsChips = class TagsChips {
    constructor(component, elementRef) {
        this.elementRef = elementRef;
        this.enterEvent = {
            which: 13,
            preventDefault: function () {
                return;
            }
        };
        this.chips = component;
    }
    ngAfterViewInit() {
        let source = this.elementRef.nativeElement.querySelectorAll('.ui-chips-input-token>input');
        //set max tag length to 255 chars
        if (source[0])
            source[0].maxLength = 255;
        //add tag on blur
        this.chips.registerOnTouched(() => {
            //adding new tag 'on blur'
            let blurred = this.elementRef.nativeElement.querySelectorAll('.ui-chips-input-token>input');
            if (blurred[0] && blurred[0]['value']) {
                this.chips.onKeydown(this.enterEvent, source[0]);
            }
        });
        this.modifyChipsOnKeydown();
    }
    modifyChipsOnKeydown() {
        let that = this;
        let originalKeydown = this.chips.onKeydown;
        this.chips.onKeydown = (event, inputEL) => {
            switch (event.which) {
                case 186:
                case 188:
                    originalKeydown.call(that.chips, this.enterEvent, inputEL);
                    event.preventDefault();
                    break;
                default:
                    originalKeydown.call(that.chips, event, inputEL);
                    break;
            }
        };
    }
};
TagsChips = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[tags-chips]',
    }),
    __param(0, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Self"])()),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_primeng_components_chips_chips__["Chips"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_primeng_components_chips_chips__["Chips"]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _b || Object])
], TagsChips);

var _a, _b;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/tags-chips.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/toggled-click-through-addon.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ToggledClickThroughAddon; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let ToggledClickThroughAddon = class ToggledClickThroughAddon {
    constructor(elementRef) {
        this.elementRef = elementRef;
    }
    onMouseOver(target) {
        if (this.elementRef.nativeElement.className === target.className) {
            __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC("setIgnoreMouseEvents", true);
        }
    }
    onMouseOut(target) {
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC("setIgnoreMouseEvents", false);
    }
    ngOnDestroy() {
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC("setIgnoreMouseEvents", false);
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('mouseover', ['$event.target']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], ToggledClickThroughAddon.prototype, "onMouseOver", null);
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('mouseout', ['$event.target']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Object]),
    __metadata("design:returntype", void 0)
], ToggledClickThroughAddon.prototype, "onMouseOut", null);
ToggledClickThroughAddon = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[toggled-click-through-addon]',
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__angular_core__["ElementRef"]) === "function" && _a || Object])
], ToggledClickThroughAddon);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/toggled-click-through-addon.js.map

/***/ }),

/***/ "../../../../../src/shared/directives/tooltip-addon.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_tooltip_tooltip__ = __webpack_require__("../../../../primeng/components/tooltip/tooltip.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_primeng_components_tooltip_tooltip___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_primeng_components_tooltip_tooltip__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TooltipAddon; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};


let TooltipAddon = class TooltipAddon {
    constructor(component) {
        this.tooltip = component;
    }
    //make sure tooltips will be closed on app click (prevents overlap tooltips and dialogs)
    onDocumentClick() {
        if (this.tooltip.container) {
            this.tooltip.destroy();
        }
    }
    ngAfterViewInit() {
        let that = this; // Do not remove
        // Save original create function
        let originalCreateFunction = this.tooltip.create;
        //override original create function
        this.tooltip.create = function () {
            if (this.container) {
                this.destroy();
            }
            //call original create function
            originalCreateFunction.call(that.tooltip);
        };
    }
    ngOnDestroy() {
        this.tooltip.deactivate();
    }
};
__decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["HostListener"])('document:click', ['$event']),
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", void 0)
], TooltipAddon.prototype, "onDocumentClick", null);
TooltipAddon = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Directive"])({
        selector: '[tooltip-addon]',
    }),
    __param(0, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Self"])()),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_primeng_components_tooltip_tooltip__["Tooltip"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_primeng_components_tooltip_tooltip__["Tooltip"]) === "function" && _a || Object])
], TooltipAddon);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/tooltip-addon.js.map

/***/ }),

/***/ "../../../../../src/shared/pipes/duration.pipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_moment__ = __webpack_require__("../../../../moment/moment.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_moment___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_moment__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DurationPipe; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};



let DurationPipe = class DurationPipe {
    transform(durationNumber) {
        if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isFinite"](durationNumber)) {
            let duration = __WEBPACK_IMPORTED_MODULE_1_moment__["duration"](durationNumber);
            return this.padTo2Digits(duration.hours()) + ':' + this.padTo2Digits(duration.minutes()) + ':' + this.padTo2Digits(duration.seconds());
        }
        else {
            return '';
        }
    }
    padTo2Digits(number) {
        return (number < 10 ? '0' : '') + number;
    }
};
DurationPipe = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({
        name: 'duration'
    })
], DurationPipe);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/duration.pipe.js.map

/***/ }),

/***/ "../../../../../src/shared/pipes/safe.pipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__ = __webpack_require__("../../../platform-browser/@angular/platform-browser.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SafyPipe; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let SafyPipe = class SafyPipe {
    constructor(sanitizer) {
        this.sanitizer = sanitizer;
    }
    transform(html) {
        return this.sanitizer.bypassSecurityTrustHtml(html);
    }
};
SafyPipe = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({ name: 'safeHtml' }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__["DomSanitizer"] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__angular_platform_browser__["DomSanitizer"]) === "function" && _a || Object])
], SafyPipe);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/safe.pipe.js.map

/***/ }),

/***/ "../../../../../src/shared/pipes/shared-pipes.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__timer_pipe__ = __webpack_require__("../../../../../src/shared/pipes/timer.pipe.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__duration_pipe__ = __webpack_require__("../../../../../src/shared/pipes/duration.pipe.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__time_pipe__ = __webpack_require__("../../../../../src/shared/pipes/time.pipe.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__truncate_pipe__ = __webpack_require__("../../../../../src/shared/pipes/truncate.pipe.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__safe_pipe__ = __webpack_require__("../../../../../src/shared/pipes/safe.pipe.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SharedPipes; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};






let SharedPipes = class SharedPipes {
};
SharedPipes = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        declarations: [
            __WEBPACK_IMPORTED_MODULE_1__timer_pipe__["a" /* TimerPipe */],
            __WEBPACK_IMPORTED_MODULE_2__duration_pipe__["a" /* DurationPipe */],
            __WEBPACK_IMPORTED_MODULE_3__time_pipe__["a" /* TimePipe */],
            __WEBPACK_IMPORTED_MODULE_4__truncate_pipe__["a" /* TruncatePipe */],
            __WEBPACK_IMPORTED_MODULE_5__safe_pipe__["a" /* SafyPipe */]
        ],
        exports: [
            __WEBPACK_IMPORTED_MODULE_1__timer_pipe__["a" /* TimerPipe */],
            __WEBPACK_IMPORTED_MODULE_2__duration_pipe__["a" /* DurationPipe */],
            __WEBPACK_IMPORTED_MODULE_3__time_pipe__["a" /* TimePipe */],
            __WEBPACK_IMPORTED_MODULE_4__truncate_pipe__["a" /* TruncatePipe */],
            __WEBPACK_IMPORTED_MODULE_5__safe_pipe__["a" /* SafyPipe */]
        ]
    })
], SharedPipes);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/shared-pipes.module.js.map

/***/ }),

/***/ "../../../../../src/shared/pipes/time.pipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_moment__ = __webpack_require__("../../../../moment/moment.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_moment___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_moment__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__services_infra_system_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/system-data.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TimePipe; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let TimePipe = class TimePipe {
    constructor(systemData) {
        this.systemData = systemData;
    }
    transform(seconds, format, suffix) {
        let time = __WEBPACK_IMPORTED_MODULE_1_moment__(seconds).locale(this.systemData.getLang()).format(format);
        if (suffix === 'REMOVE_AM_PM_SUFFIX') {
            time = time.split(' ')[0];
        }
        else if (suffix === 'REMOVE_SPACES') {
            time = time.replace(' ', '').toLowerCase();
        }
        return time;
    }
};
TimePipe = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({
        name: 'time'
    }),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__services_infra_system_data_service__["a" /* SystemDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__services_infra_system_data_service__["a" /* SystemDataService */]) === "function" && _a || Object])
], TimePipe);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/time.pipe.js.map

/***/ }),

/***/ "../../../../../src/shared/pipes/timer.pipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TimerPipe; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};

let TimerPipe = class TimerPipe {
    transform(seconds) {
        seconds = Math.round(seconds);
        let hours = Math.floor(seconds / 3600);
        seconds = seconds - hours * 3600;
        let minutes = Math.floor(seconds / 60);
        seconds = seconds - minutes * 60;
        return this.getTimerString(hours, minutes, seconds);
    }
    getTimerString(hours, minutes, seconds) {
        return this.getAsTwoDigits(hours) + ':' + this.getAsTwoDigits(minutes) + ':' + this.getAsTwoDigits(seconds);
    }
    getAsTwoDigits(number) {
        return number < 10 ? '0' + number : number;
    }
};
TimerPipe = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({
        name: 'timer'
    })
], TimerPipe);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/timer.pipe.js.map

/***/ }),

/***/ "../../../../../src/shared/pipes/truncate.pipe.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return TruncatePipe; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};

let TruncatePipe = class TruncatePipe {
    transform(value, ...args) {
        let limit = args.length > 0 ? parseInt(args[0], 10) : 20;
        let trail = args.length > 1 ? args[1] : '...';
        return value.length > limit ? value.substring(0, limit) + trail : value;
    }
};
TruncatePipe = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Pipe"])({
        name: 'truncate'
    })
], TruncatePipe);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/truncate.pipe.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/audio-device-settings.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__device_settings_base_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-settings-base.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AudioDeviceSettingsService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










let AudioDeviceSettingsService = class AudioDeviceSettingsService extends __WEBPACK_IMPORTED_MODULE_8__device_settings_base_service__["a" /* DeviceSettingsServiceBase */] {
    constructor(persistencyService, appState, log, appConfig, devicePreviewService) {
        super(persistencyService, appState, log, appConfig);
        this.devicePreviewService = devicePreviewService;
        //
        this.isCaptureSystemAudioOn = null;
        this.selectedAudioDeviceDelay = 0;
        this.sinkStartTimeout = 10000;
        this.deviceDelayKey = '';
        this.addSession('audio');
    }
    set selectedAudioDevice(value) {
        this.sessions.audio.selectedDevice = value;
    }
    get selectedAudioDevice() {
        return this.sessions.audio.selectedDevice;
    }
    set selectedInputType(value) {
        this.sessions.audio.selectedInputType = value;
    }
    get selectedInputType() {
        return this.sessions.audio.selectedInputType;
    }
    get audioInputTypes() {
        return this.sessions.audio.InputTypes;
    }
    /**
     * always return a new promise for audio settings data
     * @returns {Promise<T>}
     */
    loadAudioUserSettings() {
        return this.loadUserSettings('audio');
    }
    loadAudioDeviceList() {
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getAudioDeviceList')
            .then((devices) => {
            let filteredDevices = __WEBPACK_IMPORTED_MODULE_4_lodash__["filter"](devices, (device) => { return !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](device['device_id']); });
            this.log.info('Audio devices loaded: ' + JSON.stringify(filteredDevices));
            return Promise.resolve(filteredDevices);
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    //get initial default selection
    getInitialAudioDevice(deviceList) {
        this.isCaptureSystemAudioOn = this.appConfig.getConfigData('config.captureEngine.captureSystemAudio') ?
            this.appConfig.getConfigData('config.captureEngine.captureSystemAudio') : false;
        return this.getInitialDevice('audio', deviceList);
    }
    getInitialAudioInputType(selectedDeviceId) {
        return this.getInitialInputType('audio', this.audioInputTypes, selectedDeviceId);
    }
    onAudioDeviceChange(selectedDevice) {
        this.log.info('onAudioDeviceChange ' + selectedDevice.label);
        //make sure audio session id will always be in the sessions ids array to update
        let sessionsIdsToUpdate = __WEBPACK_IMPORTED_MODULE_4_lodash__["uniq"](__WEBPACK_IMPORTED_MODULE_4_lodash__["concat"]([this.getSessionId('audio')], this.appState.getActiveRecordableSessionsIds()));
        return this.clearAudioDeviceSelections(true)
            .then(() => {
            return this.loadUserSettings('audio');
        })
            .then(() => {
            return this.setSelectedAudioDevice(sessionsIdsToUpdate, { friendly_name: selectedDevice.label, device_id: selectedDevice.value });
        })
            .then((audioDevice) => {
            return this.loadAudioInputTypeList(sessionsIdsToUpdate, audioDevice);
        })
            .then((inputTypes) => {
            this.log.info('loading audio input type list');
            return this.setSelectedAudioInputType(sessionsIdsToUpdate, this.audioInputTypes[0]);
        })
            .then((selectedInputType) => {
            return this.devicePreviewService.refreshSessionsPreview(sessionsIdsToUpdate);
        })
            .catch((err) => {
            this.log.error('ERROR changing audio device selection . ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    reloadAudioDeviceDefaultConfiguration() {
        return this.persistencyService.get('audio.preview')
            .then((preview) => {
            //reload audio device only if it was set
            if (preview && preview === 'enabled' && this.sessions['audio'] && this.sessions['audio'].selectedDevice) {
                //label is not relevant here so just using device ID
                return this.onAudioDeviceChange({ label: this.sessions['audio'].selectedDevice, value: this.sessions['audio'].selectedDevice });
            }
            else {
                return Promise.resolve();
            }
        });
    }
    onAudioInputTypeChange(selectedAudioInputType) {
        return this.setSelectedAudioInputType(this.appState.getActiveRecordableSessionsIds(), selectedAudioInputType)
            .then(() => {
            return this.devicePreviewService.refreshRecordableSessionsPreview();
        })
            .catch((err) => {
            this.log.error('Failed to change audio input type. ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     * update all relevant sessions with new audio device configuration
     * @param sessionIds
     * @param audioDevice
     * @returns {Promise<T>|Promise<R>|Promise<U>}
     */
    setSelectedAudioDevice(sessionIds, audioDevice, saveData = true) {
        this.log.info('setSelectedAudioDevice ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(sessionIds));
        let promises = [];
        __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](sessionIds, (sessionId) => {
            this.appState.onCallStarted('setSelectedAudioDevice: ' + audioDevice.device_id, sessionId);
            promises.push(__WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + '-setAudioDevice', audioDevice.device_id));
        });
        return Promise.all(promises)
            .then(() => {
            this.log.info('Finished setSelectedAudioDevice calls');
            __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](sessionIds, (sessionId) => {
                this.appState.onCallEnded('setSelectedAudioDevice - SUCCESS', sessionId);
            });
            this.selectedAudioDevice = audioDevice.device_id;
            if (saveData) {
                this.persistencyService.set('audio.device_id', this.selectedAudioDevice);
            }
            return this.getAudioDeviceDelay(audioDevice.friendly_name);
        })
            .then(() => {
            return this.selectedAudioDevice;
        })
            .catch((err) => {
            __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](sessionIds, (sessionId) => {
                this.appState.onCallEnded('setSelectedAudioDevice - FAILURE', sessionId);
            });
            return Promise.reject(err);
        });
    }
    /**
     * retrieve device delay setting for device with given friendly name
     * @param deviceName
     * @returns {Promise<T>|Promise<R>|Promise<U>}
     */
    getAudioDeviceDelay(deviceName) {
        this.selectedAudioDeviceDelay = 0;
        this.deviceDelayKey = "config.captureEngine.deviceConfig." + deviceName + ".streamOffset";
        this.log.info('retrieving audio delay for' + deviceName);
        let streamDelay = this.appConfig.getConfigData(this.deviceDelayKey);
        let sinkStartTimeout = this.appConfig.getConfigData("config.captureEngine.sinkStartTimeout");
        this.log.info('obtained audio delay for' + this.selectedAudioDevice + ' (' + deviceName + ') ' + streamDelay);
        this.selectedAudioDeviceDelay = streamDelay || 0;
        this.sinkStartTimeout = sinkStartTimeout || 10000;
        return this.selectedAudioDeviceDelay;
    }
    /**
     * update audio delay for device
     * param delay
     * @param deviceName
     * @returns {Promise<T>|Promise<R>|Promise<U>}
     */
    setSelectedAudioDeviceDelay(delay) {
        this.log.info('setSelectedAudioDeviceDelay: Request for reloading engine config with delay: ' + delay);
        if (this.selectedAudioDeviceDelay == delay) {
            return Promise.resolve();
        }
        this.selectedAudioDeviceDelay = delay;
        return this.appConfig.setConfigData(this.deviceDelayKey, this.selectedAudioDeviceDelay, true)
            .then(() => {
            return this.appState.shutDownSessions();
        })
            .then(() => {
            return this.appState.sendInitNotification();
        });
    }
    setCaptureSystemAudioState(isCaptureSystemAudioOn) {
        this.log.info('AudioDeviceSettings: Request for reloading engine config with: System Audio: ' + isCaptureSystemAudioOn);
        this.isCaptureSystemAudioOn = isCaptureSystemAudioOn;
        return this.appConfig.setConfigData('config.captureEngine.captureSystemAudio', this.isCaptureSystemAudioOn, true)
            .then(() => {
            return this.appState.shutDownSessions();
        })
            .then(() => {
            return this.appState.sendInitNotification();
        });
    }
    /**
     * for loading input types for audio we currently need only one session id since we are using the same audio device.
     * @param sessionsIds []
     * @param selectedAudioDevice
     * @returns {Promise<Array>}
     */
    loadAudioInputTypeList(sessionsIds, selectedAudioDevice) {
        return this.loadDeviceInputTypeList('audio', sessionsIds[0], selectedAudioDevice, 'audio');
    }
    filterInputTypes(inputTypes, limits) {
        return __WEBPACK_IMPORTED_MODULE_4_lodash__["castArray"](inputTypes[0]);
    }
    /*
    *  since audio device is shared between sessions defer setting & perissting
    *  type until all promises are resolved
    *  @param sessionsIds []
    * @param inputType
    * @param saveData
    * @returns {Promise}
    * */
    setSelectedAudioInputType(sessionIds, inputType, saveData = true) {
        this.log.info('setSelectedAudioInputType: ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(sessionIds));
        let promises = __WEBPACK_IMPORTED_MODULE_4_lodash__["map"](sessionIds, (sessionId) => {
            return this.setSelectedInputType('audio', //session name
            sessionId, inputType, false); // do not update persistency
        });
        return Promise.all(promises)
            .then(() => {
            this.log.info('Finished settings audio input type. ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(sessionIds));
            if (saveData) {
                this.persistencyService.set('audio.input_type_id', inputType);
            }
            return inputType;
        });
    }
    unsetAudioDevice(sessionIds) {
        let that = this;
        let promises = __WEBPACK_IMPORTED_MODULE_4_lodash__["map"](sessionIds, function (sessionId) {
            that.appState.onCallStarted('unsetAudioDevice', sessionId);
            return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + '-unsetAudioDevice');
        });
        return Promise.all(promises)
            .then(() => {
            // not removing related sessionIds !!!!!
            __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](sessionIds, function (sessionId) {
                that.appState.onCallEnded('unsetAudioDevice - SUCCESS', sessionId);
            });
        })
            .catch((err) => {
            __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](sessionIds, function (sessionId) {
                that.appState.onCallEnded('unsetAudioDevice - FAILURE', sessionId);
            });
            return Promise.reject(err);
        });
    }
    saveDeviceSelections() {
        return super.saveDeviceSelections('audio');
    }
    clearAudioDeviceSelections(clearPersistency) {
        return super.clearDeviceSelections('audio', clearPersistency);
    }
};
AudioDeviceSettingsService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_7__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_9__device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__device_preview_service__["a" /* DevicePreviewService */]) === "function" && _e || Object])
], AudioDeviceSettingsService);

var _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/audio-device-settings.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/audio-device.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__audio_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__device_recovery_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-recovery.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__capture_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/capture-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AudioDeviceService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};












let AudioDeviceService = class AudioDeviceService extends __WEBPACK_IMPORTED_MODULE_9__capture_device_service__["a" /* CaptureDeviceService */] {
    constructor(appState, audioDeviceSettingsService, notificationService, log, devicePreviewService, persistencyService, recoveryService, appConfig) {
        super(appState, log, audioDeviceSettingsService, recoveryService);
        this.appState = appState;
        this.audioDeviceSettingsService = audioDeviceSettingsService;
        this.notificationService = notificationService;
        this.log = log;
        this.devicePreviewService = devicePreviewService;
        this.persistencyService = persistencyService;
        this.recoveryService = recoveryService;
        this.appConfig = appConfig;
        //indicates if audio devices available
        this.audioAvailable = false;
    }
    getSessionId() {
        return super.getSessionId('audio');
    }
    initAudioDevice() {
        this.log.info('initAudioDevice');
        return this.createDeviceSession('audio')
            .then(() => {
            //loading initial device configurations
            return this.loadInitialAudioDeviceConfiguration(this.getSessionId(), true);
        });
    }
    /**
     * will reject if error,
     * will reject with 'NO_AUDIO_DEVICES'
     * @param sessionId
     * @returns {Promise<T>|Promise<R>|Promise<U>}
     */
    loadInitialAudioDeviceConfiguration(sessionId, isAudioSession) {
        this.log.info('loadInitialAudioDeviceConfiguration - ' + sessionId);
        return this.initialAudioConfiguration(sessionId)
            .then((startPreview) => {
            if (startPreview) {
                return Promise.all([startPreview, this.tryToRecoverAudioDevice(isAudioSession)]);
            }
            else {
                return Promise.all([false, true]); //indication the recovery process didn't fail (it wasn't needed)
            }
        })
            .then(([startPreview, recoverySucceeded]) => {
            if (isAudioSession && startPreview && recoverySucceeded) {
                this.log.info('starting audio device for session - ' + sessionId);
                //will add the session in ACTIVE state
                return this.startAudioDevicePreview();
            }
            else {
                if (isAudioSession) {
                    this.appState.addSession(sessionId, 'audio', this.appState.SESSION_STATE.IN_ACTIVE);
                }
                return Promise.resolve();
            }
        })
            .then(() => {
            return this.audioDeviceSettingsService.saveDeviceSelections();
        })
            .catch((err) => {
            //will add the session in IN_ACTIVE state only for Audio session
            if (isAudioSession) {
                this.appState.addSession(sessionId, 'audio', this.appState.SESSION_STATE.IN_ACTIVE);
                this.recoveryService.addRecoveryReadySession(sessionId, 'audio', false, err);
            }
            return this.rejectAudioPromise('Failed to load initial audio device configuration.', err);
        });
    }
    /**
     * will return the selected input type or false if not needed or can't configure device
     * @param sessionId
     * @return {Promise<boolean>}
     */
    initialAudioConfiguration(sessionId) {
        this.log.info('initialAudioConfiguration');
        this.checkAudioDevicesAvailability();
        //audio device initialization is different than video and screen, once device is set there will be audio.
        //this is the reason for not configuring audio device if we shouldn't enable it.
        return this.shouldInitialPreviewDevice()
            .then((preview) => {
            if (preview) {
                return this.loadAudioDeviceConfiguration([sessionId], false)
                    .then((audioDevice) => {
                    return this.loadAudioInputTypeConfiguration([sessionId], audioDevice, false);
                });
            }
            else {
                return Promise.resolve(false);
            }
        });
    }
    /**
     * will return a boolean value if recovered (indication if need to start device)
     * @param isAudioSession - indicates if recovery is for an audio session and not for visual device that uses audio
     * @return {Promise<boolean>}
     */
    tryToRecoverAudioDevice(isAudioSession) {
        this.log.info('tryToRecoverAudioDevice. audioSession: ' + isAudioSession);
        return Promise.all([this.recoveryService.shouldRecoverAudioForRecording(), this.recoveryService.getAudioSessionRecordingFile()])
            .then(([shouldRecover, audioFile]) => {
            if (shouldRecover) {
                //send audio session file only for audio session - we would like to build record for this file only for the audio session
                let audioSessionFile = isAudioSession ? audioFile : null;
                return this.tryToLoadInRecoveryMode('audio', 'audio', audioSessionFile)
                    .catch((err) => {
                    return Promise.reject(this.recoveryService.DEVICE_STATE.DISCONNECTED);
                });
            }
            else {
                //although we weren't in recovery process - we set the recovery process for current device to true
                //so we will know device was configured and ready to capture
                this.recoveryService.addRecoveryReadySession(this.getSessionId(), 'audio', true);
                // device should start previewing in a non recovery mode only if we are not during a recording
                // if we are in the middle of a recording, the device was just disconnected when recording started
                return !this.isAppRecording();
            }
        });
    }
    /**
     * will reject with 'NO_AUDIO_DEVICES' if there are no audio devices and it is a must for recovery
     * @param sessionsIds array
     * @returns {Promise<T>|Promise<R>|Promise<U>}
     */
    loadAudioDeviceConfiguration(sessionsIds, saveData = true) {
        this.log.info('loadAudioDeviceConfiguration ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(sessionsIds));
        return this.audioDeviceSettingsService.loadAudioDeviceList()
            .then((devices) => {
            if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](devices)) {
                return this.configureAudioDevice(sessionsIds, devices, saveData);
            }
            else {
                this.audioDeviceSettingsService.clearAudioDeviceSelections(saveData);
                return Promise.reject('NO_AUDIO_DEVICES');
            }
        })
            .catch((err) => {
            return this.rejectAudioPromise('Failed to load and set initial audio device.', err);
        });
    }
    isAudioSettingsDisabled() {
        return this.shouldDisableDeviceSettings() || this.isProcessing();
    }
    isAudioEnabled(enableAudioOnly) {
        let audioEnabled = !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.appState.getActiveAudioSession());
        return enableAudioOnly ? audioEnabled : audioEnabled && __WEBPACK_IMPORTED_MODULE_3_lodash__["keys"](this.appState.getActiveVisualSessions()).length > 0;
    }
    /**
     * Enabling audio device
     * @returns {Promise<U>|Promise<T>|Promise<R>}
     */
    enableAudioDevice() {
        this.log.info('enable audio device');
        let sessionsIds = [this.getSessionId()]; //add audio session id
        // getting all active recordable sessions and all in-active visual session.
        // handling in-active visual session since when de-activating a session in our app we are only stopping its' preview (the session is still alive in our engine)
        // in order for the audio enabling affects those sessions as well - we need to handle them.
        sessionsIds = sessionsIds.concat(this.appState.getActiveRecordableSessionsIds(), __WEBPACK_IMPORTED_MODULE_3_lodash__["keys"](this.appState.getInActiveVisualSessions()));
        return this.loadAudioDeviceConfiguration(sessionsIds)
            .then((audioDevice) => {
            return this.loadAudioInputTypeConfiguration(sessionsIds, audioDevice);
        })
            .then(() => {
            return this.startAudioDevicePreview();
        })
            .then(() => {
            return this.devicePreviewService.refreshRecordableSessionsPreview();
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    shouldDisableAudioButton(sourceOnly = false) {
        return !this.audioAvailable ||
            this.isProcessing(sourceOnly) ||
            !this.appState.isSourceStable(this.getSessionId()) ||
            (__WEBPACK_IMPORTED_MODULE_3_lodash__["keys"](this.appState.getActiveVisualSessions()).length === 0 &&
                !this.appConfig.getConfigData('config.captureApp.audioOnlyRecording'));
    }
    /**
     * disabling audio device
     * @returns {Promise<U>|Promise<T>|Promise<R>}
     */
    disableAudioDevice() {
        this.log.info('disable audio device');
        // getting all active recordable sessions and all in-active visual session.
        // handling in-active visual session since when de-activating a session in our app we are only stopping its' preview (the session is still alive in our engine)
        // in order for the audio disabling affects those sessions as well - we need to handle them.
        let sessionsIds = __WEBPACK_IMPORTED_MODULE_3_lodash__["concat"](this.appState.getActiveRecordableSessionsIds(), __WEBPACK_IMPORTED_MODULE_3_lodash__["keys"](this.appState.getInActiveVisualSessions()));
        return this.audioDeviceSettingsService.unsetAudioDevice(sessionsIds)
            .then(() => {
            return this.stopAudioDevicePreview();
        })
            .then(() => {
            return this.devicePreviewService.refreshRecordableSessionsPreview();
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    configureAudioDevice(sessionsIds, devices, saveData = true) {
        this.log.info("configureAudioDevice " + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(sessionsIds));
        return this.audioDeviceSettingsService.getInitialAudioDevice(devices)
            .then((audioDevice) => {
            this.log.info('setting the following audio device: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(audioDevice));
            return this.audioDeviceSettingsService.setSelectedAudioDevice(sessionsIds, audioDevice, saveData);
        })
            .catch((err) => {
            return this.rejectAudioPromise('Failed to configure initial audio device.', err);
        });
    }
    loadAudioInputTypeConfiguration(sessionsIds, audioDevice, saveData = true) {
        this.log.info('loadAudioInputTypeConfiguration: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(sessionsIds));
        return this.audioDeviceSettingsService.loadAudioInputTypeList(sessionsIds, audioDevice)
            .then((inputTypes) => {
            if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](inputTypes)) {
                return this.configureAudioInputType(sessionsIds, audioDevice, saveData);
            }
            else {
                return Promise.reject('No audio input types were found for current audio device: ' + audioDevice);
            }
        })
            .catch((err) => {
            return this.rejectAudioPromise('Failed to load audio input type configuration.', err);
        });
    }
    configureAudioInputType(sessionsIds, selectedDeviceId, saveData = true) {
        this.log.info('configureAudioInputType ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(sessionsIds));
        return this.audioDeviceSettingsService.getInitialAudioInputType(selectedDeviceId)
            .then((inputType) => {
            this.log.info('setting the following audio input type: ' + inputType['description']);
            return this.audioDeviceSettingsService.setSelectedAudioInputType(sessionsIds, inputType, saveData);
        })
            .catch((err) => {
            return this.rejectAudioPromise('Failed to configure audio input type.', err);
        });
    }
    startAudioDevicePreview() {
        return this.devicePreviewService.startAudioPreviewAndActivateSession(this.getSessionId())
            .then(() => {
            return this.persistencyService.set('audio.preview', "enabled");
        })
            .catch((err) => {
            this.notificationService.sendNotification('NOTIFICATIONS.error_audioPreviewStart', 'error');
            return Promise.reject(err);
        });
    }
    stopAudioDevicePreview() {
        return this.devicePreviewService.stopAudioPreviewAndDeActivateSession(this.getSessionId())
            .then(() => {
            return this.persistencyService.set('audio.preview', "disabled");
        });
    }
    //will be ready only if all main sessions devices are in stable state
    isProcessing(sourceOnly = false) {
        let stable = true;
        __WEBPACK_IMPORTED_MODULE_3_lodash__["forEach"](this.appState.getActiveRecordableSessionsIds(), (sessionId) => {
            stable = stable && this.appState.isSourceStable(sessionId, sourceOnly);
        });
        //make sure there are recordable devices current in preview before enabling the audio button (unless in audioOnly mode)
        return !stable || (__WEBPACK_IMPORTED_MODULE_3_lodash__["keys"](this.appState.getActiveVisualSessions()).length === 0 &&
            !this.appConfig.getConfigData('config.captureApp.audioOnlyRecording'));
    }
    shouldInitialPreviewDevice() {
        return this.audioDeviceSettingsService.loadAudioUserSettings()
            .then((settings) => {
            return (!settings || !settings['preview'] || settings['preview'] === "enabled");
        })
            .catch(() => {
            return true;
        });
    }
    shouldDisableDeviceSettings() {
        return !this.audioDeviceSettingsService.selectedAudioDevice ||
            this.audioDeviceSettingsService.audioInputTypes.length === 0;
    }
    isAppRecording() {
        return this.appState.isAppRecording();
    }
    checkAudioDevicesAvailability() {
        //check if audio devices available and set the flag
        return this.audioDeviceSettingsService.loadAudioDeviceList()
            .then((devices) => {
            this.audioAvailable = !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](devices);
        })
            .catch((err) => {
            this.audioAvailable = false;
        })
            .then(() => {
            return this.audioAvailable;
        });
    }
    /**
     * will return an audio related error (prefix - AUDIO) so sessions will be able to identify an audio error
     * @param msg
     * @param err
     * @returns {Promise<void>|Promise<T>}
     */
    rejectAudioPromise(msg, err) {
        this.log.error(msg + ' - ' + JSON.stringify(err));
        let errString = __WEBPACK_IMPORTED_MODULE_3_lodash__["isObject"](err) ? JSON.stringify(err) : err;
        errString = (errString.indexOf('NO_AUDIO_DEVICES') > -1) ? errString : 'AUDIO-' + errString;
        //if recovery failed due to an error different than disconnection or NO_AUDIO_DEVICES during recording - save device settings
        if ((err && err !== this.recoveryService.DEVICE_STATE.DISCONNECTED) && !(this.isAppRecording() && errString && errString.indexOf('NO_AUDIO_DEVICES') > -1)) {
            this.deviceSettingsService.saveDeviceSelections('audio');
        }
        return Promise.reject(errString);
    }
};
AudioDeviceService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__infra_app_state_service__["a" /* AppStateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_2__audio_device_settings_service__["a" /* AudioDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__audio_device_settings_service__["a" /* AudioDeviceSettingsService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_11__infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_5__device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__device_preview_service__["a" /* DevicePreviewService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_6__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_7__device_recovery_service__["a" /* DeviceRecoveryService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__device_recovery_service__["a" /* DeviceRecoveryService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_10__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _h || Object])
], AudioDeviceService);

var _a, _b, _c, _d, _e, _f, _g, _h;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/audio-device.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/capture-device.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__audio_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__audio_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__device_connection_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-connection.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__device_recovery_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-recovery.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__device_resources_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-resources.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__video_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_shared_services_infra_infra_module__ = __webpack_require__("../../../../../src/shared/services/infra/infra.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__monitoring_monitoring_module__ = __webpack_require__("../../../../../src/shared/services/monitoring/monitoring.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__default_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/default-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12_shared_services_live_live_module__ = __webpack_require__("../../../../../src/shared/services/live/live.module.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CaptureDeviceModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};













let CaptureDeviceModule = class CaptureDeviceModule {
};
CaptureDeviceModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [
            __WEBPACK_IMPORTED_MODULE_9_shared_services_infra_infra_module__["a" /* InfraModule */],
            __WEBPACK_IMPORTED_MODULE_10__monitoring_monitoring_module__["a" /* MonitoringModule */],
            __WEBPACK_IMPORTED_MODULE_12_shared_services_live_live_module__["a" /* LiveModule */]
        ],
        providers: [
            __WEBPACK_IMPORTED_MODULE_1__audio_device_service__["a" /* AudioDeviceService */],
            __WEBPACK_IMPORTED_MODULE_2__audio_device_settings_service__["a" /* AudioDeviceSettingsService */],
            __WEBPACK_IMPORTED_MODULE_3__device_connection_service__["a" /* DeviceConnectionService */],
            __WEBPACK_IMPORTED_MODULE_4__device_preview_service__["a" /* DevicePreviewService */],
            __WEBPACK_IMPORTED_MODULE_5__device_recovery_service__["a" /* DeviceRecoveryService */],
            __WEBPACK_IMPORTED_MODULE_6__device_resources_service__["a" /* DeviceResourcesService */],
            __WEBPACK_IMPORTED_MODULE_7__video_device_service__["a" /* VideoDeviceService */],
            __WEBPACK_IMPORTED_MODULE_8__video_device_settings_service__["a" /* VideoDeviceSettingsService */],
            __WEBPACK_IMPORTED_MODULE_11__default_settings_service__["a" /* DefaultSettingsService */]
        ]
    })
], CaptureDeviceModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/capture-device.module.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/capture-device.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");


class CaptureDeviceService {
    constructor(appState, log, deviceSettingsService, recoveryService) {
        this.appState = appState;
        this.log = log;
        this.deviceSettingsService = deviceSettingsService;
        this.recoveryService = recoveryService;
    }
    getSessionId(sessionName) {
        return this.deviceSettingsService.getSessionId(sessionName);
    }
    createDeviceSession(sessionName) {
        this.appState.addLoadingSession();
        this.appState.onCallStarted('createSession', 'createSession-' + sessionName);
        return __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('createSession')
            .then((sessionId) => {
            this.appState.onCallEnded('createSession - SUCCESS', 'createSession-' + sessionName);
            this.log.info('**** ' + sessionName + ' session id: ' + sessionId);
            this.deviceSettingsService.getSessionData(sessionName).sessionId = sessionId;
            return this.deviceSettingsService.getSessionData(sessionName);
        })
            .catch((err) => {
            this.appState.onCallEnded('createSession - FAILURE', 'createSession-' + sessionName);
            this.log.error('Error creating ' + sessionName + ' session.' + __WEBPACK_IMPORTED_MODULE_1__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     * get recording settings and checking if need to load in recovery mode
     * if a capture file exists from previous recording that didn't end (app exited)
     * build recording session for current capture session with the capture file as a parameter
     * if there is no recover file name
     */
    tryToLoadInRecoveryMode(sessionName, deviceType, recoverFileName) {
        this.log.debug('tryToLoadInRecoveryMode - ' + sessionName);
        return this.recoveryService.canRecoverDeviceForRecording(sessionName)
            .then((canRecover) => {
            if (!canRecover)
                return Promise.reject(this.recoveryService.DEVICE_STATE.DISCONNECTED);
            if (!recoverFileName) {
                this.log.info('No need to build recording for current recovery request since it is an audio device used by a visual capture device');
                return Promise.resolve();
            } //there is no need to build recording (audio session that is being used by a visual recording)
            //recoverable session with recoverable recoding file
            this.log.info('Loading ' + sessionName + ' device session in recovery mode.');
            let fileName = recoverFileName.replace(/^.*[\\\/]/, '');
            return this.buildRecordingSession(sessionName, fileName);
        })
            .then(() => {
            this.log.info('Send addRecoveryReadySession notification for successful ' + sessionName + ' recovery preparation.');
            this.recoveryService.addRecoveryReadySession(this.getSessionId(sessionName), sessionName, true);
            return true;
        })
            .catch((err) => {
            this.log.error('Error loading ' + sessionName + ' device in recovery mode.');
            return Promise.reject(err);
        });
    }
    buildRecordingSession(sessionName, filePath) {
        this.log.info('Building ' + sessionName + ' device recovery recording session' + this.deviceSettingsService.getSessionData(sessionName).sessionId);
        this.appState.onCallStarted('buildRecord', sessionName + this.deviceSettingsService.getSessionData(sessionName).sessionId);
        return __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(this.deviceSettingsService.getSessionData(sessionName).sessionId + '-buildRecord', filePath)
            .then(() => {
            this.appState.onCallEnded('buildRecord - SUCCESS', sessionName + this.deviceSettingsService.getSessionData(sessionName).sessionId);
            return filePath;
        })
            .catch((err) => {
            this.appState.onCallEnded('buildRecord - FAILURE', sessionName + this.deviceSettingsService.getSessionData(sessionName).sessionId);
            this.log.error('Failed to build recording for ' + sessionName + ' session: ' + this.deviceSettingsService.getSessionData(sessionName).sessionId + __WEBPACK_IMPORTED_MODULE_1__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(this.recoveryService.DEVICE_STATE.FAILED);
        });
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = CaptureDeviceService;

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/capture-device.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/default-settings.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__audio_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__device_recovery_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-recovery.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DefaultSettingsService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};












let DefaultSettingsService = class DefaultSettingsService {
    constructor(log, appState, appConfig, recoveryService, audioDeviceService, appPersistency, devicePreviewService, videoDeviceSettingsService) {
        this.log = log;
        this.appState = appState;
        this.appConfig = appConfig;
        this.recoveryService = recoveryService;
        this.audioDeviceService = audioDeviceService;
        this.appPersistency = appPersistency;
        this.devicePreviewService = devicePreviewService;
        this.videoDeviceSettingsService = videoDeviceSettingsService;
        this.MIN_IDLE_TIME = 10; //in minutes
        this.getBaseIdleTime();
    }
    start(callback) {
        //initial application load - if app is not in recording state, setting default configuration
        this.triggerRestoreDefaultSettings(callback);
        this.intervalSub = __WEBPACK_IMPORTED_MODULE_3_rxjs__["Observable"].timer(0, 60000).subscribe(t => {
            if (this.idleCounter <= 0)
                this.triggerRestoreDefaultSettings(callback);
            else
                this.idleCounter--;
        });
    }
    restartInterval() {
        this.idleCounter = this.getBaseIdleTime();
    }
    stop() {
        if (this.intervalSub) {
            this.intervalSub.unsubscribe();
            this.intervalSub = null;
        }
    }
    triggerRestoreDefaultSettings(callback) {
        this.log.info('DefaultSettingsService: triggerRestoreDefaultSettings');
        this.appState.areSessionsReadyForRecording('triggerRestoreDefaultSettings')
            .then(() => {
            this.restoreDefaultSettings()
                .then((restored) => {
                if (restored && callback)
                    callback();
            });
        });
    }
    restoreDefaultSettings() {
        return this.isAppInRecordingState()
            .then(recording => {
            if (recording) {
                this.log.info('DefaultSettingsService: application is during recording, not setting admin default values');
                this.restartInterval();
                return Promise.resolve(false);
            }
            else {
                this.log.info('DefaultSettingsService: checking if settings need to be reset to admin defaults');
                return this.settingsRestoreProcess();
            }
        });
    }
    settingsRestoreProcess() {
        this.restartInterval();
        return this.appPersistency.get('')
            .then((persistentData) => {
            if (!persistentData || !persistentData['defaultSettings'] || __WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](persistentData) || __WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](persistentData['defaultSettings'])) {
                this.log.info('DefaultSettingsService: persistent data or defaultSettings data are empty');
                return Promise.resolve(false);
            }
            else {
                if (this.shouldRestoreAdminDefaults(persistentData)) {
                    return this.updateSessionsInPersistentData(persistentData)
                        .then(() => { return Promise.resolve(true); });
                }
                else {
                    this.log.info('DefaultSettingsService: there is no need to re-init sessions since no ');
                    return Promise.resolve(false);
                }
            }
        })
            .catch((e) => {
            this.log.error('DefaultSettingsService: Failed to update devices configurations with default settings. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(e));
            return Promise.resolve(false);
        });
    }
    shouldRestoreAdminDefaults(persistentData) {
        let defaultSettings = persistentData['defaultSettings'];
        //if sessions count is different - update current sessions
        if (this.extractSessionsNames(persistentData).length !== this.extractSessionsNames(defaultSettings).length)
            return true;
        //if sessions count is equal - check for configuration changes for each session
        let shouldRestore = false;
        __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](this.extractSessionsNames(persistentData), sessionName => {
            shouldRestore = persistentData[sessionName] && defaultSettings[sessionName] &&
                !__WEBPACK_IMPORTED_MODULE_6_lodash__["isEqual"](persistentData[sessionName], defaultSettings[sessionName]);
            if (shouldRestore)
                return false; //break lodah forEach
        });
        return shouldRestore;
    }
    updateSessionsInPersistentData(persistentData) {
        this.log.info('DefaultSettingsService: updated devices configuration with default admin settings');
        //using sessions from persistent data obj
        let sessionsNames = this.extractSessionsNames(persistentData);
        //remove persistent data old sessions
        __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](sessionsNames, sessionName => {
            delete persistentData[sessionName];
        });
        //using sessions from default settings object
        let defaultSettings = persistentData['defaultSettings'];
        sessionsNames = this.extractSessionsNames(defaultSettings);
        //add default settings sessions to persistent data
        __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](sessionsNames, sessionName => {
            persistentData[sessionName] = defaultSettings[sessionName];
        });
        //update persistent data object
        return this.appPersistency.set('all', persistentData)
            .then(() => {
            //shutdown sessions
            this.log.info('DefaultSettingsService: re-init sessions after restoring default admin settings');
            return this.shutDownAndReInitSessions();
        });
    }
    extractSessionsNames(dataObject) {
        let sessionsNames = [];
        __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](dataObject, (value, key) => {
            if (key.startsWith('session') || key.startsWith('audio')) {
                sessionsNames.push(key);
            }
        });
        return sessionsNames;
    }
    shutDownAndReInitSessions() {
        //can be called on app load before session are active
        if (__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.appState.getActiveSessions()) && __WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](this.appState.getInActiveSessions())) {
            this.log.info('DefaultSettingsService: there is no need to reinint sesson since non is active');
            return Promise.resolve();
        }
        else {
            return this.appState.areSessionsReadyForRecording('DefaultSettingsService')
                .catch(() => { }) //shut down sessions any way...
                .then(() => {
                return this.devicePreviewService.unregisterFromAudioNotification();
            })
                .then(() => {
                this.recoveryService.resetRecoverySessions();
                return this.appState.shutDownSessions()
                    .then(() => {
                    return this.videoDeviceSettingsService.clearSessions();
                })
                    .then(() => {
                    this.appState.sendInitNotification();
                })
                    .catch((err) => {
                    this.log.error('DefaultSettingsService: failed to shut down active sessions. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
                    return Promise.reject(err);
                });
            });
        }
    }
    getBaseIdleTime() {
        let baseIdleTime = this.appConfig.getConfigData('config.captureApp.restoreDefaultSettings.appIdleMin');
        return baseIdleTime && baseIdleTime > this.MIN_IDLE_TIME ? baseIdleTime : this.MIN_IDLE_TIME;
    }
    //checking persistent data and not appState since it is being used also on application start (sessions are not ready yet)
    isAppInRecordingState() {
        return this.appPersistency.get('recording')
            .then(recData => {
            return !__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](recData) && !__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](recData['details']) && !__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](recData['details']['files']);
        })
            .catch((err) => {
            this.log.error('DefaultSettingsService: Failed to read recovery persistent data. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return true;
        });
    }
};
DefaultSettingsService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_7__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_10__device_recovery_service__["a" /* DeviceRecoveryService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__device_recovery_service__["a" /* DeviceRecoveryService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_9__audio_device_service__["a" /* AudioDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__audio_device_service__["a" /* AudioDeviceService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_8__device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__device_preview_service__["a" /* DevicePreviewService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_11__video_device_settings_service__["a" /* VideoDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__video_device_settings_service__["a" /* VideoDeviceSettingsService */]) === "function" && _h || Object])
], DefaultSettingsService);

var _a, _b, _c, _d, _e, _f, _g, _h;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/default-settings.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/device-connection.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__device_recovery_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-recovery.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__video_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DeviceConnectionService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};













let DeviceConnectionService = class DeviceConnectionService {
    constructor(log, config, appState, recoveryService, persistencyService, notificationService, translate, videoDeviceService) {
        this.log = log;
        this.config = config;
        this.appState = appState;
        this.recoveryService = recoveryService;
        this.persistencyService = persistencyService;
        this.notificationService = notificationService;
        this.translate = translate;
        this.videoDeviceService = videoDeviceService;
        this.CONNECTED = 'connected';
        this.DISCONNECTED = 'disconnected';
        /**
         * notify on each device connection state change
         * will send and object of: {deviceId: xxx , state: connected / disconnected}
         * @type {BehaviorSubject}
         */
        this.deviceConnectionState = new __WEBPACK_IMPORTED_MODULE_5_rxjs__["BehaviorSubject"]({});
        this.deviceConnectionState$ = this.deviceConnectionState.asObservable();
        /**
         * disconnection events queue
         * @type {Array}
         */
        this.eventsQueue = [];
        this.inProgress = false;
        this.addListeners();
    }
    getConnectionState() {
        return this.deviceConnectionState.getValue();
    }
    /**
     * listen to connect / disconnect events from engine.
     * currently sending app notifications only for in-use devices
     */
    addListeners() {
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('on-device-status-change', (data) => {
            if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isString"](data)) {
                data = JSON.parse(data);
            }
            this.log.info('on-device-status-change notification was fired from engine. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(data));
            switch (data.state) {
                case 'Added':
                case 'unMirrored':
                    this.sendDeviceConnectionStateNotification(data['device_id'], this.CONNECTED);
                    break;
                case 'Removed':
                case 'mirrored':
                    this.sendDeviceConnectionStateNotification(data['device_id'], this.DISCONNECTED);
                    break;
                case 'Active':
                    this.log.info('on-device-status-change notification was fired from engine. returning from ctl-alt-del');
                    this.addDeviceConnectionEvent({ 'deviceId': 'display', 'state': 'false', 'event': 'ctl-alt-del', 'inUse': true });
                    break;
                case 'Inactive':
                    this.log.info('on-device-status-change notification was fired from engine. ctl-alt-del');
                    this.addDeviceConnectionEvent({ 'deviceId': 'display', 'state': 'true', 'event': 'ctl-alt-del', 'inUse': true });
                    break;
                default:
                    this.log.error('on-device-status-change unrecognized state. ' + data['state']);
                    break;
            }
        });
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('power-sleep', (data) => {
            this.log.info('power-sleep notification was fired from engine. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(data));
            this.addDeviceConnectionEvent({ 'deviceId': 'display', 'state': data, 'event': 'sleep', 'inUse': true });
        });
        // User-switch does not terminate current session, which means app continues to run and hold devices
        // mostly relevant for PersonalCapture (KalturaCapture)
        // to prevent this we just shut down the app.
        // timeing is not an issue since the "old" windows session continues to run
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('user-switch', (data) => {
            this.log.info('user-switch notification was fired from engine. quitting app ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(data));
            return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('signOutApp')
                .catch((err) => {
                this.log.error('Failed to sign out.' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            });
        });
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('rdp-connection', (data) => {
            this.log.info('rdp-connection notification was fired from engine. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(data));
            if (data) {
                this.notificationService.sendNotification("NOTIFICATIONS.warn_remoteDesktopConnection", 'warn');
            }
            else {
                this.notificationService.sendNotification("NOTIFICATIONS.info_remoteDesktopConnection", 'info');
            }
        });
        //device accessibility (privacy state) change event
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('device-accessibility-change', (data) => {
            if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isString"](data)) {
                data = JSON.parse(data);
            }
            this.log.info('device-accessibility-change notification was fired from engine. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(data));
            let sessionsDataPromises = [];
            if (data['device_type'] === 'audio') {
                sessionsDataPromises = ['audio'];
            }
            else {
                sessionsDataPromises = __WEBPACK_IMPORTED_MODULE_2_lodash__["concat"](this.appState.getSessionsNames(true), this.appState.getSessionsNames(false));
                __WEBPACK_IMPORTED_MODULE_2_lodash__["remove"](sessionsDataPromises, sessionName => {
                    return sessionName === 'audio' || this.videoDeviceService.getCaptureDeviceTypeBySessionId(sessionName) === 'screen';
                });
            }
            sessionsDataPromises = __WEBPACK_IMPORTED_MODULE_2_lodash__["map"](sessionsDataPromises, sessionName => this.persistencyService.get(sessionName));
            Promise.all(sessionsDataPromises) //waiting for all data to return
                .then((sessionsDataResults) => {
                //report device dis/connection to all devices of the type regardless it's connection status.
                // care only for device status
                const deviceIds = __WEBPACK_IMPORTED_MODULE_2_lodash__["map"](sessionsDataResults, (sessionData) => sessionData['device_id']);
                __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](deviceIds, (device_d) => {
                    this.sendDeviceConnectionStateNotification(device_d, data['state'] === 'allow' ? this.CONNECTED : this.DISCONNECTED);
                });
            });
        });
    }
    sendDeviceConnectionStateNotification(deviceId, state) {
        this.log.info('sendDeviceConnectionStateNotification. device_id ' + deviceId + ' state: ' + state);
        let sessionNames = [];
        let sessionsDataPromises = [];
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_2_lodash__["concat"](this.appState.getSessionsNames(true), this.appState.getSessionsNames(false)), (sessionName) => {
            sessionsDataPromises.push(this.persistencyService.get(sessionName));
            sessionNames.push(sessionName);
        });
        Promise.all(sessionsDataPromises) //waiting for all data to return
            .then((sessionsDataResults) => {
            let appType = this.config.getConfigData('config.shared.appType');
            let primarySessionName = this.config.getConfigData('config.captureApp.primarySessionName');
            let disconnectedDevicesDesc = [];
            __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](sessionsDataResults, (sessionData, index) => {
                //if current session device was disconnected
                if (!__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](sessionData) && (!this.appState.isAppRecording() || sessionData['preview'] === 'enabled') && deviceId === sessionData['device_id']) {
                    disconnectedDevicesDesc.push(__WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].getDisplayNameForSessionName(appType, primarySessionName, sessionNames[index]));
                }
            });
            __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](disconnectedDevicesDesc, (deviceType) => {
                this.notifyDeviceConnectionStateChange(state, deviceType);
                this.addDeviceConnectionEvent({ 'deviceId': deviceId, 'state': state, 'inUse': true });
            });
            if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](disconnectedDevicesDesc)) {
                this.addDeviceConnectionEvent({ 'deviceId': deviceId, 'state': state, 'inUse': false });
            }
        })
            .catch((err) => {
            this.log.error('Failed to load app persistent data for device connection state. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            //since it is better for the application for stop instead of crash when device connection state changes, sending
            //notification what-so-ever
            this.addDeviceConnectionEvent({ 'deviceId': deviceId, 'state': state, 'inUse': true });
        });
    }
    notifyDeviceConnectionStateChange(state, deviceType = '') {
        this.translate.get('COMMON.' + deviceType).subscribe((source) => {
            if (state === this.DISCONNECTED) {
                this.notificationService.sendNotificationWithParams("NOTIFICATIONS.error_deviceDisconnected", { 'captureType': source }, 'error');
            }
            else {
                this.notificationService.sendNotificationWithParams("NOTIFICATIONS.info_deviceReconnected", { 'captureType': source }, 'info');
            }
        });
    }
    addDeviceConnectionEvent(event) {
        this.eventsQueue.push(event);
        this.log.info('addDeviceConnectionEvent(): current events queue: ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(this.eventsQueue));
        //if it is the only event - fire it
        if (this.eventsQueue.length === 1) {
            this.fireNextDeviceConnectionEvent();
        }
    }
    fireNextDeviceConnectionEvent() {
        if (this.inProgress) {
            this.log.info('fireNextDeviceConnectionEvent(): in progress flag is still on, waiting for previous event to end.');
            __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].delayPromise(1000)
                .then(() => {
                this.fireNextDeviceConnectionEvent();
            });
        }
        else {
            this.inProgress = true;
            this.log.info('fireNextDeviceConnectionEvent(): current event queue: ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(this.eventsQueue));
            if (this.eventsQueue.length > 0) {
                this.appState.sessionsReturnedFromConnectionStateChange('fireNextDeviceConnectionEvent')
                    .then(() => {
                    this.appState.setConnectionStateChangeLock('fireNextDeviceConnectionEvent', true);
                    let event = this.eventsQueue.shift();
                    this.log.info('fireNextDeviceConnectionEvent(): fired connection event: ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(event));
                    this.deviceConnectionState.next(event); //fire the event
                    this.log.info('fireNextDeviceConnectionEvent(): Device connection service: free in progress lock');
                    this.inProgress = false;
                    this.fireNextDeviceConnectionEvent();
                });
            }
            else {
                this.log.info('fireNextDeviceConnectionEvent(): No events in queue. Device connection service: free in progress lock');
                this.inProgress = false;
            }
        }
    }
};
DeviceConnectionService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_3__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_9__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_11__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__infra_app_state_service__["a" /* AppStateService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_10__device_recovery_service__["a" /* DeviceRecoveryService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__device_recovery_service__["a" /* DeviceRecoveryService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_6__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_7__infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_8_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8_ng2_translate__["b" /* TranslateService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_12__video_device_service__["a" /* VideoDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_12__video_device_service__["a" /* VideoDeviceService */]) === "function" && _h || Object])
], DeviceConnectionService);

var _a, _b, _c, _d, _e, _f, _g, _h;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/device-connection.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/device-preview.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DevicePreviewService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







/**
 * Device Preview Service will display and hide device stream.
 * Also, only current previewing devices are considered to be active devices that will be recorded
 */
let DevicePreviewService = class DevicePreviewService {
    constructor(appState, log) {
        this.appState = appState;
        this.log = log;
        //audio level
        this.audioLeverSubject = new __WEBPACK_IMPORTED_MODULE_4_rxjs__["BehaviorSubject"](0);
        this.audioLeverSubject$ = this.audioLeverSubject.asObservable();
        //event for repositioning preview element
        this.repositionPreview = new __WEBPACK_IMPORTED_MODULE_4_rxjs__["Subject"]();
        this.repositionPreview$ = this.repositionPreview.asObservable();
        //indicates if to auto resume audio preview when visual devices are active
        this.autoResumeAudio = false;
        this.captureZoneType = 'FULL_SCREEN';
    }
    setPreviewPosition(sessionId, position) {
        this.log.info('setVideoPosition: ' + sessionId);
        position = this.validateElementPosition(position);
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + '-setVideoPosition', position.top, position.left, position.width, position.height)
            .then(() => {
            this.log.info('setVideoPosition - success: ' + sessionId + ' ' + (position ? __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(position) : 'no position'));
        })
            .catch((err) => {
            this.log.warn('setVideoPosition - failure: ' + sessionId);
            return err;
        });
    }
    startPreviewAndActivateSession(sessionId, name, type) {
        this.log.info('DevicePreviewService: startPreviewAndActivateSession');
        this.appState.onCallStarted('startPreview', sessionId);
        return this.getStartPreviewRelevantPromise(sessionId)
            .then(() => {
            this.appState.onCallEnded('startPreview - SUCCESS', sessionId);
            //add session to active session so it will be recorded
            this.appState.addSession(sessionId, name, this.appState.SESSION_STATE.ACTIVE);
            return sessionId;
        })
            .catch((err) => {
            this.appState.onCallEnded('startPreview - FAILURE', sessionId, err);
            return Promise.reject(err);
        });
    }
    stopPreviewAndDeactivateSession(sessionId, deactivateSession = true) {
        this.log.info('stopPreviewAndDeactivateSession(): ' + sessionId + ' ' + deactivateSession);
        this.appState.onCallStarted('stop preview', sessionId);
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + '-stopPreview')
            .then(() => {
            this.appState.onCallEnded('stop preview - SUCCESS', sessionId);
            if (deactivateSession)
                this.appState.removeActiveSession(sessionId);
            return sessionId;
        })
            .catch((err) => {
            //todo error handling
            if (err === 'session ended') {
                this.log.warn('stopPreviewAndDeactivateSession: Failed to stop and deactivate session since it was already ended: ' + sessionId);
                return sessionId;
            }
            this.appState.onCallEnded('stop preview - FAILURE', sessionId, err);
            return Promise.reject(err);
        });
    }
    refreshDevice(sessionId, name, type) {
        let that = this;
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](that.appState.getActiveSessions()[sessionId])) {
            return that.stopPreviewAndDeactivateSession(sessionId, false)
                .then(() => {
                return that.startPreviewAndActivateSession(sessionId, name, type);
            })
                .catch((err) => {
                that.log.error('Failed refreshing device: ' + sessionId + '. ' + __WEBPACK_IMPORTED_MODULE_6__utils_utils__["a" /* utils */].stringifyMsg(err));
                return Promise.reject(err);
            });
        }
        else {
            //no need to refresh, device is not previewing (will be refreshed when will start preview)
            return Promise.resolve();
        }
    }
    /**
     * stopping all devices preview without removing their sessions
     * @return {Promise<boolean>}
     */
    stopPreviewAll() {
        this.appState.onCallStarted('stop preview all', JSON.stringify(Object.keys(this.appState.getActiveSessions())));
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('stopPreviewAll')
            .then(() => {
            this.appState.onCallEnded('stop preview all - SUCCESS', JSON.stringify(Object.keys(this.appState.getActiveSessions())));
            return true;
        })
            .catch((err) => {
            //todo error handling
            this.appState.onCallEnded('stop preview all - FAILURE', JSON.stringify(Object.keys(this.appState.getActiveSessions())), err);
            return Promise.reject(err);
        });
    }
    /**
     * starting all devices preview without adding their sessions
     * @return {Promise<boolean>}
     */
    startPreviewAll() {
        let that = this;
        that.appState.onCallStarted('start preview all', JSON.stringify(Object.keys(that.appState.getActiveSessions())));
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('startPreviewAll')
            .then(() => {
            that.appState.onCallEnded('start preview all - SUCCESS', JSON.stringify(Object.keys(that.appState.getActiveSessions())));
            return true;
        })
            .catch((err) => {
            //todo error handling
            that.appState.onCallEnded('start preview all - FAILURE', JSON.stringify(Object.keys(that.appState.getActiveSessions())), err);
            return Promise.reject(err);
        });
    }
    hideAll() {
        this.appState.onCallStarted('setVideoPositionAll (hide all)', JSON.stringify(Object.keys(this.appState.getActiveVisualSessions())));
        let hideAllPromises = [];
        __WEBPACK_IMPORTED_MODULE_3_lodash__["forEach"](Object.keys(this.appState.getActiveVisualSessions()), (sessionId) => {
            hideAllPromises.push(this.setPreviewPosition(sessionId, { top: 0, left: 0, width: 0, height: 0 }));
        });
        return Promise.all(hideAllPromises)
            .then(() => {
            this.appState.onCallEnded('setVideoPositionAll (hide all) - SUCCESS', JSON.stringify(Object.keys(this.appState.getActiveVisualSessions())));
        })
            .catch((err) => {
            this.appState.onCallEnded('setVideoPositionAll (hide all) - FAILURE', JSON.stringify(Object.keys(this.appState.getActiveVisualSessions())), err);
            return err;
        });
    }
    refreshSessionsPreview(sessions) {
        return this.stopPreviewSome(sessions)
            .then(() => {
            this.log.info('All sessions preview were stopped');
            return this.startPreviewSome(sessions);
        })
            .then(() => {
            this.log.info('All sessions preview started');
            return true;
        })
            .catch((err) => {
            this.log.error(err);
            return Promise.reject(err);
        });
    }
    refreshRecordableSessionsPreview() {
        return this.refreshSessionsPreview(this.appState.getActiveRecordableSessionsIds());
    }
    startPreviewSome(sessionsArray) {
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](sessionsArray)) {
            this.appState.onCallStarted('start preview some', JSON.stringify(sessionsArray));
            return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('startPreviewSome', sessionsArray)
                .then(() => {
                this.appState.onCallEnded('start preview some - SUCCESS', JSON.stringify(sessionsArray));
                return true;
            })
                .catch((err) => {
                //todo error handling
                this.appState.onCallEnded('start preview some - FAILURE', JSON.stringify(sessionsArray), err);
                return Promise.reject(err);
            });
        }
        else {
            return Promise.resolve(false);
        }
    }
    stopPreviewSome(sessionsArray) {
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](sessionsArray)) {
            this.appState.onCallStarted('stop preview some', JSON.stringify(sessionsArray));
            return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('stopPreviewSome', sessionsArray)
                .then(() => {
                this.appState.onCallEnded('stop preview some - SUCCESS', JSON.stringify(sessionsArray));
                return true;
            })
                .catch((err) => {
                //todo error handling
                this.appState.onCallEnded('stop preview some - FAILURE', JSON.stringify(sessionsArray), err);
                return Promise.reject(err);
            });
        }
        else {
            return Promise.resolve({});
        }
    }
    startAudioPreviewAndActivateSession(audioSessionId) {
        this.log.info('Registering for audio notifications');
        return this.startPreviewAndActivateSession(audioSessionId, 'audio', 'audio')
            .then(() => {
            __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('audio-level', (audioLevels) => {
                // if we have only one channel we still want the UI to use both bars
                if (audioLevels.Channel1 === 0) {
                    audioLevels.Channel1 = audioLevels.Channel0;
                }
                this.audioLeverSubject.next(audioLevels);
            });
        });
    }
    stopAudioPreviewAndDeActivateSession(audioSessionId) {
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.appState.getActiveAudioSession())) {
            this.log.info('un-registering from audio notifications');
            return this.stopPreviewAndDeactivateSession(audioSessionId)
                .then(() => {
                __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].unregisterForNotification('audio-level');
                this.audioLeverSubject.next(0);
            });
        }
        else {
            return Promise.resolve();
        }
    }
    unregisterFromAudioNotification() {
        this.audioLeverSubject.next(0);
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].unregisterForNotification('audio-level');
    }
    repositionActiveSessionsPreview() {
        this.repositionPreview.next();
    }
    /**
     * make sure no pixel sized image will be shown (in case element is not yet rendered)
     * @param position
     * @returns {{left: number, top: number, width: number, height: number}}
     */
    validateElementPosition(position) {
        if (!position.width || !position.height || position.left < 0 || position.top < 0) {
            return { left: 0, top: 0, width: 0, height: 0 };
        }
        else {
            return { left: position.left, top: position.top, width: position.width, height: position.height };
        }
    }
    /**
     * checks if need to stop audio notifications due to no active visual sessions
     */
    checkIfToStopAudioPreview(audioSessionId) {
        //if there are no recordable session (in audioOnly mode - audio session will be includes do we would like to know if it is enabled (active))
        if ((this.appState.getActiveRecordableSessionsIds()).length === 0
            && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.appState.getActiveAudioSession())) {
            this.autoResumeAudio = true;
            return this.stopAudioPreviewAndDeActivateSession(audioSessionId);
        }
        else {
            return Promise.resolve();
        }
    }
    /**
     * checks if need to start audio notifications due to active visual sessions addition
     */
    checkIfToStartAudioPreview(audioSessionId) {
        if (this.autoResumeAudio) {
            this.autoResumeAudio = false;
            this.startAudioPreviewAndActivateSession(audioSessionId);
        }
        return Promise.resolve();
    }
    /**
     * return start preview promise only if need to hold capture device resources
     * in recording manager there is a free resource call on init sessions, in this service we adjust the device visual
     * capture state with the app window visibility
     * @param sessionId
     * @return {any}
     */
    getStartPreviewRelevantPromise(sessionId) {
        if (this.appState.getApplicationWindowState() === this.appState.WINDOW_STATE.VISIBLE || this.appState.isAppRecording()) {
            return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + '-startPreview');
        }
        else {
            this.log.info('DevicePreviewService: There is no need to start preview for: ' + sessionId);
            return this.setPreviewPosition(sessionId, { left: 0, top: 0, width: 0, height: 0 });
        }
    }
    resetToFullScreenCapture() {
        this.captureZoneType = 'FULL_SCREEN';
    }
};
DevicePreviewService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_state_service__["a" /* AppStateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object])
], DevicePreviewService);

var _a, _b;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/device-preview.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/device-recovery.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__audio_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DeviceRecoveryService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









let DeviceRecoveryService = class DeviceRecoveryService {
    constructor(log, appConfig, deviceSettingsService, persistencyService, audioDeviceSettingsService) {
        this.log = log;
        this.appConfig = appConfig;
        this.deviceSettingsService = deviceSettingsService;
        this.persistencyService = persistencyService;
        this.audioDeviceSettingsService = audioDeviceSettingsService;
        this.DEVICE_STATE = {
            DISCONNECTED: 'disconnected',
            FAILED: 'failed_recovery',
            NONE: 'none'
        };
        this.recoverySessions = [];
        /**
         * notify on recovery ready
         * @type {BehaviorSubject}
         */
        this.recoverySessionsReady = new __WEBPACK_IMPORTED_MODULE_6_rxjs__["Subject"]();
        this.recoverySessionsReadyPromise = this.recoverySessionsReady.asObservable().toPromise();
    }
    /**
     * adding session to recovery sessions.
     * if session is an audio session - add it only if current recording is an audio only recoridng
     * @param sessionId
     * @param sessionName
     * @param isReady
     * @param reason
     */
    addRecoveryReadySession(sessionId, sessionName, isReady, reason = '') {
        let recoverySession = { sessionId: sessionId, name: sessionName, recoveryReady: isReady, reason: reason };
        this.persistencyService.get('recording')
            .then((recData) => {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](recData) || __WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](recData['details']) || __WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](recData['details']['files'])) {
                this.log.debug('recover-service: recording data is empty: ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(recData));
                this.recoverySessionsReady.next(false);
                this.recoverySessionsReady.complete();
            }
            else {
                //add session to recovery sessions only if needed
                if (recData['details'] &&
                    //if audio only - add audio session / else if not audio only - add only none audio sessions
                    ((recData['details']['isAudioOnly'] && sessionName === 'audio') || (!recData['details']['isAudioOnly']) && sessionName !== 'audio')) {
                    this.addOrUpdateRecoverySession(recoverySession);
                    this.log.info('Recovery ready session was added: ' + sessionId + ' name: ' + sessionName + ' is ready: ' + isReady + ' reason: ' + reason + '. ' +
                        ' Number of currently ready sessions: ' + this.recoverySessions.length + '. Waiting for ' + Object.keys(recData['details']['files']).length + ' sessions');
                }
                if (this.recoverySessions.length === Object.keys(recData['details']['files']).length) {
                    this.log.info('All recoverable sessions were loaded: ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(this.recoverySessions));
                    this.recoverySessionsReady.next(true);
                    this.recoverySessionsReady.complete();
                }
            }
        })
            .catch((err) => {
            this.log.error('Failed to load recording data from app persistent data. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.recoverySessionsReady.next(false);
            this.recoverySessionsReady.complete();
        });
    }
    resetRecoverySessions() {
        this.log.info('resetting recovery sessions');
        this.recoverySessionsReady = new __WEBPACK_IMPORTED_MODULE_6_rxjs__["Subject"]();
        this.recoverySessionsReadyPromise = this.recoverySessionsReady.asObservable().toPromise();
        this.recoverySessions.length = 0;
    }
    canRecoverDeviceForRecording(sessionName) {
        if (sessionName === 'audio') {
            return this.canRecoverAudioForRecording();
        }
        else {
            return this.canRecoverSessionForRecording(sessionName);
        }
    }
    /**
     * will return the file name
     * @param sessionName
     * @return {any}
     */
    shouldRecoverVisualDeviceForRecording(sessionName) {
        if (sessionName !== 'audio') {
            return this.shouldRecoverSessionForRecording(sessionName);
        }
        else {
            return Promise.reject('DeviceRecoveryService: shouldRecoverVisualDeviceForRecording - audio session is not a visual session');
        }
    }
    /**
     * loads user settings and compares them to current device configuration.
     * since when device first loaded it tries to use its' settings from app persistent data, if
     * previous settings were valid - the device uses them.
     * since capture recording session also includes audio settings - we need to check those too
     */
    canRecoverSessionForRecording(sessionName) {
        let canRecover = false;
        return this.deviceSettingsService.loadUserSettings(sessionName)
            .then((sessionSettings) => {
            canRecover = (sessionSettings && sessionSettings['device_id'] && sessionSettings['input_type_id'] &&
                sessionSettings['device_id'] === this.deviceSettingsService.getSessionData(sessionName).selectedDevice &&
                !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](sessionSettings['encoder_config']) &&
                sessionSettings['encoder_config'].profile === this.deviceSettingsService.getSessionData(sessionName).selectedEncoderProfile &&
                sessionSettings['encoder_config'].bitrate === this.deviceSettingsService.getSessionData(sessionName).selectedBitrate &&
                sessionSettings['encoder_id'] === this.deviceSettingsService.getSessionData(sessionName).selectedEncoder);
            if (!canRecover) {
                this.log.warn('DeviceRecoveryService: Selected ' + sessionName + ' does not equal to persistent data ' + sessionName + '.');
            }
            else {
                this.log.info('DeviceRecoveryService: Selected ' + sessionName + ' equals to persistent data ' + sessionName + '.');
            }
            this.log.info('DeviceRecoveryService: Persistent data ' + sessionName + ': ' + (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](sessionSettings) ? __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(sessionSettings) : '{}'));
            this.logSelectedDevice(sessionName);
            return this.shouldRecoverAudioForRecording()
                .then((shouldRecoverAudio) => {
                return shouldRecoverAudio ? this.canRecoverAudioForRecording() : true;
            });
        })
            .then((audioRecovery) => {
            if (!audioRecovery)
                this.log.error("Can't load audio in recovery mode");
            return canRecover && audioRecovery;
        })
            .catch((err) => {
            this.log.error('Failed to decide if can load ' + sessionName + ' in recovery mode. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     * returns relevant session video file path if should recover for current recording session name
     * @returns {Promise<TResult>}
     */
    shouldRecoverSessionForRecording(sessionName) {
        this.log.debug('shouldRecoverSessionForRecording: ' + sessionName);
        return Promise.all([this.persistencyService.get(sessionName), this.persistencyService.get('recording')])
            .then(([session, recording]) => {
            if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](session) && session['preview'] === 'enabled' &&
                !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](recording) && __WEBPACK_IMPORTED_MODULE_4_lodash__["isObject"](recording) && !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](recording['details']) &&
                !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](recording['details']['files']) && !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](recording['details']['files'][sessionName])) {
                return recording['details']['files'][sessionName];
            }
            else {
                return null;
            }
        })
            .catch((err) => {
            this.log.error('Failed to decide if to should load ' + sessionName + ' in recovery mode for recording. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    shouldRecoverAudioForRecording() {
        let isAudioDeviceValid = false;
        let audioRecordingFilePath = null;
        return Promise.all([this.persistencyService.get('audio'), this.getAudioSessionRecordingFile()])
            .then(([audioSession, audioFilePath]) => {
            isAudioDeviceValid = audioSession && audioSession['preview'] && audioSession['preview'] === 'enabled' && audioSession['device_id'];
            audioRecordingFilePath = audioFilePath;
            return this.checkIfAtLeastOneVisualDeviceShouldBeRecovered();
        })
            .then((shouldRecoverVisuals) => {
            //audio should be enabled + has a device id AND any other capture session should need to be recovered
            return (isAudioDeviceValid &&
                (shouldRecoverVisuals ||
                    (audioRecordingFilePath && this.appConfig.getConfigData('config.captureApp.audioOnlyRecording'))));
        })
            .catch((err) => {
            this.log.error('Failed to determine if should recover audio or not. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    getAudioSessionRecordingFile() {
        return this.persistencyService.get('recording')
            .then((recording) => {
            //if an audio only recording
            if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](recording) && recording['details'] && recording['details']['isAudioOnly']) {
                return recording['details']['files']['audio'];
            }
            else {
                return null;
            }
        })
            .catch((err) => {
            this.log.error('Failed to get audio only recording file. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     * go over all sessions in persistent data file and check if can be recovered
     * @returns {Promise<boolean>}
       */
    checkIfAtLeastOneVisualDeviceShouldBeRecovered() {
        let shouldRecoverPromises = [];
        let shouldRecover = false;
        return this.persistencyService.get('')
            .then(persistentDataObj => {
            __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](persistentDataObj), key => {
                if (key.startsWith('session')) {
                    shouldRecoverPromises.push(this.shouldRecoverSessionForRecording(key));
                }
            });
            return Promise.all(shouldRecoverPromises);
        })
            .then((recoverables) => {
            __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](recoverables, recoverable => {
                if (recoverable)
                    shouldRecover = true;
            });
            return shouldRecover;
        });
    }
    canRecoverAudioForRecording() {
        let that = this;
        return that.audioDeviceSettingsService.loadAudioUserSettings()
            .then((audioSettings) => {
            let canRecover = (audioSettings && audioSettings['device_id'] && audioSettings['input_type_id'] &&
                audioSettings['device_id'] === that.audioDeviceSettingsService.selectedAudioDevice) ||
                !audioSettings || (audioSettings && audioSettings['preview'] === 'disabled');
            if (!canRecover) {
                this.log.warn('DeviceRecoveryService: Selected audio does not equal to persistent data audio.');
            }
            else {
                this.log.info('DeviceRecoveryService: Selected audio equals to persistent data audio.');
            }
            this.log.info('DeviceRecoveryService: Persistent data audio: ' + (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](audioSettings) ? __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(audioSettings) : '{}'));
            this.log.info('DeviceRecoveryService: Selected audio: ' + that.audioDeviceSettingsService.selectedAudioDevice + ' ' +
                __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(that.audioDeviceSettingsService.selectedInputType));
            return canRecover;
        })
            .catch((err) => {
            that.log.error('Failed to decide if can load audio in recovery mode. ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    logSelectedDevice(sessionName) {
        let sessionData = this.deviceSettingsService.getSessionData(sessionName);
        if (sessionData) {
            let dataString = 'DeviceRecoveryService: Selected ' + sessionName + ': ';
            dataString += sessionData.selectedDevice ? sessionData.selectedDevice : 'No seleced device id.';
            dataString += (sessionData.selectedInputType && sessionData.selectedInputType['description']) ?
                sessionData.selectedInputType['description'] : 'No selected input type description.';
            dataString += sessionData.selectedEncoderProfile ? sessionData.selectedEncoderProfile : 'No selected encoder profile.';
            dataString += sessionData.selectedBitrate ? sessionData.selectedBitrate : 'No selected bitrate.';
            dataString += sessionData.selectedEncoder ? sessionData.selectedEncoder : 'No selected encoder.';
            this.log.info(dataString);
        }
        else {
            this.log.info('DeviceRecoveryService: Failed to get data from selected ' + sessionName + ' device object.');
        }
    }
    addOrUpdateRecoverySession(newSession) {
        this.log.info('addOrUpdateRecoverySession: ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(newSession));
        let updateIndex = -1;
        __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](this.recoverySessions, (session, index) => {
            if (session.sessionId === newSession.sessionId) {
                updateIndex = index;
                return false; //break lodash for each
            }
        });
        if (updateIndex > -1) {
            this.log.info('addOrUpdateRecoverySession: session already exists. ' +
                'Old session data: ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(this.recoverySessions[updateIndex]) +
                '. New session data: ' + __WEBPACK_IMPORTED_MODULE_7__utils_utils__["a" /* utils */].stringifyMsg(newSession));
            this.recoverySessions[updateIndex] = newSession;
        }
        else {
            this.recoverySessions.push(newSession);
        }
    }
};
DeviceRecoveryService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_8__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_1__video_device_settings_service__["a" /* VideoDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__video_device_settings_service__["a" /* VideoDeviceSettingsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_3__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_5__audio_device_settings_service__["a" /* AudioDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__audio_device_settings_service__["a" /* AudioDeviceSettingsService */]) === "function" && _e || Object])
], DeviceRecoveryService);

var _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/device-recovery.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/device-resources.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return DeviceResourcesService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let DeviceResourcesService = class DeviceResourcesService {
    constructor(appState, log, configService, devicePreviewService) {
        this.appState = appState;
        this.log = log;
        this.configService = configService;
        this.devicePreviewService = devicePreviewService;
        this.RESOURCES_STATE = {
            FREE: 'free',
            IN_USE: 'in_use' //resources are being used by the capture application
        };
        /**
         * locking free resource state
         */
        this.freeResourcesLock = false;
        /**
         * acts as a queue of actions
         */
        this.captureResourceTasks = [];
        /**
         * is resource capturing action in progress
         */
        this.actionInProgress = false;
        let initialVisible = !this.configService.getConfigData('config.captureApp.silentStart');
        this.currentResourceState = initialVisible ? this.RESOURCES_STATE.IN_USE : this.RESOURCES_STATE.FREE;
        let winVisibility = initialVisible ? 'visible' : 'not-visible';
        this.appState.setApplicationWindowState(winVisibility);
        this.registerWindowVisibilityChanges();
    }
    addCaptureResourceTask(captureResourceTask) {
        this.captureResourceTasks.push(captureResourceTask);
        //if there are no actions waiting (except from the current one), execute immediately
        if (this.captureResourceTasks.length === 1)
            this.executeNextAction();
    }
    executeNextAction() {
        if (this.actionInProgress)
            return;
        this.actionInProgress = true;
        let captureResourceTask = this.captureResourceTasks.shift();
        this.getRelevantResourceActionPromise(captureResourceTask.action, captureResourceTask.param)
            .catch((err) => {
            this.log.error('DeviceResourcesService: failed to execute: ' + captureResourceTask.action + ' action.' + __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* utils */].stringifyMsg(err));
        })
            .then(() => {
            this.actionInProgress = false;
            //call next action in line...
            if (this.captureResourceTasks.length > 0)
                this.executeNextAction();
        });
    }
    getRelevantResourceActionPromise(action, param) {
        return action === this.appState.WINDOW_STATE.VISIBLE.toString() ?
            this.getCaptureResources(param) :
            this.freeCaptureResources(param);
    }
    registerWindowVisibilityChanges() {
        this.log.info('DeviceResourcesService: onWindowVisibilityChanges');
        __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('on-window-status-change', (visibility) => {
            this.appState.setApplicationWindowState(visibility['state']);
            let currentWindowState = this.appState.getApplicationWindowState();
            this.log.info('DeviceResourcesService: handling on-window-status-change ' + currentWindowState);
            //if an action is needed
            if ((currentWindowState === this.appState.WINDOW_STATE.VISIBLE && !this.freeResourcesLock) ||
                (currentWindowState === this.appState.WINDOW_STATE.HIDDEN)) {
                this.addCaptureResourceTask({ action: currentWindowState.toString(), param: false });
            }
        });
    }
    /**
     * make sure our app will be able to use its' capture resources, starts all devices preview if needed
     * @return {any}
     */
    getCaptureResources(removeFreeResLock = true) {
        this.log.info('DeviceResourcesService: getCaptureResources');
        if (removeFreeResLock)
            this.freeResourcesLock = false; //remove lock only if explicitly requested
        if (this.currentResourceState === this.RESOURCES_STATE.FREE) {
            this.currentResourceState = this.RESOURCES_STATE.IN_USE; //to block duplicate calls
            return this.devicePreviewService.startPreviewSome(Object.keys(this.appState.getActiveVisualSessions()))
                .then(() => {
                this.log.info('DeviceResourcesService: successfully started devices preview and got resources');
            })
                .catch((err) => {
                this.log.error('DeviceResourcesService: Failed to get capture devices resources. ' + __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* utils */].stringifyMsg(err));
                this.currentResourceState = this.RESOURCES_STATE.FREE;
                return Promise.reject(err);
            });
        }
        else {
            this.log.info('DeviceResourcesService: resources are already in use by our application.');
            return Promise.resolve();
        }
    }
    /**
     * freeing all capture resources is needed
     * @param forceAndLock boolean if to free resource regardless of window state and make resources state persistent until
     * app call will change their state (ignore window visibility changes)
     * @return {any}
     */
    freeCaptureResources(forceAndLock = false) {
        this.log.info('DeviceResourcesService: freeCaptureResources');
        if (this.appState.isAppRecording()) {
            this.log.info('DeviceResourcesService: application is recording - not freeing resources');
            return Promise.resolve();
        }
        if (forceAndLock)
            this.freeResourcesLock = forceAndLock; //noly enabling the lock (disabling it with an explicit call to getResources...)
        if (forceAndLock || this.currentResourceState === this.RESOURCES_STATE.IN_USE &&
            this.appState.getApplicationWindowState() === this.appState.WINDOW_STATE.HIDDEN) {
            this.currentResourceState = this.RESOURCES_STATE.FREE; //to block duplicate calls
            return this.devicePreviewService.stopPreviewSome(Object.keys(this.appState.getActiveVisualSessions()))
                .then(() => {
                this.log.info('DeviceResourcesService: successfully closed devices preview and freed resources');
            })
                .catch((err) => {
                this.log.error('DeviceResourcesService: Failed to free capture devices resources. ' + __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* utils */].stringifyMsg(err));
                this.currentResourceState = this.RESOURCES_STATE.IN_USE;
                return Promise.reject(err);
            });
        }
        else {
            this.log.info('DeviceResourcesService: resources are already free.');
            return Promise.resolve();
        }
    }
};
DeviceResourcesService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__infra_app_state_service__["a" /* AppStateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_6__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_3__device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__device_preview_service__["a" /* DevicePreviewService */]) === "function" && _d || Object])
], DeviceResourcesService);

var _a, _b, _c, _d;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/device-resources.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/device-settings-base.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/**
 * Created by rnd-classroom on 10/8/2017.
 */



const mediaTypeMappings = {
    'audio': 'Audio',
    'video': 'Video',
    'screen': 'Video'
};
class DeviceSettingsServiceBase {
    constructor(persistencyService, appState, log, appConfig) {
        this.persistencyService = persistencyService;
        this.appState = appState;
        this.log = log;
        this.appConfig = appConfig;
        // holds per session data
        // key is sessionName
        this.sessions = {};
        this.limits = {};
    }
    addSession(sessionName) {
        this.sessions[sessionName] = {
            InputTypes: [],
            selectedInputType: null
        };
    }
    getSessionId(sessionName) {
        if (!this.getSessionData(sessionName)) {
            return null;
        }
        return this.getSessionData(sessionName).sessionId;
    }
    getPrimarySessionId() {
        let primarySessionName = this.appConfig.getConfigData('config.captureApp.primarySessionName');
        return this.getSessionId(primarySessionName);
    }
    /*
    *
    * */
    getPersistedMediaType(selectedDeviceId, inputTypes, userSettings, defaultValue) {
        let persistedInputType = defaultValue;
        if (userSettings && userSettings['device_id'] === selectedDeviceId && userSettings['input_type_id'] && !__WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](userSettings['input_type_id'])) {
            persistedInputType = userSettings['input_type_id'];
            // REMOVEME: persistency format upgrade: string field changed to object.
            // former 'description' made an 'id'
            if (__WEBPACK_IMPORTED_MODULE_1_lodash__["isString"](persistedInputType)) {
                persistedInputType = __WEBPACK_IMPORTED_MODULE_1_lodash__["find"](inputTypes, (type) => __WEBPACK_IMPORTED_MODULE_1_lodash__["eq"](JSON.parse(type.description).id, persistedInputType));
                if (persistedInputType) {
                    this.log.info('upgraded - found type: ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(persistedInputType));
                }
            }
            else {
                /**
                 *   check if in recovery mode.
                 *   if not keep persisted type only if matching type found
                 */
                if (!this.appState.isAppRecording()) {
                    persistedInputType = __WEBPACK_IMPORTED_MODULE_1_lodash__["find"](inputTypes, (type) => __WEBPACK_IMPORTED_MODULE_1_lodash__["eq"](type.description, persistedInputType.description));
                }
            }
            if (!persistedInputType)
                persistedInputType = defaultValue;
        }
        this.log.info('getPersistedMediaType input type ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(persistedInputType));
        return persistedInputType;
    }
    getInitialInputType(sessionName, inputTypes, selectedDeviceId) {
        return this.loadUserSettings(sessionName)
            .then((Settings) => {
            return this.getPersistedMediaType(selectedDeviceId, inputTypes, Settings, inputTypes[0]);
        })
            .catch((err) => {
            this.log.error('Failed to load initial input type for ' + sessionName + ' ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     * always return a new promise for settings data
     * @returns {Promise<T>}
     */
    loadDeviceUserSettings(sessionName) {
        return Promise.all([Promise.resolve(this.appConfig.getConfigData('config.captureApp.limits')), this.persistencyService.get(sessionName)])
            .then((result) => {
            return result;
        })
            .catch((err) => {
            this.log.warn('Failed to load user settings for ' + sessionName + ' device. ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
            return [{}, {}];
        });
    }
    /**
     * always return a new promise for settings data
     * @returns {Promise<T>}
     */
    loadUserSettings(sessionName) {
        return this.loadDeviceUserSettings(sessionName)
            .then((results) => {
            this.limits = results[0];
            return results[1];
        });
    }
    /**
     * get initial device selection
     * @param deviceList
     * @param userSettings
     * @return {Promise<T>|Promise<U>|Promise<R>}
     */
    getInitialDeviceSelection(sessionName, deviceList, userSettings) {
        return this.getAllSessionsPersistentData(sessionName)
            .then((persistentDataArray) => {
            //remove all undefined elements in the array.
            persistentDataArray = __WEBPACK_IMPORTED_MODULE_1_lodash__["compact"](persistentDataArray);
            //remove current session persistent data
            persistentDataArray.splice(0, 1);
            //default selection
            let selectedDevice = deviceList[0]; //todo impl. default selection algorithm.
            //check user settings
            if (userSettings && userSettings['device_id'] && !this.isDeviceInUse(userSettings['device_id'], sessionName, persistentDataArray)) {
                for (let key in deviceList) {
                    if (deviceList[key].device_id === userSettings['device_id']) {
                        selectedDevice = deviceList[key];
                        break;
                    }
                }
            }
            this.log.info('getInitialDeviceSelection:' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(selectedDevice));
            return selectedDevice;
        });
    }
    getAllSessionsPersistentData(mySession) {
        // get session names
        let sessions = this.getSessionsNames();
        // remove our sessionName
        __WEBPACK_IMPORTED_MODULE_1_lodash__["pull"](sessions, mySession);
        // first push our session
        let promises = [this.persistencyService.get(mySession)];
        __WEBPACK_IMPORTED_MODULE_1_lodash__["each"](sessions, (s) => {
            promises.push(this.persistencyService.get(s));
        });
        return Promise.all(promises);
    }
    //get initial default selection
    getInitialDevice(sessionName, deviceList) {
        return this.loadUserSettings(sessionName)
            .then((Settings) => {
            return this.getInitialDeviceSelection(sessionName, deviceList, Settings);
        })
            .catch((err) => {
            this.log.error('Failed to load initial device of type ' + sessionName + ' ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     * set selected video|screen type in device recording session
     * @param sessionId
     * @param selectedInputType (input type description which used as its' unique id)
     * @returns {Promise<TResult>}
     */
    setSelectedInputType(sessionName, sessionId, selectedInputType, saveData = true) {
        let media = sessionName === 'audio' ? mediaTypeMappings['audio'] : mediaTypeMappings['video']; //video / screen types are the same
        this.appState.onCallStarted('setSelected' + media + 'InputType', sessionId);
        return __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + `-set${media}InputType`, selectedInputType.description)
            .then(() => {
            this.appState.onCallEnded('setSelected' + media + 'InputType - SUCCESS', sessionId);
            this.sessions[sessionName].selectedInputType = selectedInputType;
            if (saveData) {
                this.persistencyService.set(sessionName + '.input_type_id', this.sessions[sessionName].selectedInputType);
            }
            return this.sessions[sessionName].selectedInputType;
        })
            .catch((err) => {
            this.appState.onCallEnded('setSelected' + media + 'InputType - FAILURE', sessionId);
            return Promise.reject(err);
        });
    }
    /**
     * set selected device in device recording session
     * @param sessionId
     * @param device
     * @param saveData
     * @returns {Promise<TResult>}
     */
    setSelectedDevice(sessionName, sessionId, device, saveData = true) {
        return this.setSelectedDeviceInternal(sessionName, sessionId, device)
            .then((device) => {
            this.sessions[sessionName].selectedDevice = device;
            if (saveData) {
                this.persistencyService.set(sessionName + '.device_id', device);
            }
            return device;
        });
    }
    /**
     * set selected device in device recording session
     * @param sessionId
     * @param device
     * @param type device type
     * @returns {Promise<TResult>}
     */
    setSelectedDeviceInternal(sessionName, sessionId, device) {
        let mediaType = sessionName === 'audio' ? mediaTypeMappings['audio'] : mediaTypeMappings['video']; //video / screen types are the same
        this.appState.onCallStarted('setSelected Device: ' + device, sessionId);
        return __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + `-set${mediaType}Device`, device)
            .then(() => {
            this.appState.onCallEnded(`setSelected ${sessionName} Device - SUCCESS`, sessionId);
            return device;
        })
            .catch((err) => {
            this.appState.onCallEnded(`setSelected ${sessionName} Device - FAILURE`, sessionId);
            return Promise.reject(err);
        });
    }
    // Set configuration
    isDeviceInUse(device, sessionNameToExclude, otherSessionsPersistentData) {
        let inUse = false;
        //check for other sessions current usage
        __WEBPACK_IMPORTED_MODULE_1_lodash__["each"](this.sessions, (session, sessionName) => {
            if (session.selectedDevice === device && sessionNameToExclude != sessionName) {
                inUse = true;
            }
        });
        //check for other sessions future usage
        __WEBPACK_IMPORTED_MODULE_1_lodash__["each"](otherSessionsPersistentData, (data) => {
            if (data['device_id'] === device) {
                inUse = true;
            }
        });
        return inUse;
    }
    getSessionData(sessionName) {
        return this.sessions[sessionName];
    }
    getSessionDataById(sessionId) {
        let ret = null;
        this.getSessionsNames().forEach((sessionName) => {
            if (this.sessions[sessionName].sessionId === sessionId) {
                ret = this.sessions[sessionName];
            }
        });
        return ret;
    }
    getSessionNameById(sessionId) {
        let ret = null;
        this.getSessionsNames().forEach((sessionName) => {
            if (this.sessions[sessionName].sessionId === sessionId) {
                ret = sessionName;
            }
        });
        return ret;
    }
    getSessionsNames() {
        return __WEBPACK_IMPORTED_MODULE_1_lodash__["keys"](this.sessions);
    }
    setDeviceInUse(sessionName, device) {
        this.sessions[sessionName].selectedDevice = device;
    }
    /**
     * loads a list of input type for requested device
     * filtering out un relevant resolution / fps and other properties
     * also reorder according to input type 'grade'
     * @param sessionId
     * @param selectedDevice
     * @param limits
     * @returns {Promise<TResult>}
     */
    loadDeviceInputTypeList(sessionName, sessionId, selectedDevice, type) {
        let mediaType = mediaTypeMappings[type];
        let limits = this.limits[type];
        this.appState.onCallStarted('load' + mediaType + 'InputTypeList for ' + selectedDevice, sessionId);
        return __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + `-get${mediaType}InputTypeList`, selectedDevice)
            .then((inputTypes) => {
            this.appState.onCallEnded('load' + mediaType + 'InputTypeList - SUCCESS', sessionId);
            return this.filterInputTypes(inputTypes, limits);
        })
            .then((inputTypes) => {
            this.sessions[sessionName].InputTypes = __WEBPACK_IMPORTED_MODULE_1_lodash__["clone"](inputTypes);
            return this.sessions[sessionName].InputTypes;
        })
            .catch((err) => {
            this.appState.onCallEnded('load' + mediaType + 'InputTypeList - FAILURE', sessionId);
            return Promise.reject(err);
        });
    }
    filterInputTypes(inputTypes, limits) {
        throw new Error('not implemented');
    }
    saveDeviceSelections(sessionName) {
        return Promise.all([
            this.persistencyService.set(sessionName + '.device_id', this.sessions[sessionName].selectedDevice),
            this.persistencyService.set(sessionName + '.input_type_id', this.sessions[sessionName].selectedInputType || {})
        ]);
    }
    clearDeviceSelections(sessionName, clearPersistency = false) {
        return this.persistencyService.get(sessionName)
            .then((sessionObj) => {
            let previewState = sessionObj && sessionObj['preview'] ? sessionObj['preview'] : 'disabled';
            this.sessions[sessionName].selectedDevice = null;
            this.sessions[sessionName].selectedInputType = null;
            //settings a new session presistency object with last preview state - only settings was cleared
            return clearPersistency ? this.persistencyService.set(sessionName, { preview: previewState }) : Promise.resolve(true);
        });
    }
    // encoder configuration
    /**
     * loads a list of device encoders for the device that was set earlier
     * @param sessionId, type (sessionName)
     * @returns {Promise<TResult>}
     */
    loadDeviceEncoderList(sessionId, sessionName) {
        let media = sessionName === 'audio' ? mediaTypeMappings['audio'] : mediaTypeMappings['video']; //video / screen types are the same
        this.appState.onCallStarted('load' + media + 'EncoderList', sessionId);
        return __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + `-get${media}EncoderList`)
            .then((encoders) => {
            this.appState.onCallEnded('load' + media + 'EncoderList - SUCCESS', sessionId);
            return encoders;
        })
            .catch((err) => {
            this.appState.onCallEnded('load' + media + 'EncoderList - FAILURE', sessionId);
            return Promise.reject(err);
        });
    }
    /**
     * loads a list of video encoders for the video|screen device that was set earlier
     * @param sessionId
     * @returns {Promise<TResult>}
     */
    loadEncoderList(sessionName, sessionId) {
        return this.loadDeviceEncoderList(sessionId, sessionName)
            .then((encoders) => {
            this.sessions[sessionName].Encoders = __WEBPACK_IMPORTED_MODULE_1_lodash__["clone"](encoders);
            // loading the list might yield a different result,
            // so make sure not to use something that does not exist anymore
            return this.getInitialEncoder(sessionName, this.sessions[sessionName].Encoders);
        })
            .then((encoder) => {
            this.sessions[sessionName].selectedEncoder = encoder;
            return this.sessions[sessionName].Encoders;
        });
    }
    /**
     * getting initial input type
     * if user already set one - take user selection (if exists)
     * if not take one according to configured parameters
     * @param inputTypes
     * @returns {string|(()=>string)|any}
     */
    getInitialEncoder(sessionName, encoders) {
        let that = this;
        return that.loadUserSettings(sessionName)
            .then((settings) => {
            return this.getInitialEncoderSelection(encoders, settings);
        })
            .catch((err) => {
            that.log.error('Failed to load initial encoder ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     *
     * @param encoders
     * @param userSettings
     * @return {any}
     */
    getInitialEncoderSelection(encoders, userSettings) {
        //default selection
        let selectedEncoder = encoders[0].encoder_id; //todo impl. default selection algorithm.
        //check user settings
        if (userSettings && userSettings['encoder_id']) {
            for (let key in encoders) {
                if (encoders[key].encoder_id === userSettings['encoder_id']) {
                    selectedEncoder = userSettings['encoder_id'];
                    break;
                }
            }
        }
        return selectedEncoder;
    }
    /**
     * set selected encoder in device recording session
     * @param sessionId
     * @param encoder
     * @param sessionName
     * @returns {Promise<TResult>}
     */
    setSelectedDeviceEncoder(sessionId, encoder, sessionName) {
        let media = sessionName === 'audio' ? mediaTypeMappings['audio'] : mediaTypeMappings['video']; //video / screen types are the same
        this.appState.onCallStarted('setSelected' + media + 'Encoder: ' + encoder, sessionId);
        return __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(`${sessionId}-set${media}Encoder`, encoder)
            .then(() => {
            this.appState.onCallEnded('setSelected' + media + 'Encoder - SUCCESS', sessionId);
            return encoder;
        })
            .catch((err) => {
            this.appState.onCallEnded('setSelected' + media + 'Encoder - FAILURE', sessionId);
            return Promise.reject(err);
        });
    }
    // EncoderConfig: { number bitrate; string profile ('base','high','main'); string mode ('vbr','cbr') }
    setSelectedDeviceEncoderConfig(sessionId, encoderConfig, sessionName) {
        let media = sessionName === 'audio' ? mediaTypeMappings['audio'] : mediaTypeMappings['video']; //video / screen types are the same
        this.appState.onCallStarted('setSelected' + media + 'EncoderConfig: ' + JSON.stringify(encoderConfig), sessionId);
        return __WEBPACK_IMPORTED_MODULE_0__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + `-set${media}EncoderConfig`, encoderConfig)
            .then(() => {
            this.appState.onCallEnded('setSelected' + media + 'EncoderConfig - SUCCESS', sessionId);
            return encoderConfig;
        })
            .catch((err) => {
            this.appState.onCallEnded('setSelected' + media + 'EncoderConfig - FAILURE', sessionId);
            return Promise.reject(err);
        });
    }
    /**
     * set selected encoder in recording session
     * @param sessionId
     * @param encoder
     * @returns {Promise<TResult>}
     */
    setSelectedEncoder(sessionName, sessionId, encoder, saveData = true) {
        return this.setSelectedDeviceEncoder(sessionId, encoder, sessionName)
            .then((encoder) => {
            this.sessions[sessionName].selectedEncoder = encoder;
            if (saveData) {
                this.persistencyService.set(sessionName + '.encoder_id', encoder);
            }
            return encoder;
        });
    }
    generateEncoderConfig(sessionName) {
        throw new Error('not-implemented');
    }
    // EncoderConfig: { number bitrate; string profile ('base','high','main'); string mode ('vbr','cbr') }
    setSelectedEncoderConfig(sessionName, sessionId, saveData = true) {
        return this.setSelectedDeviceEncoderConfig(sessionId, this.generateEncoderConfig(sessionName), sessionName)
            .then((encoderConfig) => {
            if (saveData) {
                this.persistencyService.set(sessionName + '.encoder_config', encoderConfig);
            }
            return encoderConfig;
        });
    }
    getSessionNameByDeviceId(device_id) {
        let retSessionName;
        __WEBPACK_IMPORTED_MODULE_1_lodash__["each"](this.sessions, (session, sessionName) => {
            if (session.selectedDevice === device_id) {
                retSessionName = sessionName;
                return false; // breaks lodash loop
            }
        });
        return retSessionName;
    }
}
/* harmony export (immutable) */ __webpack_exports__["a"] = DeviceSettingsServiceBase;

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/device-settings-base.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/video-device-settings.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__device_settings_base_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-settings-base.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return VideoDeviceSettingsService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};











let VideoDeviceSettingsService = class VideoDeviceSettingsService extends __WEBPACK_IMPORTED_MODULE_9__device_settings_base_service__["a" /* DeviceSettingsServiceBase */] {
    constructor(persistencyService, appState, log, appConfig, devicePreviewService) {
        super(persistencyService, appState, log, appConfig);
        this.devicePreviewService = devicePreviewService;
        //holds device list objects for current settings load (needed for device bounds property)
        this.deviceObjects = {};
        this.Bitrates = [
            { label: '1000 Kbps', value: '1000000' },
            { label: '1500 Kbps', value: 1500 * 1000 },
            { label: '2000 Kbps', value: 2000 * 1000 },
            { label: '2500 Kbps', value: 2500 * 1000 },
            { label: '3000 Kbps', value: 3000 * 1000 },
            { label: '4000 Kbps', value: 4000 * 1000 },
            { label: '4500 Kbps', value: 4500 * 1000 },
            { label: '5000 Kbps', value: 5000 * 1000 },
            { label: '5500 Kbps', value: 5500 * 1000 },
            { label: '6000 Kbps', value: 6000 * 1000 }
        ];
        this.encoderProfiles = [
            { label: 'Base', value: 'Base' },
            { label: 'Main', value: 'Main' },
            { label: 'High', value: 'High' }
        ];
        //handling loadDeviceList requests in order to make sure they will be executed sync.
        this.loadDeviceListRequests = [];
        //loading device list lock
        this.loadingDeviceList = false;
        this.addDefaultSessionsObjects();
    }
    loadVideoBitrateList(sessionId) {
        return Promise.resolve(__WEBPACK_IMPORTED_MODULE_6_lodash__["clone"](this.Bitrates));
    }
    loadVideoProfileList(sessionId) {
        return this.getEncoderProfiles();
    }
    getDeviceData(deviceId) {
        return this.deviceObjects[deviceId];
    }
    getDeviceDataBySessionId(sessionId) {
        let sessionData = this.getSessionDataById(sessionId);
        let deviceData = this.getDeviceData(sessionData.selectedDevice);
        return deviceData;
    }
    getDeviceTypeById(deviceId) {
        return (this.deviceObjects[deviceId] && this.deviceObjects[deviceId].capture_type.toLowerCase() == 'screen') ? 'screen' : 'video';
    }
    getDeviceTypeBySessionName(sessionName) {
        return this.getDeviceTypeById(this.getSessionData(sessionName).selectedDevice);
    }
    /**
     * return all video device settings for settings component
     * @param sessionName
     * @param defaultDeviceType
     */
    getVideoDeviceSettings(sessionName, defaultDeviceType) {
        let sessionId = this.getSessionId(sessionName);
        //get device list
        return this.registerForDeviceListLoading(sessionName, defaultDeviceType)
            .then((captureDevices) => {
            this.log.info('loading ' + sessionName + ' device list');
            return captureDevices;
        })
            .then((captureDevices) => {
            return Promise.all([
                Promise.resolve(captureDevices),
                this.loadEncoderList(sessionName, sessionId),
                this.loadVideoBitrateList(sessionId),
                this.loadVideoProfileList(sessionId)
            ]);
        });
    }
    registerForDeviceListLoading(sessionName, defaultDeviceType) {
        this.log.info('registerForDeviceListLoading: ' + sessionName + ', ' + defaultDeviceType);
        let deviceListRequest = new __WEBPACK_IMPORTED_MODULE_7_rxjs__["Subject"]();
        let deviceListRequestPromise = deviceListRequest.asObservable().toPromise();
        this.loadDeviceListRequests.push({ sessionName: sessionName, defaultDeviceType: defaultDeviceType, observerPromise: deviceListRequest });
        this.loadDeviceListSync();
        return deviceListRequestPromise;
    }
    loadDeviceListSync() {
        this.log.info('loadDeviceListSync triggered');
        if (!this.loadingDeviceList && this.loadDeviceListRequests.length > 0) {
            let request = this.loadDeviceListRequests.shift();
            if (request) {
                this.log.info('loadDeviceListSync calling to loadDeviceList and locking device list requests');
                this.loadDeviceList(request.sessionName, request.defaultDeviceType, request.observerPromise);
                this.loadingDeviceList = true;
            }
        }
    }
    loadDeviceList(sessionName, defaultDeviceType, observerPromise) {
        this.log.info('loadDeviceList: sessionName: ' + sessionName + ' defaultDeviceType: ' + defaultDeviceType);
        __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getVideoDeviceList')
            .then((devices) => {
            //reset device list
            this.deviceObjects = {};
            //filtering devices with empty device_id
            devices = __WEBPACK_IMPORTED_MODULE_6_lodash__["filter"](devices, (device) => {
                return !__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](device['device_id']);
            });
            this.log.info('devices loaded: ' + JSON.stringify(devices));
            for (let i in devices) {
                this.deviceObjects[devices[i].device_id] = devices[i];
            }
            return devices;
        })
            .then((devices) => {
            return Promise.all([this.getAllSessionsPersistentData(sessionName), Promise.resolve(devices)]);
        })
            .then(([persistencyData, devices]) => {
            let ourSessionPersistencyData = persistencyData[0];
            persistencyData.splice(0, 1);
            // remove sessions where device_id is not set
            persistencyData = __WEBPACK_IMPORTED_MODULE_6_lodash__["filter"](persistencyData, (pd) => {
                return !(__WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](pd) || (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](pd) && __WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](pd['device_id'])));
            });
            let ordered = __WEBPACK_IMPORTED_MODULE_6_lodash__["sortBy"](devices, (d) => {
                return (d.capture_type === defaultDeviceType) ? 0 : 1;
            });
            // remove devices in use by other sessions
            let filtered = __WEBPACK_IMPORTED_MODULE_6_lodash__["filter"](ordered, (d) => {
                return (!this.isDeviceInUse(d.device_id, sessionName, persistencyData));
            });
            // get devices in use from persistencyData
            let devicesInUse;
            if (persistencyData && persistencyData.length > 0) {
                devicesInUse = __WEBPACK_IMPORTED_MODULE_6_lodash__["map"](persistencyData, (x) => {
                    return x['device_id'];
                });
            }
            devicesInUse = __WEBPACK_IMPORTED_MODULE_6_lodash__["filter"](devicesInUse, (d) => { return __WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](d); });
            // filter out devices used by other sessions ( by persistancy ) - this is important for startup
            let filtered2 = __WEBPACK_IMPORTED_MODULE_6_lodash__["filter"](filtered, (d) => {
                return (__WEBPACK_IMPORTED_MODULE_6_lodash__["findIndex"](devicesInUse, function (pd) { return pd == d; }) == -1);
            });
            // set the device so the 2nd session wont use it
            if (filtered2.length > 0 && !__WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](ourSessionPersistencyData) && !__WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](ourSessionPersistencyData['device_id']) &&
                (this.appState.isAppRecording() || __WEBPACK_IMPORTED_MODULE_6_lodash__["find"](devices, ['device_id', ourSessionPersistencyData['device_id']]))) {
                this.setDeviceInUse(sessionName, ourSessionPersistencyData['device_id']);
            }
            else if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](filtered2) && !__WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](filtered2[0]) && !__WEBPACK_IMPORTED_MODULE_6_lodash__["isNil"](filtered2[0].device_id)) {
                this.setDeviceInUse(sessionName, filtered2[0].device_id);
            }
            observerPromise.next(filtered2);
            observerPromise.complete();
            this.log.info('defaultDeviceType freeing device list requests lock and calling next request if needed');
            this.loadingDeviceList = false;
            this.loadDeviceListSync();
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.log.error('defaultDeviceType freeing device list requests lock and calling next request if needed');
            this.loadingDeviceList = false;
            this.loadDeviceListSync();
            return Promise.reject(err);
        });
    }
    /**
     * loads a list of input type for requested device
     * filtering out un relevant resolution / fps and other video properties
     * also reorder according to input type 'grade'
     * @param sessionId
     * @param selectedDevice
     * @returns {Promise<TResult>}
     */
    loadInputTypeList(sessionName, sessionId, selectedDevice, type) {
        return this.loadDeviceInputTypeList(sessionName, sessionId, selectedDevice, type);
    }
    filterInputTypes(inputTypes, limits) {
        return __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].filterAndSortInputs(inputTypes, limits);
    }
    getEncoderProfiles() {
        return __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getOsData')
            .then(osData => {
            let versionParts = osData['osVersion'].split('.');
            // win ver <= 7
            if (Number(versionParts[0]) < 7 && Number(versionParts[1]) < 2) {
                this.encoderProfiles = [
                    { label: 'Base', value: 'Base' },
                    { label: 'Main', value: 'Main' }
                ];
            }
            return __WEBPACK_IMPORTED_MODULE_6_lodash__["clone"](this.encoderProfiles);
        })
            .catch((err) => {
            return __WEBPACK_IMPORTED_MODULE_6_lodash__["clone"](this.encoderProfiles);
        });
    }
    getInitialBitrate(sessionName, bitrates) {
        return this.loadUserSettings(sessionName)
            .then((settings) => {
            return this.getInitialBitrateInternal(bitrates, settings);
        })
            .catch((err) => {
            this.log.error('Failed to load initial bitrate for ' + sessionName + ' ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     * get initial device bitrate
     * @param bitrates
     * @param userSettings
     * @return {any}
     */
    getInitialBitrateInternal(bitrates, userSettings) {
        //default selection
        let selectedBitrate = bitrates[2].value; //todo impl. default selection algorithm.
        //check user settings
        if (userSettings && userSettings['encoder_config'] && userSettings['encoder_config']['bitrate']) {
            selectedBitrate = userSettings['encoder_config']['bitrate'];
        }
        return selectedBitrate;
    }
    getInitialEncoderProfile(sessionName, encoderProfiles) {
        return this.loadUserSettings(sessionName)
            .then((settings) => {
            return this.getInitialEncoderProfileInternal(encoderProfiles, settings);
        })
            .catch((err) => {
            this.log.error('Failed to load initial encoder profile for ' + sessionName + ' ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    /**
     * get initial encoder profile
     * @param encoderProfiles
     * @param userSettings
     * @return {Promise<T>|Promise<U>|Promise<R>}
     */
    getInitialEncoderProfileInternal(encoderProfiles, userSettings) {
        let selectedProfile = encoderProfiles[0].value; //todo impl. default selection algorithm.
        //check user settings
        if (userSettings && userSettings['encoder_config'] && userSettings['encoder_config']['profile']) {
            selectedProfile = userSettings['encoder_config']['profile'];
        }
        return selectedProfile;
    }
    // EncoderConfig: { number bitrate; string profile ('base','high','main'); string mode ('vbr','cbr') }
    generateVideoEncoderConfig(selectedBitrate, selectedEncoderProfile) {
        let encoderConfig = {};
        encoderConfig['bitrate'] = parseInt(selectedBitrate);
        encoderConfig['brmode'] = 'cbr';
        encoderConfig['profile'] = selectedEncoderProfile;
        return encoderConfig;
    }
    generateEncoderConfig(sessionName) {
        return this.generateVideoEncoderConfig(this.sessions[sessionName].selectedBitrate, this.sessions[sessionName].selectedEncoderProfile);
    }
    loadInitialVideoDeviceSettings(sessionName, defaultDeviceType) {
        return this.setInitialDevice(sessionName, defaultDeviceType)
            .then(() => {
            return this.setInitialDeviceEncoder(sessionName);
        })
            .then(() => {
            return this.setInitialInputType(sessionName, this.getSessionData(sessionName).selectedDevice);
        })
            .then(() => {
            return this.setInitialDeviceEncoderConfig(sessionName);
        })
            .then(() => {
            return this.resetToFullScreenCapture(sessionName, false);
        });
    }
    /**
     * return initial selected video device
     */
    setInitialDevice(sessionName, defaultDeviceType) {
        this.log.info('setInitialDevice - ' + sessionName);
        return this.registerForDeviceListLoading(sessionName, defaultDeviceType)
            .then((devices) => {
            if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](devices)) {
                return this.configureInitialDevice(sessionName, devices);
            }
            else {
                this.clearDeviceSelections(sessionName, false);
                return this.noDevicesPromiseReject();
            }
        })
            .catch((err) => {
            this.log.error('Failed to load and set initial video device. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    setInitialDeviceEncoder(sessionName) {
        this.log.info('setInitialDeviceEncoder - ' + sessionName);
        return this.loadEncoderList(sessionName, this.getSessionId(sessionName))
            .then((encoders) => {
            return this.configureInitialEncoder(sessionName, encoders);
        })
            .catch((err) => {
            this.log.error('Failed to setInitialDeviceEncoder for ' + sessionName + '. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    setInitialInputType(sessionName, captureDevice) {
        this.log.info('setInitialInputType - ' + captureDevice);
        return this.loadInputTypeList(sessionName, this.getSessionId(sessionName), captureDevice, this.getDeviceTypeById(captureDevice))
            .then((inputTypes) => {
            if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](inputTypes)) {
                return this.configureInitialInputType(sessionName, inputTypes, captureDevice);
            }
            else {
                return Promise.reject('No input types were found for current ' + sessionName + ' device: ' + captureDevice);
            }
        })
            .catch((err) => {
            this.log.error('Failed to load and set initial ' + captureDevice + ' input type. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    setInitialDeviceEncoderConfig(sessionName, saveDate = false) {
        this.log.info('setInitialDeviceEncoderConfig - ' + sessionName);
        return this.loadVideoBitrateList(this.getSessionId(sessionName))
            .then((bitrates) => {
            return this.configureInitialBitrate(sessionName, bitrates);
        })
            .then(() => {
            return this.loadVideoProfileList(this.getSessionId(sessionName));
        })
            .then((encoderProfiles) => {
            return this.configureInitialEncoderProfile(sessionName, encoderProfiles);
        })
            .then(() => {
            return this.setSelectedEncoderConfig(sessionName, this.getSessionId(sessionName), saveDate);
        });
    }
    /**
     * returns the selection list default selection, if the list contains the current selected input type value
     * (of the requested option) it will return that value. otherwise it will return the first list element value
     * @param inputProperty
     * @param selectionList
     * @param reset
     * @returns {any}
     */
    getDefaultSelection(sessionName, inputs, inputProperty, reset = false) {
        if (!reset) {
            let input = __WEBPACK_IMPORTED_MODULE_6_lodash__["find"](inputs, [inputProperty, this.getSessionData(sessionName).selectedInputType[inputProperty]]);
            if (input) {
                return input[inputProperty];
            }
        }
        return inputs[0][inputProperty];
    }
    identifyDevice(selectedDevice, sessionName) {
        let device = this.getDeviceData(selectedDevice);
        if (device['bounds']) {
            __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('identify-device', { deviceBounds: device['bounds'], sessionName: sessionName });
        }
        return Promise.resolve();
    }
    shouldShowDeviceIndication(sessionName) {
        return this.getSessionData(sessionName) &&
            this.getSessionData(sessionName).selectedDevice &&
            this.getDeviceTypeBySessionName(sessionName) === 'screen';
    }
    configureInitialDevice(sessionName, devices) {
        this.log.info('configureInitialDevice - ' + sessionName);
        return this.getInitialDevice(sessionName, devices)
            .then((selectedDevice) => {
            selectedDevice = selectedDevice.device_id;
            this.log.info('setting the following ' + sessionName + ' device: ' + selectedDevice);
            return this.setSelectedDevice(sessionName, this.getSessionId(sessionName), selectedDevice, false);
        })
            .catch((err) => {
            this.log.error('Failed to configure initial ' + sessionName + ' device ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    configureInitialEncoder(sessionName, encoders) {
        this.log.info('configureInitialEncoder - ' + sessionName);
        return this.getInitialEncoder(sessionName, encoders)
            .then((selectedEncoder) => {
            this.log.info('setting the following ' + sessionName + ' encoder: ' + selectedEncoder);
            return this.setSelectedEncoder(sessionName, this.getSessionId(sessionName), selectedEncoder, false);
        })
            .catch((err) => {
            this.log.error('Failed to configure initial ' + sessionName + ' device ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    configureInitialInputType(sessionName, inputTypes, selectedDeviceId) {
        this.log.info('configureInitialInputType - ' + sessionName);
        return this.getInitialInputType(sessionName, inputTypes, selectedDeviceId)
            .then((inputType) => {
            this.log.info('setting then following ' + sessionName + ' input type: ' + inputType['description']);
            return this.setSelectedInputType(sessionName, this.getSessionId(sessionName), inputType, false);
        })
            .catch((err) => {
            this.log.error('Failed to configure ' + sessionName + ' initial input type ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    configureInitialBitrate(sessionName, bitrates) {
        this.log.info('configureInitialBitrate - ' + sessionName);
        return this.getInitialBitrate(sessionName, bitrates)
            .then((bitrate) => {
            this.log.info('setting then following ' + sessionName + ' bitrate: ' + bitrate);
            return this.setSelectedBitrate(sessionName, this.getSessionId(sessionName), bitrate);
        });
    }
    configureInitialEncoderProfile(sessionName, encoderProfiles) {
        this.log.info('configureInitialEncoderProfile - ' + sessionName);
        return this.getInitialEncoderProfile(sessionName, encoderProfiles)
            .then((encoderProfile) => {
            this.log.info('setting then following ' + sessionName + ' encoderProfiles: ' + encoderProfile);
            return this.setSelectedEncoderProfile(sessionName, this.getSessionId(sessionName), encoderProfile);
        });
    }
    noDevicesPromiseReject() {
        return Promise.reject('NO_VIDEO_DEVICES');
    }
    saveDeviceSelections(sessionName) {
        return Promise.all([
            super.saveDeviceSelections(sessionName),
            this.persistencyService.set(sessionName + '.encoder_id', this.sessions[sessionName].selectedEncoder),
            this.persistencyService.set(sessionName + '.encoder_config', this.generateVideoEncoderConfig(this.sessions[sessionName].selectedBitrate, this.sessions[sessionName].selectedEncoderProfile))
        ]);
    }
    clearDeviceSelections(sessionName, clearPersistency = false) {
        this.sessions[sessionName].selectedEncoder = null;
        this.sessions[sessionName].selectedBitrate = null;
        this.sessions[sessionName].selectedEncoderProfile = null;
        this.setSessionRegion(sessionName, null);
        return this.resetToFullScreenCapture(sessionName, false)
            .catch(() => { })
            .then(() => {
            return super.clearDeviceSelections(sessionName, clearPersistency);
        });
    }
    clearSessions() {
        this.log.info('Clearing sessions data');
        this.sessions = {};
        return this.addDefaultSessionsObjects();
    }
    setSelectedBitrate(sessionName, sessionId, bitrate) {
        this.sessions[sessionName].selectedBitrate = bitrate;
        return Promise.resolve(this.sessions[sessionName].selectedBitrate);
    }
    setSelectedEncoderProfile(sessionName, sessionId, encoderProfile) {
        this.sessions[sessionName].selectedEncoderProfile = encoderProfile;
        return Promise.resolve(this.sessions[sessionName].selectedEncoderProfile);
    }
    onDeviceChange(sessionName, sessionId, selectedDevice, selectedEncoder, selectedBitrate, selectedEncoderProfile) {
        return this.clearDeviceSelections(sessionName, true)
            .then(() => {
            return this.setSelectedDevice(sessionName, sessionId, selectedDevice);
        })
            .then(() => {
            return this.identifyDevice(selectedDevice, sessionName);
        })
            .then(() => {
            return this.loadEncoderList(sessionName, sessionId);
        })
            .then((encoders) => {
            return this.setSelectedEncoder(sessionName, sessionId, selectedEncoder);
        })
            .then(() => {
            return this.loadInputTypeList(sessionName, sessionId, selectedDevice, this.getDeviceTypeById(selectedDevice));
        })
            .then((inputTypes) => {
            this.log.info('loaded ' + sessionName + ' input type list');
            return this.getInitialInputType(sessionName, inputTypes, selectedDevice);
        })
            .then((initialInputType) => {
            return this.setSelectedInputType(sessionName, sessionId, initialInputType);
        })
            .then(() => {
            return this.setSelectedBitrate(sessionName, sessionId, selectedBitrate);
        })
            .then(() => {
            return this.setSelectedEncoderProfile(sessionName, sessionId, selectedEncoderProfile);
        })
            .then(() => {
            return this.setSelectedEncoderConfig(sessionName, sessionId);
        });
    }
    /**
     * will reload device configuration and limits and sets the same device with new default configurations
     * @param sessionName
     * @param sessionId
     * @param selectedDevice
     */
    reloadDeviceDefaultConfiguration(sessionName) {
        let sessionId = this.getSessionId(sessionName);
        let selectedDevice = this.sessions[sessionName].selectedDevice;
        let isSessionEnabled = false;
        return !selectedDevice ? Promise.resolve() :
            this.clearDeviceSelections(sessionName, true)
                .then(() => {
                return this.loadUserSettings(sessionName);
            })
                .then((settigns) => {
                isSessionEnabled = settigns.preview && settigns.preview === 'enabled' ? true : false;
                return isSessionEnabled ?
                    this.devicePreviewService.stopPreviewAndDeactivateSession(sessionId) : Promise.resolve();
            })
                .then(() => {
                return this.setSelectedDevice(sessionName, sessionId, selectedDevice);
            })
                .then(() => {
                return this.loadEncoderList(sessionName, sessionId);
            })
                .then(() => {
                return this.setSelectedEncoder(sessionName, sessionId, this.sessions[sessionName].selectedEncoder);
            })
                .then(() => {
                return this.loadInputTypeList(sessionName, sessionId, selectedDevice, this.getDeviceTypeById(selectedDevice));
            })
                .then((inputTypes) => {
                this.log.info('loaded ' + sessionName + ' input type list');
                return this.getInitialInputType(sessionName, inputTypes, selectedDevice);
            })
                .then((initialInputType) => {
                return this.setSelectedInputType(sessionName, sessionId, initialInputType);
            })
                .then(() => {
                return this.setInitialDeviceEncoderConfig(sessionName, true);
            })
                .then(() => {
                return this.resetToFullScreenCapture(sessionName, false);
            })
                .then(() => {
                return isSessionEnabled ?
                    this.devicePreviewService.startPreviewAndActivateSession(sessionId, sessionName, this.getDeviceTypeById(sessionId)) :
                    Promise.resolve();
            });
    }
    //set selected input type according to all input selected parameters
    onCsChange(sessionName, sessionId, selectedInputType) {
        return this.setSelectedInputType(sessionName, sessionId, selectedInputType)
            .then(() => {
            return this.devicePreviewService.refreshDevice(sessionId, sessionName, this.getDeviceTypeBySessionName(sessionName));
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    onBitrateChange(sessionName, sessionId, selectedBitrate) {
        return this.setSelectedBitrate(sessionName, sessionId, selectedBitrate)
            .then(() => {
            this.setSelectedEncoderConfig(sessionName, sessionId);
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    onEncoderProfileChange(sessionName, sessionId, selectedEncoderProfile) {
        return this.setSelectedEncoderProfile(sessionName, sessionId, selectedEncoderProfile)
            .then(() => {
            this.setSelectedEncoderConfig(sessionName, sessionId);
        })
            .catch((err) => {
            this.log.error(__WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    getDeviceEncoders(sessionName) {
        return this.sessions[sessionName].Encoders;
    }
    getSelectedEncoder(sessionName) {
        return this.sessions[sessionName].selectedEncoder;
    }
    /**
     * save the state of the session capture region area (Full screen/ region)
     *
     * @param sessionName
     * @param bounds: {}, null, undefined = Full Screen
     *                { x, y, width, height} = region
     */
    setSessionRegion(sessionName, bounds) {
        this.sessions[sessionName]['region'] = bounds;
    }
    getSessionRegion(sessionName) {
        return this.sessions[sessionName] ? this.sessions[sessionName]['region'] : null;
    }
    /**
     * change the screen recording and preview area + add rect to mark the location where we capture.
     * @param sessionName
     * @param engineBounds   =  { width, height, x, y}  or {} to clear.
     * @param electronBounds
     * @returns Promis
     */
    setVideoCaptureRegion(sessionName, engineBounds, electronBounds) {
        let captureBounds = engineBounds;
        let sessionId = this.getSessionId(sessionName);
        let selectionSquarePromise;
        let error;
        if (sessionId && this.getDeviceTypeBySessionName(sessionName) === 'screen') {
            if (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](engineBounds) && !__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](electronBounds)) {
                selectionSquarePromise = __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getScreenScaleFactorByPlatform', electronBounds)
                    .then((scaleFactor) => {
                    if (scaleFactor) {
                        captureBounds = {
                            width: Math.floor(engineBounds.width - (4 * scaleFactor)),
                            height: Math.floor(engineBounds.height - (4 * scaleFactor)),
                            x: Math.floor(engineBounds.x + (2 * scaleFactor)),
                            y: Math.floor(engineBounds.y + (2 * scaleFactor)),
                        };
                        this.log.info('VideoDeviceService CaptureRegion: show-selection-square for sessionName: ' + sessionName + ', electronBounds: ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(electronBounds));
                        return __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('show-selection-square', { bounds: electronBounds, sessionName: sessionName });
                    }
                    else {
                        return Promise.resolve({});
                    }
                });
            }
            else {
                selectionSquarePromise = __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('hide-selection-square', sessionName);
            }
            return selectionSquarePromise
                .then(() => {
                this.appState.onCallStarted('setVideoCaptureRegion', sessionId);
                this.log.info('VideoDeviceService CaptureRegion: ' + sessionId + '-setVideoCaptureRegion for sessionName: ' + sessionName + ', bounds: ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(engineBounds));
                return __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + '-setVideoCaptureRegion', captureBounds);
            })
                .then(() => {
                this.appState.onCallEnded('setVideoCaptureRegion - SUCCESS', sessionId);
                this.log.info('VideoDeviceService: CaptureRegion was successfully defined to sessionName: ' + sessionName + ' ' + sessionId + ' ' + (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](engineBounds) ? __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(engineBounds) : 'Full screen'));
                this.setSessionRegion(sessionName, { engineBounds, electronBounds });
            })
                .then(() => {
                return this.devicePreviewService.refreshDevice(sessionId, sessionName, this.getDeviceTypeBySessionName(sessionName));
            })
                .catch(err => {
                this.appState.onCallEnded('setVideoCaptureRegion - FAILURE', sessionId, err);
                this.log.error('VideoDeviceService: CaptureRegion: Failed to set region for sessionName: '
                    + sessionName + ' ' + (!__WEBPACK_IMPORTED_MODULE_6_lodash__["isEmpty"](engineBounds) ? __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(engineBounds) : 'Full screen') + ' error: ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
                return Promise.reject(err);
            });
        }
        else {
            this.log.info('setVideoCaptureRegion is not implemented for the following capture type: ' + this.getDeviceTypeBySessionName(sessionName));
            return Promise.resolve(sessionId);
        }
    }
    resetToFullScreenCapture(sessionName, updatePersistency) {
        this.devicePreviewService.resetToFullScreenCapture();
        return this.setVideoCaptureRegion(sessionName, {}, null)
            .then(() => {
            return updatePersistency ? this.persistencyService.set(sessionName + '.captureRegion', {}) : Promise.resolve({});
        });
    }
    resetPersistencyOfScreenCapture() {
        return this.appState.getVisualSessionsFromPersistentData()
            .then(sessions => {
            let resetPromises = [];
            __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_6_lodash__["keys"](sessions), sessionName => {
                resetPromises.push(this.persistencyService.set(sessionName + '.captureRegion', {}));
            });
            return Promise.all(resetPromises);
        });
    }
    getAllActiveDevicesObjects() {
        let devices = [];
        __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](this.sessions, (sessionObj, sessionName) => {
            if (this.appState.getActiveRecordableSessionsIds().indexOf(this.getSessionId(sessionName)) > -1) {
                devices.push(this.getDeviceData(sessionObj.selectedDevice));
            }
        });
        return devices;
    }
    addDefaultSessionsObjects() {
        this.appState.getVisualSessionsNamesAndDefaultTypesForInit()
            .then(sessions => {
            __WEBPACK_IMPORTED_MODULE_6_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_6_lodash__["keys"](sessions), sessionName => {
                this.addSession(sessionName);
            });
        });
    }
};
VideoDeviceSettingsService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_8__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__["a" /* AppStateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_0__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_10__device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__device_preview_service__["a" /* DevicePreviewService */]) === "function" && _e || Object])
], VideoDeviceSettingsService);

var _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/video-device-settings.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/capture-device/video-device.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__device_recovery_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-recovery.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__device_preview_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-preview.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__audio_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__ = __webpack_require__("../../../../../src/shared/services/monitoring/app-monitoring-agent-error-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__capture_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/capture-device.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__live_live_manager_service__ = __webpack_require__("../../../../../src/shared/services/live/live-manager.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return VideoDeviceService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};















let VideoDeviceService = class VideoDeviceService extends __WEBPACK_IMPORTED_MODULE_12__capture_device_service__["a" /* CaptureDeviceService */] {
    constructor(appState, log, recoveryService, notificationService, devicePreviewService, deviceSettingsService, audioDeviceService, appMonitoringAgentData, config, persistencyService, liveManagerService) {
        super(appState, log, deviceSettingsService, recoveryService);
        this.appState = appState;
        this.log = log;
        this.recoveryService = recoveryService;
        this.notificationService = notificationService;
        this.devicePreviewService = devicePreviewService;
        this.deviceSettingsService = deviceSettingsService;
        this.audioDeviceService = audioDeviceService;
        this.appMonitoringAgentData = appMonitoringAgentData;
        this.config = config;
        this.persistencyService = persistencyService;
        this.liveManagerService = liveManagerService;
        this.CAPTURE_TYPE = {
            SCREEN: 'screen',
            VIDEO: 'video'
        };
    }
    /**
     * creates capture device recording session
     * configure device
     * try to load in recovery mode
     */
    initDevice(sessionName, defaultDeviceType) {
        return this.createSessionAndConfigureDevice(sessionName, defaultDeviceType)
            .then(() => {
            //on success init of a device, we need to clear all relevat errors
            this.appMonitoringAgentData.clearError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, this.captureTypeToMonitoringSource(sessionName));
            //since during device init we are init audio as well. on success we need to clear all relevant errors
            this.appMonitoringAgentData.clearError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].AUDIO);
        });
    }
    /**
     * running device recovery process
     * @return {Promise<boolean>} if device should start preview or not
     */
    deviceRecoveryProcess(sessionName) {
        this.log.debug('deviceRecoveryProcess');
        return this.recoveryService.shouldRecoverVisualDeviceForRecording(sessionName)
            .then((recoverFileName) => {
            if (recoverFileName) {
                //recovery is needed - try to recover device
                return this.persistencyService.get(sessionName + '.captureRegion')
                    .then((engineAndElectronBounds) => {
                    if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](engineAndElectronBounds) && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](engineAndElectronBounds['engineBounds']) && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](engineAndElectronBounds['electronBounds'])) {
                        return this.setVideoCaptureRegion(sessionName, engineAndElectronBounds['engineBounds'], engineAndElectronBounds['electronBounds']);
                    }
                }).then(() => {
                    return this.persistencyService.get('recording.details.liveData.' + sessionName);
                }).then((liveData) => {
                    return liveData ? this.liveManagerService.addLiveConfig(liveData, this.getSessionId(sessionName)) : Promise.resolve();
                }).then(() => {
                    return this.tryToLoadInRecoveryMode(sessionName, this.getCaptureDeviceTypeBySessionName(sessionName), recoverFileName);
                }).then(() => {
                    return true;
                });
            }
            else {
                //although we weren't in recovery process - we set the recovery process for current device to true
                //so we will know device was configured and ready to capture
                this.recoveryService.addRecoveryReadySession(this.getSessionId(sessionName), sessionName, true);
                this.deviceSettingsService.saveDeviceSelections(sessionName);
                // If recovery is not needed - Reset persistency to full screen capture state
                return this.persistencyService.set(sessionName + '.captureRegion', {})
                    .then(() => {
                    // device should start previewing in a non recovery mode only if we are not during a recording
                    // if we are in the middle of a recording, the device was just disconnected when recording started
                    return !this.appState.isAppRecording();
                });
            }
        })
            .catch((err) => {
            if (err && err !== this.recoveryService.DEVICE_STATE.DISCONNECTED) {
                //if recovery failed due to an error different than disconnection save device settings
                this.deviceSettingsService.saveDeviceSelections(sessionName);
                return this.persistencyService.set(sessionName + '.captureRegion', {})
                    .catch(() => { return true; }).then(() => { return Promise.reject(err); });
            }
            //disconnection
            return Promise.reject(err);
        });
    }
    startDevicePreviewAndActivateSession(sessionName, location) {
        this.log.info('startDevicePreview: ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(location));
        return this.devicePreviewService.setPreviewPosition(this.getSessionId(sessionName), location)
            .then(() => {
            return this.devicePreviewService.startPreviewAndActivateSession(this.getSessionId(sessionName), sessionName, this.getCaptureDeviceTypeBySessionName(sessionName));
        })
            .then(() => {
            return this.devicePreviewService.checkIfToStartAudioPreview(this.audioDeviceService.getSessionId());
        })
            .then(() => {
            this.persistencyService.set(sessionName + '.preview', "enabled");
            return this.deviceSettingsService.saveDeviceSelections(sessionName);
        })
            .catch((err) => {
            this.log.error('Failed to startPreview - ' + sessionName + '. ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.notificationService.sendNotification('NOTIFICATIONS.error_' + sessionName + 'PreviewStart', 'error');
            return Promise.reject(err);
        });
    }
    stopDevicePreviewAndDeactivateSession(sessionName) {
        this.log.info('stopDevicePreviewAndDeactivateSession(): ' + sessionName);
        return this.devicePreviewService.stopPreviewAndDeactivateSession(this.getSessionId(sessionName))
            .then(() => {
            return this.devicePreviewService.checkIfToStopAudioPreview(this.audioDeviceService.getSessionId());
        })
            .then(() => {
            this.persistencyService.set(sessionName + '.preview', "disabled");
        })
            .catch((err) => {
            this.log.error('Failed to stopPreview - ' + sessionName + '. ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.notificationService.sendNotification('NOTIFICATIONS.error_' + sessionName + 'PreviewStart', 'error');
            return Promise.reject(err);
        });
    }
    hideDevicePreview(sessionName) {
        return this.updateDevicePreviewLocation(sessionName, { left: 0, top: 0, width: 0, height: 0 });
    }
    stopPreviewAll() {
        return this.devicePreviewService.stopPreviewAll();
    }
    stopAllVisualPreviewsExceptSessionName(exceptSessionName) {
        this.log.info('stopAllVisualPreviewsExceptSessionName(): ' + exceptSessionName);
        let sessionsArray = [];
        __WEBPACK_IMPORTED_MODULE_3_lodash__["forEach"](this.appState.getActiveVisualSessions(), (value, key) => {
            if (!exceptSessionName || this.getSessionNameById(key) !== exceptSessionName) {
                sessionsArray.push(key);
            }
        });
        if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](sessionsArray)) {
            return this.devicePreviewService.stopPreviewSome(sessionsArray);
        }
        else {
            return Promise.resolve();
        }
    }
    updateDevicePreviewLocation(sessionName, location) {
        return this.devicePreviewService.setPreviewPosition(this.getSessionId(sessionName), location)
            .catch((err) => {
            this.log.error('Failed to update ' + sessionName + ' device preview position. ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    isDevicePreviewing(sessionName) {
        return this.getSessionId(sessionName) && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.appState.getActiveSessions()[this.getSessionId(sessionName)]);
    }
    isDeviceStable(sessionName, sourceOnly = false) {
        return this.appState.isSourceStable(this.getSessionId(sessionName), sourceOnly);
    }
    shouldInitialPreviewDevice(sessionName) {
        this.log.info('shouldInitialPreviewDevice - ' + sessionName);
        return this.deviceSettingsService.loadUserSettings(sessionName)
            .then((settings) => {
            return (!settings || !settings['preview'] || settings['preview'] === "enabled");
        })
            .catch(() => {
            return true;
        });
    }
    repositionsDevicePreview(sessionName, position) {
        this.log.info('repositionsDevicePreview - ' + sessionName);
        this.shouldInitialPreviewDevice(sessionName)
            .then((preview) => {
            if (preview) {
                this.log.info('need to reposition ' + sessionName + ' Device Preview');
                return this.devicePreviewService.setPreviewPosition(this.getSessionId(sessionName), position);
            }
        });
    }
    shouldDisableDeviceConfiguration(sessionName, sourceOnly = false) {
        return !this.isDeviceStable(sessionName, sourceOnly) ||
            !this.deviceSettingsService.getSessionData(sessionName) ||
            !this.deviceSettingsService.getSessionData(sessionName).selectedDevice ||
            !this.deviceSettingsService.getSessionData(sessionName).InputTypes ||
            this.deviceSettingsService.getSessionData(sessionName).InputTypes.length === 0;
    }
    /**
     * if device initial configuration was successful - start device
     * if in recovery mode - build recording session accordingly
     * if in regular mode - start previewing device
     * @returns {Promise<boolean>} if to start device preview or not
     */
    startDevice(sessionName, previewPosition) {
        //check if need to load in recovery mode
        //if so try to load in recovery mode
        return this.shouldInitialPreviewDevice(sessionName)
            .then((shouldPreview) => {
            if (shouldPreview) {
                return Promise.all([shouldPreview, this.deviceRecoveryProcess(sessionName)]);
            }
            else {
                return Promise.all([shouldPreview, true]); //indication the recovery process didn't fail (it wasn't needed)
            }
        })
            .then(([startPreview, recoverySucceeded]) => {
            if (startPreview && recoverySucceeded) {
                this.log.debug('starting ' + sessionName + ' device preview after successful recovery process');
                return this.startDevicePreviewAndActivateSession(sessionName, previewPosition);
            }
            else {
                //everything went OK however this device should be disabled
                this.appState.addSession(this.getSessionId(sessionName), sessionName, this.appState.SESSION_STATE.IN_ACTIVE);
            }
        })
            .catch((err) => {
            return Promise.reject(err);
        });
    }
    getCaptureDeviceTypeBySessionName(sessionName) {
        if (this.deviceSettingsService.getSessionData(sessionName)) {
            return this.deviceSettingsService.getDeviceTypeBySessionName(sessionName);
        }
        else {
            return null;
        }
    }
    getCaptureDeviceTypeBySessionId(sessionId) {
        if (this.deviceSettingsService.getSessionDataById(sessionId)) {
            return this.deviceSettingsService.getDeviceTypeById(this.deviceSettingsService.getSessionDataById(sessionId).selectedDevice);
        }
        else {
            return null;
        }
    }
    getSessionNameById(sessionId) {
        return this.deviceSettingsService.getSessionNameById(sessionId);
    }
    createSessionAndConfigureDevice(sessionName, defaultDeviceType) {
        this.log.debug('createSessionAndConfigureDevice - ' + sessionName);
        return this.createDeviceSession(sessionName)
            .then(() => {
            //loading initial device configurations
            return this.loadInitialDeviceConfiguration(sessionName, defaultDeviceType);
        });
    }
    /**
     * will be rejected if an error will happen.
     * will return 'NO_VIDEO_DEVICES' / 'NO_SCREEN_DEVICE if no video / screen devices were connected
     */
    loadInitialDeviceConfiguration(sessionName, defaultDeviceType) {
        this.log.debug('loadInitialVideoDeviceConfiguration - ' + sessionName);
        return this.deviceSettingsService.loadInitialVideoDeviceSettings(sessionName, defaultDeviceType)
            .then(() => {
            this.log.info('loadInitialSharedAudioConfiguration - ' + sessionName);
            return this.audioDeviceService.loadInitialAudioDeviceConfiguration(this.getSessionId(sessionName), false);
        })
            .catch((err) => {
            if (err && __WEBPACK_IMPORTED_MODULE_3_lodash__["isString"](err) && err.indexOf('NO_AUDIO_DEVICES') > -1) {
                return this.recoveryService.shouldRecoverAudioForRecording()
                    .then((recover) => {
                    if (recover) {
                        this.log.error('Failed loading initial video device configuration. ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
                        return Promise.reject(err);
                    }
                    else {
                        this.log.info(sessionName + ' session was loaded without any audio device since there are no audio devices connected');
                        this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].AUDIO, 'NOTIFICATIONS.error_audioDevices');
                        this.notificationService.sendNotification('NOTIFICATIONS.error_audioDevices', 'warn');
                        return Promise.resolve();
                    }
                });
            }
            else {
                return Promise.reject(err);
            }
        });
    }
    /**
     * device error handling
     * @param err
     * @param elementPosition
     * @return {Promise<TResult>}
     */
    handleDeviceInitError(sessionName, err, elementPosition) {
        let shouldStartPreview = true;
        let errString = __WEBPACK_IMPORTED_MODULE_3_lodash__["isObject"](err) ? JSON.stringify(err) : err;
        //no device error handling
        if (errString.indexOf('NO_SCREEN_DEVICES') > -1 ||
            errString.indexOf('NO_VIDEO_DEVICES') > -1 ||
            errString.indexOf('NO_AUDIO_DEVICES') > -1) {
            //handle no device error
            shouldStartPreview = this.handleNoDeviceError(errString);
        }
        else if (errString.indexOf(this.recoveryService.DEVICE_STATE.DISCONNECTED) > -1 ||
            errString.indexOf(this.recoveryService.DEVICE_STATE.FAILED) > -1 ||
            errString.indexOf('AUDIO-' + this.recoveryService.DEVICE_STATE.DISCONNECTED) > -1) {
            //handle recovery failures
            shouldStartPreview = this.handleRecoveryError(sessionName, errString);
        }
        else if (errString.indexOf('AUDIO-') > -1) {
            //handle audio device errors
            shouldStartPreview = this.handleAudioInitializationError(sessionName, errString);
        }
        else {
            //handle screen / video device errors
            shouldStartPreview = this.handleRecordableInitializationError(sessionName, errString);
        }
        //if failed before even start to check if need to recover
        return this.finalizeErrorHandling(sessionName, errString, shouldStartPreview, elementPosition);
    }
    handleNoDeviceError(errString) {
        let shouldStartPreview = true;
        if (errString.indexOf('NO_SCREEN_DEVICES') > -1) {
            this.log.warn('No screen devices were detected');
            shouldStartPreview = false;
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].SCREEN, 'NOTIFICATIONS.error_screenDevices');
            this.notificationService.sendNotification('NOTIFICATIONS.error_screenDevices', 'warn');
        }
        else if (errString.indexOf('NO_VIDEO_DEVICES') > -1) {
            shouldStartPreview = false;
            this.log.warn('No video devices were detected');
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].VIDEO, 'NOTIFICATIONS.error_videoDevices');
            this.notificationService.sendNotification('NOTIFICATIONS.error_videoDevices', 'warn');
        }
        else if (errString.indexOf('NO_AUDIO_DEVICES') > -1) {
            this.log.warn('No audio devices were detected');
            shouldStartPreview = false; //disable capture device preview when audio doesn't exist
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].AUDIO, 'NOTIFICATIONS.error_audioDevices');
            this.notificationService.sendNotification('NOTIFICATIONS.error_audioDevices', 'warn');
        }
        return shouldStartPreview;
    }
    handleRecoveryError(sessionName, errString) {
        let shouldStartPreview = true;
        if (errString.indexOf(this.recoveryService.DEVICE_STATE.DISCONNECTED) > -1) {
            //if capture device was disconnected - do not preview it
            if (errString.indexOf('AUDIO-') === -1) {
                this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, this.captureTypeToMonitoringSource(sessionName), 'NOTIFICATIONS.error_deviceDisconnected', { 'captureType': this.captureTypeToMonitoringSource(sessionName) });
                this.log.error('Failed to recover ' + sessionName + ' device due to a device disconnection.');
            }
            else {
                this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].AUDIO, 'NOTIFICATIONS.error_deviceDisconnected', { 'captureType': 'Audio' });
                this.log.error('Failed to recover ' + sessionName + ' device due to a disconnection in audio.');
            }
            shouldStartPreview = false;
        }
        else if (errString.indexOf(this.recoveryService.DEVICE_STATE.FAILED) > -1) {
            shouldStartPreview = false;
            this.log.error('Failed to recover ' + sessionName + ' device.');
            let notificationText = 'NOTIFICATIONS.' +
                (sessionName !== this.config.getConfigData('config.captureApp.primarySessionName') ?
                    'error_secondaryDeviceRecovery' : 'error_primaryDeviceRecovery');
            this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, this.captureTypeToMonitoringSource(sessionName), notificationText);
            this.notificationService.sendNotification(notificationText, 'error');
        }
        return shouldStartPreview;
    }
    ///@todo - this is bad to do stuff based on session name
    handleAudioInitializationError(sessionName, errString) {
        this.log.error('Failed to initialize audio device. ' + errString);
        let notification = 'NOTIFICATIONS.' +
            (sessionName !== this.config.getConfigData('config.captureApp.primarySessionName') ?
                'error_audioForSecondary' : 'error_audioForPrimary');
        this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].AUDIO, notification);
        this.notificationService.sendNotification(notification, 'error');
        return false;
    }
    handleRecordableInitializationError(sessionName, errString) {
        this.log.error('Failed to initialize ' + sessionName + ' device. ' + errString);
        let notification = 'NOTIFICATIONS.' +
            (sessionName !== this.config.getConfigData('config.captureApp.primarySessionName') ?
                'error_secondaryDevice' : 'error_primaryDevice');
        this.appMonitoringAgentData.setError(__WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["b" /* MONITOR_ERROR_TYPE */].DEVICE_ERROR, this.captureTypeToMonitoringSource(sessionName), notification);
        this.notificationService.sendNotification(notification, 'error');
        return false;
    }
    finalizeErrorHandling(sessionName, errString, shouldStartPreview, elementPosition) {
        return this.recoveryService.shouldRecoverVisualDeviceForRecording(sessionName)
            .then((shouldRecover) => {
            if (shouldRecover) {
                this.log.error('Send addRecoveryReadySession notification for failed ' + sessionName + ' recovery preparation.');
                this.recoveryService.addRecoveryReadySession(this.getSessionId(sessionName), sessionName, false, errString);
            }
            else {
                //if we shouldn't recover sessions, need to save current selection since they are presented to the user
                shouldStartPreview = false; //no recovery was needed so no need to display the device
                this.deviceSettingsService.saveDeviceSelections(sessionName);
            }
            return shouldStartPreview;
        })
            .catch((err) => {
            this.log.warn('Failed to decide if ' + sessionName + ' device should be in recovery mode,' +
                ' handling error like it should not. ' + __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(err));
            return shouldStartPreview;
        })
            .then((shouldStartPreview) => {
            return this.handleDevicePreviewAfterFailure(sessionName, shouldStartPreview, elementPosition);
        });
    }
    handleDevicePreviewAfterFailure(sessionName, shouldStartPreview, elementPosition) {
        if (shouldStartPreview) {
            this.log.info('Trying to start ' + sessionName + ' device after failed device initialization');
            return this.startDevicePreviewAndActivateSession(sessionName, elementPosition)
                .catch((err) => {
                this.log.error('Failed to start ' + sessionName + ' device preview');
                this.notificationService.sendNotification('NOTIFICATIONS.error_' + sessionName + 'PreviewStart', 'error');
                this.appState.addSession(this.getSessionId(sessionName), sessionName, this.appState.SESSION_STATE.IN_ACTIVE);
            });
        }
        else {
            //start preview will remove current session from the loading sessions object
            //here we need to do it ourselves, also, since we already created the session. we need to add it to  the active
            //sessions with a 'failed' state.
            if (this.getSessionId(sessionName)) {
                this.appState.addSession(this.getSessionId(sessionName), sessionName, this.appState.SESSION_STATE.IN_ACTIVE);
            }
            return Promise.resolve();
        }
    }
    captureTypeToMonitoringSource(sessionName) {
        return this.getCaptureDeviceTypeBySessionName(sessionName) === this.CAPTURE_TYPE.SCREEN ? __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].SCREEN : __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["c" /* MONITORED_SOURCE_TYPE */].VIDEO;
    }
    setVideoCaptureRegion(sessionName, engineBounds, electronBounds) {
        return this.deviceSettingsService.setVideoCaptureRegion(sessionName, engineBounds, electronBounds);
    }
    resetToFullScreenCapture(sessionName, updatePersistency) {
        return this.deviceSettingsService.resetToFullScreenCapture(sessionName, updatePersistency);
    }
    /**
     * set liveData persistency object to contain the live streaming duration and stopped date
     * @param sessionName
     */
    stopLiveStreaming(sessionName) {
        this.persistencyService.get('recording.recordingTime')
            .then((recDuration) => {
            this.persistencyService.set('recording.details.liveData.' + sessionName, {
                duration: recDuration,
                updatedAt: (new Date().getTime() / 1000)
            });
        });
    }
};
VideoDeviceService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_10__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_0__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_0__infra_app_state_service__["a" /* AppStateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_4__device_recovery_service__["a" /* DeviceRecoveryService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__device_recovery_service__["a" /* DeviceRecoveryService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_6__device_preview_service__["a" /* DevicePreviewService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__device_preview_service__["a" /* DevicePreviewService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_8__video_device_settings_service__["a" /* VideoDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__video_device_settings_service__["a" /* VideoDeviceSettingsService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_9__audio_device_service__["a" /* AudioDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__audio_device_service__["a" /* AudioDeviceService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["a" /* AppMonitoringAgentErrorDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__monitoring_app_monitoring_agent_error_data_service__["a" /* AppMonitoringAgentErrorDataService */]) === "function" && _h || Object, typeof (_j = typeof __WEBPACK_IMPORTED_MODULE_13__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_13__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _j || Object, typeof (_k = typeof __WEBPACK_IMPORTED_MODULE_7__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _k || Object, typeof (_l = typeof __WEBPACK_IMPORTED_MODULE_14__live_live_manager_service__["a" /* LiveManagerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_14__live_live_manager_service__["a" /* LiveManagerService */]) === "function" && _l || Object])
], VideoDeviceService);

var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/video-device.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/accessability.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AccessibilityService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let AccessibilityService = class AccessibilityService {
    constructor(log, translate, panelsService) {
        this.log = log;
        this.translate = translate;
        this.panelsService = panelsService;
        this.accessibilityAlert = new __WEBPACK_IMPORTED_MODULE_3_rxjs__["Subject"]();
        this.accessibilityAlert$ = this.accessibilityAlert.asObservable();
    }
    markNavigation(event) {
        if (event.code === "Tab") {
            this.lastCode = event.code;
            // remove the previous outline focus
            if (this.lastElement) {
                this.lastElement.classList.remove('keyboard-focus');
            }
            // should we lock focus on a dialog?
            if (this.lockNavOnDialog && !event.target['parentElement'].classList.contains('dialog-footer')) {
                // if we are in an open dialog choose the the first button in the footer and focus on it.
                this.lastElement = this.dialogElement.querySelector('button');
                this.lastElement.classList.add('keyboard-focus');
                this.lastElement.focus();
            }
            else if (event.target['tagName'].toLowerCase() === 'body') {
                let isItemWasSelected = this.selectFirstItem(event);
                if (!isItemWasSelected) {
                    setTimeout(() => {
                        this.selectFirstItem(event);
                    }, 200);
                }
            }
            else {
                this.lastElement = event.target;
                if (this.lastElement) {
                    this.lastElement.classList.add('keyboard-focus');
                }
            }
        }
        else if (event.code === "Enter" || event.code === "Space" || event.code === "NumpadEnter") {
            this.lastCode = event.code;
            // remove the previous outline focus
            if (this.lastElement) {
                this.lastElement.classList.remove('keyboard-focus');
            }
            // on Enter/Space/NumpadEnter if we hit body, refocus on last element (make sure that element ask not to be focus twice)
            if (event.target['tagName'].toLowerCase() === 'body' && (this.lastElement && !this.lastElement.classList.contains('focus-once'))) {
                this.forceFocusOnLastElement();
            }
            else if (this.lastElement && this.lastElement.tagName.toLowerCase() === 'button' && !this.lastElement.classList.contains('focus-once')) {
                this.lastElement = event.target;
                this.forceFocusOnLastElement();
            }
            else if (this.lastElement && this.lastElement.tagName.toLowerCase() === 'a') {
                this.lastElement = event.target;
                this.forceFocusOnLastElement(event.code === "Space"); // trigger click on 'a' when hitting Space (only space needed the fix)
            }
        }
        else if (event.code === "Escape") {
            if (event.target instanceof HTMLInputElement) {
                event.target.blur();
                if (this.lastElement === event.target) {
                    this.lastElement.classList.remove('keyboard-focus');
                }
            }
            else {
                let currentPanel = this.panelsService.getCurrentPanel();
                if (currentPanel && currentPanel['active']) {
                    currentPanel['active'] = false;
                    this.panelsService.updateCurrentPanel(currentPanel);
                }
            }
        }
        return true;
    }
    forceFocusOnLastElement(triggerClick = false) {
        setTimeout(() => {
            this.lastElement.classList.add('keyboard-focus');
            if (triggerClick) {
                this.lastElement.click();
            }
            else {
                this.lastElement.focus();
            }
        }, 400);
    }
    selectFirstItem(event) {
        let nextTabTargets = event.target['querySelectorAll']('button, a, input, select, area, textarea, object');
        nextTabTargets = Array.prototype.filter.call(nextTabTargets, function (elem) {
            return elem.tabIndex != -1; // when specify no tab navigation do not choose him as option 
        });
        if (nextTabTargets.length > 0) {
            this.lastElement = nextTabTargets[0];
            this.lastElement.classList.add('keyboard-focus');
            this.lastElement.focus();
        }
        return nextTabTargets.length > 0;
    }
    toggleNavLimitationOnDialog(lock, element) {
        this.lockNavOnDialog = lock;
        this.dialogElement = element;
    }
    getLastCode() {
        return this.lastCode;
    }
    setLastCode(value) {
        this.lastCode = value;
    }
    /**
     * Add Accessibility alert to be read by screen reader
     * @param i18nText i18n text
     * @param alertDuration long (5 sec) or short (2 sec)
     * @param localization params
     */
    setAccessibilityAlert(i18nText, alertDuration = 'short', params = null) {
        this.getTranslationSub(i18nText, params).subscribe((res) => {
            this.accessibilityAlert.next({ alert: res, duration: alertDuration });
        });
    }
    getTranslationSub(i18nText, params) {
        return params ? this.translate.get(i18nText, params) : this.translate.get(i18nText);
    }
    /* Scroll up and clear focus classes*/
    clearFocusAndScrollUp(element, divSelectorToScroll) {
        let elem = element.nativeElement.querySelector(divSelectorToScroll);
        if (elem) {
            elem.scrollTop = 0;
        }
        let elements = Array.from(element.nativeElement.querySelectorAll('.keyboard-focus'));
        __WEBPACK_IMPORTED_MODULE_5_lodash__["forEach"](elements, (elem) => {
            elem.classList.remove('keyboard-focus');
        });
    }
    setFocusOnMainWindow() {
        return __WEBPACK_IMPORTED_MODULE_6__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('setFocusOnMainWindow');
    }
    setFocusOnThisElement(elementRef) {
        elementRef.nativeElement.classList.add('keyboard-focus');
        elementRef.nativeElement.focus();
    }
};
AccessibilityService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_4_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4_ng2_translate__["b" /* TranslateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_2__panels_service__["a" /* PanelsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__panels_service__["a" /* PanelsService */]) === "function" && _c || Object])
], AccessibilityService);

var _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/accessability.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/app-config.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__personal_app_consts__ = __webpack_require__("../../../../../src/personal/app.consts.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppConfigService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let AppConfigService = AppConfigService_1 = class AppConfigService {
    constructor() {
    }
    static loadConfigData() {
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getConfig', 'config')
            .then((config) => {
            this.configObject = { 'config': __WEBPACK_IMPORTED_MODULE_2_lodash__["clone"](config) };
            this.validateConfigObjectValues();
        });
    }
    getConfigData(path) {
        return __WEBPACK_IMPORTED_MODULE_2_lodash__["get"](AppConfigService_1.configObject, path);
    }
    setConfigData(path, value, reloadEngineConfiguration = false, saveToDisk = true) {
        //update internal config object only with data that we want to save to disk (maintain data integrity)
        if (saveToDisk)
            __WEBPACK_IMPORTED_MODULE_2_lodash__["set"](AppConfigService_1.configObject, path, value);
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('setConfig', path, value, reloadEngineConfiguration, saveToDisk);
    }
    static validateConfigObjectValues() {
        if (this.configObject.config['captureApp']['scheduling']) {
            this.validateSchedulingSection();
        }
        this.validateCapturePreSets();
        this.validateMultiSessionsProperties();
    }
    static validateSchedulingSection() {
        let schedulingConfigObj = this.configObject.config['captureApp']['scheduling'];
        if (!Number.isInteger(schedulingConfigObj.viewEventsAheadDay) || schedulingConfigObj.viewEventsAheadDay > 30) {
            this.configObject.config['captureApp']['scheduling']['viewEventsAheadDay'] = 14;
        }
        if (!Number.isInteger(schedulingConfigObj.intervalSec) || schedulingConfigObj.intervalSec < 300) {
            this.configObject.config['captureApp']['scheduling']['intervalSec'] = 300;
        }
        if (!Number.isInteger(schedulingConfigObj.countdownInSec) || schedulingConfigObj.countdownInSec < 300) {
            this.configObject.config['captureApp']['scheduling']['countdownInSec'] = 600;
        }
        if (!Number.isInteger(schedulingConfigObj.extendEventInSec) || schedulingConfigObj.extendEventInSec < 300) {
            this.configObject.config['captureApp']['scheduling']['extendEventInSec'] = 300;
        }
        if (!Number.isInteger(schedulingConfigObj.displayExtendEventInSec) || schedulingConfigObj.displayExtendEventInSec > 600) {
            this.configObject.config['captureApp']['scheduling']['displayExtendEventInSec'] = 600;
        }
        if (schedulingConfigObj.countdownInSec > this.MAX_COUNTDOWN_IN_SEC) {
            this.configObject.config['captureApp']['scheduling']['countdownInSec'] = this.MAX_COUNTDOWN_IN_SEC;
        }
        if (!Number.isInteger(schedulingConfigObj.eventEndNotificationInSec) || schedulingConfigObj.eventEndNotificationInSec > 900) {
            this.configObject.config['captureApp']['scheduling']['eventEndNotificationInSec'] = 600;
        }
    }
    static validateCapturePreSets() {
        let captureZoneSelectionPresets = this.configObject.config['captureApp']['captureZoneSelectionPresets'];
        let validPresets = [];
        if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isArray"](captureZoneSelectionPresets)) {
            __WEBPACK_IMPORTED_MODULE_2_lodash__["each"](captureZoneSelectionPresets, (dimensions) => {
                // check if values are bigger than minimum app size
                if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isNumber"](dimensions.width) && dimensions.width >= __WEBPACK_IMPORTED_MODULE_3__personal_app_consts__["a" /* AppConsts */].MINIMUM_APP_WIDTH && __WEBPACK_IMPORTED_MODULE_2_lodash__["isNumber"](dimensions.height) && dimensions.height >= __WEBPACK_IMPORTED_MODULE_3__personal_app_consts__["a" /* AppConsts */].MINIMUM_APP_HEIGHT) {
                    validPresets.push(dimensions);
                }
            });
            validPresets = __WEBPACK_IMPORTED_MODULE_2_lodash__["sortBy"](validPresets, [function (dimensions) { return dimensions.width * dimensions.height; }]);
            if (validPresets.length === 0) {
                validPresets.push({ width: 800, height: 600 });
            }
        }
        else {
            validPresets.push({ width: 800, height: 600 });
        }
        this.configObject.config['captureApp']['captureZoneSelectionPresets'] = validPresets;
    }
    static validateMultiSessionsProperties() {
        if (!this.configObject.config['captureApp']['maxNumberOfInputs'] ||
            this.configObject.config['captureApp']['maxNumberOfInputs'] > 4 ||
            this.configObject.config['captureApp']['maxNumberOfInputs'] < 1) {
            this.configObject.config['captureApp']['maxNumberOfInputs'] = 4;
        }
        if (!this.configObject.config['captureApp']['defaultSessionsConfiguration'] ||
            this.configObject.config['captureApp']['defaultSessionsConfiguration'].length < 1 ||
            this.configObject.config['captureApp']['defaultSessionsConfiguration'].length > 4) {
            this.configObject.config['captureApp']['defaultSessionsConfiguration'] = ["screen", "video"];
        }
        if (!this.configObject.config['captureApp']['primarySessionName']) {
            this.configObject.config['captureApp']['primarySessionName'] = this.PRIMARY_SESSION_NAME;
        }
    }
};
AppConfigService.MAX_COUNTDOWN_IN_SEC = 10800;
AppConfigService.PRIMARY_SESSION_NAME = 'session0';
AppConfigService.configObject = { 'config': {} };
AppConfigService = AppConfigService_1 = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [])
], AppConfigService);

var AppConfigService_1;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-config.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/app-logger.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppLoggerService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



let AppLoggerService = class AppLoggerService {
    constructor() { }
    debug(msg) {
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('NativeLogger_Debug', __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(msg));
    }
    info(msg) {
        console.log(__WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(msg));
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('NativeLogger_Info', __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(msg));
    }
    warn(msg) {
        console.log(__WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(msg));
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('NativeLogger_Warn', __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(msg));
    }
    error(msg) {
        console.log(__WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(msg));
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('NativeLogger_Error', __WEBPACK_IMPORTED_MODULE_2__utils_utils__["a" /* utils */].stringifyMsg(msg));
    }
};
AppLoggerService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [])
], AppLoggerService);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-logger.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/app-notifications.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_lodash__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppNotificationsService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





let AppNotificationsService = class AppNotificationsService {
    constructor(translate, appConfig) {
        this.translate = translate;
        this.appConfig = appConfig;
        /**
         * array of current notifications {message: text, severity: error/warn/success/info}
         * @type {Array}
         */
        this.notifications = [];
        this.registerForNotificationCloseEvents();
    }
    sendNotification(msg, severity, url = '') {
        let display = this.shouldDisplayNotification(severity);
        //show info and scheduling msgs only is configured to do so
        if (display) {
            this.translate.get(msg).subscribe((res) => {
                this.sendIPCNotification({ message: res, url: url, severity: severity });
            });
        }
    }
    sendNotificationWithParams(msg, params, severity) {
        let display = this.shouldDisplayNotification(severity);
        //show info and scheduling msgs only is configured to do so
        if (display) {
            this.translate.get(msg, params).subscribe((res) => {
                this.sendIPCNotification({ message: res, severity: severity });
            });
        }
    }
    sendIPCNotification(notification) {
        if (this.isNewNotification(notification)) {
            this.notifications.push(notification);
            __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('app-notification', notification);
        }
    }
    shouldDisplayNotification(severity) {
        let conf = this.appConfig.getConfigData('config.captureApp');
        //show info and scheduling msgs only is configured to do so
        return (severity === 'warn' || severity === 'error' ||
            (conf && conf['allowInfoNotifications'] && conf['allowInfoNotifications'] === true));
    }
    registerForNotificationCloseEvents() {
        __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('app-notification-closed', (data) => {
            let removed = __WEBPACK_IMPORTED_MODULE_4_lodash__["remove"](this.notifications, (n) => {
                return data.notification['severity'] === n['severity'] &&
                    data.notification['message'] === n['message'];
            });
        });
    }
    isNewNotification(notification) {
        return !__WEBPACK_IMPORTED_MODULE_4_lodash__["find"](this.notifications, { severity: notification['severity'],
            message: notification['message'] });
    }
};
AppNotificationsService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1_ng2_translate__["b" /* TranslateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_2__app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__app_config_service__["a" /* AppConfigService */]) === "function" && _b || Object])
], AppNotificationsService);

var _a, _b;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-notifications.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/app-persistent-data.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppPersistentDataService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let AppPersistentDataService = class AppPersistentDataService {
    constructor() {
    }
    get(path) {
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getPersistency', path);
    }
    set(path, data) {
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('setPersistency', path, data);
    }
};
AppPersistentDataService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [])
], AppPersistentDataService);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-persistent-data.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/app-state.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppStateService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








let AppStateService = class AppStateService {
    constructor(log, persistencyService, appConfig) {
        this.log = log;
        this.persistencyService = persistencyService;
        this.appConfig = appConfig;
        this.DEFAULT_CAPTURE_TYPE = 'video';
        this.REC_STATE = {
            IN_PROCESS: 'in_process',
            LOADING: 'loading',
            STABLE: 'stable'
        };
        this.SESSION_STATE = {
            ACTIVE: 'active',
            IN_ACTIVE: 'in_active'
        };
        this.WINDOW_STATE = {
            VISIBLE: 'visible',
            HIDDEN: 'not-visible'
        };
        this.SESSION_LOAD_WAIT_STATE = {
            NEXT_TIME: 'next_time',
            NEVER: 'never',
            ALWAYS: 'wait'
        };
        /**
         * notify when app sessions are ready
         * when all planned sessions were created and ready
         * @type {Subject}
         */
        this.appSessionsReady = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.sessionsAreReadyPromise = this.appSessionsReady.asObservable().toPromise();
        /**
         * notify device component to init
         * @type {Subject}
         */
        this.notifyDeviceComponentInit = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.notifyDeviceComponentInit$ = this.notifyDeviceComponentInit.asObservable();
        /**
         * notify recording phase changes
         * @type {Subject}
         */
        this.recordingPhaseUpdate = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.recordingPhaseUpdate$ = this.recordingPhaseUpdate.asObservable();
        /**
         * application main browser window state
         */
        this.applicationWindowState = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["BehaviorSubject"](this.WINDOW_STATE.VISIBLE);
        this.applicationWindowState$ = this.applicationWindowState.asObservable();
        /**
         * notify sessions status change
         * @type {Subject}
         */
        this.sessionStatusChange = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.sessionStatusChange$ = this.sessionStatusChange.asObservable();
        /**
         * pairs of sessionId and number of in progress calls
         * @type {Array}
         */
        this.callsInProgress = [];
        /**
         * application state object contains:
         * 1. application-state object:
         *      contains a key value pairs of - sourceId : sessionState (indicates if app is in process or in stable mode)
         *      main application state (recording state) will have the following pairs: rec-state : in_process / stable / disconnected
         *      application sessions will have the following pairs: <sessionId> : in_process / stable
         *      <sessionId> : in_process / stable
         *      <rec-state> : in_process / stable / disconnected (in_process when recordingPhase !== 'initial')
         */
        this.appState = {};
        /**
         * current active sessions (sessions to record)
         * @type {Array} of [sessionId] => {type: video/audio/screen}
         */
        this.activeSessions = {};
        /**
         * current inactive sessions (sessions that tryied to load but failed)
         * @type {Array} of [sessionId] => {type: video/audio/screen}
         */
        this.inactiveSessions = {};
        /**
         * maintain all removed sessions ids
         * @type {{}}
         */
        this.removedSessions = {};
        /**
         * Sessions that are in loading process at the moment
         */
        this.loadingSessionsCount = 0;
        /**
         * current app recording phase
         * @type {string}
         */
        this._recordingPhase = 'initial';
        this.connectionStateChangeLock = false;
        this.liveConfigured = false;
        this.liveStreaming = false;
        /**
         * There are places in our app that we are shutting down our sessions without re-init them (before off cycle recovery process)
         * Since there is no immediate re-init command, there is no need (actually we can't) to wait for our sessions to load before executing other commands
         */
        this.waitForSessionsToLoad = this.SESSION_LOAD_WAIT_STATE.ALWAYS;
    }
    set recordingPhase(recPhase) {
        if (this._recordingPhase !== recPhase) {
            this.recordingPhaseUpdate.next(recPhase);
        }
        this._recordingPhase = recPhase;
    }
    get recordingPhase() {
        return this._recordingPhase;
    }
    addSession(sessionId, sessionName, state) {
        this.log.info('AppState: addSession: ' + sessionId + ' - ' + sessionName + ' - ' + state);
        if (this.removedSessions[sessionId]) {
            this.log.info('AppState: tried to add removed session to added sessions: ' + sessionName + ' - ' + sessionId);
            return;
        }
        if (state === this.SESSION_STATE.ACTIVE) {
            this.activeSessions[sessionId] = { name: sessionName };
            delete this.inactiveSessions[sessionId];
            this.sessionStatusChange.next();
        }
        else {
            delete this.activeSessions[sessionId];
            this.inactiveSessions[sessionId] = { name: sessionName };
            this.sessionStatusChange.next();
        }
        this.removeLoadingSession();
        this.checkIfAllSessionsAreReady(sessionName);
    }
    removeActiveSession(sessionId) {
        this.log.info('AppState: ?: ' + sessionId);
        if (this.activeSessions[sessionId]) {
            this.inactiveSessions[sessionId] = this.activeSessions[sessionId];
            delete this.activeSessions[sessionId];
        }
        else {
            this.log.warn('removeActiveSession. ' + sessionId + ' is not active. ');
        }
        this.removeLoadingSession();
        this.sessionStatusChange.next();
    }
    addLoadingSession() {
        this.loadingSessionsCount++;
    }
    removeLoadingSession() {
        if (this.loadingSessionsCount > 0) {
            this.loadingSessionsCount--;
        }
    }
    getLoadingSessionsCount() {
        return this.loadingSessionsCount;
    }
    shutDownSessions(waitForSessions = this.SESSION_LOAD_WAIT_STATE.ALWAYS) {
        this.log.info('AppState: shutDownSessions');
        this.waitForSessionsToLoad = waitForSessions;
        let sessions = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](__WEBPACK_IMPORTED_MODULE_2_lodash__["merge"](this.getActiveVisualSessions(), this.getInActiveVisualSessions(), this.getActiveAudioSession(), this.getInActiveAudioSession()));
        if (sessions && sessions.length > 0) {
            this.onCallStarted('shutDown', JSON.stringify(sessions));
            return __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('shutDownSome', sessions)
                .then(() => {
                this.onCallEnded('shutDown - SUCCESS', JSON.stringify(sessions));
                this.removeAllSessions();
            })
                .catch((err) => {
                if (err === 'session ended') {
                    this.onCallEnded('shutDown - SUCCESS (sessions ended)', JSON.stringify(sessions));
                    this.removeAllSessions();
                }
                else {
                    this.onCallEnded('shutDown - FAILURE', JSON.stringify(sessions), err);
                    return Promise.reject(err);
                }
            });
        }
        else {
            this.log.warn('No sessions to shutdown');
            return Promise.resolve();
        }
    }
    removeAllSessions() {
        this.log.info('AppState: removeAllSessions');
        this.appSessionsReady = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.sessionsAreReadyPromise = this.appSessionsReady.asObservable().toPromise();
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.activeSessions), (sessionId) => {
            delete this.activeSessions[sessionId];
            this.removedSessions[sessionId] = sessionId;
            this.clearSessionFromAppState(sessionId);
        });
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.inactiveSessions), (sessionId) => {
            delete this.inactiveSessions[sessionId];
            this.clearSessionFromAppState(sessionId);
        });
    }
    //remove all sessions related properties
    clearSessionFromAppState(sessionId) {
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](this.appState, (value, key) => {
            if (key.indexOf('rec-state') === -1) {
                delete this.appState[key];
            }
        });
    }
    sendInitNotification() {
        this.notifyDeviceComponentInit.next();
    }
    getActiveSessions() {
        return this.activeSessions;
    }
    getInActiveSessions() {
        return this.inactiveSessions;
    }
    getActiveVisualSessions() {
        let sessions = {};
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](this.activeSessions, (sessionObj, sessionId) => {
            if (sessionObj['name'] && sessionObj['name'] !== 'audio') {
                sessions[sessionId] = sessionObj;
            }
        });
        return sessions;
    }
    getInActiveVisualSessions() {
        let sessions = {};
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](this.inactiveSessions, (sessionObj, sessionId) => {
            if (sessionObj['name'] && sessionObj['name'] !== 'audio') {
                sessions[sessionId] = sessionObj;
            }
        });
        return sessions;
    }
    getActiveAudioSession() {
        let audioSession = {};
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](this.activeSessions, (sessionObj, sessionId) => {
            if (sessionObj['name'] && sessionObj['name'] === 'audio') {
                audioSession[sessionId] = sessionObj;
                return false; //breaking for each loop
            }
        });
        return audioSession;
    }
    getInActiveAudioSession() {
        let audioSession = {};
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](this.inactiveSessions, (sessionObj, sessionId) => {
            if (sessionObj['name'] && sessionObj['name'] === 'audio') {
                audioSession[sessionId] = sessionObj;
                return false; //breaking for each loop
            }
        });
        return audioSession;
    }
    /**
     * will return sessions ids for active visual sessions or if no active visual session exists and audio only mode
     * is enabled - will return the active audio session
     * @return {string[]}
     */
    getActiveRecordableSessionsIds() {
        let activeSessions = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.getActiveVisualSessions());
        //if there a no visual session and audio only mode is on - try audio session
        if ((!activeSessions || __WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](activeSessions)) &&
            this.appConfig.getConfigData('config.captureApp.audioOnlyRecording')) {
            activeSessions = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.getActiveAudioSession());
        }
        return activeSessions;
    }
    getInActiveRecordableSessionsIds() {
        let inActiveSessions = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.getInActiveVisualSessions());
        //if there a no visual session and audio only mode is on - try audio session
        if ((!inActiveSessions || __WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](inActiveSessions)) &&
            this.appConfig.getConfigData('config.captureApp.audioOnlyRecording')) {
            inActiveSessions = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.getInActiveAudioSession());
        }
        return inActiveSessions;
    }
    getSessionsNames(isActive) {
        let sessions = isActive ? this.activeSessions : this.inactiveSessions;
        let sessionsNames = [];
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](sessions, (session) => {
            sessionsNames.push(session['name']);
        });
        return sessionsNames;
    }
    getSessionIdByName(sessionName, active = true) {
        let sessions = active ? this.getActiveSessions() : this.getInActiveSessions();
        for (let key of Object.keys(sessions)) {
            if (sessions[key]["name"] === sessionName)
                return key;
        }
    }
    updateAppState(sourceId, state) {
        this.appState[sourceId] = state;
    }
    setLiveConfigurationState(confState) {
        this.liveConfigured = confState;
    }
    setLiveStreamingState(streamingState) {
        this.liveStreaming = streamingState;
    }
    isAppLiveConfigured() {
        return this.liveConfigured;
    }
    isAppStreaming() {
        return this.isAppRecording() && this.liveConfigured && this.liveStreaming;
    }
    /**
     * all calls completed and app is not during a recording session
     * @returns {boolean}
     */
    isAppStable() {
        return __WEBPACK_IMPORTED_MODULE_2_lodash__["every"](__WEBPACK_IMPORTED_MODULE_2_lodash__["values"](this.appState), (state) => {
            return state === this.REC_STATE.STABLE;
        });
    }
    isAppRecording() {
        return (this.appState['rec-state'] && this.appState['rec-state'] === this.REC_STATE.IN_PROCESS) ||
            (this.recordingPhase && this.recordingPhase !== 'initial'); //added to support app loading stage where rec-state wasn't initialized yet
    }
    isSourceStable(sourceId, sourceOnly = false) {
        return ((this.appState[sourceId] && this.appState[sourceId] === this.REC_STATE.STABLE) || !(this.appState[sourceId])) &&
            ((this.appState['rec-state'] && this.appState['rec-state'] === this.REC_STATE.STABLE) || sourceOnly);
    }
    /**
     * Getting sessions names and default device type from persistent data file and user settings for app init phase
     * For personal capture app - always make sure returned sessions count is a least the amount of sessions configured
     * in the user localSettings 'defaultSessionsConfiguration'.
     * For classroom capture - if sessions count from persistent data equals to 0. load sessions as configured in the
     * user localSettings 'defaultSessionsConfiguration'. else - return the sessions from app persistent data file
     *
     * usage example: used during app sessions init in BL and UI
     */
    getVisualSessionsNamesAndDefaultTypesForInit() {
        let captureSessionsToInit = {};
        return this.getVisualSessionsFromPersistentData()
            .then(sessions => {
            let defaultSessionsTypeArray = this.appConfig.getConfigData('config.captureApp.defaultSessionsConfiguration');
            __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](sessions).sort(), (sessionKey, index) => {
                let defaultType = defaultSessionsTypeArray[index] ? defaultSessionsTypeArray[index] : this.DEFAULT_CAPTURE_TYPE;
                captureSessionsToInit[sessionKey] = defaultType;
            });
            let appType = this.appConfig.getConfigData('config.shared.appType');
            //for personal capture OR if there are no sessions to init - load defaults
            if (appType === 'pc' || __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](captureSessionsToInit).length === 0) {
                //making sure persistent sessions count is at least equal to default configured sessions
                for (let count = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](sessions).length; count < defaultSessionsTypeArray.length; count++) {
                    captureSessionsToInit['session' + count] = defaultSessionsTypeArray[count];
                }
            }
            return captureSessionsToInit;
        });
    }
    getVisualSessionsFromPersistentData() {
        let sessions = {};
        return this.persistencyService.get('')
            .then((persistentDataObj) => {
            __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](persistentDataObj, (value, key) => {
                if (key.startsWith('session')) {
                    sessions[key] = value;
                }
            });
        }).catch((err) => { })
            .then(() => { return sessions; });
    }
    getNumberOfSessionsFromPersistentData() {
        //get all visual sessions count and add the 'audio' session
        return this.getVisualSessionsFromPersistentData()
            .then(sessions => {
            return __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](sessions).length + 1;
        });
    }
    checkIfAllSessionsAreReady(sessionName) {
        this.getNumberOfSessionsFromPersistentData()
            .then((sessionsToLoad) => {
            let activeSessionsNumber = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.getActiveSessions()).length;
            let inActiveSessionsNumber = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.getInActiveSessions()).length;
            this.log.info('Session ' + sessionName + ' was added. number of current active sessions: ' + activeSessionsNumber +
                '. Number of in active sessions: ' + inActiveSessionsNumber +
                '. Number of loading sessions: ' + this.loadingSessionsCount + '. Number of sessions to load: ' + sessionsToLoad);
            this.log.info('AppState: active sessions: ' + __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* utils */].stringifyMsg(this.activeSessions));
            this.log.info('AppState: inactive sessions: ' + __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* utils */].stringifyMsg(this.inactiveSessions));
            if (activeSessionsNumber + inActiveSessionsNumber >= sessionsToLoad && this.loadingSessionsCount === 0 || sessionsToLoad === 0) {
                this.log.info('AppState: All sessions are ready');
                this.log.info('AppState: free connection state lock');
                this.setConnectionStateChangeLock('checkIfAllSessionsAreReady - ready', false);
                this.appSessionsReady.next(true);
                this.appSessionsReady.complete();
            }
        });
    }
    onCallStarted(source, sessionId) {
        if (sessionId && sessionId !== '[]') {
            let numOfCalls = this.callsInProgress[sessionId] ? this.callsInProgress[sessionId] : 0;
            this.callsInProgress[sessionId] = ++numOfCalls;
            this.updateAppState(sessionId, this.REC_STATE.IN_PROCESS);
            this.log.info('call started: ' + source + ' id: ' + sessionId + ' number of current calls: ' + this.callsInProgress[sessionId]);
        }
    }
    onCallEnded(source, sessionId, data = '') {
        if (sessionId && sessionId !== '[]') {
            let numOfCalls = this.callsInProgress[sessionId];
            this.callsInProgress[sessionId] = --numOfCalls;
            this.updateAppState(sessionId, (this.callsInProgress[sessionId] === 0 ? this.REC_STATE.STABLE : this.REC_STATE.IN_PROCESS));
            if (this.callsInProgress[sessionId] === 0) {
                delete this.callsInProgress[sessionId];
            }
            this.log.info('call ended: ' + source + ' id: ' + sessionId + ' number of current calls: ' +
                (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.callsInProgress[sessionId]) ? 0 : this.callsInProgress[sessionId]) +
                (!__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](data) ? (' ' + __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* utils */].stringifyMsg(data)) : ''));
        }
    }
    setApplicationWindowState(state) {
        this.applicationWindowState.next(state);
    }
    getApplicationWindowState() {
        return this.applicationWindowState.getValue();
    }
    areSessionsReadyForRecording(caller) {
        //if there is no need to wait for loading sessions (@see this.waitForSessionsToLoad comment above...)
        switch (this.waitForSessionsToLoad) {
            case this.SESSION_LOAD_WAIT_STATE.NEXT_TIME:
                this.waitForSessionsToLoad = this.SESSION_LOAD_WAIT_STATE.ALWAYS;
            case this.SESSION_LOAD_WAIT_STATE.NEVER:
                this.log.info('AppState: ' + caller + ' there is no need to wait for loading sessions.');
                return Promise.resolve(true);
        }
        let timeoutDelay = 30000;
        //if function is stuck, there are probably some sessions issues, call to re-init.
        let delayedTO = setTimeout(() => {
            this.log.warn('AppState: for ' + caller + ' - Sessions are not ready for more than ' + timeoutDelay / 1000 + ' seconds, call to re-launch app');
            return __WEBPACK_IMPORTED_MODULE_4__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('relaunch');
        }, timeoutDelay);
        this.log.info(caller + ' is waiting for sessions to be ready');
        return this.getNumberOfSessionsFromPersistentData()
            .then(sessionsCount => {
            if (sessionsCount === 0) {
                this.log.info('AppState: There are no sessions to wait for. App is ready');
                clearTimeout(delayedTO);
                return Promise.resolve(true);
            }
            else {
                return this.sessionsAreReadyPromise
                    .then((ready) => {
                    clearTimeout(delayedTO);
                    this.log.info('AppState: ' + caller + ' all sessions are in ready state: ' + ready);
                    return Promise.resolve(true);
                });
            }
        });
    }
    setConnectionStateChangeLock(caller, lock) {
        this.log.info('AppState: ' + caller + ' set connection state lock to: ' + lock);
        this.connectionStateChangeLock = lock;
    }
    sessionsReturnedFromConnectionStateChange(caller) {
        this.log.info('AppState: waiting for session to be ready after connection state change');
        return this.areSessionsReadyForRecording(caller)
            .then(() => {
            if (this.connectionStateChangeLock) {
                this.log.info('AppState: sessions are still during connection state change process.');
                return __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* utils */].delayPromise(2000).then(() => {
                    return this.sessionsReturnedFromConnectionStateChange(caller);
                });
            }
            else {
                this.log.info('AppState: sessions finished connection state change process.');
                return Promise.resolve(true);
            }
        });
    }
};
AppStateService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_3__app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_6__app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_7__app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object])
], AppStateService);

var _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-state.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/authentication.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_http__ = __webpack_require__("../../../http/@angular/http.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AuthenticationService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};







let AuthenticationService = class AuthenticationService {
    constructor(http, log, config, appState, appConfig) {
        this.http = http;
        this.log = log;
        this.config = config;
        this.appState = appState;
        this.appConfig = appConfig;
        /**
         * emit event when user auth state updates,
         * true - logged in
         * false - logged out
         */
        this.userAuthUpdate = new __WEBPACK_IMPORTED_MODULE_3_rxjs__["Subject"]();
        this.userAuthUpdate$ = this.userAuthUpdate.asObservable();
        this._isLoggedIn = false;
    }
    set isLoggedIn(loggedIn) {
        this._isLoggedIn = loggedIn;
        this.userAuthUpdate.next(this._isLoggedIn);
    }
    get isLoggedIn() {
        return this._isLoggedIn;
    }
    static getAuthenticationMode() {
        return __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('isAuthEnabled')
            .then((enabled) => {
            this.isAuthenticationEnabled = enabled === 0 ? false : true;
        });
    }
    isUrlValid() {
        return this.http.get(this.appConfig.getConfigData('config.shared.authenticationUrl')).toPromise()
            .then((res) => {
            return true;
        })
            .catch((e) => {
            return Promise.reject(false);
        });
    }
    isUserLoggedIn() {
        return this.isLoggedIn;
    }
    logIn(userDate) {
        this.setUserLogInData(userDate);
    }
    logOut() {
        this.restartLoginIdleInterval();
        return this.logoutAndClearSessionData()
            .then((response) => {
            if (this.appState.isAppRecording())
                return Promise.resolve(true);
            //if not during recording
            this.removeUserLogInData();
            this.log.info('User was logged out');
        })
            .catch((error) => {
            this.log.info('Failed to logout from external site, removing logged in user data');
            this.removeUserLogInData();
            return Promise.resolve(false);
        });
    }
    getAuthLoginUrl() {
        return this.isUrlValid()
            .then((valid) => {
            return this.appConfig.getConfigData('config.shared.authenticationUrl');
        });
    }
    getUserLogoutUrl() {
        return this.appConfig.getConfigData('config.shared.authenticationUrl') + '?logout=true';
    }
    getLoggedInUserId() {
        if (this.isUserLoggedIn())
            return this.config.getConfigData('config.shared.externalSettings.userId');
        else
            return '';
    }
    setUserLogInData(userData) {
        this.config.setConfigData('config.shared.externalSettings.appToken', userData.appToken);
        this.config.setConfigData('config.shared.externalSettings.appTokenId', userData.appTokenId);
        this.config.setConfigData('config.shared.externalSettings.hashType', userData.hashType);
        this.config.setConfigData('config.shared.externalSettings.partnerId', userData.partnerId);
        this.config.setConfigData('config.shared.externalSettings.serviceUrl', userData.serviceUrl);
        this.config.setConfigData('config.shared.externalSettings.userId', userData.userId);
        this.isLoggedIn = true;
        this.startLoginIdleInterval();
    }
    logoutAndClearSessionData() {
        return __WEBPACK_IMPORTED_MODULE_5__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('clearSessionData');
    }
    removeUserLogInData() {
        this.isLoggedIn = false;
        this.config.setConfigData('config.shared.externalSettings', {});
        this.stopLoginIdleInterval();
    }
    startLoginIdleInterval() {
        this.idleCounter = this.getBaseIdleTime();
        this.intervalSub = __WEBPACK_IMPORTED_MODULE_3_rxjs__["Observable"].timer(0, 1000).subscribe(t => {
            if (this.idleCounter <= 0)
                this.logOut();
            else
                this.idleCounter--;
        });
    }
    restartLoginIdleInterval() {
        this.idleCounter = this.getBaseIdleTime();
    }
    stopLoginIdleInterval() {
        if (this.intervalSub) {
            this.intervalSub.unsubscribe();
            this.intervalSub = null;
        }
    }
    getBaseIdleTime() {
        let baseIdleTime = this.appConfig.getConfigData('config.shared.appLoginIdleMinutes');
        return baseIdleTime ? baseIdleTime * 60 : 15 * 60;
    }
};
AuthenticationService.isAuthenticationEnabled = false;
AuthenticationService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__angular_http__["b" /* Http */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__angular_http__["b" /* Http */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_1__app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_4__app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_6__app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__app_state_service__["a" /* AppStateService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_4__app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__app_config_service__["a" /* AppConfigService */]) === "function" && _e || Object])
], AuthenticationService);

var _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/authentication.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/infra.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__kaltura_api_service__ = __webpack_require__("../../../../../src/shared/services/infra/kaltura-api.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__system_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/system-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__system_health_service__ = __webpack_require__("../../../../../src/shared/services/infra/system-health.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__panels_service__ = __webpack_require__("../../../../../src/shared/services/infra/panels.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__accessability_service__ = __webpack_require__("../../../../../src/shared/services/infra/accessability.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__authentication_service__ = __webpack_require__("../../../../../src/shared/services/infra/authentication.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__session_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/session-state.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return InfraModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};













let InfraModule = class InfraModule {
};
InfraModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        providers: [
            __WEBPACK_IMPORTED_MODULE_1__app_config_service__["a" /* AppConfigService */],
            __WEBPACK_IMPORTED_MODULE_2__app_logger_service__["a" /* AppLoggerService */],
            __WEBPACK_IMPORTED_MODULE_3__app_persistent_data_service__["a" /* AppPersistentDataService */],
            __WEBPACK_IMPORTED_MODULE_4__app_state_service__["a" /* AppStateService */],
            __WEBPACK_IMPORTED_MODULE_5__app_notifications_service__["a" /* AppNotificationsService */],
            __WEBPACK_IMPORTED_MODULE_6__kaltura_api_service__["a" /* KalturaApiService */],
            __WEBPACK_IMPORTED_MODULE_7__system_data_service__["a" /* SystemDataService */],
            __WEBPACK_IMPORTED_MODULE_8__system_health_service__["a" /* SystemHealthService */],
            __WEBPACK_IMPORTED_MODULE_9__panels_service__["a" /* PanelsService */],
            __WEBPACK_IMPORTED_MODULE_10__accessability_service__["a" /* AccessibilityService */],
            __WEBPACK_IMPORTED_MODULE_11__authentication_service__["a" /* AuthenticationService */],
            __WEBPACK_IMPORTED_MODULE_12__session_state_service__["a" /* SessionStateService */]
        ]
    })
], InfraModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/infra.module.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/kaltura-api.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_http__ = __webpack_require__("../../../http/@angular/http.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs_Rx__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_rxjs_Rx___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_rxjs_Rx__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_rxjs_Observable__ = __webpack_require__("../../../../rxjs/Observable.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_rxjs_Observable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_rxjs_Observable__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return KalturaApiService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









let KalturaApiService = class KalturaApiService {
    constructor(http, logger, appConfig, appPersistency) {
        this.http = http;
        this.logger = logger;
        this.appConfig = appConfig;
        this.appPersistency = appPersistency;
        this._id = 0;
        /*
         this.listUsers("web").subscribe( res => {
         console.warn("listUsers",res);
         });
         */
    }
    listUsers(startsWith) {
        return this.apiRequest([{ service: 'user',
                action: 'list',
                "filter:objectType": "KalturaUserFilter",
                "filter:idOrScreenNameStartsWith": startsWith,
                'pager:pageSize': 10 },
            { service: 'user',
                action: 'list',
                "filter:objectType": "KalturaUserFilter",
                "filter:firstNameOrLastNameStartsWith": startsWith,
                'pager:pageSize': 10 }])
            .map(res => {
            let userList = [];
            __WEBPACK_IMPORTED_MODULE_3_lodash__["each"](res, (result, key) => {
                userList = __WEBPACK_IMPORTED_MODULE_3_lodash__["unionBy"](userList, result['objects'], 'id');
            });
            return userList;
        });
    }
    /**
     *
     * @param {string} resourceId
     * @param {string} eventType
     * @param {any} data
     * @param {boolean} shouldLog
     * @param {boolean} rawData raw data or private data (image or text)
     * @returns {Observable<any>}
     */
    reportMonitoringData(resourceId, eventType, data, shouldLog, rawData) {
        let reqObject = {
            "service": 'beacon_beacon',
            "action": 'add',
            "shouldLog": shouldLog ? 1 : 0,
            "beacon:objectType": 'KalturaBeacon',
            "beacon:relatedObjectType": "1",
            "beacon:eventType": eventType,
            "beacon:objectId": resourceId
        };
        if (rawData) {
            reqObject['beacon:rawData'] = __WEBPACK_IMPORTED_MODULE_3_lodash__["isObject"](data) ? JSON.stringify(data) : data;
        }
        else {
            reqObject['beacon:privateData'] = __WEBPACK_IMPORTED_MODULE_3_lodash__["isObject"](data) ? JSON.stringify(data) : data;
        }
        return this.apiRequest(reqObject);
    }
    /**
     *
     * @param startDate time in millis
     * @param endDate time in millis
     * @return {Observable<R>}
     */
    getScheduledEvents(startDate, endDate, resourceId) {
        this.logger.debug("Sending API get request scheduled event: " + resourceId);
        return this.apiRequest({ service: 'schedule_scheduleevent',
            action: 'list',
            "filter:objectType": "KalturaScheduleEventFilter",
            "filter:endDateGreaterThanOrEqual": startDate / 1000,
            "filter:startDateLessThanOrEqual": endDate / 1000,
            "filter:orderBy": "+startDate,+createdAt",
            "filter:resourceIdsLike": resourceId,
            "filter:recurrenceTypeIn": "0,2",
            "filter:statusEqual": 2,
            'pager:pageSize': 1000 })
            .map(res => {
            return res.objects;
        });
    }
    getEntry(entryId) {
        this.logger.debug("Sending API get request for entry id: " + entryId);
        return this.apiRequest({ service: 'baseentry',
            action: 'get',
            entryId: entryId
        });
    }
    updateRedirectEntryId(entryId, redirectEntryId) {
        this.logger.debug("Sending API update request for entry id: " + entryId + " with redirectEntryId of: [" + redirectEntryId + "]");
        return this.apiRequest({ service: 'baseentry',
            action: 'update',
            entryId: entryId,
            "baseEntry:objectType": "KalturaBaseEntry",
            "baseEntry:redirectEntryId": redirectEntryId
        });
    }
    updateAdminTags(entryId, adminTags) {
        this.logger.debug("Sending API update request for entry id: " + entryId + " with AdminTags of: " + adminTags);
        return this.apiRequest({ service: 'baseentry',
            action: 'update',
            entryId: entryId,
            "baseEntry:objectType": "KalturaBaseEntry",
            "baseEntry:adminTags": adminTags
        });
    }
    getFlavors(flavorIds) {
        this.logger.debug("Sending API list request for flavors ids: " + flavorIds);
        return this.apiRequest({ service: 'flavorparams',
            action: 'list',
            "filter:objectType": "KalturaScheduleEventFilter",
            "filter:idIn": flavorIds
        }).map(res => {
            return res.objects;
        });
    }
    apiRequest(params) {
        let now = new Date();
        if (this._ks_expiry && now > this._ks_expiry) {
            this._ks = null;
        }
        if (this._ks) {
            return this._apiRequest(params);
        }
        return this.login().flatMap(res => {
            return this._apiRequest(params);
        });
    }
    /**
     * sets user suggested tags in persistent data file [last 10 tags]
     * *** in future we might consider to use Kaltura api to fetch all relevant tags and remove this method ***
     * @param tags
       */
    setSuggestedTags(tags) {
        return this.getSuggestedTags('').toPromise()
            .then((oldTags) => {
            let allTags = __WEBPACK_IMPORTED_MODULE_3_lodash__["uniq"](oldTags.concat(tags));
            this.appPersistency.set('user.tags', __WEBPACK_IMPORTED_MODULE_3_lodash__["takeRight"](allTags, 10).join(','));
        });
    }
    /**
     * gets user suggested tags [last 10 used tags] from app persistent data
     * *** in future we might consider to use Kaltura api to fetch all relevant tags ***
     * @param containedString
     * @returns {Array}
       */
    getSuggestedTags(containedString) {
        return __WEBPACK_IMPORTED_MODULE_6_rxjs_Observable__["Observable"].fromPromise(this.appPersistency.get('user')
            .then((userData) => {
            let tags = [];
            if (userData && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](userData) && userData['tags']) {
                let suggested = userData['tags'].split(',');
                __WEBPACK_IMPORTED_MODULE_3_lodash__["forEach"](suggested, (suggestedTag) => {
                    if (suggestedTag.includes(containedString))
                        tags.push(suggestedTag);
                });
            }
            return tags;
        }));
    }
    login() {
        this._config = this.appConfig.getConfigData("config.shared");
        return this._apiRequest({
            service: "session",
            action: "startWidgetSession",
            "widgetId": '_' + this._config["partnerId"]
        }).flatMap((result) => {
            return this._apiRequest({
                service: "apptoken",
                action: "startSession",
                ks: result.ks,
                tokenHash: __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].sha1(result.ks + this._config["appToken"]),
                id: this._config["appTokenId"]
            }).map((result) => {
                this._ks = result.ks;
                let now = new Date();
                this._ks_expiry = new Date(now.getTime() + 1 * 60 * 60 * 1000); //1 hour
                return result;
            });
        });
    }
    _apiRequest(requests) {
        let body = {
            ks: this._ks,
            format: 1,
            clientTag: "CRA:" + this._config.app_version
        };
        if (__WEBPACK_IMPORTED_MODULE_3_lodash__["isArray"](requests)) {
            body['service'] = "multirequest";
            requests.forEach((item, index) => {
                __WEBPACK_IMPORTED_MODULE_3_lodash__["each"](item, (value, key) => {
                    body[index + ":" + key] = value;
                });
            });
        }
        else {
            body = __WEBPACK_IMPORTED_MODULE_3_lodash__["assign"](body, requests);
        }
        let requestJSON = JSON.stringify(body);
        this._id++;
        let headers = new __WEBPACK_IMPORTED_MODULE_1__angular_http__["c" /* Headers */]();
        headers.append('Content-Type', 'application/json');
        this.logger.debug('API request [#' + this._id + '] for service ' + body['service'] + '::' + body['action']);
        return this.http.post(this._config['serviceUrl'] + `/api_v3/index.php`, requestJSON, {
            headers: headers
        }).map((response) => {
            let result = response.json();
            let headers = response.headers;
            this.logger.debug('API response for [#' + this._id + '] X-Me: [' + headers.get('X-Me') + '] X-Kaltura-Session: ' + headers.get('X-Kaltura-Session'));
            if (result && result.objectType === "KalturaAPIException") {
                throw __WEBPACK_IMPORTED_MODULE_6_rxjs_Observable__["Observable"].throw(result);
            }
            return result;
        }).catch((error) => {
            this.logger.warn('API response failed for #' + this._id + ' result.' +
                ' Token Id: ' + this._config["appTokenId"] +
                ' KS: ' + this._ks +
                ' KS expiry: ' + this._ks_expiry +
                ' Error msg: ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(error));
            this._ks = null; //making sure we won't use the same KS in the next call
            return __WEBPACK_IMPORTED_MODULE_6_rxjs_Observable__["Observable"].throw(error);
        });
    }
    checkIsLive(entryId) {
        let requestJSON = JSON.stringify({ service: 'livestream',
            action: 'isLive',
            "id": entryId,
            "protocol": "applehttp",
            "format": 1,
        });
        return this.http.post(this._config['serviceUrl'] + `/api_v3/index.php`, requestJSON, {
            headers: new __WEBPACK_IMPORTED_MODULE_1__angular_http__["c" /* Headers */]({ 'Content-Type': 'application/json' })
        }).map((response) => {
            let result = response.json();
            if (result && result.objectType === "KalturaAPIException") {
                throw __WEBPACK_IMPORTED_MODULE_6_rxjs_Observable__["Observable"].throw(result);
            }
            return result;
        });
    }
};
KalturaApiService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__angular_http__["b" /* Http */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_7__app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_2__app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_8__app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _d || Object])
], KalturaApiService);

var _a, _b, _c, _d;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/kaltura-api.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/panels.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return PanelsService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let PanelsService = class PanelsService {
    constructor(log) {
        this.log = log;
        /**
         * contain an panel object:
         * type: <the panel type f.e: 'recording-details-edit' / 'audio-device-settings' etc...>,
         * active: true / false
         * @type {BehaviorSubject<Object>}
         */
        this.currentPanel = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["BehaviorSubject"]({});
        this.currentPanel$ = this.currentPanel.asObservable();
    }
    /**
     * update current panel state
     * @param panel
     * @param force if true, updating new panel although current panel is open
     */
    updateCurrentPanel(panel, force = false) {
        //if the app is trying to open two panels at the same time and not is force mode
        if (!force && !__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.getCurrentPanel()) && panel['active'] && this.getCurrentPanel()['active']) {
            this.log.info('rejected open panel request');
        }
        else {
            this.currentPanel.next(panel);
        }
    }
    getCurrentPanel() {
        return this.currentPanel.getValue();
    }
    /**
     * is the current active panel is the provided panel
     * @param panelType
     * @returns {boolean}
     */
    isPanelActive(panelType) {
        return (this.getCurrentPanel() && this.getCurrentPanel()['type'] === panelType) ?
            this.currentPanel.getValue()['active'] : false;
    }
    /**
     * is there any active panel at the moment - displayed to the user
     * @returns {boolean|any}
     */
    isCurrentPanelActive() {
        return !__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.getCurrentPanel()) && this.getCurrentPanel()['active'];
    }
};
PanelsService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_3__app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object])
], PanelsService);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/panels.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/session-state.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SessionStateService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};


let SessionStateService = class SessionStateService {
    constructor() {
        /**
         * fires event when all sessions finished initialization process
         * @type {Subject}
         */
        this.sessionsInit = new __WEBPACK_IMPORTED_MODULE_1_rxjs__["Subject"]();
        this.sessionsInit$ = this.sessionsInit.asObservable();
    }
};
SessionStateService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])()
], SessionStateService);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/session-state.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/system-data.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SystemDataService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};




let SystemDataService = class SystemDataService {
    constructor(log) {
        this.log = log;
        this.systemData = null;
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getLocalizationData').then((data) => {
            this.systemData = data;
        }).catch((err) => {
            this.log.error('Failed to getLocalizationData. ' + __WEBPACK_IMPORTED_MODULE_3__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    getLang() {
        if (this.systemData && this.systemData['lang']) {
            return this.systemData['lang'];
        }
        return navigator.language;
    }
};
SystemDataService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object])
], SystemDataService);

var _a;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/system-data.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/infra/system-health.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_Rx__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_Rx___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_Rx__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SystemHealthService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









let SystemHealthService = class SystemHealthService {
    /**
     * system health notification is being started on app loading (see appModule).
     */
    constructor(log, config, notificationService, appState) {
        this.log = log;
        this.config = config;
        this.notificationService = notificationService;
        this.appState = appState;
        this.SYS_HEALTH_ERROR = 'sys_health_error';
        this.HEALTH_STATUS = {
            OK: 'ok',
            ERROR: 'error'
        };
        this.BYTES_IN_GB = 1073741824;
        this.SAMPLE_INTERVAL_SEC = 10;
        this.MAX_CPU_PERCENTAGE = 70;
        this.MIN_MEMORY_GB = 1;
        this.MIN_DISKSPACE_GB = 20;
        this.NUM_SAMPLES_TO_ALER_TAFTER = 3;
        this.systemHealthTimer = null;
        this.systemHealthTimerSub = null;
        this.systemHealthThresholds = {
            'sampleIntervalSec': this.SAMPLE_INTERVAL_SEC,
            'maxCpuPercentage': this.MAX_CPU_PERCENTAGE,
            'minMemoryGB': this.MIN_MEMORY_GB,
            'minDiskspaceGB': this.MIN_DISKSPACE_GB,
            'numSamplesToAlertAfter': this.NUM_SAMPLES_TO_ALER_TAFTER
        };
        this.exceedThresholdSet = new Set();
        this.systemNotHealthy = new __WEBPACK_IMPORTED_MODULE_3_rxjs_Rx__["BehaviorSubject"](false); // healthy state
        this.systemNotHealthy$ = this.systemNotHealthy.asObservable();
        this.cpuPercent_consecutive_violations = 0;
        this.memFree_consecutive_violations = 0;
    }
    start() {
        this.log.info('Loading system health configurations');
        let sysHealth = this.config.getConfigData('config.captureApp.systemHealth');
        sysHealth = __WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](sysHealth) ? {} : sysHealth;
        this.systemHealthThresholds = __WEBPACK_IMPORTED_MODULE_2_lodash__["merge"](this.systemHealthThresholds, sysHealth);
        this.validateHealthParams();
        this.systemHealthTimer = __WEBPACK_IMPORTED_MODULE_3_rxjs_Rx__["Observable"].timer(1000, this.systemHealthThresholds['sampleIntervalSec'] * 1000);
        this.startSystemHealthInterval();
    }
    validateHealthParams() {
        if (!Number.isInteger(this.systemHealthThresholds['sampleIntervalSec']) || this.systemHealthThresholds['sampleIntervalSec'] < 10 || this.systemHealthThresholds['sampleIntervalSec'] > 60) {
            this.systemHealthThresholds['sampleIntervalSec'] = 60;
            this.log.warn('SystemHealthService: sampleIntervalSec should be a number between 10-60 seconds (default: 60)');
        }
        if (!Number.isInteger(this.systemHealthThresholds['minDiskspaceLeftMB']) || this.systemHealthThresholds['minDiskspaceLeftMB'] < 500) {
            this.systemHealthThresholds['minDiskspaceLeftMB'] = 500;
            this.log.warn('SystemHealthService: minDiskspaceLeftMB should be a number more than 500 (default: 500)');
        }
    }
    stop() {
        this.log.info('Stopping system health notifications');
        if (this.systemHealthTimerSub) {
            this.systemHealthTimerSub.unsubscribe();
            this.systemHealthTimerSub = null;
        }
    }
    startSystemHealthInterval() {
        this.log.info('Starting system health notifications');
        this.systemHealthTimer.subscribe(() => {
            this.checkSystemHealth();
        });
    }
    checkSystemHealth(scheduled = true, forMonitoring = false) {
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getPerformanceCounters')
            .then((data) => {
            if (!__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](data)) {
                if (data['cpuPercent'] && scheduled)
                    this.notifyCpu(data['cpuPercent']);
                if (data['diskFree'])
                    this.notifyDiskspace(data['diskFree'] / this.BYTES_IN_GB, scheduled);
                if (data['memFree'] && scheduled)
                    this.notifyMemory(data['memFree'] / this.BYTES_IN_GB);
            }
            // send health status obj for checking manually (on StartRecording...)
            // fist of all - check if DS is almost full - most critical
            if (this.exceedThresholdSet.has('diskspaceAlmostFull')) {
                return { status: this.HEALTH_STATUS.ERROR, message: 'SYSTEM_HEALTH.diskspace-full', type: this.SYS_HEALTH_ERROR };
                //just for monitoring and less critical than full DS
            }
            else if (forMonitoring && this.exceedThresholdSet.has('diskspaceThresholdExceeded')) {
                return { status: this.HEALTH_STATUS.ERROR, message: 'SYSTEM_HEALTH.diskspace',
                    type: this.SYS_HEALTH_ERROR, params: { diskspace_value: this.systemHealthThresholds['minDiskspaceGB'] + 'GB' } };
            }
            else {
                return { status: this.HEALTH_STATUS.OK };
            }
        })
            .catch((err) => {
            // if Performance data is not exits don't fail the recording (status: ok)
            this.log.error('Failed to load system health data. ' + __WEBPACK_IMPORTED_MODULE_5__utils_utils__["a" /* utils */].stringifyMsg(err));
            return { status: this.HEALTH_STATUS.OK };
        });
    }
    notifyCpu(cpuData) {
        this.log.debug('System health - CPU: ' + cpuData);
        if (cpuData >= this.systemHealthThresholds['maxCpuPercentage']) {
            this.cpuPercent_consecutive_violations++;
            if (!this.exceedThresholdSet.has('cpuThresholdExceeded') &&
                this.cpuPercent_consecutive_violations > this.systemHealthThresholds['numSamplesToAlertAfter'] &&
                this.appState.isAppRecording()) {
                this.notificationService.sendNotificationWithParams(this.appState.isAppLiveConfigured() ? "SYSTEM_HEALTH.cpu_inLive" : "SYSTEM_HEALTH.cpu", { cpu_value: this.systemHealthThresholds['maxCpuPercentage'] + '%' }, 'warn');
                this.exceedThresholdSet.add('cpuThresholdExceeded');
            }
        }
        else {
            this.cpuPercent_consecutive_violations = 0;
            this.exceedThresholdSet.delete('cpuThresholdExceeded');
        }
    }
    notifyMemory(memoryData) {
        this.log.debug('System health - Memory: ' + memoryData);
        if (memoryData <= this.systemHealthThresholds['minMemoryGB']) {
            this.memFree_consecutive_violations++;
            if (!this.exceedThresholdSet.has('memoryThresholdExceeded') &&
                this.memFree_consecutive_violations > this.systemHealthThresholds['numSamplesToAlertAfter'] &&
                this.appState.isAppRecording()) {
                this.notificationService.sendNotificationWithParams(this.appState.isAppLiveConfigured() ? "SYSTEM_HEALTH.memory_inLive" : "SYSTEM_HEALTH.memory", { memory_value: this.systemHealthThresholds['minMemoryGB'] + 'GB' }, 'warn');
                this.exceedThresholdSet.add('memoryThresholdExceeded');
            }
        }
        else {
            this.memFree_consecutive_violations = 0;
            this.exceedThresholdSet.delete('memoryThresholdExceeded');
        }
    }
    /**
     *
     * @param diskspaceData
     * @param scheduled if was called from a scheduled timer
     */
    notifyDiskspace(diskspaceData, scheduled = true) {
        this.log.debug('System health - Diskspace: ' + diskspaceData);
        if (diskspaceData <= this.systemHealthThresholds['minDiskspaceGB']) {
            // on disk space we notify even when not recording & without numSamplesToAlertAfter since it's not something that changes often
            if (!this.exceedThresholdSet.has('diskspaceThresholdExceeded')) {
                this.notificationService.sendNotificationWithParams('SYSTEM_HEALTH.diskspace', { diskspace_value: this.systemHealthThresholds['minDiskspaceGB'] + 'GB' }, 'warn');
                this.exceedThresholdSet.add('diskspaceThresholdExceeded');
            }
        }
        else {
            this.exceedThresholdSet.delete('diskspaceThresholdExceeded');
        }
        if (diskspaceData <= this.systemHealthThresholds['minDiskspaceLeftMB'] / 1000) {
            // if not enough diskspace send notification at first time
            if (!this.exceedThresholdSet.has('diskspaceAlmostFull')) {
                this.notificationService.sendNotification('SYSTEM_HEALTH.diskspace-full', 'error');
                this.exceedThresholdSet.add('diskspaceAlmostFull');
            }
            // and fire the Not Health notifier
            if (this.appState.isAppRecording() && scheduled) {
                this.systemNotHealthy.next(true);
            }
        }
        else {
            this.exceedThresholdSet.delete('diskspaceAlmostFull');
        }
    }
};
SystemHealthService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_4__app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_6__app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__app_config_service__["a" /* AppConfigService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_7__app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_8__app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__app_state_service__["a" /* AppStateService */]) === "function" && _d || Object])
], SystemHealthService);

var _a, _b, _c, _d;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/system-health.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/live/live-manager.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__infra_kaltura_api_service__ = __webpack_require__("../../../../../src/shared/services/infra/kaltura-api.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9_rxjs__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LiveManagerService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










let LiveManagerService = LiveManagerService_1 = class LiveManagerService {
    constructor(appState, log, config, notificationService, apiService) {
        this.appState = appState;
        this.log = log;
        this.config = config;
        this.notificationService = notificationService;
        this.apiService = apiService;
        this.currentLiveEntryId = null;
        this.streamingSessionId = null;
        this.subscribeIntervalForIsLiveCheck = null;
        this.registerForSlideCapturingNotifications();
        this.registerForLiveNotifications();
    }
    checkIsLive() {
        this.apiService.checkIsLive(this.currentLiveEntryId).toPromise().then((isLive) => {
            this.log.debug("Setting isLive as: " + isLive + " for entry: " + this.currentLiveEntryId);
            this.appState.setLiveStreamingState(isLive);
        }).catch((err) => {
            this.log.warn('Failed to get isLive with error msg: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            this.appState.setLiveStreamingState(false);
        });
    }
    startIsLiveInterval() {
        let interval = this.config.getConfigData("config.captureApp.liveStreaming.checkIntervalForLive");
        interval = Math.min(interval ? interval * 1000 : 10000, 10000); //convert to ms or set 10 sec as default
        this.subscribeIntervalForIsLiveCheck = __WEBPACK_IMPORTED_MODULE_9_rxjs__["Observable"].timer(0, interval)
            .subscribe(() => {
            this.checkIsLive();
        });
    }
    static buildStreamUrl(baseUrl, flavor) {
        return baseUrl.slice(0, -2) + flavor['streamSuffix'];
    }
    getStreamingSessionName(active = true) {
        let sessions = active ? this.appState.getActiveSessions() : this.appState.getInActiveSessions();
        for (let key of Object.keys(sessions)) {
            if (this.streamingSessionId === key)
                return sessions[key]["name"];
        }
    }
    removeLiveConfig() {
        this.log.debug("Reset Live broadcast: setting the currentLiveEntryId as null. Currently is: " + this.currentLiveEntryId);
        this.currentLiveEntryId = null;
        this.streamingSessionId = null;
        this.appState.setLiveConfigurationState(false);
        this.appState.setLiveStreamingState(false);
        if (this.subscribeIntervalForIsLiveCheck)
            this.subscribeIntervalForIsLiveCheck.unsubscribe();
    }
    static getStreamUrl(baseUrl, flavors, tag) {
        let sourceFlavor = flavors.find(flavor => flavor['tags'].includes(tag));
        if (sourceFlavor)
            return LiveManagerService_1.buildStreamUrl(baseUrl, sourceFlavor);
        return '';
    }
    getLiveData(baseUrl, flavors) {
        let flavorArray = [];
        let primaryRtmp = LiveManagerService_1.getStreamUrl(baseUrl, flavors, 'source');
        if (!this.config.getConfigData("config.captureApp.liveStreaming.enableLocalFlavorTranscoding"))
            return { primaryRtmp, flavorArray };
        let flavorArrayFromConf = this.config.getConfigData("config.captureApp.liveStreaming.localFlavorTranscodingArray");
        if (flavorArrayFromConf)
            return { primaryRtmp, flavorArray: flavorArrayFromConf };
        // get all the flavors mark with the classroom tag
        flavors.forEach(flavor => {
            if (flavor['tags'].includes('classroom')) {
                flavorArray.push({ url: LiveManagerService_1.buildStreamUrl(baseUrl, flavor),
                    videoBitrate: flavor['videoBitrate'], width: flavor['width'], height: flavor['height'] });
            }
        });
        if (flavorArray.length === 0)
            flavorArray.push({ url: LiveManagerService_1.getStreamUrl(baseUrl, flavors, 'mbr'), videoBitrate: 600000, width: 640, height: 480 });
        return { primaryRtmp, flavorArray };
    }
    getLiveSessionIdForInputStream(sessionIdInRecovery = null) {
        if (sessionIdInRecovery)
            return sessionIdInRecovery;
        let primarySessionName = this.config.getConfigData('config.captureApp.primarySessionName');
        let sessionsNames = this.appState.getSessionsNames(true);
        if (sessionsNames.includes(primarySessionName))
            return this.appState.getSessionIdByName(primarySessionName);
        this.log.warn('Primary session is disable - fall-back to other inputs');
        for (const sessionName of sessionsNames.sort()) {
            if (sessionName != "audio") {
                this.sendNotification("NOTIFICATIONS.warn_primaryInputDisableWhenLive", null, "warn", true);
                return this.appState.getSessionIdByName(sessionName);
            }
        }
        return null;
    }
    addLiveConfig(liveData, sessionIdInRecovery = null) {
        if (liveData.hasOwnProperty("primaryRtmp")) {
            this.log.debug("@@DW - Start configuring live data");
            let sessionsId = this.getLiveSessionIdForInputStream(sessionIdInRecovery);
            if (!sessionsId) {
                this.log.warn("No sessions valid for live streaming: " + sessionsId);
                this.sendNotification("NOTIFICATIONS.warn_allVideoSessionDisableWhenLive", null, "warn", true);
                return Promise.resolve();
            }
            this.streamingSessionId = sessionsId;
            this.currentLiveEntryId = liveData['templateEntryId'];
            if (!this.currentLiveEntryId)
                this.currentLiveEntryId = liveData["primaryRtmp"].split('/').pop().slice(0, -2);
            liveData = __WEBPACK_IMPORTED_MODULE_0_lodash__["pick"](liveData, ['primaryRtmp', 'flavorArray', "id"]);
            this.appState.setLiveConfigurationState(true);
            this.startIsLiveInterval();
            this.log.info("Event with id [" + liveData["id"] + "] need to be stream to [" + liveData["primaryRtmp"] + "] for sessionId: " + sessionsId);
            return this.setLiveConfig(sessionsId, liveData);
        }
        return Promise.resolve();
    }
    setLiveConfig(sessionId, liveData) {
        this.appState.onCallStarted('setLiveConfig', sessionId);
        return __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(`${sessionId}-setLiveConfig`, liveData)
            .then(() => {
            this.appState.onCallEnded('setLiveConfig - SUCCESS', sessionId);
        })
            .catch((err) => {
            this.appState.onCallEnded('setLiveConfig - FAILURE', sessionId);
            return Promise.reject(err);
        });
    }
    registerForLiveNotifications() {
        __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('live-notification', (data) => {
            this.log.info('live-notification - got data: ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(data));
            try {
                data = JSON.parse(data);
                switch (data.errorReason) {
                    case "connection":
                        this.sendNotification("NOTIFICATIONS.error_LiveNetworkDisconnected", null, data.severity, data.retriesNum == 1);
                        if (data.retriesNum == 1) {
                            this.stopLiveStreaming();
                        }
                        break;
                    case "bufferOverflow":
                        this.sendNotification("NOTIFICATIONS.error_LiveNetworkLowBandwidth", { latencyInSeconds: data.latencyInSeconds }, data.severity, false);
                        break;
                }
            }
            catch (err) {
                this.log.warn("Got Error while receiving live-notification: " + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            }
        });
    }
    sendNotification(msg, params, severity, force = false) {
        if (this.config.getConfigData("config.captureApp.notifications.level") === "verbose" || force) {
            this.notificationService.sendNotificationWithParams(msg, params, severity);
        }
    }
    registerForSlideCapturingNotifications() {
        __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('capture-ppt', (data) => {
            if (!this.currentLiveEntryId)
                return; // no live streaming - ignore
            try {
                data = JSON.parse(data);
            }
            catch (err) {
                this.log.warn("Error while trying to upload slide to [" + this.currentLiveEntryId + "] with data: [" + data + "] got error: " + err);
            }
            if (data) {
                this.log.debug("Currently streaming to live entry of: " + this.currentLiveEntryId);
                return __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC("uploadSlide", this.currentLiveEntryId, data['slide-path']);
            }
        });
    }
    isInputLiveConfigured(sessionName) {
        return this.appState.isAppLiveConfigured() && (this.appState.getSessionIdByName(sessionName) === this.streamingSessionId)
            && this.isDevicePreviewing(sessionName);
    }
    isDevicePreviewing(sessionName) {
        let sessionsNames = this.appState.getSessionsNames(true);
        return sessionsNames.includes(sessionName);
    }
    stopLiveStreaming() {
        if (!this.currentLiveEntryId)
            return Promise.resolve(); // currently no streaming
        let sessionId = this.streamingSessionId;
        this.log.debug("stop live streaming: for [" + this.currentLiveEntryId + "] and session: " + sessionId);
        this.removeLiveConfig();
        this.appState.onCallStarted('stopLiveStreaming', sessionId);
        return __WEBPACK_IMPORTED_MODULE_2__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(`${sessionId}-stopLiveStreaming`)
            .then(() => {
            this.appState.onCallEnded('stopLiveStreaming - SUCCESS', sessionId);
        })
            .catch((err) => {
            this.appState.onCallEnded('stopLiveStreaming - FAILURE', sessionId);
            return Promise.reject(err);
        });
    }
};
LiveManagerService = LiveManagerService_1 = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__infra_app_state_service__["a" /* AppStateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_6__infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_7__infra_kaltura_api_service__["a" /* KalturaApiService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__infra_kaltura_api_service__["a" /* KalturaApiService */]) === "function" && _e || Object])
], LiveManagerService);

var LiveManagerService_1, _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/live-manager.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/live/live.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_infra_module__ = __webpack_require__("../../../../../src/shared/services/infra/infra.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__live_manager_service__ = __webpack_require__("../../../../../src/shared/services/live/live-manager.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return LiveModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};



let LiveModule = class LiveModule {
};
LiveModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [
            __WEBPACK_IMPORTED_MODULE_1__infra_infra_module__["a" /* InfraModule */],
        ],
        providers: [
            __WEBPACK_IMPORTED_MODULE_2__live_manager_service__["a" /* LiveManagerService */],
        ]
    })
], LiveModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/live.module.js.map

/***/ }),

/***/ "../../../../../src/shared/services/monitoring/app-monitoring-agent-error-data.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_system_health_service__ = __webpack_require__("../../../../../src/shared/services/infra/system-health.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_ng2_translate__ = __webpack_require__("../../../../ng2-translate/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_rxjs__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return MONITOR_ERROR_TYPE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return MONITORED_SOURCE_TYPE; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppMonitoringAgentErrorDataService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};









var MONITOR_ERROR_TYPE;
(function (MONITOR_ERROR_TYPE) {
    MONITOR_ERROR_TYPE[MONITOR_ERROR_TYPE["DEVICE_ERROR"] = 'DEVICE_ERROR'] = "DEVICE_ERROR";
    MONITOR_ERROR_TYPE[MONITOR_ERROR_TYPE["RECORDING_ERROR"] = 'RECORDING_ERROR'] = "RECORDING_ERROR";
    MONITOR_ERROR_TYPE[MONITOR_ERROR_TYPE["SYS_HEALTH_ERROR"] = 'SYS_HEALTH_ERROR'] = "SYS_HEALTH_ERROR";
})(MONITOR_ERROR_TYPE || (MONITOR_ERROR_TYPE = {}));
var MONITORED_SOURCE_TYPE;
(function (MONITORED_SOURCE_TYPE) {
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["ALL"] = 'ALL'] = "ALL";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["VIDEO"] = 'VIDEO'] = "VIDEO";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["SCREEN"] = 'SCREEN'] = "SCREEN";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["AUDIO"] = 'AUDIO'] = "AUDIO";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["START_RECORDING"] = 'START_RECORDING'] = "START_RECORDING";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["RESUME_RECORDING"] = 'RESUME_RECORDING'] = "RESUME_RECORDING";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["STOP_RECORDING"] = 'STOP_RECORDING'] = "STOP_RECORDING";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["PAUSE_RECORDING"] = 'PAUSE_RECORDING'] = "PAUSE_RECORDING";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["CANCEL_RECORDING"] = 'CANCEL_RECORDING'] = "CANCEL_RECORDING";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["RECOVER_RECORDING"] = 'RECOVER_RECORDING'] = "RECOVER_RECORDING";
    MONITORED_SOURCE_TYPE[MONITORED_SOURCE_TYPE["DISKSPACE"] = 'DISKSPACE'] = "DISKSPACE";
})(MONITORED_SOURCE_TYPE || (MONITORED_SOURCE_TYPE = {}));
let AppMonitoringAgentErrorDataService = class AppMonitoringAgentErrorDataService {
    constructor(log, translate, appConfig, persistentData, systemHealthService) {
        this.log = log;
        this.translate = translate;
        this.appConfig = appConfig;
        this.persistentData = persistentData;
        this.systemHealthService = systemHealthService;
        /**
         * an object represents the application errors data for the monitoring agent
         *  {
         *      APP_STATUS: OK / ERROR,
         *      DEVICE_ERROR: {
         *       MONITORED_SOURCE_TYPE: {
         *        text: error string,
         *        time: time in millis
         *       }
         *       ....
         *      },
         *      RECORDING_ERROR: {
         *        MONITORED_SOURCE_TYPE:  {
         *        text: error string,
         *        time: time in millis
         *       }
         *       ...
         *      }
         *      SYS_HEALTH_ERROR: {
         *        MONITORED_SOURCE_TYPE:  {
         *        text: error string,
         *        time: time in millis
         *       }
         *       ...
         *      }
         *  }
         * @type {{}}
         */
        this.monitoringAgentErrorData = {};
        let monitorConfig = this.appConfig.getConfigData('config.shared.monitoring');
        if (monitorConfig && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](monitorConfig) && monitorConfig['enabled']) {
            this.ready()
                .then(() => {
                __WEBPACK_IMPORTED_MODULE_7_rxjs__["Observable"].timer(0, 5000).subscribe(() => {
                    this.getMonitoringErrorData();
                });
            });
        }
    }
    ready() {
        if (!this._ready) {
            this._ready = this.persistentData.get('appMonitoringAgentErrorData')
                .then((data) => {
                if (data) {
                    this.monitoringAgentErrorData = data;
                }
                this.log.info('AppMonitoringAgentDataService: Ready()');
                return Promise.resolve(true);
            })
                .catch((err) => {
                this.log.error('AppMonitoringAgentErrorDataService: Failed to load app monitoring agent error data.' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
                this.monitoringAgentErrorData = {};
                return Promise.resolve(false);
            });
        }
        return this._ready;
    }
    setError(errorType, source, error, params = null) {
        Promise.all([this.ready(), this.getTranslationPromise(error, params)])
            .then(([ready, errorMsg]) => {
            if (__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.monitoringAgentErrorData[errorType])) {
                this.monitoringAgentErrorData[errorType] = {};
            }
            this.monitoringAgentErrorData[errorType][source] = {
                'text': errorMsg,
                'time': new Date().getTime()
            };
            this.updateAppStatusData();
            this.updatePersistentData();
        });
    }
    clearError(errorType, source) {
        this.ready()
            .then(() => {
            if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.monitoringAgentErrorData[errorType])) {
                //remove all error type errors
                if (source === MONITORED_SOURCE_TYPE.ALL) {
                    this.monitoringAgentErrorData[errorType] = {};
                    //remove specific source error if exists
                }
                else if (this.monitoringAgentErrorData[errorType][source]) {
                    delete this.monitoringAgentErrorData[errorType][source];
                }
            }
            this.updateAppStatusData();
            this.updatePersistentData();
        });
    }
    getMonitoringErrorData() {
        return this.ready()
            .then(() => {
            return this.checkSysHealth();
        })
            .then(() => {
            return this.monitoringAgentErrorData;
        });
    }
    checkSysHealth() {
        return this.systemHealthService.checkSystemHealth(false, true) //promise will never be rejected
            .then((sysHealth) => {
            if (__WEBPACK_IMPORTED_MODULE_3_lodash__["isObject"](sysHealth) && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](sysHealth) &&
                sysHealth['status'] === this.systemHealthService.HEALTH_STATUS.ERROR) {
                let params = sysHealth['params'] ? sysHealth['params'] : null;
                this.setError(MONITOR_ERROR_TYPE.SYS_HEALTH_ERROR, MONITORED_SOURCE_TYPE.DISKSPACE, sysHealth['message'], params);
            }
            else {
                this.clearError(MONITOR_ERROR_TYPE.SYS_HEALTH_ERROR, MONITORED_SOURCE_TYPE.DISKSPACE);
            }
        })
            .catch((err) => {
            this.log.error('AppMonitoringAgentErrorDataService: Failed to get sysHealth. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    updateAppStatusData() {
        let appStatus = __WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.monitoringAgentErrorData[MONITOR_ERROR_TYPE.DEVICE_ERROR]) &&
            __WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.monitoringAgentErrorData[MONITOR_ERROR_TYPE.RECORDING_ERROR]) &&
            __WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.monitoringAgentErrorData[MONITOR_ERROR_TYPE.SYS_HEALTH_ERROR]) ? 'OK' : 'ERROR';
        this.monitoringAgentErrorData['APP_STATUS'] = appStatus;
    }
    updatePersistentData() {
        let monitorConfig = this.appConfig.getConfigData('config.shared.monitoring');
        if (monitorConfig && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](monitorConfig) && monitorConfig['enabled']) {
            this.log.info('AppMonitoringAgentErrorDataService: update monitoring agent error data in app persistent data file');
            this.persistentData.set("appMonitoringAgentErrorData", this.monitoringAgentErrorData);
        }
    }
    getTranslationPromise(msg, params = null) {
        return params ? this.translate.get(msg, params).toPromise() : this.translate.get(msg).toPromise();
    }
};
AppMonitoringAgentErrorDataService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_6_ng2_translate__["b" /* TranslateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6_ng2_translate__["b" /* TranslateService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_8__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_5__infra_system_health_service__["a" /* SystemHealthService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_system_health_service__["a" /* SystemHealthService */]) === "function" && _e || Object])
], AppMonitoringAgentErrorDataService);

var _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-monitoring-agent-error-data.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/monitoring/app-monitoring-agent.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_Rx__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_rxjs_Rx___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_rxjs_Rx__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__app_monitoring_agent_error_data_service__ = __webpack_require__("../../../../../src/shared/services/monitoring/app-monitoring-agent-error-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__infra_kaltura_api_service__ = __webpack_require__("../../../../../src/shared/services/infra/kaltura-api.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__resource_id_resource_id_service__ = __webpack_require__("../../../../../src/shared/services/resource-id/resource-id.service.ts");
/* unused harmony export LiveInputStatus */
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AppMonitoringAgentService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};












var LiveInputStatus;
(function (LiveInputStatus) {
    LiveInputStatus[LiveInputStatus["Not_Configured"] = 'Not_Configured'] = "Not_Configured";
    LiveInputStatus[LiveInputStatus["Stopped"] = 'Stopped'] = "Stopped";
    LiveInputStatus[LiveInputStatus["Broadcasting"] = 'Broadcasting'] = "Broadcasting";
    LiveInputStatus[LiveInputStatus["Playing"] = 'Playing'] = "Playing";
    LiveInputStatus[LiveInputStatus["Error"] = 'Error'] = "Error";
})(LiveInputStatus || (LiveInputStatus = {}));
let AppMonitoringAgentService = class AppMonitoringAgentService {
    constructor(log, config, appState, monitoringAgentErrorData, kalturaApi, resourceIdService, persistentData) {
        this.log = log;
        this.config = config;
        this.appState = appState;
        this.monitoringAgentErrorData = monitoringAgentErrorData;
        this.kalturaApi = kalturaApi;
        this.resourceIdService = resourceIdService;
        this.persistentData = persistentData;
        /**
         * an object represents the application monitoring agent data
         *  {
         *    Errors: {
         *      APP_STATUS: OK / ERROR,
         *      DEVICE_ERROR: {
         *       MONITORED_SOURCE_TYPE: {
         *        text: error string,
         *        time: time in millis
         *       }
         *       ....
         *      },
         *      RECORDING_ERROR: {
         *        MONITORED_SOURCE_TYPE:  {
         *        text: error string,
         *        time: time in millis
         *       }
         *       ...
         *      }
         *      SYS_HEALTH_ERROR: {
         *        MONITORED_SOURCE_TYPE:  {
         *        text: error string,
         *        time: time in millis
         *       }
         *       ...
         *      }
         *    },
         *    ResourceDetails: {
         *      resourceId: resourceId
         *      resourceName: resourceName,
         *      appVersion: <app version>
         *      activeSessions: {
         *        'primary' : false,
         *        'secondary': true,
         *        ...
         *      },
         *      previewingSessions: {
         *        'primary' : false,
         *        'secondary': true,
         *        ...
         *      }
         *    },
         *    RecordingData: {
         *      recordingPhase: recording / paused / idle
         *      recordingTime: 02:00:23 / '' (if not recording)
         *      isScheduledEvent: true / false
         *      streamingInputObjects: {  // currently there will be only single input here (primaryInput,input2,input3,input4)
         *          <session name>: {
         *            templateEntryId: <templateEntryId>,
         *            status: LiveInputStatus
         *            duration: string (streaming duration)
         *            updatedAt: timestamp
         *          },
         *          ...
         *      }
         *    },
         *    Scheduling: {
         *      NextScheduledEvent: {
         *        id: next event id
         *        summary: next event summary
         *        description: next event description
         *        organizer: next event organizer
         *        startDate: next event startDate
         *        endDate: next event endDate
         *      },
         *      currentScheduledEvent: {
         *        id: currentEvent.id
         *        summary: currentEvent.summary
         *        isLiveEvent: currentEvent.primaryRtmp ? true : false
         *        templateEntryId: currentEvent.templateEntryId
         *      }
         *    }
         *  }
         * @type {{}}
         */
        this.monitoringAgentData = {};
        this.uploadPreviewIntervalSec = 120;
        this.dataReportingIntervalSec = 30;
        this.getImagesTimer = null;
        this.reportDataTimer = null;
        this.PRIMARY_SESSION_NAME_FALLBACK = 'session0';
    }
    start() {
        this.log.info('AppMonitoringAgentService: Starting app-monitoring-agent service');
        this.setIntervalsValues();
        this.startTimers();
    }
    stop() {
        this.log.info('AppMonitoringAgentService: Stopping app-monitoring-agent service');
        if (this.getImagesTimer) {
            this.getImagesTimer.unsubscribe();
        }
    }
    setIntervalsValues() {
        let monitoringConfig = this.config.getConfigData('config.shared.monitoring');
        this.uploadPreviewIntervalSec = monitoringConfig['uploadPreviewIntervalSec'] || 60;
        if (this.uploadPreviewIntervalSec < 60)
            this.uploadPreviewIntervalSec = 60;
        this.log.info('AppMonitoringAgentService: Validate Config params - uploadPreviewIntervalSec is not a valid value. set to 60');
        this.dataReportingIntervalSec = monitoringConfig['dataReportingIntervalSec'] || 30;
        if (this.dataReportingIntervalSec < 30)
            this.dataReportingIntervalSec = 30;
        this.log.info('AppMonitoringAgentService: Validate Config params - dataReportingIntervalSec is not a valid value. set to 30');
    }
    startTimers() {
        this.getImagesTimer = __WEBPACK_IMPORTED_MODULE_3_rxjs_Rx__["Observable"].timer(5000, this.uploadPreviewIntervalSec * 1000)
            .subscribe(() => {
            this.getImagesAndUpload();
        });
        this.reportDataTimer = __WEBPACK_IMPORTED_MODULE_3_rxjs_Rx__["Observable"].timer(5000, this.dataReportingIntervalSec * 1000)
            .subscribe(() => {
            this.getMonitoringAgentData();
        });
    }
    getImagesAndUpload() {
        let sessions = this.appState.getActiveVisualSessions();
        let sessionIds = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](sessions);
        if (sessionIds.length > 0) {
            let primarySession = this.config.getConfigData('config.captureApp.primarySessionName');
            __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](sessionIds, (sessionId) => {
                let sessionIndex = parseInt(sessions[sessionId].name.split('session')[1]);
                //will result previewImage_primary / previewImage_secondary / previewImage_secondary<n>
                let sessionPostFix = (sessions[sessionId].name === primarySession) ?
                    'primary' : ('secondary' + (sessionIndex === 1 ? '' : (sessionIndex - 1)));
                __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC(sessionId + '-getPreviewImage', sessionId)
                    .then((data) => {
                    this.kalturaApi
                        .reportMonitoringData(this.resourceIdService.resourceId, 'previewImage_' + sessionPostFix, data, false, true)
                        .subscribe(() => {
                        this.log.debug('reported preview image to beacon service');
                    }, err => {
                        this.log.debug('failed to upload beacon preview image to server ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                    });
                })
                    .catch((err) => {
                    this.log.debug('failed to get preview image from engine ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
                });
            });
        }
    }
    getMonitoringAgentData() {
        Promise.all([this.monitoringAgentErrorData.getMonitoringErrorData(), this.setRecordingData(), this.setResourceDetails()])
            .then(([errorData, recData, resDetails]) => {
            this.monitoringAgentData['Errors'] = errorData;
            this.kalturaApi.reportMonitoringData(this.resourceIdService.resourceId, 'monitoringAgentData', this.monitoringAgentData, true, false).subscribe(() => {
                this.log.debug('reported monitoringAgentData to beacon service');
            });
        });
    }
    setRecordingData() {
        let recordingPhase = this.appState.recordingPhase !== 'initial' ? this.appState.recordingPhase : 'idle';
        // initial recordingData
        this.monitoringAgentData['RecordingData'] = {
            'recordingPhase': recordingPhase,
            'recordingTime': '',
            'streamingInputObjects': {}
        };
        //if there is no need to update recordingTime and live data
        if (recordingPhase === 'idle')
            return Promise.resolve(true);
        return this.persistentData.get("recording")
            .then((recording) => {
            if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](recording))
                return;
            this.monitoringAgentData['RecordingData']['recordingTime'] =
                recording['recordingTime'] ? recording['recordingTime'] : 0;
            this.updateLiveData(recording);
        })
            .catch((err) => {
            return Promise.resolve(false); //not rejecting the promise because we would like to send monitor updates event even if app persistency will throw exception
        });
    }
    /**
     * update live data in recording data object in beacon
     * @param recordingData persistent recording data
     */
    updateLiveData(recordingData) {
        // checking if live event
        let currentScheduledEvent = !__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.monitoringAgentData['Scheduling']['currentScheduledEvent'])
            ? this.monitoringAgentData['Scheduling']['currentScheduledEvent']
            : {};
        // recording is live only during live scheduled event and the event has rtmp property
        if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](currentScheduledEvent) || !currentScheduledEvent.isLiveEvent)
            return;
        // although event is live - application is not streaming live data
        if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](recordingData['details']) || __WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](recordingData['details']['liveData']))
            return;
        // live data object in persistency file
        let liveData = recordingData['details']['liveData'];
        // for current development phase - take the only input that streams live (first and only input in our object)
        let streamingSessionName = Object.keys(liveData)[0];
        let streamingSessionDisplayName = this.getLiveSessionDisplayName(streamingSessionName);
        let streamingInputObjects = this.monitoringAgentData['RecordingData']['streamingInputObjects'];
        // todo [david] add relevant inputs when support for multi input streaming will be developed
        // set default live data properties for our only streaming input
        streamingInputObjects[streamingSessionDisplayName] = {
            templateEntryId: currentScheduledEvent.templateEntryId,
            status: this.appState.isAppStreaming() ? LiveInputStatus.Playing : LiveInputStatus.Broadcasting,
            duration: this.monitoringAgentData['RecordingData']['recordingTime'],
            updatedAt: (new Date().getTime() / 1000)
        };
        // checking if live was actually stopped by the user
        // if live streaming hasn't stopped (there won't be any duration in live data object)
        // so there is nothing to update
        if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](liveData[streamingSessionName]) || !liveData[streamingSessionName]['duration'])
            return;
        // primary input live streaming was stopped - update relevant live data properties
        streamingInputObjects[streamingSessionDisplayName]['duration'] = liveData[streamingSessionName]['duration'];
        streamingInputObjects[streamingSessionDisplayName]['updatedAt'] = liveData[streamingSessionName]['updatedAt'];
        streamingInputObjects[streamingSessionDisplayName]['status'] = LiveInputStatus.Stopped;
    }
    setResourceDetails() {
        return this.appState.getVisualSessionsFromPersistentData()
            .then((sessions) => {
            this.monitoringAgentData['ResourceDetails'] = {
                'resourceId': this.resourceIdService.resourceId,
                'resourceName': this.resourceIdService.resourceName,
                'activeSessions': this.getActiveSessionsObject(sessions),
                'previewingSessions': this.getPreviewEnabledSessionsObject(),
                'appVersion': this.config.getConfigData("config.shared").app_version
            };
        });
    }
    getActiveSessionsObject(sessions) {
        let activeSessions = {};
        let primarySession = this.config.getConfigData('config.captureApp.primarySessionName');
        __WEBPACK_IMPORTED_MODULE_2_lodash__["each"](__WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](sessions), (sessionName) => {
            let sessionIndex = parseInt(sessionName.split('session')[1]);
            let sessionOrder = sessionName === primarySession ?
                'primary' : ('secondary' + (sessionIndex === 1 ? '' : (sessionIndex - 1)));
            activeSessions[sessionOrder] = true;
        });
        return activeSessions;
    }
    getPreviewEnabledSessionsObject() {
        let enabledSessions = {};
        let primarySession = this.config.getConfigData('config.captureApp.primarySessionName');
        __WEBPACK_IMPORTED_MODULE_2_lodash__["each"](this.appState.getActiveVisualSessions(), (s) => {
            let sessionIndex = parseInt(s.name.split('session')[1]);
            let sessionOrder = s.name === primarySession ?
                'primary' : ('secondary' + (sessionIndex === 1 ? '' : (sessionIndex - 1)));
            enabledSessions[sessionOrder] = true;
        });
        return enabledSessions;
    }
    setSchedulingDataNextEvent(nextEvent) {
        if (!this.shouldPopulateScheduledEvent('NextScheduledEvent', nextEvent))
            return;
        this.monitoringAgentData['Scheduling']['NextScheduledEvent'] = {
            id: nextEvent.id,
            summary: nextEvent.summary,
            description: nextEvent.description,
            organizer: nextEvent.organizer,
            startDate: nextEvent.startDate,
            endDate: nextEvent.endDate
        };
    }
    setSchedulingDataCurrentEvent(currentEvent) {
        if (!this.shouldPopulateScheduledEvent('currentScheduledEvent', currentEvent))
            return;
        this.monitoringAgentData['Scheduling']['currentScheduledEvent'] = {
            id: currentEvent.id,
            summary: currentEvent.summary,
            isLiveEvent: currentEvent.primaryRtmp ? true : false,
            templateEntryId: currentEvent.templateEntryId
        };
    }
    shouldPopulateScheduledEvent(eventType, event) {
        if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.monitoringAgentData['Scheduling']))
            this.monitoringAgentData['Scheduling'] = {};
        if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](event)) {
            this.monitoringAgentData['Scheduling'][eventType] = {};
            return false;
        }
        return true;
    }
    getLiveSessionDisplayName(sessionName) {
        let primarySessionName = this.config.getConfigData('config.captureApp.primarySessionName') ?
            this.config.getConfigData('config.captureApp.primarySessionName') : this.PRIMARY_SESSION_NAME_FALLBACK;
        if (sessionName === primarySessionName) {
            return 'primaryInput';
        }
        else {
            let sessionIndex = parseInt(sessionName.split('session')[1]);
            return 'input' + ++sessionIndex;
        }
    }
};
AppMonitoringAgentService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_6__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__infra_app_state_service__["a" /* AppStateService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_7__app_monitoring_agent_error_data_service__["a" /* AppMonitoringAgentErrorDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__app_monitoring_agent_error_data_service__["a" /* AppMonitoringAgentErrorDataService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_9__infra_kaltura_api_service__["a" /* KalturaApiService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__infra_kaltura_api_service__["a" /* KalturaApiService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_11__resource_id_resource_id_service__["a" /* ResourceIdService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__resource_id_resource_id_service__["a" /* ResourceIdService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_10__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _g || Object])
], AppMonitoringAgentService);

var _a, _b, _c, _d, _e, _f, _g;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/app-monitoring-agent.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/monitoring/monitoring.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_infra_module__ = __webpack_require__("../../../../../src/shared/services/infra/infra.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__resource_id_resource_id_module__ = __webpack_require__("../../../../../src/shared/services/resource-id/resource-id.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__app_monitoring_agent_service__ = __webpack_require__("../../../../../src/shared/services/monitoring/app-monitoring-agent.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__app_monitoring_agent_error_data_service__ = __webpack_require__("../../../../../src/shared/services/monitoring/app-monitoring-agent-error-data.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MonitoringModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};





let MonitoringModule = class MonitoringModule {
};
MonitoringModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [
            __WEBPACK_IMPORTED_MODULE_1__infra_infra_module__["a" /* InfraModule */],
            __WEBPACK_IMPORTED_MODULE_2__resource_id_resource_id_module__["a" /* ResourceIdModule */]
        ],
        providers: [
            __WEBPACK_IMPORTED_MODULE_3__app_monitoring_agent_service__["a" /* AppMonitoringAgentService */],
            __WEBPACK_IMPORTED_MODULE_4__app_monitoring_agent_error_data_service__["a" /* AppMonitoringAgentErrorDataService */]
        ]
    })
], MonitoringModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/monitoring.module.js.map

/***/ }),

/***/ "../../../../../src/shared/services/recording/mouse-click-indication.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__capture_device_video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MouseClickIndicationService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let MouseClickIndicationService = class MouseClickIndicationService {
    constructor(appConfig, videoDeviceSettingsService, log) {
        this.appConfig = appConfig;
        this.videoDeviceSettingsService = videoDeviceSettingsService;
        this.log = log;
    }
    startMouseClickIndication() {
        if (this.appConfig.getConfigData('config.captureApp.recording.mouseClickIndication') === true) {
            let displaysBounds = [];
            __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](this.videoDeviceSettingsService.getAllActiveDevicesObjects(), device => {
                if (device['bounds'])
                    displaysBounds.push(device['bounds']);
            });
            if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](displaysBounds)) {
                this.log.info('there are no screens for current recording, mouse click indication is not needed');
                return Promise.resolve({});
            }
            else {
                return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('create-mouse-click-indication-windows', displaysBounds);
            }
        }
        else {
            this.log.info('There is no need in mouse click indication for current recording');
            return Promise.resolve({});
        }
    }
    stopMouseClickIndication() {
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('destroy-mouse-click-indication-windows');
    }
};
MouseClickIndicationService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_3__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_5__capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _c || Object])
], MouseClickIndicationService);

var _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/mouse-click-indication.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/recording/recording-details.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_moment__ = __webpack_require__("../../../../moment/moment.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_moment___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_moment__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__infra_kaltura_api_service__ = __webpack_require__("../../../../../src/shared/services/infra/kaltura-api.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__capture_device_video_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__infra_authentication_service__ = __webpack_require__("../../../../../src/shared/services/infra/authentication.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__infra_system_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/system-data.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordingDetailsService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};













let RecordingDetailsService = RecordingDetailsService_1 = class RecordingDetailsService {
    constructor(appConfig, persistencyService, log, kaltura, appState, systemData, authService, videoDeviceSettingsService) {
        this.appConfig = appConfig;
        this.persistencyService = persistencyService;
        this.log = log;
        this.kaltura = kaltura;
        this.appState = appState;
        this.systemData = systemData;
        this.authService = authService;
        this.videoDeviceSettingsService = videoDeviceSettingsService;
        /**
         * indicates if recording details is read only or not (f.e. scheduled event will be read only)
         * @type {boolean}
         */
        this.readOnly = false;
        /**
         * templateEntryId: string
         * liveStreamed: bool
         * title: string
         * description: string
         * userName: string
         * tags; array
         * videoFile: string
         * screenFile: string
         * @type {{}}
         */
        this.recordingDetailsObject = {};
        /**
         * users ids list subscription
         * @type {any}
         */
        this.userListSubscription$ = null;
        /**
         * indicates if it is possible to validate user name using api call
         * @type {boolean}
         */
        this.userListIsOffline = false;
        /**
         * current filtered users ids list
         * @type {Array}
         */
        this.userList = null;
        /**
         * Current cuePoint index
         * @type {number}
         */
        this.currentCuePointIndex = 1;
        /**
         * indicates where recording detials service is ready
         * @type {any}
         */
        this.isReady = null;
        this.isReady = this.loadInitialRecordingDetails();
    }
    /**
     * loading initial rec details from persistent data
     */
    loadInitialRecordingDetails() {
        return this.persistencyService.get('recording.details')
            .then((details) => {
            if (details) {
                return this.setRecordingDetails(details);
            }
            else {
                return Promise.resolve();
            }
        })
            .catch((err) => {
            return Promise.reject(err);
        });
    }
    getRecordingDetails() {
        return this.recordingDetailsObject;
    }
    get currentSlideIndex() {
        return __WEBPACK_IMPORTED_MODULE_4_lodash__["size"](this.recordingDetailsObject['slides']) + 1;
    }
    setRecordingDetails(newRecordingDetails) {
        this.recordingDetailsObject['title'] = newRecordingDetails['title'] ? newRecordingDetails['title'] : '';
        this.recordingDetailsObject['description'] = newRecordingDetails['description'] ? newRecordingDetails['description'] : '';
        this.recordingDetailsObject['userName'] = newRecordingDetails['userName'] ? newRecordingDetails['userName'] : '';
        this.recordingDetailsObject['tags'] = newRecordingDetails['tags'] ? newRecordingDetails['tags'] : [];
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](newRecordingDetails['templateEntryId'])) {
            this.recordingDetailsObject['templateEntryId'] = newRecordingDetails['templateEntryId'];
        }
        if (__WEBPACK_IMPORTED_MODULE_4_lodash__["has"](newRecordingDetails, 'liveStreamed')) {
            this.recordingDetailsObject['liveStreamed'] = newRecordingDetails['liveStreamed'];
        }
        this.recordingDetailsObject['currentCuePointIndex'] = newRecordingDetails['currentCuePointIndex'] ? newRecordingDetails['currentCuePointIndex'] : 1;
        this.recordingDetailsObject['slides'] = newRecordingDetails['slides'] ? newRecordingDetails['slides'] : {};
        this.recordingDetailsObject['annotationCuePoints'] = newRecordingDetails['annotationCuePoints'] ? newRecordingDetails['annotationCuePoints'] : {};
        this.recordingDetailsObject['eventId'] = newRecordingDetails['eventId'];
        //if in authentication mode but not in a scheduled event recording
        if (this.shouldSetAuthenticatedUserData()) {
            this.recordingDetailsObject['appToken'] = newRecordingDetails['appToken'];
            this.recordingDetailsObject['appTokenId'] = newRecordingDetails['appTokenId'];
            this.recordingDetailsObject['hashType'] = newRecordingDetails['hashType'];
            this.recordingDetailsObject['partnerId'] = newRecordingDetails['partnerId'];
            this.recordingDetailsObject['serviceUrl'] = newRecordingDetails['serviceUrl'];
        }
        return this.saveToPersistentData();
    }
    setRecordedFilePath(sessionName, filePath) {
        if (__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['files'])) {
            this.recordingDetailsObject['files'] = {};
        }
        this.recordingDetailsObject['files'][sessionName] = filePath;
        this.saveToPersistentData();
    }
    setRecordingLiveData(sessionName, liveData) {
        if (__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['liveData'])) {
            this.recordingDetailsObject['liveData'] = {};
        }
        this.recordingDetailsObject['liveData'][sessionName] = liveData;
        this.saveToPersistentData();
    }
    setDefaultRecDetails() {
        let config = this.appConfig.getConfigData('config.captureApp');
        this.recordingDetailsObject['title'] = __WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['title']) ?
            config['defaultRecordingName'] + ' - ' + __WEBPACK_IMPORTED_MODULE_5_moment__().locale(this.systemData.getLang()).format('MMMM Do YYYY, h:mm:ss a') : this.recordingDetailsObject['title'];
        this.recordingDetailsObject['recordingStartTime'] = __WEBPACK_IMPORTED_MODULE_5_moment__().valueOf();
        this.setAuthenticatedUserDetails();
        this.setRecordingType();
    }
    /**
     * mark this recording as audioOnly or not...
     */
    setRecordingType() {
        this.recordingDetailsObject['isAudioOnly'] =
            this.appConfig.getConfigData('config.captureApp.audioOnlyRecording') &&
                __WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](this.appState.getActiveSessions()).length === 1 && !__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.appState.getActiveAudioSession()); //there is only one session to record and it is an audio
        this.saveToPersistentData();
    }
    addSlideCapturedFilePath(slideObject) {
        this.isReady //waiting for app persistency to load in order to determin current slide index
            .then(() => {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['slides'])) {
                this.recordingDetailsObject['slides'] = {};
            }
            this.recordingDetailsObject['slides']['slide' + this.currentSlideIndex] = {
                offset: slideObject['timestamp'],
                filePath: slideObject['slide-path'],
                title: this.removeInvalidXmlChars(slideObject['title']),
                description: this.removeInvalidXmlChars(slideObject['description']),
                status: 'pending'
            };
            this.saveToPersistentData();
        })
            .catch((err) => {
            this.log.error('Failed to add slide to persistent data. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    addAnnotationCuePoint(cuePointObject) {
        this.isReady //waiting for app persistency to load in order to determin current slide index
            .then(() => {
            if (__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['annotationCuePoints'])) {
                this.recordingDetailsObject['annotationCuePoints'] = {};
            }
            let offset = __WEBPACK_IMPORTED_MODULE_5_moment__(cuePointObject['timestamp']).diff(__WEBPACK_IMPORTED_MODULE_5_moment__(this.recordingDetailsObject['recordingStartTime']));
            offset = offset && offset > 0 ? offset : 0;
            this.recordingDetailsObject['annotationCuePoints']['cuePoint' + this.currentCuePointIndex] = {
                offset: offset,
                title: this.removeInvalidXmlChars(cuePointObject['text']),
                status: 'pending'
            };
            this.recordingDetailsObject['currentCuePointIndex'] = ++this.currentCuePointIndex;
            this.saveToPersistentData();
        })
            .catch((err) => {
            this.log.error('Failed to add slide to persistent data. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    resetRecordingDetails() {
        this.log.info('resetting current recording details');
        this.recordingDetailsObject = {};
        this.currentCuePointIndex = 1;
        this.readOnly = false;
        return this.saveToPersistentData(true);
    }
    setReadOnly(readOnly) {
        this.readOnly = readOnly;
    }
    isReadOnly() {
        return this.readOnly;
    }
    saveRecordingDetailsJson() {
        let config = this.appConfig.getConfigData('config');
        return this.getRecordingProperties(config)
            .then(recordingProperties => {
            let recJson = {};
            let isPc = config['shared']['appType'].toLowerCase() === 'pc';
            recJson = __WEBPACK_IMPORTED_MODULE_4_lodash__["merge"](recJson, recordingProperties, this.getUserDependentProperties(isPc, config));
            this.addRecordedFilesToJson(recJson);
            return Promise.all([__WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('saveRecJson', recJson), recJson]);
        });
    }
    filterUserList(queryString) {
        if (queryString) {
            // abort previous request
            if (this.userListSubscription$) {
                this.userListSubscription$.unsubscribe();
                this.userListSubscription$ = null;
                this.userList = null;
            }
            if (queryString.length >= 3) {
                this.log.info('filtering users: ' + queryString);
                this.userListSubscription$ = this.kaltura.listUsers(queryString)
                    .subscribe(res => {
                    this.userListSubscription$ = null;
                    this.userListIsOffline = false;
                    let users = [];
                    __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](res, function (user) {
                        users.push({ id: user.id, fullName: user.fullName, email: user.email });
                    });
                    this.userList = users;
                }, err => {
                    this.userListSubscription$ = null;
                    this.userListIsOffline = true;
                });
            }
            else {
                this.userList = [];
            }
        }
    }
    isUserNameValid(selectedUser) {
        let userName = __WEBPACK_IMPORTED_MODULE_4_lodash__["isObject"](selectedUser) ? selectedUser['id'] : selectedUser;
        let filterdUsers = __WEBPACK_IMPORTED_MODULE_4_lodash__["filter"](this.userList, { 'id': userName });
        let isValid = this.isUserListOffline() ||
            (userName && userName.length < 3) ||
            userName === "" ||
            filterdUsers.length > 0 ||
            userName === this.recordingDetailsObject['userName'] ||
            this.userList === null; // if null then we are before the request -> don't show error
        return isValid;
    }
    isUserNameValidForSave(selectedUser) {
        let userName = __WEBPACK_IMPORTED_MODULE_4_lodash__["isObject"](selectedUser) ? selectedUser['id'] : selectedUser;
        return this.isUserNameValid(userName) && (userName && userName.length >= 3) || __WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](userName);
    }
    isUserNameDisabled() {
        return this.isReadOnly() || this.isAuthEnabled();
    }
    isUserListOffline() {
        return this.userListIsOffline;
    }
    isAuthEnabled() {
        return __WEBPACK_IMPORTED_MODULE_11__infra_authentication_service__["a" /* AuthenticationService */].isAuthenticationEnabled;
    }
    getAuthenticatedUserName() {
        return this.authService.getLoggedInUserId();
    }
    addRecordedFilesToJson(recJson) {
        //if there are no files in our object - we have nothing to do
        if (__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['files'])) {
            this.log.info('RecordingDetailsService Error: there are no files in recordingDetails object');
            return;
        }
        //gets the default primary session name as configured in our app configuration or the next input in line (if primary is disabled f.e)
        let primaryFileSessionName = this.getPrimaryRecordedSessionName();
        //set primary video file in recording json
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['files'][primaryFileSessionName])) {
            recJson['primaryMediaFile'] = this.recordingDetailsObject['files'][primaryFileSessionName];
        }
        //set all secondary sessions
        let secondaryMediaIndex = 0;
        __WEBPACK_IMPORTED_MODULE_4_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](this.recordingDetailsObject['files']), (sessionName) => {
            if (sessionName !== primaryFileSessionName) {
                let mediaFileKey = secondaryMediaIndex === 0 ? 'secondaryMediaFile' : ('secondaryMediaFile' + secondaryMediaIndex);
                recJson[mediaFileKey] = this.recordingDetailsObject['files'][sessionName];
                secondaryMediaIndex++;
            }
        });
    }
    getPrimaryRecordedSessionName() {
        let primarySessionName = this.appConfig.getConfigData('config.captureApp.primarySessionName');
        let recordedSessionsNames = __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].sortInputsNames(__WEBPACK_IMPORTED_MODULE_4_lodash__["keys"](this.recordingDetailsObject['files']));
        //return default primarySession name and if doesn't exist - use the first enabled input name
        return recordedSessionsNames.includes(primarySessionName) ? primarySessionName : recordedSessionsNames[0];
    }
    saveToPersistentData(reset = false) {
        let that = this;
        return that.persistencyService.get('recording.details')
            .then((data) => {
            if (!reset) {
                that.recordingDetailsObject = __WEBPACK_IMPORTED_MODULE_4_lodash__["extend"](data, that.recordingDetailsObject);
            }
            return that.persistencyService.set('recording.details', that.recordingDetailsObject);
        })
            .catch((err) => {
            that.log.error('Error. Failed to load and set persistent data. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    onAutoCompleteUserChange(text) {
        if (text && text.length >= 3) {
            this.userList = null;
        }
    }
    getRecordingProperties(config) {
        let recDetails = {};
        recDetails['summary'] = this.recordingDetailsObject['title'] ? this.recordingDetailsObject['title'] : config['captureApp']['defaultRecordingName'];
        recDetails['description'] = this.recordingDetailsObject['description'];
        recDetails['tags'] = this.recordingDetailsObject['tags'] ? __WEBPACK_IMPORTED_MODULE_4_lodash__["join"](this.recordingDetailsObject['tags']) : '';
        recDetails['recordingStartTime'] = this.recordingDetailsObject['recordingStartTime'];
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['templateEntryId'])) {
            recDetails['templateEntryId'] = this.recordingDetailsObject['templateEntryId'];
        }
        if (__WEBPACK_IMPORTED_MODULE_4_lodash__["has"](this.recordingDetailsObject, 'liveStreamed')) {
            recDetails['liveStreamed'] = this.recordingDetailsObject['liveStreamed'];
        }
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['slides'])) {
            recDetails['slides'] = this.recordingDetailsObject['slides'];
        }
        if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](this.recordingDetailsObject['annotationCuePoints'])) {
            recDetails['annotationCuePoints'] = this.recordingDetailsObject['annotationCuePoints'];
        }
        recDetails['isAudioOnly'] = this.recordingDetailsObject['isAudioOnly'];
        recDetails['uploadStatus'] = config['captureApp']['manualUpload'] ? 'manual' : 'auto';
        let filesObject = this.recordingDetailsObject['files'];
        return __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getDurationFromFile', filesObject[Object.keys(filesObject)[0]]) //getting one of the recorded files name
            .then(duration => {
            recDetails['durationSec'] = duration;
            return recDetails;
        })
            .catch((err) => {
            this.log.error('Failed to get duration from the engine. ' + __WEBPACK_IMPORTED_MODULE_8__utils_utils__["a" /* utils */].stringifyMsg(err));
            recDetails['durationSec'] = 0;
            return Promise.resolve(recDetails);
        });
    }
    getUserDependentProperties(isPc, config) {
        let userDetails = {};
        if (this.shouldSetAuthenticatedUserData() && !isPc) {
            userDetails['partnerId'] = this.recordingDetailsObject['partnerId'];
            userDetails['ownerId'] = this.recordingDetailsObject['userName'];
            userDetails['appToken'] = this.recordingDetailsObject['appToken'];
            userDetails['appTokenId'] = this.recordingDetailsObject['appTokenId'];
            userDetails['serviceUrl'] = this.recordingDetailsObject['serviceUrl'];
            userDetails['hashType'] = this.recordingDetailsObject['hashType'];
        }
        else {
            userDetails['partnerId'] = isPc ? config['shared']['externalSettings']['partnerId'] : config['shared']['partnerId'];
            userDetails['ownerId'] = isPc ? config['shared']['externalSettings']['userId'] :
                (this.recordingDetailsObject['userName'] ? this.recordingDetailsObject['userName'] : config['captureApp']['userId']);
            if (isPc) {
                userDetails['appToken'] = config['shared']['externalSettings']['appToken'];
                userDetails['appTokenId'] = config['shared']['externalSettings']['appTokenId'];
                userDetails['serviceUrl'] = config['shared']['externalSettings']['serviceUrl'];
                userDetails['hashType'] = config['shared']['externalSettings']['hashType'];
            }
        }
        return userDetails;
    }
    setAuthenticatedUserDetails() {
        //if in authentication mode but not in a scheduled event recording
        if (this.shouldSetAuthenticatedUserData()) {
            this.recordingDetailsObject['appToken'] = this.appConfig.getConfigData('config.shared.externalSettings.appToken');
            this.recordingDetailsObject['appTokenId'] = this.appConfig.getConfigData('config.shared.externalSettings.appTokenId');
            this.recordingDetailsObject['hashType'] = this.appConfig.getConfigData('config.shared.externalSettings.hashType');
            this.recordingDetailsObject['partnerId'] = this.appConfig.getConfigData('config.shared.externalSettings.partnerId');
            this.recordingDetailsObject['serviceUrl'] = this.appConfig.getConfigData('config.shared.externalSettings.serviceUrl');
            this.recordingDetailsObject['userName'] = this.appConfig.getConfigData('config.shared.externalSettings.userId');
        }
    }
    static makeVideoInputInfo(inputType) {
        return ['ar', 'width', 'height', 'interlaceMode', 'fps', 'colorspace'].reduce((ret, cur) => {
            ret[cur] = inputType[cur];
            return ret;
        }, {});
    }
    getMetaData(sessionId) {
        return Promise.all([this.persistencyService.get(''), __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getOsData')])
            .then(([persistentData, osInfo]) => {
            let metadata = {};
            if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](persistentData) && sessionId) {
                const sessions = this.appState.getActiveSessions();
                const session = sessions[sessionId];
                const sessionName = session ? session['name'] : null;
                let videoEncoders = 'unavailable';
                let selectedVideoEncoderId = 'unavailable';
                let selectedVideoEncoder = 'unavailable';
                let videoInputTypeInfo = 'unavailable';
                let audioInputTypeInfo = 'unavailable';
                if (sessionName === 'audio') {
                    const audioInputType = persistentData['audio'] ? persistentData['audio']['input_type_id'] : null;
                    if (audioInputType) {
                        audioInputTypeInfo = `${audioInputType['channels']}, ${audioInputType['bitsPerSample']} Bit, ${audioInputType['samplesPerSec']}Hz ${audioInputType['subtype']}`;
                    }
                }
                else {
                    // Encoder Info
                    videoEncoders = this.videoDeviceSettingsService.getDeviceEncoders(sessionName);
                    selectedVideoEncoderId = this.videoDeviceSettingsService.getSelectedEncoder(sessionName);
                    selectedVideoEncoder = __WEBPACK_IMPORTED_MODULE_4_lodash__["find"](videoEncoders, (encoder) => {
                        return encoder['encoder_id'] === selectedVideoEncoderId;
                    });
                    // Input type for screen
                    const screenInputType = persistentData[sessionName] ? persistentData[sessionName]['input_type_id'] : null;
                    if (screenInputType) {
                        videoInputTypeInfo = RecordingDetailsService_1.makeVideoInputInfo(screenInputType);
                    }
                }
                // config: for partnerId, userId
                const recDetails = this.getRecordingDetails();
                const config = this.appConfig.getConfigData("config");
                const recordingTime = persistentData['recording'] ? persistentData['recording']['recordingTime'] : '';
                metadata = {
                    appVersion: config['shared']['app_version'],
                    appType: config['shared']['appType'],
                    resourceId: config['shared']['resourceId'],
                    partnerId: config['shared']['partnerId'],
                    userId: config['captureApp']['userId'],
                    isScheduledEvent: recDetails ? (recDetails['eventId'] ? true : false) : '',
                    scheduledEventId: recDetails ? recDetails['eventId'] : '',
                    videoInputTypeInfo: videoInputTypeInfo,
                    audioInputTypeInfo: audioInputTypeInfo,
                    videoEncoder: selectedVideoEncoder ? selectedVideoEncoder['friendly_name'] : '',
                    recordingTime: recordingTime
                };
            }
            if (!__WEBPACK_IMPORTED_MODULE_4_lodash__["isEmpty"](osInfo)) {
                metadata['os'] = `${osInfo['platform']}, osVersion: ${osInfo['osVersion']}`;
            }
            return [metadata];
        });
    }
    removeInvalidXmlChars(str) {
        let NOT_SAFE_IN_XML_1_0 = /[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm;
        return str.replace(NOT_SAFE_IN_XML_1_0, ' ');
    }
    shouldSetAuthenticatedUserData() {
        return __WEBPACK_IMPORTED_MODULE_11__infra_authentication_service__["a" /* AuthenticationService */].isAuthenticationEnabled && !this.recordingDetailsObject['eventId'];
    }
};
RecordingDetailsService = RecordingDetailsService_1 = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_3__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_6__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_7__infra_kaltura_api_service__["a" /* KalturaApiService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__infra_kaltura_api_service__["a" /* KalturaApiService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_10__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_10__infra_app_state_service__["a" /* AppStateService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_12__infra_system_data_service__["a" /* SystemDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_12__infra_system_data_service__["a" /* SystemDataService */]) === "function" && _f || Object, typeof (_g = typeof __WEBPACK_IMPORTED_MODULE_11__infra_authentication_service__["a" /* AuthenticationService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_11__infra_authentication_service__["a" /* AuthenticationService */]) === "function" && _g || Object, typeof (_h = typeof __WEBPACK_IMPORTED_MODULE_9__capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__capture_device_video_device_settings_service__["a" /* VideoDeviceSettingsService */]) === "function" && _h || Object])
], RecordingDetailsService);

var RecordingDetailsService_1, _a, _b, _c, _d, _e, _f, _g, _h;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/recording-details.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/recording/recording-recovery.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__capture_device_device_recovery_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/device-recovery.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordingRecoveryService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let RecordingRecoveryService = class RecordingRecoveryService {
    constructor(log, persistencyService, deviceRecoveryService) {
        this.log = log;
        this.persistencyService = persistencyService;
        this.deviceRecoveryService = deviceRecoveryService;
    }
    /**
     * return a persistent recording data if there is one. null if not.
     * checking for existing recorded files
     */
    shouldRecoverRecordingSession() {
        return this.persistencyService.get('recording')
            .then((recData) => {
            if (!__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](recData) && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](recData['details']) && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](recData['details']['files'])) {
                return recData;
            }
            else {
                return null;
            }
        })
            .catch((err) => {
            this.log.error('Failed to read recovery persistent data. ' + __WEBPACK_IMPORTED_MODULE_4__utils_utils__["a" /* utils */].stringifyMsg(err));
            return Promise.reject(err);
        });
    }
    canRecoverRecordingSession() {
        this.log.info('canRecoverRecordingSession()');
        let canRecover = true;
        return this.persistencyService.get('recording.details')
            .then((details) => {
            __WEBPACK_IMPORTED_MODULE_3_lodash__["forEach"](this.deviceRecoveryService.recoverySessions, function (sessionObj) {
                canRecover = canRecover && (__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](details['files'][sessionObj['name']]) || sessionObj['recoveryReady']);
            });
            return canRecover;
        })
            .catch((err) => {
            return Promise.reject(err);
        });
    }
    /**
     * at the moment just checks for disconnection or not
     * @return {string}
     */
    getRecoveryFailureReason() {
        if (__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](this.deviceRecoveryService.recoverySessions)) {
            return this.deviceRecoveryService.DEVICE_STATE.NONE;
        }
        else {
            let failureReason = this.deviceRecoveryService.DEVICE_STATE.FAILED;
            __WEBPACK_IMPORTED_MODULE_3_lodash__["forEach"](this.deviceRecoveryService.recoverySessions, (obj) => {
                if (obj && !__WEBPACK_IMPORTED_MODULE_3_lodash__["isEmpty"](obj['reason']) &&
                    (obj['reason'] === this.deviceRecoveryService.DEVICE_STATE.DISCONNECTED || obj['reason'] === 'AUDIO-' + this.deviceRecoveryService.DEVICE_STATE.DISCONNECTED ||
                        obj['reason'] === 'NO_VIDEO_DEVICES' || obj['reason'] === 'NO_SCREEN_DEVICES' || obj['reason'] === 'NO_AUDIO_DEVICES')) {
                    failureReason = this.deviceRecoveryService.DEVICE_STATE.DISCONNECTED;
                }
            });
            return failureReason;
        }
    }
    resetRecoverySessions() {
        this.deviceRecoveryService.resetRecoverySessions();
    }
    getRecoverySessionsReadyPromise() {
        return this.deviceRecoveryService.recoverySessionsReadyPromise;
    }
    getRecoveryDisconnectionState() {
        return this.deviceRecoveryService.DEVICE_STATE.DISCONNECTED;
    }
};
RecordingRecoveryService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__capture_device_device_recovery_service__["a" /* DeviceRecoveryService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__capture_device_device_recovery_service__["a" /* DeviceRecoveryService */]) === "function" && _c || Object])
], RecordingRecoveryService);

var _a, _b, _c;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/recording-recovery.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/recording/recording-utils.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__infra_app_persistent_data_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-persistent-data.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__recording_details_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-details.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__capture_device_audio_device_settings_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/audio-device-settings.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__capture_device_video_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordingUtilsService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};










let RecordingUtilsService = class RecordingUtilsService {
    constructor(log, persistencyService, appState, recordingDetailsService, videoDeviceService, audioSettingsService) {
        this.log = log;
        this.persistencyService = persistencyService;
        this.appState = appState;
        this.recordingDetailsService = recordingDetailsService;
        this.videoDeviceService = videoDeviceService;
        this.audioSettingsService = audioSettingsService;
        //mp4 files suffix
        this.metadataFileSuffix = ".metadata";
        this.mediatypesFileSuffix = ".mediatypes";
    }
    getRecordingFilesForDeletion(filesFromEngine = []) {
        let filesToDelete = [];
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](filesFromEngine, (file) => {
            if (file) {
                filesToDelete.push(file.path);
                if (file.slides) {
                    filesToDelete.push(file.slides);
                }
            }
        });
        // check that files for deletion got from the engine equals to the files we have in our persistent data
        // (inactive sessions files won't return from the engine)
        return this.getFilesToDeletionFromPersistency(filesToDelete);
    }
    removeRecordedFiles(files) {
        this.log.info('removing recorded files: ' + JSON.stringify(files));
        return __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('removeFiles', files)
            .catch((err) => {
            this.log.error('failed to remove recorded files: ' + JSON.stringify(files) + '. Error: ' + __WEBPACK_IMPORTED_MODULE_1__utils_utils__["a" /* utils */].stringifyMsg(err));
        });
    }
    /**
     * Using this function during cancel recording flow. since we don't know if the engine will return all relevant files
     * for deletion (disconnection for example) we are adding relevant files from our persistency file.
     * @param filesToDelete
     */
    getFilesToDeletionFromPersistency(filesToDelete) {
        return this.persistencyService.get('recording.details.files')
            .then((files) => {
            let slidesFoldersPromises = [];
            if (files && !__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](files)) {
                __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](files, mp4File => {
                    filesToDelete.push(mp4File);
                    filesToDelete.push(mp4File + this.mediatypesFileSuffix);
                    filesToDelete.push(mp4File + this.metadataFileSuffix);
                    //in case there are some slides related to this session - remove them
                    slidesFoldersPromises.push(this.getRecordingFileRelatedSlidesDir(mp4File.replace(/^.*[\\\/]/, '')));
                });
            }
            return Promise.all(slidesFoldersPromises);
        })
            .then((slidesFolders) => {
            __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](slidesFolders, slideFolder => {
                filesToDelete.push(slideFolder);
            });
            return __WEBPACK_IMPORTED_MODULE_2_lodash__["uniq"](filesToDelete);
        })
            .catch((err) => {
            this.log.error('Failed to get recording files from our persistency file: ' + __WEBPACK_IMPORTED_MODULE_1__utils_utils__["a" /* utils */].stringifyMsg(err));
            return filesToDelete;
        });
    }
    getRecordingFileRelatedSlidesDir(mp4File) {
        let slideDirName = mp4File.substr(0, mp4File.lastIndexOf('.'));
        return __WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('getSlidesFolderForCaptureFileName', slideDirName);
    }
    isProcessing() {
        let sessionsIds = __WEBPACK_IMPORTED_MODULE_2_lodash__["keys"](this.appState.getActiveSessions());
        let stable = true;
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](sessionsIds, (sessionId) => {
            stable = stable && this.appState.isSourceStable(sessionId, true);
        });
        return !stable;
    }
    updateRecState(state) {
        this.log.info('update recording state to: ' + state);
        this.appState.updateAppState('rec-state', state);
    }
    getSessionActionArgs(action, sessionId) {
        if (action === 'stopRecord' || action === 'recoverMP4File') {
            return this.recordingDetailsService.getMetaData(sessionId);
        }
        return Promise.resolve(); //no prams is needed
    }
    finalizeRecordingFileOffCycle(files) {
        this.log.info('finalizeRecordingFileOffCycle()');
        let strAction;
        return this.getSessionActionArgs('recoverMP4File')
            .then((recordingActionArgs) => {
            let finalizeCalls = [];
            __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](files, function (file) {
                finalizeCalls.push(__WEBPACK_IMPORTED_MODULE_3__utils_ipcWrapper__["a" /* ipcWrapper */].sendIPC('recoverMP4File', file, ...recordingActionArgs));
            });
            strAction = JSON.stringify(this.appState.getActiveRecordableSessionsIds());
            this.appState.onCallStarted('recoverMP4File', strAction);
            return Promise.all(finalizeCalls);
        }).then((res) => {
            this.appState.onCallEnded('recoverMP4File - SUCCESS', strAction);
            return true;
        })
            .catch((err) => {
            this.appState.onCallEnded('recoverMP4File - FAILURE', strAction);
            return Promise.reject(err);
        });
    }
    updateRecordingFiles(files) {
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](files, file => {
            if (!__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.appState.getActiveSessions()) && !__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](this.appState.getActiveSessions()[file['id']])) {
                let sessionName = this.videoDeviceService.getSessionNameById(file['id']) ?
                    this.videoDeviceService.getSessionNameById(file['id']) :
                    this.audioSettingsService.getSessionNameById(file['id']);
                this.recordingDetailsService.setRecordedFilePath(sessionName, file['path']);
            }
        });
    }
};
RecordingUtilsService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_4__infra_app_persistent_data_service__["a" /* AppPersistentDataService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__infra_app_persistent_data_service__["a" /* AppPersistentDataService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_6__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__infra_app_state_service__["a" /* AppStateService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_7__recording_details_service__["a" /* RecordingDetailsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__recording_details_service__["a" /* RecordingDetailsService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_9__capture_device_video_device_service__["a" /* VideoDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_9__capture_device_video_device_service__["a" /* VideoDeviceService */]) === "function" && _e || Object, typeof (_f = typeof __WEBPACK_IMPORTED_MODULE_8__capture_device_audio_device_settings_service__["a" /* AudioDeviceSettingsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_8__capture_device_audio_device_settings_service__["a" /* AudioDeviceSettingsService */]) === "function" && _f || Object])
], RecordingUtilsService);

var _a, _b, _c, _d, _e, _f;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/recording-utils.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/recording/recording.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_infra_module__ = __webpack_require__("../../../../../src/shared/services/infra/infra.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__recording_details_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-details.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__recording_recovery_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-recovery.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__slides_service__ = __webpack_require__("../../../../../src/shared/services/recording/slides.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__monitoring_monitoring_module__ = __webpack_require__("../../../../../src/shared/services/monitoring/monitoring.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__capture_device_capture_device_module__ = __webpack_require__("../../../../../src/shared/services/capture-device/capture-device.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__mouse_click_indication_service__ = __webpack_require__("../../../../../src/shared/services/recording/mouse-click-indication.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__recording_utils_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-utils.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RecordingModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};









let RecordingModule = class RecordingModule {
};
RecordingModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [
            __WEBPACK_IMPORTED_MODULE_1__infra_infra_module__["a" /* InfraModule */],
            __WEBPACK_IMPORTED_MODULE_5__monitoring_monitoring_module__["a" /* MonitoringModule */],
            __WEBPACK_IMPORTED_MODULE_6__capture_device_capture_device_module__["a" /* CaptureDeviceModule */]
        ],
        providers: [
            __WEBPACK_IMPORTED_MODULE_2__recording_details_service__["a" /* RecordingDetailsService */],
            __WEBPACK_IMPORTED_MODULE_3__recording_recovery_service__["a" /* RecordingRecoveryService */],
            __WEBPACK_IMPORTED_MODULE_4__slides_service__["a" /* SlideService */],
            __WEBPACK_IMPORTED_MODULE_7__mouse_click_indication_service__["a" /* MouseClickIndicationService */],
            __WEBPACK_IMPORTED_MODULE_8__recording_utils_service__["a" /* RecordingUtilsService */]
        ]
    })
], RecordingModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/recording.module.js.map

/***/ }),

/***/ "../../../../../src/shared/services/recording/slides.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__ = __webpack_require__("../../../../../src/utils/ipcWrapper.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__recording_details_service__ = __webpack_require__("../../../../../src/shared/services/recording/recording-details.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_state_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-state.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__capture_device_video_device_service__ = __webpack_require__("../../../../../src/shared/services/capture-device/video-device.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return SlideService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};








let SlideService = class SlideService {
    constructor(appState, appConfig, recordingDetails, notificationService, videoService) {
        this.appState = appState;
        this.appConfig = appConfig;
        this.recordingDetails = recordingDetails;
        this.notificationService = notificationService;
        this.videoService = videoService;
        this.registerForSlideCapturingNotifications();
    }
    shouldCaptureSlides() {
        let screenSession = __WEBPACK_IMPORTED_MODULE_2_lodash__["find"](this.appState.getActiveRecordableSessionsIds(), (sessionId) => {
            return this.videoService.getCaptureDeviceTypeBySessionId(sessionId) === 'screen';
        });
        return this.appConfig.setConfigData('config.captureEngine.capturePowerPoint', //config path
        this.appConfig.getConfigData('config.captureEngine.capturePowerPoint') && !__WEBPACK_IMPORTED_MODULE_2_lodash__["isEmpty"](screenSession), //new captureSlide value
        true, //reload engine with new slide capture value
        false //don't save this dynamic value to disc (of even save to app config object) - only current engine action will use this new value
        );
    }
    registerForSlideCapturingNotifications() {
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('capture-ppt', (data) => {
            if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isString"](data)) {
                data = JSON.parse(data);
            }
            this.recordingDetails.addSlideCapturedFilePath(data);
        });
        __WEBPACK_IMPORTED_MODULE_1__utils_ipcWrapper__["a" /* ipcWrapper */].registerForNotification('capture-ppt-error', (data) => {
            if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isString"](data)) {
                data = JSON.parse(data);
                if (data.code !== "EngineError_UnspecifiedError")
                    this.notificationService.sendNotification('NOTIFICATIONS.' + data.code, "error");
            }
        });
    }
};
SlideService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_state_service__["a" /* AppStateService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_state_service__["a" /* AppStateService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_6__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_6__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_3__recording_details_service__["a" /* RecordingDetailsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__recording_details_service__["a" /* RecordingDetailsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_4__infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_4__infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _d || Object, typeof (_e = typeof __WEBPACK_IMPORTED_MODULE_7__capture_device_video_device_service__["a" /* VideoDeviceService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_7__capture_device_video_device_service__["a" /* VideoDeviceService */]) === "function" && _e || Object])
], SlideService);

var _a, _b, _c, _d, _e;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/slides.service.js.map

/***/ }),

/***/ "../../../../../src/shared/services/resource-id/resource-id.module.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_infra_module__ = __webpack_require__("../../../../../src/shared/services/infra/infra.module.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__resource_id_service__ = __webpack_require__("../../../../../src/shared/services/resource-id/resource-id.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ResourceIdModule; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};



let ResourceIdModule = class ResourceIdModule {
};
ResourceIdModule = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])({
        imports: [
            __WEBPACK_IMPORTED_MODULE_1__infra_infra_module__["a" /* InfraModule */]
        ],
        providers: [
            __WEBPACK_IMPORTED_MODULE_2__resource_id_service__["a" /* ResourceIdService */]
        ]
    })
], ResourceIdModule);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/resource-id.module.js.map

/***/ }),

/***/ "../../../../../src/shared/services/resource-id/resource-id.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__infra_kaltura_api_service__ = __webpack_require__("../../../../../src/shared/services/infra/kaltura-api.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-config.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__infra_app_logger_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-logger.service.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_utils_utils__ = __webpack_require__("../../../../../src/utils/utils.ts");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__infra_app_notifications_service__ = __webpack_require__("../../../../../src/shared/services/infra/app-notifications.service.ts");
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ResourceIdService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};






let ResourceIdService = class ResourceIdService {
    constructor(kalturaAPI, log, appNotificationService, appConfig) {
        this.kalturaAPI = kalturaAPI;
        this.log = log;
        this.appNotificationService = appNotificationService;
        this.appConfig = appConfig;
    }
    get resourceId() {
        return this._resourceId;
    }
    get resourceName() {
        return this._resourceName;
    }
    ready() {
        //called after the constructor and called  after the first ngOnChanges()
        if (!this._ready) {
            let sharedConfig = this.appConfig.getConfigData('config.shared');
            this._resourceName = sharedConfig.resourceName;
            this._ready = this.getResourceId(sharedConfig)
                .then(resourceId => {
                this._resourceId = resourceId;
                //check if resourceName has changed from last time
                return this.refreshResourceNameFromServer().then(() => {
                    return Promise.resolve(true);
                }).catch(err => {
                    //not API response, we don't really care
                    return Promise.resolve(true);
                });
            })
                .catch(err => {
                let error = __WEBPACK_IMPORTED_MODULE_4_utils_utils__["a" /* utils */].getAPIErrorMessage(err);
                this.appNotificationService.sendNotification(error, 'error');
                return Promise.resolve(false);
            });
        }
        return this._ready;
    }
    refreshResourceNameFromServer() {
        return this.getResourceFromId(this.resourceId).then((res) => {
            if (this._resourceName != res.name) {
                this._resourceName = res.name;
                this.appConfig.setConfigData('config.shared.resourceName', this._resourceName);
            }
        });
    }
    getResourceId(sharedConfig) {
        if (!sharedConfig.resourceId) {
            return this.createResourceId(this._resourceName);
        }
        return Promise.resolve(sharedConfig.resourceId);
    }
    createResourceId(resourceName) {
        this.log.info("creating new resourceId with resourceName = " + resourceName);
        return this.getResourceIdFromName(resourceName).then(resourceId => {
            if (!resourceId) {
                return this.kalturaAPI.apiRequest({
                    "service": "schedule_scheduleresource",
                    "action": "add",
                    "scheduleResource:objectType": "KalturaCameraScheduleResource",
                    "scheduleResource:name": resourceName
                }).toPromise().then((res) => {
                    this.log.info("created new resourceId with resourceName = " + resourceName + " obj= " + JSON.stringify(res));
                    this.appConfig.setConfigData('config.shared.resourceId', res.id);
                    return res.id;
                });
            }
            this.appConfig.setConfigData('config.shared.resourceId', resourceId);
            return resourceId;
        });
    }
    getResourceIdFromName(resourceName) {
        this.log.info("getting  resourceId for resourceName = " + resourceName);
        return this.kalturaAPI.apiRequest({
            "service": "schedule_scheduleresource",
            "action": "list",
            "filter:objectType": "KalturaCameraScheduleResourceFilter",
            "filter:statusEqual": 2,
            "filter:nameEqual": resourceName
        }).toPromise().then((res) => {
            if (res.objects && res.objects.length > 0) {
                this.log.info("got  resource " + JSON.stringify(res.objects[0]) + " for resourceName = " + resourceName);
                return res.objects[0].id;
            }
            this.log.warn("didn't found resourceId for resourceName = " + resourceName);
            return null;
        });
    }
    getResourceFromId(resourceId) {
        this.log.info("getting  resourceName for resourceId = " + resourceId);
        //todo: move to schedule_scheduleresource:get
        /*
         return this.kalturaAPI.apiRequest( {
         "service": "schedule_scheduleresource",
         "action": "get",
         "scheduleResourceId": resourceId,
         }).toPromise();
         */
        return this.kalturaAPI.apiRequest({
            "service": "schedule_scheduleresource",
            "action": "list",
            "filter:objectType": "KalturaCameraScheduleResourceFilter",
            "filter:idEqual": resourceId
        }).toPromise().then(res => {
            if (res.objects && res.objects.length > 0) {
                return res.objects[0];
            }
            return Promise.reject(null);
        });
    }
    renameResourceName(newResourceName) {
        this.log.info("Renaming resourceName to  " + newResourceName + " for id " + this._resourceId);
        return this.getResourceIdFromName(newResourceName).then(resId => {
            if (!resId) {
                return this.kalturaAPI.apiRequest({
                    "service": "schedule_scheduleresource",
                    "action": "update",
                    "scheduleResourceId": this._resourceId,
                    "scheduleResource:objectType": "KalturaCameraScheduleResource",
                    "scheduleResource:name": newResourceName
                }).toPromise().then((res) => {
                    this.log.info("Renamed resourceName  " + newResourceName);
                    this.appConfig.setConfigData('config.shared.resourceName', newResourceName);
                    this._resourceName = newResourceName;
                    return res.id;
                }).catch(err => {
                    this.log.warn("Couldn't rename resourceName to  " + newResourceName + " for id " + this._resourceId + " err=" + __WEBPACK_IMPORTED_MODULE_4_utils_utils__["a" /* utils */].stringifyMsg(err));
                    return Promise.reject(err);
                });
            }
            if (resId == this._resourceId) {
                return Promise.resolve(resId);
            }
            this.log.warn("Couldn't rename resourceName to  " + newResourceName + " for id " + this._resourceId + " name already exists");
            //simulate API error
            return Promise.reject({ error: { code: 'SYSTEM_NAME_ALREADY_EXISTS' } });
        });
    }
    ;
};
ResourceIdService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [typeof (_a = typeof __WEBPACK_IMPORTED_MODULE_1__infra_kaltura_api_service__["a" /* KalturaApiService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_1__infra_kaltura_api_service__["a" /* KalturaApiService */]) === "function" && _a || Object, typeof (_b = typeof __WEBPACK_IMPORTED_MODULE_3__infra_app_logger_service__["a" /* AppLoggerService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_3__infra_app_logger_service__["a" /* AppLoggerService */]) === "function" && _b || Object, typeof (_c = typeof __WEBPACK_IMPORTED_MODULE_5__infra_app_notifications_service__["a" /* AppNotificationsService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_5__infra_app_notifications_service__["a" /* AppNotificationsService */]) === "function" && _c || Object, typeof (_d = typeof __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__["a" /* AppConfigService */] !== "undefined" && __WEBPACK_IMPORTED_MODULE_2__infra_app_config_service__["a" /* AppConfigService */]) === "function" && _d || Object])
], ResourceIdService);

var _a, _b, _c, _d;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/resource-id.service.js.map

/***/ }),

/***/ "../../../../../src/utils/ipcWrapper.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_angular2_uuid__ = __webpack_require__("../../../../angular2-uuid/index.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_angular2_uuid___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_angular2_uuid__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_lodash__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ipcWrapper; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};



const COMMON_EVENT_NAME = 'ipc-promise-common-event';
const COMMON_REPEAT_EVENT_NAME = 'ipc-promise-common-repeat-event';
const UNREGISTER_COMMON_REPEAT_EVENT_NAME = 'ipc-promise-common-repeat-event-unregister';
const SUCCESS_EVENT_SUFFIX = '-success';
const FAILURE_EVENT_SUFFIX = '-failure';
const COMMON_SUCCESS_EVENT_NAME = COMMON_EVENT_NAME + SUCCESS_EVENT_SUFFIX;
const COMMON_FAILURE_EVENT_NAME = COMMON_EVENT_NAME + FAILURE_EVENT_SUFFIX;
let ipcWrapper = ipcWrapper_1 = class ipcWrapper {
    constructor() {
    }
    static sendSystemCommand(systemCommand, ...args) {
        electron.ipcRenderer.send(systemCommand, args);
    }
    static popCallParams(id) {
        let params = ipcWrapper_1.map.get(id);
        ipcWrapper_1.map.delete(id);
        return params;
    }
    static sendIPC(eventName, ...data) {
        if (__WEBPACK_IMPORTED_MODULE_2_lodash__["isArray"](data) && data.length > 0) {
            data = __WEBPACK_IMPORTED_MODULE_2_lodash__["without"](data, undefined);
        }
        if (ipcWrapper_1.counter === 0) {
            electron.ipcRenderer.on(COMMON_SUCCESS_EVENT_NAME, (event, resParams) => {
                let callParams = ipcWrapper_1.popCallParams(resParams.id);
                if (callParams) {
                    callParams.resolve(resParams.data);
                }
            });
            electron.ipcRenderer.on(COMMON_FAILURE_EVENT_NAME, (event, resParams) => {
                let callParams = ipcWrapper_1.popCallParams(resParams.id);
                if (callParams) {
                    callParams.reject(resParams.data);
                }
            });
        }
        return new Promise(function (resolve, reject) {
            let id = eventName + new Date().getTime() + ++ipcWrapper_1.counter;
            let params = {
                data: data,
                eventName: eventName,
                id: id,
                resolve: resolve,
                reject: reject
            };
            ipcWrapper_1.map.set(id, params);
            electron.ipcRenderer.send(COMMON_EVENT_NAME, params);
        });
    }
    static registerForNotification(eventName, callback, ...data) {
        let uuid = __WEBPACK_IMPORTED_MODULE_1_angular2_uuid__["UUID"].UUID();
        let handleEvent = (event, params) => {
            if (callback) {
                callback(...params.data);
            }
        };
        electron.ipcRenderer.on(COMMON_REPEAT_EVENT_NAME + '_' + eventName, handleEvent);
        ipcWrapper_1.listenersMap.set(eventName + uuid, handleEvent);
        let params = {
            data: data,
            eventName: eventName
        };
        electron.ipcRenderer.send(COMMON_REPEAT_EVENT_NAME, params);
        return uuid;
    }
    // stop getting notifications for the channel named COMMON_REPEAT_EVENT_NAME + '_' + eventName
    static unregisterForNotification(eventName, id = '') {
        //remove specific listener from channel
        let listenerKey = eventName + id;
        if (ipcWrapper_1.listenersMap.has(listenerKey)) {
            electron.ipcRenderer.removeListener(COMMON_REPEAT_EVENT_NAME + '_' + eventName, ipcWrapper_1.listenersMap.get(listenerKey));
            ipcWrapper_1.listenersMap.delete(listenerKey);
        }
        else {
            electron.ipcRenderer.removeAllListeners(COMMON_REPEAT_EVENT_NAME + '_' + eventName);
            ipcWrapper_1.clearListenersMapByEventName(eventName);
        }
    }
    static clearListenersMapByEventName(eventName) {
        __WEBPACK_IMPORTED_MODULE_2_lodash__["forEach"](__WEBPACK_IMPORTED_MODULE_2_lodash__["filter"]([...ipcWrapper_1.listenersMap.keys()], (mapKey) => { return mapKey.indexOf(eventName) > -1; }), (rmKey) => {
            ipcWrapper_1.listenersMap.delete(rmKey);
        });
    }
    static registerShortcutCB(shortcutData) {
        let shortcut = shortcutData['shortcut'];
        let cb = ipcWrapper_1.keyboardShortcuts.get(shortcut);
        if (cb) {
            cb();
        }
    }
    static registerShortcut(shortcut, cb) {
        //we need to register to the callback only once!
        let callback = ipcWrapper_1.keyboardShortcuts.size > 0 ? null : ipcWrapper_1.registerShortcutCB;
        ipcWrapper_1.keyboardShortcuts.set(shortcut, cb);
        return ipcWrapper_1.registerForNotification("registerGlobalShortcut", callback, shortcut);
    }
    static unRegisterShortcut(shortcut, id = '') {
        ipcWrapper_1.keyboardShortcuts.delete(shortcut);
        ipcWrapper_1.unregisterForNotification("registerGlobalShortcut", id);
    }
};
ipcWrapper.counter = 0;
/**
 * key: eventName + uuid
 * value: event listener
 * @type {Map<any, any>}
 */
ipcWrapper.listenersMap = new Map();
ipcWrapper.keyboardShortcuts = new Map();
ipcWrapper.map = new Map();
ipcWrapper = ipcWrapper_1 = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [])
], ipcWrapper);

var ipcWrapper_1;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/ipcWrapper.js.map

/***/ }),

/***/ "../../../../../src/utils/minimize.service.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs__ = __webpack_require__("../../../../rxjs/Rx.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_rxjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_rxjs__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return MinimizeService; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};


let MinimizeService = class MinimizeService {
    constructor() {
        this.minimizeRecording$ = null;
    }
    minimizeToTray(delaySec) {
        this.cancelTrayMinimizationSubscription();
        this.minimizeRecording$ = __WEBPACK_IMPORTED_MODULE_1_rxjs__["Observable"].timer(delaySec * 1000).subscribe(() => {
            window.close();
        });
    }
    cancelTrayMinimizationSubscription() {
        if (this.minimizeRecording$) {
            this.minimizeRecording$.unsubscribe();
        }
    }
};
MinimizeService = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])()
], MinimizeService);

//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/minimize.service.js.map

/***/ }),

/***/ "../../../../../src/utils/utils.ts":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__("../../../core/@angular/core.es5.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash__ = __webpack_require__("../../../../lodash/lodash.js");
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_lodash__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return utils; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};


let errorCodes = {
    'INVALID_WIDGET_ID': 'NOTIFICATIONS.error_invalid_partner_id',
    "SYSTEM_NAME_ALREADY_EXISTS": 'SETTINGS.SYSTEM_NAME_ALREADY_EXISTS'
};
let utils = utils_1 = class utils {
    constructor() {
    }
    static sortResolutionArray(resArray) {
        resArray.sort((a, b) => {
            return b.value[0] * b.value[1] - a.value[0] * a.value[1];
        });
    }
    static getAPIErrorMessage(err) {
        let error = 'NOTIFICATIONS.error_server_not_reachable';
        if (err && __WEBPACK_IMPORTED_MODULE_1_lodash__["isObject"](err.error) && err.error.code) {
            error = errorCodes[err.error.code];
            if (!error) {
                error = err.error.message;
            }
        }
        return error;
    }
    static stringifyMsg(msg) {
        if (__WEBPACK_IMPORTED_MODULE_1_lodash__["isError"](msg)) {
            return msg.message + " " + msg.stack;
        }
        if (__WEBPACK_IMPORTED_MODULE_1_lodash__["isString"](msg))
            return msg;
        return JSON.stringify(msg);
    }
    static delayPromise(milis) {
        return new Promise(resolve => {
            setTimeout(() => {
                resolve();
            }, milis);
        });
    }
    static filterAndSortInputs(inputTypes, limits) {
        let ret = __WEBPACK_IMPORTED_MODULE_1_lodash__["filter"](__WEBPACK_IMPORTED_MODULE_1_lodash__["castArray"](inputTypes), (input) => {
            let fps = input['fps'];
            return (fps >= limits.minFPS && fps <= limits.maxFPS);
        });
        ret = __WEBPACK_IMPORTED_MODULE_1_lodash__["orderBy"](ret, [
            (input) => {
                if (limits.defaultHeight) {
                    return Math.abs(input['height'] - limits.defaultHeight);
                }
                else {
                    return 1; //ignore height
                }
            },
            (input) => {
                return Math.abs(input['fps'] - limits.defaultFPS);
            },
            function (input) {
                return input.interlaceMode === 'progressive' ? 1 : 0;
            },
            function (input) {
                return input['width'] * input['height'];
            },
            (input) => {
                let weight = utils_1.colorspace_weight[input['colorspace'].toUpperCase()];
                if (weight) {
                    return weight;
                }
                return 0;
            }
        ], ["asec", "asec", "desc", "desc", "desc"]);
        return ret;
    }
    static sha1(msg) {
        function rotate_left(n, s) {
            var t4 = (n << s) | (n >>> (32 - s));
            return t4;
        }
        ;
        function lsb_hex(val) {
            var str = "";
            var i;
            var vh;
            var vl;
            for (i = 0; i <= 6; i += 2) {
                vh = (val >>> (i * 4 + 4)) & 0x0f;
                vl = (val >>> (i * 4)) & 0x0f;
                str += vh.toString(16) + vl.toString(16);
            }
            return str;
        }
        ;
        function cvt_hex(val) {
            var str = "";
            var i;
            var v;
            for (i = 7; i >= 0; i--) {
                v = (val >>> (i * 4)) & 0x0f;
                str += v.toString(16);
            }
            return str;
        }
        ;
        function Utf8Encode(string) {
            string = string.replace(/\r\n/g, "\n");
            var utftext = "";
            for (var n = 0; n < string.length; n++) {
                var c = string.charCodeAt(n);
                if (c < 128) {
                    utftext += String.fromCharCode(c);
                }
                else if ((c > 127) && (c < 2048)) {
                    utftext += String.fromCharCode((c >> 6) | 192);
                    utftext += String.fromCharCode((c & 63) | 128);
                }
                else {
                    utftext += String.fromCharCode((c >> 12) | 224);
                    utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                    utftext += String.fromCharCode((c & 63) | 128);
                }
            }
            return utftext;
        }
        ;
        var blockstart;
        var i, j;
        var W = new Array(80);
        var H0 = 0x67452301;
        var H1 = 0xEFCDAB89;
        var H2 = 0x98BADCFE;
        var H3 = 0x10325476;
        var H4 = 0xC3D2E1F0;
        var A, B, C, D, E;
        var temp;
        msg = Utf8Encode(msg);
        var msg_len = msg.length;
        var word_array = new Array();
        for (i = 0; i < msg_len - 3; i += 4) {
            j = msg.charCodeAt(i) << 24 | msg.charCodeAt(i + 1) << 16 |
                msg.charCodeAt(i + 2) << 8 | msg.charCodeAt(i + 3);
            word_array.push(j);
        }
        switch (msg_len % 4) {
            case 0:
                i = 0x080000000;
                break;
            case 1:
                i = msg.charCodeAt(msg_len - 1) << 24 | 0x0800000;
                break;
            case 2:
                i = msg.charCodeAt(msg_len - 2) << 24 | msg.charCodeAt(msg_len - 1) << 16 | 0x08000;
                break;
            case 3:
                i = msg.charCodeAt(msg_len - 3) << 24 | msg.charCodeAt(msg_len - 2) << 16 | msg.charCodeAt(msg_len - 1) << 8 | 0x80;
                break;
        }
        word_array.push(i);
        while ((word_array.length % 16) != 14)
            word_array.push(0);
        word_array.push(msg_len >>> 29);
        word_array.push((msg_len << 3) & 0x0ffffffff);
        for (blockstart = 0; blockstart < word_array.length; blockstart += 16) {
            for (i = 0; i < 16; i++)
                W[i] = word_array[blockstart + i];
            for (i = 16; i <= 79; i++)
                W[i] = rotate_left(W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16], 1);
            A = H0;
            B = H1;
            C = H2;
            D = H3;
            E = H4;
            for (i = 0; i <= 19; i++) {
                temp = (rotate_left(A, 5) + ((B & C) | (~B & D)) + E + W[i] + 0x5A827999) & 0x0ffffffff;
                E = D;
                D = C;
                C = rotate_left(B, 30);
                B = A;
                A = temp;
            }
            for (i = 20; i <= 39; i++) {
                temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0x6ED9EBA1) & 0x0ffffffff;
                E = D;
                D = C;
                C = rotate_left(B, 30);
                B = A;
                A = temp;
            }
            for (i = 40; i <= 59; i++) {
                temp = (rotate_left(A, 5) + ((B & C) | (B & D) | (C & D)) + E + W[i] + 0x8F1BBCDC) & 0x0ffffffff;
                E = D;
                D = C;
                C = rotate_left(B, 30);
                B = A;
                A = temp;
            }
            for (i = 60; i <= 79; i++) {
                temp = (rotate_left(A, 5) + (B ^ C ^ D) + E + W[i] + 0xCA62C1D6) & 0x0ffffffff;
                E = D;
                D = C;
                C = rotate_left(B, 30);
                B = A;
                A = temp;
            }
            H0 = (H0 + A) & 0x0ffffffff;
            H1 = (H1 + B) & 0x0ffffffff;
            H2 = (H2 + C) & 0x0ffffffff;
            H3 = (H3 + D) & 0x0ffffffff;
            H4 = (H4 + E) & 0x0ffffffff;
        }
        let str_temp = cvt_hex(H0) + cvt_hex(H1) + cvt_hex(H2) + cvt_hex(H3) + cvt_hex(H4);
        return str_temp.toLowerCase();
    }
    ;
    static areEventsEqual(eventA, eventB) {
        // if both not exits => equal
        // if both exits with the same properties => equal
        return ((__WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](eventA) && __WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](eventB))
            || (!__WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](eventA)
                && !__WEBPACK_IMPORTED_MODULE_1_lodash__["isEmpty"](eventB)
                && eventA['id'] === eventB['id']
                && eventA['startDate'] === eventB['startDate']
                && eventA['endDate'] === eventB['endDate']
                && eventA['summary'] === eventB['summary']
                && eventA['description'] === eventB['description']
                && eventA['organizer'] === eventB['organizer']
                && eventA['tags'] === eventB['tags']));
    }
    /**
     * Concat url and prevent double slash and redundant spaces - no handling for params.
     * @param input: a collected array of url parts to be concat.
     */
    static urlBuilder(...input) {
        let url;
        if (input.length && input[0].startsWith('file:')) {
            // join all except the file string with /
            url = [].slice.call(input, 1).join('/');
            // remove double splash
            url = url.replace(/([^:\s])\/+/g, '$1/');
            // add the file:///
            url = [input[0], url].join('/');
            // make sure max / is 3
            return url.replace(/(\/{0,3})\/*/g, '$1');
        }
        else {
            // join all with /
            url = [].slice.call(input, 0).join('/');
            // remove double splash
            return url.replace(/([^:\s])\/+/g, '$1/');
        }
    }
    /**
     * sort inputs names alphabetically when audio input is the last one
     * f.e: ['session0', 'session1'..., 'audio']
     * @param inputsNames
     */
    static sortInputsNames(inputsNames) {
        inputsNames.sort((a, b) => {
            //audio should be last
            if (a === 'audio')
                return 1;
            if (b === 'audio')
                return -1;
            //alphabetical order
            return a < b ? -1 : 1;
        });
        return inputsNames;
    }
    /**
     * each sessionName has it's own display name
     * After classroom app multiple inputs impl. our pc and cc app started to use different sessions display name...
     * returned string are translation placeholders under COMMON category (f.e COMMON.primary in en.json locale)
     */
    static getDisplayNameForSessionName(appType, defaultPrimarySession, sessionName) {
        if (appType === 'cc') {
            switch (sessionName) {
                case 'audio':
                    return 'audio';
                case 'session0':
                    return 'primary_input';
                default:
                    let sessionIndex = parseInt(sessionName.split('session')[1]);
                    return 'input' + ++sessionIndex;
            }
        }
        else {
            return sessionName === 'audio' ? 'audio' : (sessionName === defaultPrimarySession ? 'primary' : 'secondary');
        }
    }
    /**
     *
     * implementing Promise.allSettled behaviour (currently a stage 3 proposal: https://github.com/tc39/proposal-promise-allSettled)
     *
     * Returning an array of completed promises, some can be rejected and some fulfilled
     * Usage example after returned:
     *    const successfulPromises = results.filter(p => p.status === 'fulfilled');
     * @param promises array of promises
     * @return an array of promiseState objects
     */
    static promiseAllSettled(promises) {
        function reflect(promise) {
            return promise.then((v) => {
                return { status: 'fulfilled', value: v };
            }, (error) => {
                return { status: 'rejected', reason: error };
            });
        }
        return Promise.all(promises.map(reflect));
    }
};
utils.STRING_LIMIT = 28;
utils.colorspace_weight = {
    'NV12': 100,
    'YV12': 99,
    'YUY2': 98,
    'UYVY': 97
};
utils = utils_1 = __decorate([
    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__angular_core__["Injectable"])(),
    __metadata("design:paramtypes", [])
], utils);

var utils_1;
//# sourceMappingURL=C:/BuildAgentUItestsAgent/work/1716201729f5df63/lecture-capture-app/src/utils.js.map

/***/ }),

/***/ "../../../../moment/locale recursive ^\\.\\/.*$":
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./af": "../../../../moment/locale/af.js",
	"./af.js": "../../../../moment/locale/af.js",
	"./ar": "../../../../moment/locale/ar.js",
	"./ar-dz": "../../../../moment/locale/ar-dz.js",
	"./ar-dz.js": "../../../../moment/locale/ar-dz.js",
	"./ar-kw": "../../../../moment/locale/ar-kw.js",
	"./ar-kw.js": "../../../../moment/locale/ar-kw.js",
	"./ar-ly": "../../../../moment/locale/ar-ly.js",
	"./ar-ly.js": "../../../../moment/locale/ar-ly.js",
	"./ar-ma": "../../../../moment/locale/ar-ma.js",
	"./ar-ma.js": "../../../../moment/locale/ar-ma.js",
	"./ar-sa": "../../../../moment/locale/ar-sa.js",
	"./ar-sa.js": "../../../../moment/locale/ar-sa.js",
	"./ar-tn": "../../../../moment/locale/ar-tn.js",
	"./ar-tn.js": "../../../../moment/locale/ar-tn.js",
	"./ar.js": "../../../../moment/locale/ar.js",
	"./az": "../../../../moment/locale/az.js",
	"./az.js": "../../../../moment/locale/az.js",
	"./be": "../../../../moment/locale/be.js",
	"./be.js": "../../../../moment/locale/be.js",
	"./bg": "../../../../moment/locale/bg.js",
	"./bg.js": "../../../../moment/locale/bg.js",
	"./bn": "../../../../moment/locale/bn.js",
	"./bn.js": "../../../../moment/locale/bn.js",
	"./bo": "../../../../moment/locale/bo.js",
	"./bo.js": "../../../../moment/locale/bo.js",
	"./br": "../../../../moment/locale/br.js",
	"./br.js": "../../../../moment/locale/br.js",
	"./bs": "../../../../moment/locale/bs.js",
	"./bs.js": "../../../../moment/locale/bs.js",
	"./ca": "../../../../moment/locale/ca.js",
	"./ca.js": "../../../../moment/locale/ca.js",
	"./cs": "../../../../moment/locale/cs.js",
	"./cs.js": "../../../../moment/locale/cs.js",
	"./cv": "../../../../moment/locale/cv.js",
	"./cv.js": "../../../../moment/locale/cv.js",
	"./cy": "../../../../moment/locale/cy.js",
	"./cy.js": "../../../../moment/locale/cy.js",
	"./da": "../../../../moment/locale/da.js",
	"./da.js": "../../../../moment/locale/da.js",
	"./de": "../../../../moment/locale/de.js",
	"./de-at": "../../../../moment/locale/de-at.js",
	"./de-at.js": "../../../../moment/locale/de-at.js",
	"./de-ch": "../../../../moment/locale/de-ch.js",
	"./de-ch.js": "../../../../moment/locale/de-ch.js",
	"./de.js": "../../../../moment/locale/de.js",
	"./dv": "../../../../moment/locale/dv.js",
	"./dv.js": "../../../../moment/locale/dv.js",
	"./el": "../../../../moment/locale/el.js",
	"./el.js": "../../../../moment/locale/el.js",
	"./en-au": "../../../../moment/locale/en-au.js",
	"./en-au.js": "../../../../moment/locale/en-au.js",
	"./en-ca": "../../../../moment/locale/en-ca.js",
	"./en-ca.js": "../../../../moment/locale/en-ca.js",
	"./en-gb": "../../../../moment/locale/en-gb.js",
	"./en-gb.js": "../../../../moment/locale/en-gb.js",
	"./en-ie": "../../../../moment/locale/en-ie.js",
	"./en-ie.js": "../../../../moment/locale/en-ie.js",
	"./en-nz": "../../../../moment/locale/en-nz.js",
	"./en-nz.js": "../../../../moment/locale/en-nz.js",
	"./eo": "../../../../moment/locale/eo.js",
	"./eo.js": "../../../../moment/locale/eo.js",
	"./es": "../../../../moment/locale/es.js",
	"./es-do": "../../../../moment/locale/es-do.js",
	"./es-do.js": "../../../../moment/locale/es-do.js",
	"./es.js": "../../../../moment/locale/es.js",
	"./et": "../../../../moment/locale/et.js",
	"./et.js": "../../../../moment/locale/et.js",
	"./eu": "../../../../moment/locale/eu.js",
	"./eu.js": "../../../../moment/locale/eu.js",
	"./fa": "../../../../moment/locale/fa.js",
	"./fa.js": "../../../../moment/locale/fa.js",
	"./fi": "../../../../moment/locale/fi.js",
	"./fi.js": "../../../../moment/locale/fi.js",
	"./fo": "../../../../moment/locale/fo.js",
	"./fo.js": "../../../../moment/locale/fo.js",
	"./fr": "../../../../moment/locale/fr.js",
	"./fr-ca": "../../../../moment/locale/fr-ca.js",
	"./fr-ca.js": "../../../../moment/locale/fr-ca.js",
	"./fr-ch": "../../../../moment/locale/fr-ch.js",
	"./fr-ch.js": "../../../../moment/locale/fr-ch.js",
	"./fr.js": "../../../../moment/locale/fr.js",
	"./fy": "../../../../moment/locale/fy.js",
	"./fy.js": "../../../../moment/locale/fy.js",
	"./gd": "../../../../moment/locale/gd.js",
	"./gd.js": "../../../../moment/locale/gd.js",
	"./gl": "../../../../moment/locale/gl.js",
	"./gl.js": "../../../../moment/locale/gl.js",
	"./gom-latn": "../../../../moment/locale/gom-latn.js",
	"./gom-latn.js": "../../../../moment/locale/gom-latn.js",
	"./he": "../../../../moment/locale/he.js",
	"./he.js": "../../../../moment/locale/he.js",
	"./hi": "../../../../moment/locale/hi.js",
	"./hi.js": "../../../../moment/locale/hi.js",
	"./hr": "../../../../moment/locale/hr.js",
	"./hr.js": "../../../../moment/locale/hr.js",
	"./hu": "../../../../moment/locale/hu.js",
	"./hu.js": "../../../../moment/locale/hu.js",
	"./hy-am": "../../../../moment/locale/hy-am.js",
	"./hy-am.js": "../../../../moment/locale/hy-am.js",
	"./id": "../../../../moment/locale/id.js",
	"./id.js": "../../../../moment/locale/id.js",
	"./is": "../../../../moment/locale/is.js",
	"./is.js": "../../../../moment/locale/is.js",
	"./it": "../../../../moment/locale/it.js",
	"./it.js": "../../../../moment/locale/it.js",
	"./ja": "../../../../moment/locale/ja.js",
	"./ja.js": "../../../../moment/locale/ja.js",
	"./jv": "../../../../moment/locale/jv.js",
	"./jv.js": "../../../../moment/locale/jv.js",
	"./ka": "../../../../moment/locale/ka.js",
	"./ka.js": "../../../../moment/locale/ka.js",
	"./kk": "../../../../moment/locale/kk.js",
	"./kk.js": "../../../../moment/locale/kk.js",
	"./km": "../../../../moment/locale/km.js",
	"./km.js": "../../../../moment/locale/km.js",
	"./kn": "../../../../moment/locale/kn.js",
	"./kn.js": "../../../../moment/locale/kn.js",
	"./ko": "../../../../moment/locale/ko.js",
	"./ko.js": "../../../../moment/locale/ko.js",
	"./ky": "../../../../moment/locale/ky.js",
	"./ky.js": "../../../../moment/locale/ky.js",
	"./lb": "../../../../moment/locale/lb.js",
	"./lb.js": "../../../../moment/locale/lb.js",
	"./lo": "../../../../moment/locale/lo.js",
	"./lo.js": "../../../../moment/locale/lo.js",
	"./lt": "../../../../moment/locale/lt.js",
	"./lt.js": "../../../../moment/locale/lt.js",
	"./lv": "../../../../moment/locale/lv.js",
	"./lv.js": "../../../../moment/locale/lv.js",
	"./me": "../../../../moment/locale/me.js",
	"./me.js": "../../../../moment/locale/me.js",
	"./mi": "../../../../moment/locale/mi.js",
	"./mi.js": "../../../../moment/locale/mi.js",
	"./mk": "../../../../moment/locale/mk.js",
	"./mk.js": "../../../../moment/locale/mk.js",
	"./ml": "../../../../moment/locale/ml.js",
	"./ml.js": "../../../../moment/locale/ml.js",
	"./mr": "../../../../moment/locale/mr.js",
	"./mr.js": "../../../../moment/locale/mr.js",
	"./ms": "../../../../moment/locale/ms.js",
	"./ms-my": "../../../../moment/locale/ms-my.js",
	"./ms-my.js": "../../../../moment/locale/ms-my.js",
	"./ms.js": "../../../../moment/locale/ms.js",
	"./my": "../../../../moment/locale/my.js",
	"./my.js": "../../../../moment/locale/my.js",
	"./nb": "../../../../moment/locale/nb.js",
	"./nb.js": "../../../../moment/locale/nb.js",
	"./ne": "../../../../moment/locale/ne.js",
	"./ne.js": "../../../../moment/locale/ne.js",
	"./nl": "../../../../moment/locale/nl.js",
	"./nl-be": "../../../../moment/locale/nl-be.js",
	"./nl-be.js": "../../../../moment/locale/nl-be.js",
	"./nl.js": "../../../../moment/locale/nl.js",
	"./nn": "../../../../moment/locale/nn.js",
	"./nn.js": "../../../../moment/locale/nn.js",
	"./pa-in": "../../../../moment/locale/pa-in.js",
	"./pa-in.js": "../../../../moment/locale/pa-in.js",
	"./pl": "../../../../moment/locale/pl.js",
	"./pl.js": "../../../../moment/locale/pl.js",
	"./pt": "../../../../moment/locale/pt.js",
	"./pt-br": "../../../../moment/locale/pt-br.js",
	"./pt-br.js": "../../../../moment/locale/pt-br.js",
	"./pt.js": "../../../../moment/locale/pt.js",
	"./ro": "../../../../moment/locale/ro.js",
	"./ro.js": "../../../../moment/locale/ro.js",
	"./ru": "../../../../moment/locale/ru.js",
	"./ru.js": "../../../../moment/locale/ru.js",
	"./sd": "../../../../moment/locale/sd.js",
	"./sd.js": "../../../../moment/locale/sd.js",
	"./se": "../../../../moment/locale/se.js",
	"./se.js": "../../../../moment/locale/se.js",
	"./si": "../../../../moment/locale/si.js",
	"./si.js": "../../../../moment/locale/si.js",
	"./sk": "../../../../moment/locale/sk.js",
	"./sk.js": "../../../../moment/locale/sk.js",
	"./sl": "../../../../moment/locale/sl.js",
	"./sl.js": "../../../../moment/locale/sl.js",
	"./sq": "../../../../moment/locale/sq.js",
	"./sq.js": "../../../../moment/locale/sq.js",
	"./sr": "../../../../moment/locale/sr.js",
	"./sr-cyrl": "../../../../moment/locale/sr-cyrl.js",
	"./sr-cyrl.js": "../../../../moment/locale/sr-cyrl.js",
	"./sr.js": "../../../../moment/locale/sr.js",
	"./ss": "../../../../moment/locale/ss.js",
	"./ss.js": "../../../../moment/locale/ss.js",
	"./sv": "../../../../moment/locale/sv.js",
	"./sv.js": "../../../../moment/locale/sv.js",
	"./sw": "../../../../moment/locale/sw.js",
	"./sw.js": "../../../../moment/locale/sw.js",
	"./ta": "../../../../moment/locale/ta.js",
	"./ta.js": "../../../../moment/locale/ta.js",
	"./te": "../../../../moment/locale/te.js",
	"./te.js": "../../../../moment/locale/te.js",
	"./tet": "../../../../moment/locale/tet.js",
	"./tet.js": "../../../../moment/locale/tet.js",
	"./th": "../../../../moment/locale/th.js",
	"./th.js": "../../../../moment/locale/th.js",
	"./tl-ph": "../../../../moment/locale/tl-ph.js",
	"./tl-ph.js": "../../../../moment/locale/tl-ph.js",
	"./tlh": "../../../../moment/locale/tlh.js",
	"./tlh.js": "../../../../moment/locale/tlh.js",
	"./tr": "../../../../moment/locale/tr.js",
	"./tr.js": "../../../../moment/locale/tr.js",
	"./tzl": "../../../../moment/locale/tzl.js",
	"./tzl.js": "../../../../moment/locale/tzl.js",
	"./tzm": "../../../../moment/locale/tzm.js",
	"./tzm-latn": "../../../../moment/locale/tzm-latn.js",
	"./tzm-latn.js": "../../../../moment/locale/tzm-latn.js",
	"./tzm.js": "../../../../moment/locale/tzm.js",
	"./uk": "../../../../moment/locale/uk.js",
	"./uk.js": "../../../../moment/locale/uk.js",
	"./ur": "../../../../moment/locale/ur.js",
	"./ur.js": "../../../../moment/locale/ur.js",
	"./uz": "../../../../moment/locale/uz.js",
	"./uz-latn": "../../../../moment/locale/uz-latn.js",
	"./uz-latn.js": "../../../../moment/locale/uz-latn.js",
	"./uz.js": "../../../../moment/locale/uz.js",
	"./vi": "../../../../moment/locale/vi.js",
	"./vi.js": "../../../../moment/locale/vi.js",
	"./x-pseudo": "../../../../moment/locale/x-pseudo.js",
	"./x-pseudo.js": "../../../../moment/locale/x-pseudo.js",
	"./yo": "../../../../moment/locale/yo.js",
	"./yo.js": "../../../../moment/locale/yo.js",
	"./zh-cn": "../../../../moment/locale/zh-cn.js",
	"./zh-cn.js": "../../../../moment/locale/zh-cn.js",
	"./zh-hk": "../../../../moment/locale/zh-hk.js",
	"./zh-hk.js": "../../../../moment/locale/zh-hk.js",
	"./zh-tw": "../../../../moment/locale/zh-tw.js",
	"./zh-tw.js": "../../../../moment/locale/zh-tw.js"
};
function webpackContext(req) {
	return __webpack_require__(webpackContextResolve(req));
};
function webpackContextResolve(req) {
	var id = map[req];
	if(!(id + 1)) // check for number or string
		throw new Error("Cannot find module '" + req + "'.");
	return id;
};
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "../../../../moment/locale recursive ^\\.\\/.*$";

/***/ }),

/***/ 1:
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__("../../../../../src/classroom/main.ts");


/***/ })

},[1]);
//# sourceMappingURL=main.bundle.js.map